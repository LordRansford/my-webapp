#!/usr/bin/env node
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

function qid(prefix, n) {
  return `${prefix}-q${String(n).padStart(2, "0")}`;
}

function mcq({ id, question, options, correctIndex, explanation, tags, bloomLevel }) {
  return {
    id,
    type: "MCQ",
    bloomLevel,
    difficultyTarget: 0.6,
    discriminationIndex: null,
    question,
    options: JSON.stringify(options),
    correctAnswer: JSON.stringify(correctIndex),
    explanation,
    tags,
  };
}

const foundations = [
  mcq({ id: qid("cyber-foundations", 1), bloomLevel: 1, tags: "cia,basics", question: "Which goal is about preventing unauthorised reading of data", options: ["Confidentiality", "Integrity", "Availability", "Non repudiation"], correctIndex: 0, explanation: "Confidentiality is about restricting access to data so only authorised parties can read it.", }),
  mcq({ id: qid("cyber-foundations", 2), bloomLevel: 1, tags: "cia,basics", question: "Which goal is about preventing unauthorised changes to data", options: ["Availability", "Integrity", "Confidentiality", "Observability"], correctIndex: 1, explanation: "Integrity is about ensuring data is accurate and has not been altered without authorisation.", }),
  mcq({ id: qid("cyber-foundations", 3), bloomLevel: 2, tags: "authn,authz", question: "You can log in but you cannot view a resource. Which control is failing", options: ["Authentication", "Authorisation", "Encryption", "Backups"], correctIndex: 1, explanation: "Authentication proves who you are. Authorisation decides what you can access after you are identified.", }),
  mcq({ id: qid("cyber-foundations", 4), bloomLevel: 2, tags: "mfa,account", question: "What is the strongest reason to use multi factor authentication", options: ["It makes passwords longer", "It reduces risk from stolen passwords", "It removes the need for monitoring", "It prevents all phishing"], correctIndex: 1, explanation: "Multi factor authentication reduces account takeover risk when a password is phished or reused.", }),
  mcq({ id: qid("cyber-foundations", 5), bloomLevel: 2, tags: "phishing,awareness", question: "Which sign is most reliable for identifying a phishing attempt", options: ["A logo that looks wrong", "Urgent pressure plus a link to sign in", "Poor spelling", "A message sent at night"], correctIndex: 1, explanation: "Pressure and an unexpected sign in link are common and effective phishing patterns even when spelling looks perfect.", }),
  mcq({ id: qid("cyber-foundations", 6), bloomLevel: 2, tags: "patching,vuln", question: "Why do organisations patch regularly", options: ["To increase battery life", "To reduce known exploit risk", "To avoid needing backups", "To make software faster"], correctIndex: 1, explanation: "Patching removes known vulnerabilities which lowers the chance of compromise through public exploits.", }),
  mcq({ id: qid("cyber-foundations", 7), bloomLevel: 1, tags: "malware,basics", question: "What is ransomware", options: ["A tool that scans ports", "Malware that encrypts or locks data for payment", "A secure backup method", "A type of firewall rule"], correctIndex: 1, explanation: "Ransomware typically encrypts data or blocks access then demands payment to restore access.", }),
  mcq({ id: qid("cyber-foundations", 8), bloomLevel: 2, tags: "backups,resilience", question: "Which backup property best limits ransomware damage", options: ["Backups stored on the same server", "Backups that are immutable or offline", "Backups that are larger", "Backups that are compressed"], correctIndex: 1, explanation: "Offline or immutable backups prevent an attacker from encrypting or deleting the backups during an incident.", }),
  mcq({ id: qid("cyber-foundations", 9), bloomLevel: 2, tags: "logging,basics", question: "What is the main purpose of security logging", options: ["To slow attackers", "To detect and investigate activity", "To replace access controls", "To remove the need for updates"], correctIndex: 1, explanation: "Logs provide evidence of what happened so you can detect, investigate, and recover with confidence.", }),
  mcq({ id: qid("cyber-foundations", 10), bloomLevel: 2, tags: "least-privilege,iam", question: "Least privilege means", options: ["Everyone is an admin", "Users get only the access they need", "Access is granted forever", "Passwords must be shared"], correctIndex: 1, explanation: "Least privilege limits what an account can do so misuse and compromise have smaller impact.", }),
  mcq({ id: qid("cyber-foundations", 11), bloomLevel: 2, tags: "network,basics", question: "What does a firewall primarily do", options: ["Encrypts data at rest", "Controls network traffic based on rules", "Generates passwords", "Runs antivirus scans"], correctIndex: 1, explanation: "A firewall enforces allow and deny rules for network connections and reduces exposure.", }),
  mcq({ id: qid("cyber-foundations", 12), bloomLevel: 2, tags: "dns,basics", question: "DNS is used to", options: ["Store files", "Translate names to IP addresses", "Encrypt traffic", "Authenticate users"], correctIndex: 1, explanation: "DNS maps human readable domain names to IP addresses so clients can reach services.", }),
  mcq({ id: qid("cyber-foundations", 13), bloomLevel: 2, tags: "tls,basics", question: "TLS provides", options: ["Confidentiality and integrity in transit", "Integrity at rest only", "Backups", "User authorisation"], correctIndex: 0, explanation: "TLS encrypts and authenticates data in transit so traffic is private and tamper resistant.", }),
  mcq({ id: qid("cyber-foundations", 14), bloomLevel: 2, tags: "passwords,basics", question: "Which is the best guidance for passwords", options: ["Reuse a strong password everywhere", "Use a password manager and unique passwords", "Write passwords in a notebook", "Use short memorable passwords"], correctIndex: 1, explanation: "Unique passwords reduce credential stuffing risk and a manager makes strong passwords usable.", }),
  mcq({ id: qid("cyber-foundations", 15), bloomLevel: 2, tags: "risk,basics", question: "Risk is best described as", options: ["A list of threats", "Likelihood times impact", "A security tool", "A password policy"], correctIndex: 1, explanation: "Risk combines how likely an event is with how much damage it would cause.", }),
  mcq({ id: qid("cyber-foundations", 16), bloomLevel: 2, tags: "incident,basics", question: "In incident response what does containment aim to do", options: ["Restore all services immediately", "Stop the attacker from spreading", "Publish a press release", "Delete all logs"], correctIndex: 1, explanation: "Containment limits damage by stopping or isolating malicious activity before full recovery.", }),
  mcq({ id: qid("cyber-foundations", 17), bloomLevel: 2, tags: "social-engineering", question: "Social engineering attacks primarily target", options: ["Network cables", "Human decision making", "CPU speed", "Disk capacity"], correctIndex: 1, explanation: "Social engineering exploits trust, urgency, and confusion to bypass technical controls.", }),
  mcq({ id: qid("cyber-foundations", 18), bloomLevel: 2, tags: "updates,basics", question: "Why should browsers be kept up to date", options: ["To change the user interface", "To reduce known security flaws", "To increase monitor brightness", "To avoid needing HTTPS"], correctIndex: 1, explanation: "Browsers are a high value target and updates fix vulnerabilities used for drive by compromise.", }),
  mcq({ id: qid("cyber-foundations", 19), bloomLevel: 3, tags: "email,controls", question: "Which control most helps prevent email spoofing at your domain", options: ["DMARC with SPF and DKIM", "A longer domain name", "More inbox folders", "A VPN"], correctIndex: 0, explanation: "SPF and DKIM authenticate mail and DMARC enforces policy and reporting which reduces spoofing.", }),
  mcq({ id: qid("cyber-foundations", 20), bloomLevel: 3, tags: "accounts,shared", question: "Why are shared accounts risky", options: ["They are always faster", "They reduce accountability and increase blast radius", "They improve logging", "They prevent phishing"], correctIndex: 1, explanation: "Shared credentials remove identity certainty and make it harder to revoke access safely.", }),
  mcq({ id: qid("cyber-foundations", 21), bloomLevel: 2, tags: "data,classification", question: "Data classification is useful because it", options: ["Makes data smaller", "Helps apply controls based on sensitivity", "Eliminates the need for encryption", "Replaces backups"], correctIndex: 1, explanation: "Classification guides who can access data and what protection is required.", }),
  mcq({ id: qid("cyber-foundations", 22), bloomLevel: 2, tags: "device,hardening", question: "A secure baseline for a laptop usually includes", options: ["Disable updates", "Disk encryption and a screen lock", "Public admin account", "No backups"], correctIndex: 1, explanation: "Disk encryption protects data at rest and a screen lock prevents casual access to a logged in session.", }),
  mcq({ id: qid("cyber-foundations", 23), bloomLevel: 2, tags: "vpn,network", question: "A VPN mainly provides", options: ["Encrypted tunnel between device and network", "Guaranteed anonymity", "Automatic malware removal", "Stronger passwords"], correctIndex: 0, explanation: "A VPN encrypts traffic to a network endpoint. It does not guarantee anonymity or prevent endpoint compromise.", }),
  mcq({ id: qid("cyber-foundations", 24), bloomLevel: 2, tags: "encryption,keys", question: "If an attacker steals an encryption key they can often", options: ["Undo strong hashing", "Decrypt protected data", "Disable backups automatically", "Change DNS records"], correctIndex: 1, explanation: "Encryption depends on key secrecy. Key theft can defeat otherwise strong encryption.", }),
  mcq({ id: qid("cyber-foundations", 25), bloomLevel: 2, tags: "hashing,passwords", question: "Why should passwords be hashed and salted", options: ["To make them readable", "To make offline cracking harder", "To store them in logs", "To speed up login"], correctIndex: 1, explanation: "Salting prevents reuse of precomputed tables and hashing prevents storing passwords in plain text.", }),
  mcq({ id: qid("cyber-foundations", 26), bloomLevel: 3, tags: "supply-chain,basics", question: "A common software supply chain risk is", options: ["A slow internet connection", "A compromised dependency package", "A larger monitor", "A short meeting"], correctIndex: 1, explanation: "Dependencies can be attacked upstream which makes downstream applications vulnerable.", }),
  mcq({ id: qid("cyber-foundations", 27), bloomLevel: 2, tags: "segmentation,network", question: "Network segmentation helps by", options: ["Making all traffic public", "Limiting lateral movement after compromise", "Removing the need for firewalls", "Eliminating phishing"], correctIndex: 1, explanation: "Segmentation reduces blast radius by separating systems with different risk levels.", }),
  mcq({ id: qid("cyber-foundations", 28), bloomLevel: 2, tags: "defaults,hardening", question: "Why are default passwords dangerous", options: ["They are unique per device", "Attackers can guess them at scale", "They improve availability", "They encrypt the device"], correctIndex: 1, explanation: "Default credentials are widely known. Attackers automate scanning for them.", }),
  mcq({ id: qid("cyber-foundations", 29), bloomLevel: 2, tags: "mobile,security", question: "A safe default for a phone is", options: ["No screen lock", "Biometric or strong passcode plus updates", "Always install unknown apps", "Disable encryption"], correctIndex: 1, explanation: "Strong device unlock plus updates reduces common compromise paths.", }),
  mcq({ id: qid("cyber-foundations", 30), bloomLevel: 3, tags: "threat-model,basics", question: "Threat modelling is mainly used to", options: ["Predict stock prices", "Identify likely attackers and weak points", "Replace testing", "Disable logging"], correctIndex: 1, explanation: "Threat modelling helps you focus controls on realistic attack paths and valuable assets.", }),
  mcq({ id: qid("cyber-foundations", 31), bloomLevel: 2, tags: "privacy,basics", question: "Data minimisation means", options: ["Collect everything just in case", "Collect only what you need", "Never delete data", "Share data widely"], correctIndex: 1, explanation: "Minimisation reduces privacy risk and lowers impact if data is exposed.", }),
  mcq({ id: qid("cyber-foundations", 32), bloomLevel: 2, tags: "access,revocation", question: "What is a good practice when staff leave", options: ["Keep accounts active", "Revoke access quickly and review shared secrets", "Delete all logs", "Disable backups"], correctIndex: 1, explanation: "Fast revocation reduces insider and account takeover risk during transitions.", }),
  mcq({ id: qid("cyber-foundations", 33), bloomLevel: 2, tags: "monitoring,basics", question: "What is a good reason to alert on unusual logins", options: ["It makes dashboards pretty", "It can indicate account takeover", "It improves encryption", "It increases storage"], correctIndex: 1, explanation: "Unusual login patterns are a common early signal of compromise.", }),
  mcq({ id: qid("cyber-foundations", 34), bloomLevel: 2, tags: "updates,process", question: "Why should updates be tested and rolled out gradually", options: ["To hide vulnerabilities", "To reduce outage risk", "To prevent audit logs", "To increase phishing"], correctIndex: 1, explanation: "Staged rollout reduces operational risk while still improving security.", }),
  mcq({ id: qid("cyber-foundations", 35), bloomLevel: 2, tags: "physical,security", question: "Tailgating is", options: ["A network scan", "Entering a secure area by following someone", "Encrypting data", "A password policy"], correctIndex: 1, explanation: "Tailgating is a physical social engineering tactic to bypass access controls.", }),
  mcq({ id: qid("cyber-foundations", 36), bloomLevel: 2, tags: "principles,defence-in-depth", question: "Defence in depth means", options: ["One control is enough", "Use multiple layers of controls", "Avoid monitoring", "Share admin accounts"], correctIndex: 1, explanation: "Multiple layers reduce the chance that one failure leads to compromise.", }),
  mcq({ id: qid("cyber-foundations", 37), bloomLevel: 3, tags: "browser,security", question: "Why is an extension allow list useful", options: ["It blocks all websites", "It reduces risky add ons that can read data", "It improves WiFi speed", "It replaces backups"], correctIndex: 1, explanation: "Browser extensions can access sensitive data. Allow listing limits exposure.", }),
  mcq({ id: qid("cyber-foundations", 38), bloomLevel: 2, tags: "wifi,basics", question: "A safe default for WiFi security is", options: ["Open network", "WPA2 or WPA3 with a strong passphrase", "No password but hidden SSID", "WEP"], correctIndex: 1, explanation: "WPA2 and WPA3 provide stronger protection than outdated protocols like WEP.", }),
  mcq({ id: qid("cyber-foundations", 39), bloomLevel: 2, tags: "public-wifi", question: "When using public WiFi you should assume", options: ["Traffic is always private", "Traffic can be monitored by others on the network", "Passwords cannot be stolen", "DNS cannot be changed"], correctIndex: 1, explanation: "Public networks are untrusted. Use HTTPS and consider a VPN for extra protection.", }),
  mcq({ id: qid("cyber-foundations", 40), bloomLevel: 3, tags: "secrets,basics", question: "Where should API keys be stored", options: ["In source code", "In a secret manager or secure environment variable store", "In a public wiki", "In client side JavaScript"], correctIndex: 1, explanation: "Secrets should be stored in controlled systems with rotation and auditability.", }),
  mcq({ id: qid("cyber-foundations", 41), bloomLevel: 2, tags: "threats,scanning", question: "Port scanning is used to", options: ["Measure CPU temperature", "Find exposed services on a host", "Encrypt files", "Create user accounts"], correctIndex: 1, explanation: "Scanning identifies open ports and services that may be vulnerable or misconfigured.", }),
  mcq({ id: qid("cyber-foundations", 42), bloomLevel: 2, tags: "backup,testing", question: "A backup is only useful if", options: ["It is never tested", "You can restore from it", "It is stored in email", "It is larger than production"], correctIndex: 1, explanation: "Restore tests validate that backups work and that recovery time is acceptable.", }),
  mcq({ id: qid("cyber-foundations", 43), bloomLevel: 2, tags: "policy,basics", question: "A security policy should be", options: ["Hidden from staff", "Clear and practical", "Only about punishment", "Unchangeable forever"], correctIndex: 1, explanation: "Policies must be understandable and workable so people can follow them consistently.", }),
  mcq({ id: qid("cyber-foundations", 44), bloomLevel: 3, tags: "metrics,basics", question: "A useful security metric is", options: ["Number of meetings held", "Time to patch critical issues", "Number of stickers on laptops", "Hours spent reading email"], correctIndex: 1, explanation: "Time to patch is tied to risk reduction and is actionable for teams.", }),
  mcq({ id: qid("cyber-foundations", 45), bloomLevel: 3, tags: "logging,retention", question: "Why does log retention matter", options: ["It increases CPU use", "You need history to investigate incidents", "It disables access controls", "It makes passwords weaker"], correctIndex: 1, explanation: "Without enough log history you cannot trace events or prove what happened.", }),
  mcq({ id: qid("cyber-foundations", 46), bloomLevel: 2, tags: "security,tradeoffs", question: "Which statement is most accurate about security", options: ["Security is a one time task", "Security is ongoing risk management", "Security is only a tool purchase", "Security can be ignored if you use cloud"], correctIndex: 1, explanation: "Security is a continuous process that balances risk, cost, and usability.", }),
  mcq({ id: qid("cyber-foundations", 47), bloomLevel: 3, tags: "access,review", question: "Access reviews help because they", options: ["Make code compile", "Remove unneeded access over time", "Guarantee no breaches", "Replace encryption"], correctIndex: 1, explanation: "Over time access accumulates. Reviews reduce privilege creep and stale accounts.", }),
  mcq({ id: qid("cyber-foundations", 48), bloomLevel: 2, tags: "endpoint,antivirus", question: "Endpoint protection is mainly intended to", options: ["Replace patching", "Detect and block malicious activity on devices", "Provide backups", "Stop all phishing"], correctIndex: 1, explanation: "Endpoint tools can detect and stop malware, but they work best alongside patching and least privilege.", }),
  mcq({ id: qid("cyber-foundations", 49), bloomLevel: 3, tags: "response,comms", question: "During an incident internal communication should be", options: ["Unplanned and informal only", "Clear and role based", "Hidden from everyone", "Sent to attackers"], correctIndex: 1, explanation: "Clear roles and updates reduce confusion and speed up coordinated response.", }),
  mcq({ id: qid("cyber-foundations", 50), bloomLevel: 3, tags: "controls,priority", question: "If you must pick one control for account security first choose", options: ["A new logo", "Multi factor authentication", "A longer username", "More email signatures"], correctIndex: 1, explanation: "Multi factor authentication reduces a large class of account takeover attacks quickly.", }),
];

const applied = [
  mcq({ id: qid("cyber-applied", 1), bloomLevel: 3, tags: "owasp,auth", question: "An attacker reuses leaked passwords to log in. Which attack is this", options: ["Credential stuffing", "SQL injection", "DNS cache poisoning", "DDoS"], correctIndex: 0, explanation: "Credential stuffing uses known username and password pairs across many sites.", }),
  mcq({ id: qid("cyber-applied", 2), bloomLevel: 3, tags: "owasp,web", question: "User input is concatenated into a SQL query. What risk is most direct", options: ["SQL injection", "Clickjacking", "Broken access control", "Insecure deserialisation"], correctIndex: 0, explanation: "SQL injection can allow attackers to change the meaning of a query and access data.", }),
  mcq({ id: qid("cyber-applied", 3), bloomLevel: 3, tags: "owasp,web", question: "A page reflects untrusted input and runs script in the browser. What is this", options: ["Cross site scripting", "Rate limiting", "CSRF", "SSRF"], correctIndex: 0, explanation: "Cross site scripting executes attacker controlled script in a victim browser context.", }),
  mcq({ id: qid("cyber-applied", 4), bloomLevel: 3, tags: "owasp,csrf", question: "A logged in user is tricked into submitting a hidden form. What is this", options: ["CSRF", "RCE", "LFI", "SSTI"], correctIndex: 0, explanation: "CSRF abuses a user session to perform actions without the user intent.", }),
  mcq({ id: qid("cyber-applied", 5), bloomLevel: 4, tags: "auth,cookies", question: "A secure session cookie should usually be", options: ["HttpOnly and Secure", "Readable by JavaScript and sent over HTTP", "Stored in localStorage only", "Shared across unrelated domains"], correctIndex: 0, explanation: "HttpOnly reduces XSS impact and Secure ensures cookies are only sent over HTTPS.", }),
  mcq({ id: qid("cyber-applied", 6), bloomLevel: 4, tags: "access-control", question: "A user can access another user profile by changing an id in the URL. What is this", options: ["Broken access control", "Path traversal", "DNS spoofing", "Race condition"], correctIndex: 0, explanation: "This is an authorisation failure where object level access checks are missing or incorrect.", }),
  mcq({ id: qid("cyber-applied", 7), bloomLevel: 4, tags: "logging,api", question: "Which log field is most important for traceability", options: ["A stable user or subject id", "A random emoji", "The page background colour", "The font size"], correctIndex: 0, explanation: "Traceability depends on being able to connect actions to a stable identity and request context.", }),
  mcq({ id: qid("cyber-applied", 8), bloomLevel: 4, tags: "rate-limit,abuse", question: "Rate limiting best reduces which risk", options: ["Brute force and abuse at scale", "Local file inclusion", "Buffer overflow", "Supply chain compromise"], correctIndex: 0, explanation: "Rate limiting constrains repeated attempts such as password guessing and scraping.", }),
  mcq({ id: qid("cyber-applied", 9), bloomLevel: 4, tags: "secrets,devops", question: "A secret is committed to git. What is the best immediate action", options: ["Rotate the secret and remove it from history if possible", "Rename the variable", "Ignore it and rely on HTTPS", "Add comments in code"], correctIndex: 0, explanation: "Assume the secret is compromised. Rotate quickly, then clean up history and add scanning.", }),
  mcq({ id: qid("cyber-applied", 10), bloomLevel: 4, tags: "sdlc,testing", question: "A SAST tool is most useful for", options: ["Finding risky code patterns early", "Replacing code review", "Creating backups", "Blocking all runtime attacks"], correctIndex: 0, explanation: "Static analysis flags patterns and common bugs earlier in the build pipeline.", }),
  mcq({ id: qid("cyber-applied", 11), bloomLevel: 4, tags: "threat-model,dataflow", question: "A trust boundary is", options: ["Where data crosses into a different privilege zone", "A database index", "A UI theme", "A compression method"], correctIndex: 0, explanation: "Trust boundaries mark where assumptions change and where extra checks are needed.", }),
  mcq({ id: qid("cyber-applied", 12), bloomLevel: 4, tags: "ssrf,cloud", question: "SSRF is most dangerous because it can", options: ["Reach internal services from a public endpoint", "Reduce CPU usage", "Improve caching", "Encrypt backups"], correctIndex: 0, explanation: "SSRF lets attackers use server network access to hit internal targets and metadata endpoints.", }),
  mcq({ id: qid("cyber-applied", 13), bloomLevel: 4, tags: "injection,command", question: "If untrusted input is passed to a shell command the main risk is", options: ["Command injection", "CSRF", "Clickjacking", "Open redirect"], correctIndex: 0, explanation: "Command injection can allow arbitrary command execution in the server context.", }),
  mcq({ id: qid("cyber-applied", 14), bloomLevel: 3, tags: "crypto,basics", question: "A password reset token should be", options: ["Random, single use, and time limited", "Based on user id only", "The same for every user", "Stored in logs"], correctIndex: 0, explanation: "Reset tokens must be unpredictable and expire quickly to reduce account takeover risk.", }),
  mcq({ id: qid("cyber-applied", 15), bloomLevel: 4, tags: "privacy,logging", question: "What should you avoid logging by default", options: ["Passwords and secrets", "Request ids", "Status codes", "Latency"], correctIndex: 0, explanation: "Sensitive data in logs increases breach impact and can leak credentials.", }),
  mcq({ id: qid("cyber-applied", 16), bloomLevel: 4, tags: "validation,input", question: "Input validation is best described as", options: ["Reject or normalise unexpected input before processing", "Store all input exactly as received", "Disable error messages", "Avoid using types"], correctIndex: 0, explanation: "Validation reduces injection and logic flaws by controlling what enters the system.", }),
  mcq({ id: qid("cyber-applied", 17), bloomLevel: 4, tags: "security-headers,web", question: "Which header reduces clickjacking risk", options: ["X Frame Options or frame ancestors", "Accept", "Server", "Cache Control"], correctIndex: 0, explanation: "Frame restrictions prevent your site from being embedded in a malicious page overlay.", }),
  mcq({ id: qid("cyber-applied", 18), bloomLevel: 4, tags: "csp,web", question: "Content Security Policy mainly helps by", options: ["Reducing impact of XSS", "Improving DNS resolution", "Replacing encryption", "Speeding up uploads"], correctIndex: 0, explanation: "CSP limits where scripts can load from and can block inline script execution.", }),
  mcq({ id: qid("cyber-applied", 19), bloomLevel: 4, tags: "deps,sbom", question: "An SBOM is useful because it", options: ["Lists components so you can respond to vulnerability news", "Encrypts traffic", "Stops phishing", "Creates access tokens"], correctIndex: 0, explanation: "Knowing what you run helps you assess exposure quickly when a dependency issue is reported.", }),
  mcq({ id: qid("cyber-applied", 20), bloomLevel: 4, tags: "reviews,change", question: "A lightweight feature security review should include", options: ["Risks, controls, and how you will verify them", "Only a diagram of the UI", "Only a list of tools", "Only a company slogan"], correctIndex: 0, explanation: "The goal is defensible decisions. That requires risks, controls, and evidence of verification.", }),
  mcq({ id: qid("cyber-applied", 21), bloomLevel: 4, tags: "auth,token", question: "A refresh token should usually be stored", options: ["In an HttpOnly cookie with rotation", "In a public repo", "In the URL query string", "Inside an email signature"], correctIndex: 0, explanation: "Refresh tokens are powerful. Protect them and rotate to reduce replay and theft impact.", }),
  mcq({ id: qid("cyber-applied", 22), bloomLevel: 3, tags: "api,authz", question: "For API access control the safest default is", options: ["Deny by default", "Allow by default", "Allow if request has any header", "Allow if client uses HTTPS"], correctIndex: 0, explanation: "Deny by default prevents accidental exposure when new endpoints are added.", }),
  mcq({ id: qid("cyber-applied", 23), bloomLevel: 4, tags: "idempotency,api", question: "Idempotency keys are mainly used to", options: ["Prevent duplicate charges on retries", "Encrypt payloads", "Rotate passwords", "Disable caching"], correctIndex: 0, explanation: "Idempotency ensures that retrying a request does not create multiple side effects.", }),
  mcq({ id: qid("cyber-applied", 24), bloomLevel: 4, tags: "uploads,web", question: "File upload security should include", options: ["Type validation and storage isolation", "Only a bigger server", "Disable antivirus", "Accept any executable"], correctIndex: 0, explanation: "Uploads can be used for malware or script injection. Validate and isolate to reduce impact.", }),
  mcq({ id: qid("cyber-applied", 25), bloomLevel: 4, tags: "auth,lockout", question: "Account lockout should be designed to avoid", options: ["Denial of service by attackers", "Logging", "Encryption", "MFA"], correctIndex: 0, explanation: "Attackers can trigger lockouts to block real users. Use rate limits and detection instead of harsh lockouts.", }),
  mcq({ id: qid("cyber-applied", 26), bloomLevel: 4, tags: "errors,infoleak", question: "Why should error messages be careful", options: ["They can leak sensitive internal details", "They reduce uptime", "They break DNS", "They disable HTTPS"], correctIndex: 0, explanation: "Overly detailed errors reveal system structure and can guide attackers to exploit paths.", }),
  mcq({ id: qid("cyber-applied", 27), bloomLevel: 4, tags: "tokens,jwt", question: "JWT validation must include", options: ["Signature and expected audience checks", "Only base64 decoding", "Only checking length", "Only checking issuer string in UI"], correctIndex: 0, explanation: "You must verify signature and claims such as audience to ensure a token is intended for your service.", }),
  mcq({ id: qid("cyber-applied", 28), bloomLevel: 4, tags: "caching,privacy", question: "Caching personalised pages can be risky because it", options: ["Can leak one user data to another", "Makes pages too fast", "Encrypts content", "Improves availability"], correctIndex: 0, explanation: "If cache keys are wrong, private content can be served to other users.", }),
  mcq({ id: qid("cyber-applied", 29), bloomLevel: 4, tags: "infra,config", question: "A common misconfiguration in cloud storage is", options: ["Public read access to sensitive buckets", "Too many unit tests", "Too much compression", "Too many logs"], correctIndex: 0, explanation: "Public access misconfigurations can expose data directly without exploitation.", }),
  mcq({ id: qid("cyber-applied", 30), bloomLevel: 4, tags: "infra,iam", question: "Service to service calls should use", options: ["Short lived credentials and least privilege roles", "Shared admin passwords", "Hard coded keys in code", "Anonymous access"], correctIndex: 0, explanation: "Short lived credentials reduce leakage impact and roles restrict actions to what is needed.", }),
  mcq({ id: qid("cyber-applied", 31), bloomLevel: 4, tags: "observability,security", question: "A high signal authentication alert is", options: ["Many failed logins followed by a success", "One successful login", "A user changing theme", "A page view"], correctIndex: 0, explanation: "Burst failures then success often indicates guessing or credential stuffing that finally worked.", }),
  mcq({ id: qid("cyber-applied", 32), bloomLevel: 4, tags: "permissions,scopes", question: "OAuth scopes should be", options: ["Minimal and reviewed regularly", "As wide as possible", "Randomly named", "Stored in client side logs"], correctIndex: 0, explanation: "Minimal scopes reduce damage if a token is misused and keep user consent meaningful.", }),
  mcq({ id: qid("cyber-applied", 33), bloomLevel: 4, tags: "supply-chain,ci", question: "Which control best reduces malicious dependency updates", options: ["Pin versions and verify integrity", "Allow any version automatically", "Disable code review", "Disable tests"], correctIndex: 0, explanation: "Pinning and integrity checks reduce unexpected changes from upstream sources.", }),
  mcq({ id: qid("cyber-applied", 34), bloomLevel: 4, tags: "secrets,rotation", question: "Secret rotation is important because", options: ["It limits how long stolen secrets remain useful", "It improves screen resolution", "It guarantees no breaches", "It prevents all bugs"], correctIndex: 0, explanation: "If a secret leaks, rotation reduces the window of exploitation.", }),
  mcq({ id: qid("cyber-applied", 35), bloomLevel: 4, tags: "api,validation", question: "Why should you validate server side even if the client validates", options: ["Clients can be bypassed or modified", "It breaks caching", "It disables HTTPS", "It makes UI slower"], correctIndex: 0, explanation: "Attackers can send requests directly. Server side validation is the authoritative guard.", }),
  mcq({ id: qid("cyber-applied", 36), bloomLevel: 4, tags: "db,least-privilege", question: "A database user for an app should usually have", options: ["Only needed permissions such as read and write on required tables", "Superuser access", "Permission to drop all schemas", "No password"], correctIndex: 0, explanation: "Least privilege at the database layer reduces damage if the app is compromised.", }),
  mcq({ id: qid("cyber-applied", 37), bloomLevel: 4, tags: "headers,transport", question: "HSTS is used to", options: ["Force HTTPS for a domain", "Encrypt data at rest", "Rotate keys", "Check passwords"], correctIndex: 0, explanation: "HSTS tells browsers to use HTTPS and prevents downgrade to HTTP.", }),
  mcq({ id: qid("cyber-applied", 38), bloomLevel: 4, tags: "storage,encryption", question: "Encrypting data at rest helps mainly if", options: ["Storage is stolen or accessed without OS controls", "Users forget passwords", "Logs are too large", "Servers are too fast"], correctIndex: 0, explanation: "Encryption at rest reduces exposure from disk theft and some classes of access bypass.", }),
  mcq({ id: qid("cyber-applied", 39), bloomLevel: 4, tags: "abuse,limits", question: "A good abuse prevention step for sign up is", options: ["Email verification and rate limits", "Disable logging", "Allow unlimited attempts", "Use one shared account"], correctIndex: 0, explanation: "Verification and rate limits reduce automated abuse and account farming.", }),
  mcq({ id: qid("cyber-applied", 40), bloomLevel: 4, tags: "api,pagination", question: "Why is pagination useful for security", options: ["It limits data exfiltration speed and load", "It replaces authorisation", "It disables TLS", "It forces admin access"], correctIndex: 0, explanation: "Pagination reduces the impact of scraping and makes abusive queries easier to detect.", }),
  mcq({ id: qid("cyber-applied", 41), bloomLevel: 4, tags: "audit,events", question: "An audit log should be", options: ["Append only and protected from tampering", "Editable by any user", "Stored only in browser storage", "Deleted daily without backup"], correctIndex: 0, explanation: "Audit logs must be trustworthy so they need tamper resistance and access controls.", }),
  mcq({ id: qid("cyber-applied", 42), bloomLevel: 4, tags: "api,ssrf", question: "If a URL fetch feature is required you should", options: ["Allow list domains and block internal IP ranges", "Allow any URL", "Disable DNS", "Store fetched content in secrets"], correctIndex: 0, explanation: "Allow lists and network controls reduce SSRF risk while still enabling safe functionality.", }),
  mcq({ id: qid("cyber-applied", 43), bloomLevel: 4, tags: "storage,uploads", question: "Serving user uploads from the same domain as your app is risky because", options: ["It can enable script execution in your origin", "It improves caching", "It reduces costs", "It increases TLS strength"], correctIndex: 0, explanation: "Separate domains reduce XSS risk from uploaded content and isolate cookies and credentials.", }),
  mcq({ id: qid("cyber-applied", 44), bloomLevel: 4, tags: "monitoring,alerting", question: "Which is a good alert action pair", options: ["Alert on admin role change and require approval", "Alert on page load and restart servers", "Alert on colour change and rotate secrets", "Alert on successful login and lock user"], correctIndex: 0, explanation: "Admin role changes are high risk and should be controlled and reviewed.", }),
  mcq({ id: qid("cyber-applied", 45), bloomLevel: 4, tags: "auth,reset", question: "A password reset flow should avoid", options: ["Leaking whether an email exists", "Using HTTPS", "Using tokens", "Logging events"], correctIndex: 0, explanation: "Account enumeration makes targeted attacks easier. Use consistent responses.", }),
  mcq({ id: qid("cyber-applied", 46), bloomLevel: 4, tags: "apis,scopes", question: "An API key with write access should", options: ["Be scoped to least privilege and rotated", "Be shared across customers", "Be embedded in public docs", "Never expire"], correctIndex: 0, explanation: "Write access keys can cause damage. Scope and rotation reduce exposure.", }),
  mcq({ id: qid("cyber-applied", 47), bloomLevel: 4, tags: "secure-sdlc,gates", question: "A good secure SDLC gate is one that", options: ["Has a clear output you can verify", "Is vague and optional", "Has no owner", "Changes every day"], correctIndex: 0, explanation: "Gates work when they are verifiable and repeatable with clear accountability.", }),
  mcq({ id: qid("cyber-applied", 48), bloomLevel: 4, tags: "privacy,consent", question: "Consent should be", options: ["Specific and revocable", "Bundled with unrelated features", "Assumed forever", "Hidden in logs"], correctIndex: 0, explanation: "Meaningful consent is specific, informed, and can be withdrawn.", }),
  mcq({ id: qid("cyber-applied", 49), bloomLevel: 4, tags: "content,rendering", question: "To prevent XSS when rendering user text you should", options: ["Escape or sanitise and avoid dangerous HTML injection", "Disable TLS", "Trust all input", "Store scripts in cookies"], correctIndex: 0, explanation: "Escaping and safe rendering prevent attacker controlled script from executing.", }),
  mcq({ id: qid("cyber-applied", 50), bloomLevel: 4, tags: "risk,prioritisation", question: "When fixing issues first you should consider", options: ["Exposure and impact", "Only code style", "Only number of lines", "Only developer preference"], correctIndex: 0, explanation: "Prioritisation should focus on likely exploit paths and the damage they can cause.", }),
];

const practice = [
  mcq({ id: qid("cyber-practice", 1), bloomLevel: 5, tags: "sdlc,gates", question: "A build pipeline gate should fail the build when", options: ["Critical issues are detected and not waived", "The UI colour changes", "A comment is added", "A test name is long"], correctIndex: 0, explanation: "Failing on critical issues prevents risky releases unless an explicit exception is approved.", }),
  mcq({ id: qid("cyber-practice", 2), bloomLevel: 5, tags: "threat-model,design", question: "When reviewing a design the highest value first question is", options: ["What assets must be protected and who can reach them", "What is the favourite framework", "What is the font family", "What is the meeting schedule"], correctIndex: 0, explanation: "Asset focus and reachable attack paths drive the rest of the review and control choices.", }),
  mcq({ id: qid("cyber-practice", 3), bloomLevel: 5, tags: "zero-trust,network", question: "Zero trust is best summarised as", options: ["Verify explicitly and minimise implicit trust", "Trust internal networks fully", "Disable MFA", "Use one shared password"], correctIndex: 0, explanation: "Zero trust reduces reliance on network location and emphasises identity, device posture, and least privilege.", }),
  mcq({ id: qid("cyber-practice", 4), bloomLevel: 5, tags: "runtime,cloud", question: "A high value runtime control is", options: ["Detect unusual process and network behaviour", "Disable logging", "Disable patching", "Allow all outbound traffic"], correctIndex: 0, explanation: "Runtime detection catches compromise that bypasses prevention controls.", }),
  mcq({ id: qid("cyber-practice", 5), bloomLevel: 5, tags: "vuln,triage", question: "A vulnerability should be prioritised highest when", options: ["It is reachable from the internet and has high impact", "It is only theoretical and unreachable", "It is in a test README", "It affects only a local developer machine"], correctIndex: 0, explanation: "Exposure plus impact drives urgency. Internet reachable high impact issues are often urgent.", }),
  mcq({ id: qid("cyber-practice", 6), bloomLevel: 5, tags: "ir,detection", question: "A good detection rule should", options: ["Be testable and linked to a response action", "Alert on everything always", "Be undocumented", "Require manual reading of raw logs"], correctIndex: 0, explanation: "Detections must be actionable. Testability and response linkage reduce noise and improve outcomes.", }),
  mcq({ id: qid("cyber-practice", 7), bloomLevel: 5, tags: "supply-chain,controls", question: "To reduce supply chain build risk you should", options: ["Use pinned dependencies and restricted build permissions", "Allow random scripts to run as admin", "Disable signing", "Disable reviews"], correctIndex: 0, explanation: "Pinning and limiting build permissions reduces the chance that a compromised dependency can do damage.", }),
  mcq({ id: qid("cyber-practice", 8), bloomLevel: 5, tags: "privacy,audit", question: "Auditability in privacy work requires", options: ["Evidence of decisions and data flows", "Only marketing pages", "No logs at all", "Secrets in tickets"], correctIndex: 0, explanation: "You need traceable evidence of what data is processed, why, and how controls were chosen.", }),
  mcq({ id: qid("cyber-practice", 9), bloomLevel: 5, tags: "reliability,security", question: "Security and reliability overlap because", options: ["Outages and incidents both need clear response and evidence", "They are unrelated", "Security replaces backups", "Reliability removes need for access control"], correctIndex: 0, explanation: "Both require operational discipline, detection, and response processes that minimise impact.", }),
  mcq({ id: qid("cyber-practice", 10), bloomLevel: 5, tags: "cloud,iam", question: "The best default for cloud IAM policies is", options: ["Start narrow and expand with evidence", "Start wide and hope to tighten later", "Give everyone owner", "Disable logs"], correctIndex: 0, explanation: "Starting narrow reduces immediate blast radius and forces intentional access growth.", }),
  mcq({ id: qid("cyber-practice", 11), bloomLevel: 5, tags: "secrets,ops", question: "Secret scanning alerts should trigger", options: ["Rotation and an investigation of exposure", "A UI redesign", "A new logo", "Deletion of all logs"], correctIndex: 0, explanation: "Treat secret exposure as a potential incident. Rotate quickly and assess where the secret was used.", }),
  mcq({ id: qid("cyber-practice", 12), bloomLevel: 5, tags: "logging,design", question: "The most useful security log fields for an API are", options: ["Subject id, request id, action, result, and source", "Only the UI theme", "Only the browser language", "Only the server hostname"], correctIndex: 0, explanation: "Traceable fields let you reconstruct who did what, when, and from where.", }),
  mcq({ id: qid("cyber-practice", 13), bloomLevel: 5, tags: "incident,first-hour", question: "In the first hour of an incident you should prioritise", options: ["Containment and preserving evidence", "Deleting systems", "Announcing blame", "Turning off all monitoring"], correctIndex: 0, explanation: "Containment reduces damage and evidence preservation supports investigation and recovery.", }),
  mcq({ id: qid("cyber-practice", 14), bloomLevel: 5, tags: "vuln,patch", question: "A safe patch rollout strategy is", options: ["Stage rollout with monitoring and rollback plan", "Deploy everywhere instantly without checks", "Never patch", "Patch only after a breach"], correctIndex: 0, explanation: "Staged rollout balances speed and stability while allowing quick rollback if issues appear.", }),
  mcq({ id: qid("cyber-practice", 15), bloomLevel: 5, tags: "detection,false-positives", question: "Reducing false positives usually requires", options: ["Tuning based on real behaviour and test cases", "Alerting on less data", "Deleting logs", "Disabling alerts"], correctIndex: 0, explanation: "Tune using known good behaviour and test scenarios so alerts are meaningful.", }),
  mcq({ id: qid("cyber-practice", 16), bloomLevel: 5, tags: "zero-trust,identity", question: "A strong identity control for admin access is", options: ["MFA plus device posture and approval workflow", "One shared password", "Public tokens in code", "No session timeout"], correctIndex: 0, explanation: "Admin access needs strong identity assurance and explicit approvals to reduce misuse.", }),
  mcq({ id: qid("cyber-practice", 17), bloomLevel: 5, tags: "sdlc,threat-model", question: "Threat modelling should happen", options: ["Before building and again after major changes", "Only after an incident", "Only in production", "Only in marketing"], correctIndex: 0, explanation: "Early modelling prevents expensive redesign and repeated modelling keeps it aligned with reality.", }),
  mcq({ id: qid("cyber-practice", 18), bloomLevel: 5, tags: "cloud,metadata", question: "Why is the instance metadata endpoint a risk in cloud", options: ["It can expose credentials if reachable via SSRF", "It improves uptime", "It encrypts disks", "It blocks attacks"], correctIndex: 0, explanation: "SSRF can reach metadata endpoints and steal credentials which can lead to account compromise.", }),
  mcq({ id: qid("cyber-practice", 19), bloomLevel: 5, tags: "sbom,response", question: "When a critical dependency vulnerability is announced first you should", options: ["Identify where you use it then patch or mitigate", "Wait a month", "Disable logs", "Change branding"], correctIndex: 0, explanation: "Exposure assessment comes first. Then patch, mitigate, and verify quickly.", }),
  mcq({ id: qid("cyber-practice", 20), bloomLevel: 5, tags: "governance,policy", question: "A good security exception process should require", options: ["Reason, owner, expiry date, and compensating controls", "Only a verbal agreement", "No record", "Permanent approvals"], correctIndex: 0, explanation: "Exceptions add risk. You need accountability and expiry so risk does not become permanent.", }),
  mcq({ id: qid("cyber-practice", 21), bloomLevel: 5, tags: "monitoring,coverage", question: "Detection coverage should map to", options: ["High value assets and likely attack paths", "Favourite tools", "Office seating plan", "Holiday calendar"], correctIndex: 0, explanation: "Coverage is most valuable when it matches realistic attack paths against important assets.", }),
  mcq({ id: qid("cyber-practice", 22), bloomLevel: 5, tags: "vuln,signals", question: "An exploit in the wild signal should", options: ["Increase priority and accelerate patching", "Reduce priority", "Disable monitoring", "Stop backups"], correctIndex: 0, explanation: "Active exploitation raises likelihood so it should increase urgency.", }),
  mcq({ id: qid("cyber-practice", 23), bloomLevel: 5, tags: "tls,ops", question: "A certificate expiry incident is best prevented by", options: ["Monitoring with early warning and rotation runbook", "Using longer passwords", "Disabling HTTPS", "Deleting DNS records"], correctIndex: 0, explanation: "Expiry is predictable. Monitoring and a runbook prevent avoidable outages.", }),
  mcq({ id: qid("cyber-practice", 24), bloomLevel: 5, tags: "backup,recovery", question: "Recovery time objective is", options: ["How quickly you must restore service", "How many logs you store", "How many users you have", "How long passwords are"], correctIndex: 0, explanation: "RTO defines acceptable downtime so recovery plans can be designed and tested.", }),
  mcq({ id: qid("cyber-practice", 25), bloomLevel: 5, tags: "architecture,segmentation", question: "Segmentation can be validated by", options: ["Network tests that confirm blocked paths", "Assuming it works", "Disabling logs", "Only reading diagrams"], correctIndex: 0, explanation: "Verification needs tests that confirm the intended blocks are in place in reality.", }),
  mcq({ id: qid("cyber-practice", 26), bloomLevel: 5, tags: "cloud,logging", question: "For cloud audit logs you should ensure", options: ["They are enabled, centralised, and protected", "They are stored on each laptop", "They are deleted weekly", "They are editable by any user"], correctIndex: 0, explanation: "Centralised protected logs support incident investigation and compliance needs.", }),
  mcq({ id: qid("cyber-practice", 27), bloomLevel: 5, tags: "kms,keys", question: "A strong key management practice is", options: ["Limit key use and audit access", "Share keys in chat", "Store keys in code", "Never rotate keys"], correctIndex: 0, explanation: "Restricting and auditing key use reduces the chance that key compromise goes unnoticed.", }),
  mcq({ id: qid("cyber-practice", 28), bloomLevel: 5, tags: "privacy,retention", question: "Data retention should", options: ["Be limited to what is needed and enforced by deletion", "Be forever for convenience", "Ignore legal needs", "Be stored in logs"], correctIndex: 0, explanation: "Retention limits reduce risk and support privacy obligations when deletion is enforced.", }),
  mcq({ id: qid("cyber-practice", 29), bloomLevel: 5, tags: "response,roles", question: "During a major incident decision authority should be", options: ["Clear and preassigned", "Undefined until the incident happens", "Given to everyone equally", "Given to attackers"], correctIndex: 0, explanation: "Clear roles prevent delays and conflicting actions during high pressure response.", }),
  mcq({ id: qid("cyber-practice", 30), bloomLevel: 5, tags: "vuln,ownership", question: "Vulnerability management improves when you have", options: ["Clear owners and deadlines", "No tracking", "Only meetings", "Only a new logo"], correctIndex: 0, explanation: "Ownership and deadlines turn findings into fixes. Without them issues linger and risk stays.", }),
  mcq({ id: qid("cyber-practice", 31), bloomLevel: 5, tags: "attack-surface", question: "Attack surface is reduced by", options: ["Removing unused services and closing ports", "Adding more ports", "Sharing credentials", "Disabling updates"], correctIndex: 0, explanation: "Fewer exposed services means fewer paths for attackers to exploit.", }),
  mcq({ id: qid("cyber-practice", 32), bloomLevel: 5, tags: "ops,evidence", question: "Operational evidence is most convincing when it is", options: ["Repeatable and time stamped", "Only verbal", "Only a screenshot without context", "Hidden in personal notes"], correctIndex: 0, explanation: "Repeatable time stamped evidence supports audits and incident learning without relying on memory.", }),
  mcq({ id: qid("cyber-practice", 33), bloomLevel: 5, tags: "ransomware,prep", question: "The best preparation for ransomware is", options: ["Offline backups plus tested restore and detection", "Paying immediately", "Disabling backups", "Sharing admin passwords"], correctIndex: 0, explanation: "Resilient backups and tested recovery reduce leverage. Detection helps contain early.", }),
  mcq({ id: qid("cyber-practice", 34), bloomLevel: 5, tags: "cloud,egress", question: "Outbound egress controls help by", options: ["Limiting data exfiltration paths", "Improving UI colour", "Replacing TLS", "Disabling MFA"], correctIndex: 0, explanation: "Egress filtering can stop unexpected outbound connections and reduce exfiltration options.", }),
  mcq({ id: qid("cyber-practice", 35), bloomLevel: 5, tags: "iam,review", question: "Privileged access should be", options: ["Reviewed and time limited", "Permanent for convenience", "Shared in a group account", "Logged only on paper"], correctIndex: 0, explanation: "Time limits and review reduce privilege creep and make misuse easier to detect.", }),
  mcq({ id: qid("cyber-practice", 36), bloomLevel: 5, tags: "cloud,break-glass", question: "A break glass account should be", options: ["Rarely used, monitored, and strongly protected", "Used daily", "Shared widely", "Without MFA"], correctIndex: 0, explanation: "Break glass access is for emergencies. Strong protection and monitoring reduce misuse risk.", }),
  mcq({ id: qid("cyber-practice", 37), bloomLevel: 5, tags: "sdlc,review", question: "A security design review output should include", options: ["Key risks and decisions with evidence", "Only a diagram title", "Only a budget", "Only a meeting note"], correctIndex: 0, explanation: "Reviews should produce decisions that can be defended later using evidence and rationale.", }),
  mcq({ id: qid("cyber-practice", 38), bloomLevel: 5, tags: "secrets,scope", question: "If a secret leak occurred you should assume", options: ["All systems that used it are potentially exposed", "No one saw it", "Only the UI is affected", "Only DNS is affected"], correctIndex: 0, explanation: "Secrets can be copied quickly. Assume exposure and investigate where the secret was valid.", }),
  mcq({ id: qid("cyber-practice", 39), bloomLevel: 5, tags: "incident,forensics", question: "Why keep original logs during investigation", options: ["They are evidence and support root cause analysis", "They look nice", "They reduce patch time", "They improve WiFi"], correctIndex: 0, explanation: "Original logs help reconstruct events and support containment and remediation decisions.", }),
  mcq({ id: qid("cyber-practice", 40), bloomLevel: 5, tags: "vuln,backlog", question: "A healthy vulnerability backlog is one where", options: ["Old critical issues are not left unowned", "Critical issues stay for years", "There is no tracking", "All issues are equal priority"], correctIndex: 0, explanation: "Critical issues need ownership and deadlines. Otherwise the backlog becomes a risk register only.", }),
  mcq({ id: qid("cyber-practice", 41), bloomLevel: 5, tags: "cloud,shared-responsibility", question: "In cloud shared responsibility you still own", options: ["Identity, configuration, and data protection", "Physical datacenter security only", "The provider billing page only", "Nothing at all"], correctIndex: 0, explanation: "Cloud providers secure the infrastructure. You still must configure services and protect data.", }),
  mcq({ id: qid("cyber-practice", 42), bloomLevel: 5, tags: "red-team,blue-team", question: "A realistic purple team exercise focuses on", options: ["Improving detections and response using real scenarios", "Winning an argument", "Buying tools only", "Hiding results"], correctIndex: 0, explanation: "The goal is practical improvement through measured scenarios and iteration.", }),
  mcq({ id: qid("cyber-practice", 43), bloomLevel: 5, tags: "audit,controls", question: "A control is easiest to audit when", options: ["It produces clear evidence automatically", "It depends on memory", "It is undocumented", "It is different every week"], correctIndex: 0, explanation: "Automatic evidence reduces reliance on manual reporting and improves consistency.", }),
  mcq({ id: qid("cyber-practice", 44), bloomLevel: 5, tags: "risk,acceptance", question: "Risk acceptance should be", options: ["Explicit with an owner and review date", "Silent", "Forever", "Done by interns only"], correctIndex: 0, explanation: "Accepted risk must be accountable and revisited as context changes.", }),
  mcq({ id: qid("cyber-practice", 45), bloomLevel: 5, tags: "operations,runbooks", question: "Runbooks are valuable because they", options: ["Reduce delay and mistakes under pressure", "Replace monitoring", "Replace authentication", "Remove need for backups"], correctIndex: 0, explanation: "Runbooks provide clear steps and contacts so response is faster and more consistent.", }),
  mcq({ id: qid("cyber-practice", 46), bloomLevel: 5, tags: "attack,chain", question: "Breaking an attack chain is easier when you", options: ["Detect early steps and contain quickly", "Wait for data theft", "Disable logs", "Use shared accounts"], correctIndex: 0, explanation: "Early detection and containment reduce attacker time and limit damage.", }),
  mcq({ id: qid("cyber-practice", 47), bloomLevel: 5, tags: "kpi,security", question: "A useful operational security KPI is", options: ["Mean time to detect and respond", "Number of emojis in tickets", "Number of pages in the wiki", "Number of meetings"], correctIndex: 0, explanation: "Time to detect and respond is tied to impact reduction and can be improved with practice.", }),
  mcq({ id: qid("cyber-practice", 48), bloomLevel: 5, tags: "design,defaults", question: "Secure defaults mean", options: ["New features start locked down and need explicit enablement", "All features start open", "Access is shared", "Logs are disabled"], correctIndex: 0, explanation: "Secure defaults reduce accidental exposure and make risk conscious changes intentional.", }),
  mcq({ id: qid("cyber-practice", 49), bloomLevel: 5, tags: "review,verification", question: "Verification is different from documentation because verification", options: ["Proves a control works in reality", "Is only a promise", "Is only a diagram", "Is only a meeting"], correctIndex: 0, explanation: "Verification uses tests or evidence to show controls are implemented and effective.", }),
  mcq({ id: qid("cyber-practice", 50), bloomLevel: 5, tags: "capstone,pack", question: "A strong operational security pack should include", options: ["Scope, risks, controls, verification, and evidence plan", "Only a slogan", "Only a list of tools", "Only a budget"], correctIndex: 0, explanation: "A pack is defensible when it clearly defines scope, top risks, chosen controls, how you verify, and what evidence you keep.", }),
];

async function upsertAssessment({ courseId, levelId }) {
  return prisma.assessment.upsert({
    where: { courseId_levelId: { courseId, levelId } },
    create: { courseId, levelId, passThreshold: 80, timeLimit: 75 },
    update: { passThreshold: 80, timeLimit: 75 },
    select: { id: true },
  });
}

async function upsertQuestions(assessmentId, items) {
  for (const q of items) {
    await prisma.question.upsert({
      where: { id: q.id },
      create: { ...q, assessmentId },
      update: {
        assessmentId,
        type: q.type,
        bloomLevel: q.bloomLevel,
        difficultyTarget: q.difficultyTarget,
        discriminationIndex: q.discriminationIndex,
        question: q.question,
        options: q.options,
        correctAnswer: q.correctAnswer,
        explanation: q.explanation,
        tags: q.tags,
      },
    });
  }
}

async function main() {
  const courseId = "cybersecurity";

  const a1 = await upsertAssessment({ courseId, levelId: "foundations" });
  await upsertQuestions(a1.id, foundations);

  const a2 = await upsertAssessment({ courseId, levelId: "applied" });
  await upsertQuestions(a2.id, applied);

  const a3 = await upsertAssessment({ courseId, levelId: "practice" });
  await upsertQuestions(a3.id, practice);

  console.log("Seed complete");
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });

