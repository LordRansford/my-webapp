;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="59d78257-a919-4a40-3dd2-856cee6bfa50")}catch(e){}}();
module.exports=[877272,e=>{"use strict";var t=e.i(747909),r=e.i(174017),s=e.i(996250),a=e.i(759756),o=e.i(561916),n=e.i(114444),i=e.i(837092),u=e.i(869741),l=e.i(316795),d=e.i(487718),c=e.i(995169),p=e.i(47587),m=e.i(666012),h=e.i(570101),f=e.i(626937),g=e.i(10372),y=e.i(193695);e.i(52474);var v=e.i(600220),x=e.i(89171),b=e.i(679594),w=e.i(504446),R=e.i(469719),k=e.i(757660),N=e.i(568212),S=e.i(363984),P=e.i(936426),C=e.i(657194),O=e.i(895968);let E=e=>{let t=w.default.isIP(e)?e:null;if(!t)return!1;let r=t.split(".").map(e=>parseInt(e,10));return 10===r[0]||172===r[0]&&!!(r[1]>=16)&&!!(r[1]<=31)||192===r[0]&&168===r[1]||127===r[0]},I=e=>/^[a-zA-Z0-9.-]+$/.test(e)&&e.includes(".");async function T(e){return(0,O.withRequestLogging)(e,{route:"POST /api/tools/run"},async()=>{let t=(0,P.requireSameOrigin)(e);if(t)return t;let r=(0,C.rateLimit)(e,{keyPrefix:"tools-run",limit:60,windowMs:6e4});if(r)return r;try{let t=await e.json().catch(()=>null);if(!t||!t.toolId||!t.mode||!t.inputs)return x.NextResponse.json({success:!1,error:{code:"invalid_request",message:"Missing required fields"}},{status:400});let r="heavy"===t.requestedComplexityPreset?"heavy":"standard"===t.requestedComplexityPreset?"standard":"light";if("local"===t.mode)return x.NextResponse.json({success:!1,error:{code:"local_mode_error",message:"Local mode should not call this endpoint. Use client-side execution."}},{status:400});let s=String(t.toolId||"").trim(),a=await (0,k.getServerSession)(N.authOptions).catch(()=>null),o=a?.user?.id||null;if("whois-summary"===s){let r=R.z.object({target:R.z.string().trim().min(1).max(200)}).safeParse(t.inputs);if(!r.success)return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a valid domain.",fixSuggestion:"Use a public domain like example.com"}},{status:400});let s=r.data.target.toLowerCase();if(!I(s)||E(s))return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a valid public hostname.",fixSuggestion:"Private and local targets are blocked."}},{status:400});let a=await (0,S.runWithMetering)({req:e,userId:o,toolId:"whois-summary",inputBytes:Buffer.byteLength(s),requestedComplexityPreset:"light",execute:async()=>{let e={target:s,fallback:!0,registrar:"Use your registrar WHOIS portal",ageHint:"Check creation and expiry dates via WHOIS or RDAP",tip:"Compare domain age to the context. Newly registered domains can be higher risk."};return{output:e,outputBytes:Buffer.byteLength(JSON.stringify(e))}}});if(!a.ok)return x.NextResponse.json({success:!1,error:{code:"run_blocked",message:a.message,fixSuggestion:a.estimate?.reason||"Try again later, or reduce input size."},estimate:a.estimate},{status:a.status});return x.NextResponse.json({success:!0,output:a.output,receipt:a.receipt})}if("dns-lookup"===s){let r=R.z.object({target:R.z.string().trim().min(1).max(200)}).safeParse(t.inputs);if(!r.success)return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a valid hostname.",fixSuggestion:"Use a public hostname like example.com"}},{status:400});let s=r.data.target.toLowerCase();if(!I(s)||E(s))return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a valid public hostname.",fixSuggestion:"Private and local targets are blocked."}},{status:400});let a=await (0,S.runWithMetering)({req:e,userId:o,toolId:"dns-lookup",inputBytes:Buffer.byteLength(s),requestedComplexityPreset:"light",execute:async()=>{let e,t=await (e=b.default.promises.resolveAny(s),Promise.race([e,new Promise((e,t)=>setTimeout(()=>t(Error("Timed out")),5e3))])).catch(()=>null);if(!t){let e={target:s,fallback:!0,message:"Could not resolve. Verify the domain exists and try again.",records:[]};return{output:e,outputBytes:Buffer.byteLength(JSON.stringify(e))}}let r=Array.isArray(t)?t.slice(0,50):t,a={target:s,fallback:!1,message:"OK",records:r};return{output:a,outputBytes:Buffer.byteLength(JSON.stringify(a))}}});if(!a.ok)return x.NextResponse.json({success:!1,error:{code:"run_blocked",message:a.message,fixSuggestion:a.estimate?.reason||"Try again later, or reduce input size."},estimate:a.estimate},{status:a.status});return x.NextResponse.json({success:!0,output:a.output,receipt:a.receipt})}if("ai-story-generator"===s){let s=R.z.object({prompt:R.z.string().trim().min(1).max(240)}).safeParse(t.inputs);if(!s.success)return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a prompt (1–240 characters).",fixSuggestion:"Try a short sentence like: A kind robot helps a lost astronaut"}},{status:400});let a=s.data.prompt,n=await (0,S.runWithMetering)({req:e,userId:o,toolId:"ai-story-generator",inputBytes:Buffer.byteLength(a),requestedComplexityPreset:r,execute:async()=>{let e="heavy"===r?700:"standard"===r?420:180;await new Promise(t=>setTimeout(t,Math.min(1400,e+3*a.length)));let t=`Once upon a time, a brave robot named R2-D5 discovered a quiet planet filled with shimmering crystals.

It followed one simple rule: be curious, be careful, and be kind. R2-D5 helped a lost traveller and returned home safely.`,s=`Once upon a time, a brave robot named R2-D5 discovered a quiet planet filled with shimmering crystals.

It followed a simple rule: be curious, be careful, and be kind. With a small map and a bright light, it explored caves, logged the terrain, and helped a lost traveller find the safest path home.

R2-D5 also made a tiny “safety plan”: 1) stay with your team, 2) check your equipment, 3) ask for help early, 4) rest when tired.

In the end, R2-D5 returned with new knowledge and a promise: every adventure is better when you keep people safe.`,o="light"===r?t:s,n={prompt:a,quality:r,story:o,safety:{mode:"safe-demo",note:"No external model calls. Deterministic output for reliability."}};return{output:n,outputBytes:Buffer.byteLength(JSON.stringify(n))}}});if(!n.ok)return x.NextResponse.json({success:!1,error:{code:"run_blocked",message:n.message,fixSuggestion:n.estimate?.reason||"Try a shorter prompt, or sign in to run beyond the free tier."},estimate:n.estimate},{status:n.status});return x.NextResponse.json({success:!0,output:n.output,receipt:n.receipt})}if("ai-homework-helper"===s){let s=R.z.object({question:R.z.string().trim().min(1).max(300)}).safeParse(t.inputs);if(!s.success)return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a question (1–300 characters).",fixSuggestion:"Try: How do I solve 2x + 5 = 15?"}},{status:400});let a=s.data.question,n=await (0,S.runWithMetering)({req:e,userId:o,toolId:"ai-homework-helper",inputBytes:Buffer.byteLength(a),requestedComplexityPreset:r,execute:async()=>{let e="heavy"===r?700:"standard"===r?420:180;await new Promise(t=>setTimeout(t,Math.min(1400,e+2*a.length)));let t=a.replace(/\s+/g," ").match(/(\d+)\s*x\s*\+\s*(\d+)\s*=\s*(\d+)/i),s={question:a,ranAt:new Date().toISOString()};if(t){let e=Number(t[1]),a=Number(t[2]),o=Number(t[3]),n=(o-a)/e;s.steps=[`Subtract ${a} from both sides → ${e}x = ${o-a}`,`Divide both sides by ${e} → x = ${n}`],"heavy"===r&&s.steps.push(`Check: plug x back in → ${e}\xb7${n} + ${a} = ${e*n+a} ✓`),s.answer=`x = ${n}`}else s.steps=["Rewrite the problem in a simpler form (remove extra words).","Identify what is being asked.","Show one step at a time, and check your result at the end."],s.answer="This demo can only solve simple equations like 2x + 5 = 15.";return s.quality=r,s.safety={mode:"safe-demo",note:"No external model calls. Deterministic output for reliability."},{output:s,outputBytes:Buffer.byteLength(JSON.stringify(s))}}});if(!n.ok)return x.NextResponse.json({success:!1,error:{code:"run_blocked",message:n.message,fixSuggestion:n.estimate?.reason||"Try a shorter question, or sign in to run beyond the free tier."},estimate:n.estimate},{status:n.status});return x.NextResponse.json({success:!0,output:n.output,receipt:n.receipt})}if("ai-support-bot"===s){let s=R.z.object({question:R.z.string().trim().min(1).max(300)}).safeParse(t.inputs);if(!s.success)return x.NextResponse.json({success:!1,error:{code:"validation_error",message:"Provide a question (1–300 characters).",fixSuggestion:"Try: How do I return an item?"}},{status:400});let a=s.data.question,n=await (0,S.runWithMetering)({req:e,userId:o,toolId:"ai-support-bot",inputBytes:Buffer.byteLength(a),requestedComplexityPreset:r,execute:async()=>{let e="heavy"===r?700:"standard"===r?420:180;await new Promise(t=>setTimeout(t,Math.min(1400,e+2*a.length)));let t=a.toLowerCase(),s="I can help with orders, returns, delivery, and account questions. Tell me what you need, and include your order number if you have one.";t.includes("return")?s="To return an item: 1) Sign in, 2) Open Orders, 3) Select the item, 4) Choose Return, 5) Print the label, 6) Drop it off. If the item is damaged, contact support first.":t.includes("refund")?s="Refunds usually process after the return is received. Check your Orders page for the status. If it has been more than 7 days since delivery, contact support with your order number.":t.includes("delivery")||t.includes("shipping")?s="For delivery updates, check the tracking link in your Orders page. If tracking has not updated for 48 hours, contact support and include your order number.":(t.includes("password")||t.includes("sign in")||t.includes("login"))&&(s="If you cannot sign in, use the password reset link on the sign-in page. If you do not receive the email, check spam and confirm the address is correct.");let o="heavy"===r?{question:a,quality:r,summary:s,steps:["Confirm the intent (return/refund/delivery/login).","Provide the exact steps and where to find them in the account area.","Offer escalation if the timeline is abnormal or the user is stuck."],escalation:"If this does not solve it, contact support and include your order number.",safety:{mode:"safe-demo",note:"No external model calls. Deterministic output for reliability."},ranAt:new Date().toISOString()}:{question:a,quality:r,reply:s,safety:{mode:"safe-demo",note:"No external model calls. Deterministic output for reliability."},ranAt:new Date().toISOString()};return{output:o,outputBytes:Buffer.byteLength(JSON.stringify(o))}}});if(!n.ok)return x.NextResponse.json({success:!1,error:{code:"run_blocked",message:n.message,fixSuggestion:n.estimate?.reason||"Try a shorter question, or sign in to run beyond the free tier."},estimate:n.estimate},{status:n.status});return x.NextResponse.json({success:!0,output:n.output,receipt:n.receipt})}return x.NextResponse.json({success:!1,error:{code:"compute_not_implemented",message:"Compute execution is not implemented for this tool yet.",fixSuggestion:"Try a different tool or use Local mode where available."}},{status:501})}catch(e){return x.NextResponse.json({success:!1,error:{code:"server_error",message:e instanceof Error?e.message:"Internal server error"}},{status:500})}})}e.s(["POST",()=>T],186743);var q=e.i(186743);let A=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/tools/run/route",pathname:"/api/tools/run",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/tools/run/route.ts",nextConfigOutput:"",userland:q}),{workAsyncStorage:_,workUnitAsyncStorage:j,serverHooks:D}=A;function B(){return(0,s.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:j})}async function M(e,t,s){A.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let x="/api/tools/run/route";x=x.replace(/\/index$/,"")||"/";let b=await A.prepare(e,t,{srcPage:x,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:w,params:R,nextConfig:k,parsedUrl:N,isDraftMode:S,prerenderManifest:P,routerServerContext:C,isOnDemandRevalidate:O,revalidateOnlyGenerated:E,resolvedPathname:I,clientReferenceManifest:T,serverActionsManifest:q}=b,_=(0,u.normalizeAppPath)(x),j=!!(P.dynamicRoutes[_]||P.routes[I]),D=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,N,!1):t.end("This page could not be found"),null);if(j&&!S){let e=!!P.routes[I],t=P.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(k.experimental.adapterPath)return await D();throw new y.NoFallbackError}}let B=null;!j||A.isDev||S||(B="/index"===(B=I)?"/":B);let M=!0===A.isDev||!j,L=j&&!M;q&&T&&(0,n.setReferenceManifestsSingleton)({page:x,clientReferenceManifest:T,serverActionsManifest:q,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:q})});let H=e.method||"GET",U=(0,o.getTracer)(),$=U.getActiveScopeSpan(),z={params:R,prerenderManifest:P,renderOpts:{experimental:{authInterrupts:!!k.experimental.authInterrupts},cacheComponents:!!k.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:k.cacheLife,waitUntil:s.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,s)=>A.onRequestError(e,t,s,C)},sharedContext:{buildId:w}},W=new l.NodeNextRequest(e),F=new l.NodeNextResponse(t),K=d.NextRequestAdapter.fromNodeNextRequest(W,(0,d.signalFromNodeResponse)(t));try{let n=async e=>A.handle(K,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=U.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${H} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${x}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),u=async a=>{var o,u;let l=async({previousCacheEntry:r})=>{try{if(!i&&O&&E&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await n(a);e.fetchMetrics=z.renderOpts.fetchMetrics;let u=z.renderOpts.pendingWaitUntil;u&&s.waitUntil&&(s.waitUntil(u),u=void 0);let l=z.renderOpts.collectedTags;if(!j)return await (0,m.sendResponse)(W,F,o,z.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(o.headers);l&&(t[g.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,s=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==r?void 0:r.isStale)&&await A.onRequestError(e,t,{routerKind:"App Router",routePath:x,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:O})},C),t}},d=await A.handleResponse({req:e,nextConfig:k,cacheKey:B,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:P,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:E,responseGenerator:l,waitUntil:s.waitUntil,isMinimalMode:i});if(!j)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(u=d.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",O?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return i&&j||c.delete(g.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(W,F,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};$?await u($):await U.withPropagatedContext(e.headers,()=>U.trace(c.BaseServerSpan.handleRequest,{spanName:`${H} ${x}`,kind:o.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},u))}catch(t){if(t instanceof y.NoFallbackError||await A.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:O})}),j)throw t;return await (0,m.sendResponse)(W,F,new Response(null,{status:500})),null}}e.s(["handler",()=>M,"patchFetch",()=>B,"routeModule",()=>A,"serverHooks",()=>D,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>j],877272)}];

//# debugId=59d78257-a919-4a40-3dd2-856cee6bfa50
//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_bb3d12d7.js.map