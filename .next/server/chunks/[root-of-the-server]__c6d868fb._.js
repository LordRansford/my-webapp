;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="71046381-145e-2502-014d-72d08a9812c1")}catch(e){}}();
module.exports=[814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},657194,e=>{"use strict";var t=e.i(89171),r=e.i(254799);let a=new Map;function i(e,i){var n,s;let o,l,d,u=Date.now(),c=`${i.keyPrefix}:${(n=i.keySuffix,o=e.headers.get("x-forwarded-for")||"",l=o.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",d=e.headers.get("user-agent")||"unknown",s=`${l}|${d}|${n||""}`,r.default.createHash("sha256").update(s).digest("hex").slice(0,24))}`,p=a.get(c);if(!p||p.resetAt<=u)return a.set(c,{count:1,resetAt:u+i.windowMs}),null;if(p.count+=1,p.count>i.limit){let e=Math.max(1,Math.ceil((p.resetAt-u)/1e3));return t.NextResponse.json({error:i.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>i])},640205,e=>{"use strict";var t=e.i(747909),r=e.i(174017),a=e.i(996250),i=e.i(759756),n=e.i(561916),s=e.i(114444),o=e.i(837092),l=e.i(869741),d=e.i(316795),u=e.i(487718),c=e.i(995169),p=e.i(47587),h=e.i(666012),v=e.i(570101),m=e.i(626937),g=e.i(10372),f=e.i(193695);e.i(52474);var R=e.i(600220);function w(e){let t={low:1,medium:2,high:3,critical:4};return 0===e.length?0:Math.round(e.reduce((e,r)=>e+(t[r.riskLevel]||1)*(t[r.likelihood]||1),0)/e.length*10)/10}function E(e){return e>=12?"critical":e>=9?"high":e>=6?"medium":"low"}let x=(0,e.i(1863).createToolExecutionHandler)({toolId:"data-studio-privacy",executeTool:async(e,t)=>{let r,a,i,n,s,o,l,d,u=Date.now(),c=t.projectName||t.name||"Untitled Project",p=t.dataTypes||[],h=t.privacyRisks||t.risks||[],v=t.mitigations||[],m=(r=[],a=[],c&&""!==c.trim()||r.push("Project name cannot be empty"),0===p.length&&a.push("No data types specified"),h.forEach((e,t)=>{e.description&&""!==e.description.trim()||r.push(`Risk ${t+1} must have a description`),("critical"===e.riskLevel||"high"===e.riskLevel)&&(v.some(t=>t.riskId===e.id)||a.push(`High/critical risk "${e.description}" should have a mitigation plan`))}),v.forEach(e=>{h.some(t=>t.id===e.riskId)||r.push(`Mitigation references non-existent risk: ${e.riskId}`)}),{valid:0===r.length,errors:r,warnings:a});if(!m.valid)return{result:{success:!1,errors:m.errors,warnings:m.warnings,assessment:{project:c,dataTypes:p,risks:h,mitigations:v}},actualUsage:{cpuMs:Date.now()-u,memMb:150,durationMs:Date.now()-u}};let g=(i=[],n=p.some(e=>e.toLowerCase().includes("personal")||e.toLowerCase().includes("pii")),s=p.some(e=>e.toLowerCase().includes("health")||e.toLowerCase().includes("medical")),n&&i.push("GDPR","CCPA"),s&&i.push("HIPAA"),h.some(e=>"sensitive"===e.dataCategory||"confidential"===e.dataCategory)&&i.push("PIPEDA","LGPD"),Array.from(new Set(i))),f=w(h),R=E(f),x=(o=`PRIVACY IMPACT ASSESSMENT
=========================

Project: ${c}
Generated: ${new Date().toISOString()}

`,d=E(l=w(h)),o+=`EXECUTIVE SUMMARY
=================
Overall Privacy Risk Score: ${l}/16
Overall Risk Level: ${d.toUpperCase()}
Total Risks Identified: ${h.length}
Total Mitigations: ${v.length}
Relevant Frameworks: ${g.join(", ")||"None identified"}

DATA TYPES
==========
`,p.length>0?p.forEach((e,t)=>{o+=`${t+1}. ${e}
`}):o+=`No data types specified
`,o+=`

PRIVACY RISKS
=============

`,["critical","high","medium","low"].forEach(e=>{let t=h.filter(t=>t.riskLevel===e);t.length>0&&(o+=`${e.toUpperCase()} RISKS
${"-".repeat(e.length+6)}

`,t.forEach((e,t)=>{o+=`${t+1}. ${e.description}
   Category: ${e.dataCategory}
   Impact: ${e.impact||"Not specified"}
   Likelihood: ${e.likelihood}
`;let r=v.filter(t=>t.riskId===e.id);r.length>0?(o+=`   Mitigations:
`,r.forEach(e=>{o+=`     - ${e.description} (Effectiveness: ${e.effectiveness})
`})):o+=`   Mitigations: None specified
`,o+=`
`}))}),o+=`
--- END OF ASSESSMENT ---
`);return await new Promise(e=>setTimeout(e,250)),{result:{success:!0,assessment:{project:c,dataTypes:p,risks:h,mitigations:v,compliance:g,privacyScore:f,overallRiskLevel:R,report:x,summary:{totalRisks:h.length,byLevel:h.reduce((e,t)=>(e[t.riskLevel]=(e[t.riskLevel]||0)+1,e),{}),totalMitigations:v.length},validation:{valid:!0,warnings:m.warnings},toolId:"data-studio-privacy",timestamp:new Date().toISOString()}},actualUsage:{cpuMs:Date.now()-u,memMb:150,durationMs:Date.now()-u}}}});e.s(["POST",0,x],831617);var y=e.i(831617);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/data-studio/privacy/run/route",pathname:"/api/data-studio/privacy/run",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/data-studio/privacy/run/route.ts",nextConfigOutput:"",userland:y}),{workAsyncStorage:A,workUnitAsyncStorage:k,serverHooks:P}=C;function S(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:k})}async function T(e,t,a){C.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/data-studio/privacy/run/route";w=w.replace(/\/index$/,"")||"/";let E=await C.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!E)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:x,params:y,nextConfig:A,parsedUrl:k,isDraftMode:P,prerenderManifest:S,routerServerContext:T,isOnDemandRevalidate:M,revalidateOnlyGenerated:$,resolvedPathname:b,clientReferenceManifest:I,serverActionsManifest:N}=E,O=(0,l.normalizeAppPath)(w),D=!!(S.dynamicRoutes[O]||S.routes[b]),_=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,k,!1):t.end("This page could not be found"),null);if(D&&!P){let e=!!S.routes[b],t=S.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await _();throw new f.NoFallbackError}}let U=null;!D||C.isDev||P||(U="/index"===(U=b)?"/":U);let H=!0===C.isDev||!D,L=D&&!H;N&&I&&(0,s.setReferenceManifestsSingleton)({page:w,clientReferenceManifest:I,serverActionsManifest:N,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:N})});let q=e.method||"GET",j=(0,n.getTracer)(),F=j.getActiveScopeSpan(),K={params:y,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,T)},sharedContext:{buildId:x}},G=new d.NodeNextRequest(e),V=new d.NodeNextResponse(t),B=u.NextRequestAdapter.fromNodeNextRequest(G,(0,u.signalFromNodeResponse)(t));try{let s=async e=>C.handle(B,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=j.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${q} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${w}`)}),o=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var n,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&M&&$&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await s(i);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=K.renderOpts.collectedTags;if(!D)return await (0,h.sendResponse)(G,V,n,K.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,v.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[g.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:R.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:M})},T),t}},u=await C.handleResponse({req:e,nextConfig:A,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:M,revalidateOnlyGenerated:$,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:o});if(!D)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==R.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",M?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),P&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,v.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&D||c.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,m.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(G,V,new Response(u.value.body,{headers:c,status:u.value.status||200})),null};F?await l(F):await j.withPropagatedContext(e.headers,()=>j.trace(c.BaseServerSpan.handleRequest,{spanName:`${q} ${w}`,kind:n.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:M})}),D)throw t;return await (0,h.sendResponse)(G,V,new Response(null,{status:500})),null}}e.s(["handler",()=>T,"patchFetch",()=>S,"routeModule",()=>C,"serverHooks",()=>P,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>k],640205)},549292,e=>{e.v(e=>Promise.resolve().then(()=>e(333248)))},118191,e=>{e.v(t=>Promise.all(["server/chunks/src_lib_credits_store_ts_40181bd8._.js"].map(t=>e.l(t))).then(()=>t(685750)))},119949,e=>{e.v(e=>Promise.resolve().then(()=>e(124594)))}];

//# debugId=71046381-145e-2502-014d-72d08a9812c1
//# sourceMappingURL=%5Broot-of-the-server%5D__c6d868fb._.js.map