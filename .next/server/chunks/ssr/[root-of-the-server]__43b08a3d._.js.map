{
  "version": 3,
  "sources": [],
  "debugId": "1f37d260-2dde-16f0-d75e-eb15d45d6e30",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/lib/entitlements/entitlements.js","../../../../src/hooks/useTemplateState.js","../../../../src/app/templates/cybersecurity/incident-response/page.jsx"],"sourcesContent":["const DONATION_KEY = \"template-donation-token\";\nconst PERMISSION_KEY = \"template-permission-token\";\n\nconst safeWindow = () => (typeof window !== \"undefined\" ? window : null);\n\nexport function setDonationToken(token) {\n  const win = safeWindow();\n  if (!win || !token) return;\n  win.localStorage.setItem(DONATION_KEY, token);\n}\n\nexport function getDonationToken() {\n  const win = safeWindow();\n  if (!win) return null;\n  return win.localStorage.getItem(DONATION_KEY);\n}\n\nexport function setPermissionToken(token) {\n  const win = safeWindow();\n  if (!win || !token) return;\n  win.localStorage.setItem(PERMISSION_KEY, token.trim());\n}\n\nexport function getPermissionToken() {\n  const win = safeWindow();\n  if (!win) return null;\n  const token = win.localStorage.getItem(PERMISSION_KEY);\n  return token ? token.trim() : null;\n}\n\nexport function hasDonationSupport() {\n  return Boolean(getDonationToken());\n}\n\nexport function hasPermissionToken() {\n  return Boolean(getPermissionToken());\n}\n\nexport function unlockCommercialNoAttribution() {\n  return hasDonationSupport() || hasPermissionToken();\n}\n","\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\n\nconst cloneValue = (value) => JSON.parse(JSON.stringify(typeof value === \"function\" ? value() : value));\n\nexport function useTemplateState(storageKey, initialState) {\n  const [state, setState] = useState(() => cloneValue(initialState));\n  const [lastUpdated, setLastUpdated] = useState(null);\n  const [hydrated, setHydrated] = useState(false);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const raw = window.localStorage.getItem(storageKey);\n    if (raw) {\n      try {\n        const parsed = JSON.parse(raw);\n        if (parsed.data !== undefined) {\n          setState(parsed.data);\n        }\n        if (parsed.lastUpdated) {\n          setLastUpdated(parsed.lastUpdated);\n        }\n      } catch (error) {\n        console.warn(\"Could not parse stored template state\", error);\n      }\n    }\n    setHydrated(true);\n  }, [storageKey]);\n\n  const persist = useCallback(\n    (nextState, timestamp) => {\n      if (typeof window === \"undefined\") return;\n      const payload = {\n        data: nextState,\n        lastUpdated: timestamp,\n      };\n      window.localStorage.setItem(storageKey, JSON.stringify(payload));\n    },\n    [storageKey]\n  );\n\n  const updateState = useCallback(\n    (updater) => {\n      setState((prev) => {\n        const next = typeof updater === \"function\" ? updater(prev) : updater;\n        const timestamp = new Date().toISOString();\n        setLastUpdated(timestamp);\n        persist(next, timestamp);\n        return next;\n      });\n    },\n    [persist]\n  );\n\n  const resetState = useCallback(() => {\n    const resetValue = cloneValue(initialState);\n    const timestamp = new Date().toISOString();\n    setState(resetValue);\n    setLastUpdated(timestamp);\n    persist(resetValue, timestamp);\n  }, [initialState, persist]);\n\n  const status = useMemo(\n    () => ({\n      hydrated,\n      lastUpdated,\n    }),\n    [hydrated, lastUpdated]\n  );\n\n  return {\n    state,\n    updateState,\n    resetState,\n    ...status,\n  };\n}\n","\"use client\";\n\nimport { useMemo } from \"react\";\nimport TemplateLayout from \"@/components/templates/TemplateLayout\";\nimport TemplateExportPanel from \"@/components/templates/TemplateExportPanel\";\nimport { useTemplateState } from \"@/hooks/useTemplateState\";\n\nconst storageKey = \"template-incident-response-v1\";\nconst templateVersion = \"1.0.0\";\nconst templateCategory = \"Cybersecurity\";\nconst attributionText =\n  \"Created by Ransford for Ransfords Notes. Internal use allowed. Commercial use requires visible attribution. Downloads will be gated in the next stage.\";\n\nconst defaultState = {\n  detection: \"SIEM alerts triaged within 15 minutes; on-call rotation active; playbooks in pager app.\",\n  containment: \"Isolate affected hosts via EDR; block indicators at firewall/WAF; rotate exposed credentials.\",\n  eradication: \"Remove malicious persistence; patch vulnerable services; validate configs via IaC.\",\n  recovery: \"Restore from clean backups; phased traffic cutover; run smoke tests; monitor for reoccurrence.\",\n  lessons: \"Capture timeline within 24 hours; update runbooks; backlog follow-up actions with owners.\",\n};\n\nconst steps = [\n  { key: \"detection\", title: \"Detection\", hint: \"How is the incident spotted? Alert sources, roles, and initial triage steps.\" },\n  {\n    key: \"containment\",\n    title: \"Containment\",\n    hint: \"Immediate actions to stop spread or further harm. Network, identity, and access changes.\",\n  },\n  {\n    key: \"eradication\",\n    title: \"Eradication\",\n    hint: \"Remove the root cause and ensure systems are clean. Consider persistence and backdoors.\",\n  },\n  { key: \"recovery\", title: \"Recovery\", hint: \"Restore service safely. Validation, traffic ramp-up, and communications.\" },\n  {\n    key: \"lessons\",\n    title: \"Lessons learned\",\n    hint: \"What will you change? Controls, training, architecture, or processes.\",\n  },\n];\n\nconst formatTimestamp = (iso) => {\n  if (!iso) return \"Not saved yet\";\n  try {\n    return new Date(iso).toLocaleString();\n  } catch (error) {\n    return iso;\n  }\n};\n\nexport default function IncidentResponsePlannerPage() {\n  const { state, updateState, resetState, lastUpdated } = useTemplateState(storageKey, defaultState);\n\n  const missingSections = useMemo(\n    () => steps.filter((step) => !String(state[step.key] || \"\").trim()).map((step) => step.title),\n    [state]\n  );\n\n  const updateField = (field) => (event) => {\n    updateState((prev) => ({ ...prev, [field]: event.target.value }));\n  };\n\n  const outputSummary =\n    missingSections.length === 0\n      ? \"Incident response plan is complete across detection, containment, eradication, recovery, and lessons.\"\n      : `Missing content in: ${missingSections.join(\", \")}. Fill these before circulating the plan.`;\n\n  const outputInterpretation =\n    missingSections.length === 0\n      ? \"Use this plan for tabletop exercises and during real incidents. Keep owners current and rehearse quarterly.\"\n      : \"Resolve the gaps, confirm ownership, and rerun a short review. Gaps increase risk during a live incident.\";\n\n  const outputNextSteps = [\n    \"Share with on-call leads and service owners.\",\n    \"Link to runbooks and checklists referenced here.\",\n    \"Schedule a tabletop exercise to validate the plan.\",\n  ];\n\n  const buildSections = () => [\n    { heading: \"Detection\", body: state.detection },\n    { heading: \"Containment\", body: state.containment },\n    { heading: \"Eradication\", body: state.eradication },\n    { heading: \"Recovery\", body: state.recovery },\n    { heading: \"Lessons learned\", body: state.lessons },\n    { heading: \"Readiness summary\", body: `${outputSummary} ${outputInterpretation}` },\n  ];\n\n  return (\n    <TemplateLayout\n      title=\"Incident Response Planner\"\n      description=\"Timeline-style incident response plan you can rehearse and reuse. Highlights missing sections automatically.\"\n      audience=\"Incident managers, SRE/on-call leads, security responders.\"\n      useCases={[\n        \"Prepare for tabletop exercises.\",\n        \"Capture the go-to plan for a specific system or product.\",\n        \"Highlight ownership gaps before an incident.\",\n      ]}\n      instructions={[\n        \"Draft each phase in order: detection -> containment -> eradication -> recovery -> lessons.\",\n        \"Keep each entry action-oriented and name responsible roles.\",\n        \"Use Reset to clear the plan between exercises; autosave keeps drafts between visits.\",\n        \"Review the missing sections panel before considering the plan ready.\",\n      ]}\n      outputTitle=\"Readiness summary\"\n      outputSummary={outputSummary}\n      outputInterpretation={outputInterpretation}\n      outputNextSteps={outputNextSteps}\n      attributionText={attributionText}\n      version={templateVersion}\n    >\n      <TemplateExportPanel\n        templateId=\"incident-response-planner\"\n        title=\"Incident Response Planner\"\n        category={templateCategory}\n        version={templateVersion}\n        attributionText={attributionText}\n        prepareSections={buildSections}\n      />\n\n      <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n        <p className=\"text-sm font-medium text-slate-700\">Autosaves locally. Last updated: {formatTimestamp(lastUpdated)}</p>\n        <button\n          type=\"button\"\n          onClick={resetState}\n          className=\"inline-flex items-center justify-center rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:-translate-y-0.5 hover:border-slate-300 hover:shadow focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900\"\n        >\n          Reset template\n        </button>\n      </div>\n\n      {missingSections.length > 0 ? (\n        <div className=\"rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900\" role=\"alert\">\n          <p className=\"font-semibold\">Incomplete sections</p>\n          <ul className=\"mt-2 list-disc space-y-1 pl-5\">\n            {missingSections.map((section) => (\n              <li key={section}>{section}</li>\n            ))}\n          </ul>\n        </div>\n      ) : (\n        <div className=\"rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-900\" role=\"status\">\n          All sections filled. Keep owners and contacts up to date.\n        </div>\n      )}\n\n      <div className=\"relative rounded-3xl border border-slate-200 bg-white/95 p-6 shadow-sm\">\n        <div className=\"absolute left-5 top-10 bottom-10 w-px bg-slate-200\" aria-hidden=\"true\" />\n        <div className=\"space-y-6\">\n          {steps.map((step, index) => {\n            const value = state[step.key] || \"\";\n            const isEmpty = !value.trim();\n            return (\n              <div key={step.key} className=\"relative pl-10\">\n                <div\n                  className={`absolute left-2 top-1 flex h-7 w-7 items-center justify-center rounded-full text-xs font-bold text-white shadow ${\n                    isEmpty ? \"bg-slate-400\" : \"bg-slate-900\"\n                  }`}\n                  aria-hidden=\"true\"\n                >\n                  {index + 1}\n                </div>\n                <div\n                  className={`rounded-2xl border p-4 shadow-sm ${\n                    isEmpty ? \"border-amber-200 bg-amber-50/80\" : \"border-slate-200 bg-slate-50/80\"\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between gap-3\">\n                    <h3 className=\"text-base font-semibold text-slate-900\">{step.title}</h3>\n                    <span\n                      className={`rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-wide ${\n                        isEmpty ? \"bg-amber-100 text-amber-900\" : \"bg-emerald-100 text-emerald-900\"\n                      }`}\n                    >\n                      {isEmpty ? \"Needs detail\" : \"Ready\"}\n                    </span>\n                  </div>\n                  <p className=\"mt-1 text-xs text-slate-600\">{step.hint}</p>\n                  <textarea\n                    id={step.key}\n                    name={step.key}\n                    value={value}\n                    onChange={updateField(step.key)}\n                    rows={3}\n                    className=\"mt-3 w-full rounded-lg border border-slate-200 bg-white p-3 text-sm text-slate-800 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200\"\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </TemplateLayout>\n  );\n}\n"],"names":[],"mappings":"wKAiBO,SAAS,EAAmB,CAAK,EAIxC,CAEO,SAAS,IAEJ,OAAO,IAGnB,CAEO,SAAS,IACd,OAAO,CACT,CAEO,MAHU,GAGD,IACd,OAAO,CAAQ,GACjB,CAEO,SAAS,IACd,OAAO,AAAwB,GACjC,iLCtCA,IAAA,EAAA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAa,AAAC,GAAU,KAAK,KAAK,CAAC,KAAK,SAAS,CAAkB,YAAjB,OAAO,EAAuB,IAAU,IAEzF,SAAS,EAAiB,CAAU,CAAE,CAAY,EACvD,GAAM,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAAM,EAAW,IAC9C,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,MACzC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEzC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAiBV,EAAG,CAAC,EAAW,EAEf,IAAM,EAAU,CAAA,EAAA,EAAA,WAAA,AAAW,EACzB,CAAC,EAAW,KAOZ,EACA,CAAC,EAAW,EAGR,EAAc,CAAA,EAAA,EAAA,WAAA,AAAW,EAC7B,AAAC,IACC,EAAS,AAAC,IACR,IAAM,EAA0B,YAAnB,OAAO,EAAyB,EAAQ,GAAQ,EACvD,EAAY,IAAI,OAAO,WAAW,GAGxC,OAFA,EAAe,GACf,EAAQ,EAAM,GACP,CACT,EACF,EACA,CAAC,EAAQ,EAmBX,MAAO,OACL,cACA,EACA,WAnBiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KAC7B,IAAM,EAAa,EAAW,GACxB,EAAY,IAAI,OAAO,WAAW,GACxC,EAAS,GACT,EAAe,GACf,EAAQ,EAAY,EACtB,EAAG,CAAC,EAAc,EAAQ,EAOD,GALV,CAAA,EAAA,EAAA,OAAA,AAAO,EACpB,IAAM,CAAC,CACL,WACA,cACF,CAAC,CACD,CAAC,EAAU,EAAY,CAOvB,AACF,CACF,EAFO,MAAM,oECzEb,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,MAGA,IAAM,EAAkB,QAElB,EACJ,yJAEI,EAAe,CACnB,UAAW,0FACX,YAAa,gGACb,YAAa,qFACb,SAAU,iGACV,QAAS,2FACX,EAEM,EAAQ,CACZ,CAAE,IAAK,YAAa,MAAO,YAAa,KAAM,8EAA+E,EAC7H,CACE,IAAK,cACL,MAAO,cACP,KAAM,0FACR,EACA,CACE,IAAK,cACL,MAAO,cACP,KAAM,yFACR,EACA,CAAE,IAAK,WAAY,MAAO,WAAY,KAAM,0EAA2E,EACvH,CACE,IAAK,UACL,MAAO,kBACP,KAAM,uEACR,EACD,CAWc,SAAS,IACtB,GAAM,OAAE,CAAK,aAAE,CAAW,YAAE,CAAU,CAAE,aAAW,CAAE,CAAG,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,AA5CxD,gCA4CoE,GAE/E,EAAkB,CAAA,EAAA,EAAA,OAAA,AAAO,EAC7B,IAAM,EAAM,MAAM,CAAC,AAAC,GAAS,CAAC,OAAO,CAAK,CAAC,EAAK,GAAG,CAAC,EAAI,IAAI,IAAI,IAAI,GAAG,CAAC,AAAC,GAAS,EAAK,KAAK,EAC5F,CAAC,EAAM,EAOH,EACJ,AAA2B,MAAX,MAAM,CAClB,wGACA,CAAC,oBAAoB,EAAE,EAAgB,IAAI,CAAC,MAAM,yCAAyC,CAAC,CAE5F,EACuB,IAA3B,EAAgB,MAAM,CAClB,8GACA,4GAiBN,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAc,CAAA,CACb,MAAM,4BACN,YAAY,+GACZ,SAAS,6DACT,SAAU,CACR,kCACA,2DACA,+CACD,CACD,aAAc,CACZ,6FACA,8DACA,uFACA,uEACD,CACD,YAAY,oBACZ,cAAe,EACf,qBAAsB,EACtB,gBAlCoB,CACtB,AAiCmB,+CAhCnB,mDACA,qDACD,CA+BG,gBAAiB,EACjB,QAAS,YAET,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAmB,CAAA,CAClB,WAAW,4BACX,MAAM,4BACN,SAxGiB,CAwGP,eACV,QAAS,EACT,gBAAiB,EACjB,gBAtCgB,CAsCC,GAtCK,CAC1B,CAAE,QAAS,YAAa,KAAM,EAAM,SAAS,AAAC,EAC9C,CAAE,QAAS,cAAe,KAAM,EAAM,WAAW,AAAC,EAClD,CAAE,QAAS,cAAe,KAAM,EAAM,WAAW,AAAC,EAClD,CAAE,QAAS,WAAY,KAAM,EAAM,QAAS,AAAD,EAC3C,CAAE,QAAS,kBAAmB,KAAM,EAAM,OAAO,AAAC,EAClD,CAAE,QAAS,oBAAqB,KAAM,CAAA,EAAG,EAAc,CAAC,EAAE,EAAA,CAAsB,AAAC,EAClF,GAkCG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+EACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,+CAAqC,oCAAkC,CA/EpE,AAAC,IACvB,GAAI,CAAC,EAAK,MAAO,gBACjB,GAAI,CACF,OAAO,IAAI,KAAK,GAAK,cAAc,EACrC,CAAE,MAAO,EAAO,CACd,OAAO,CACT,EACF,EAwE4G,MACpG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,EACT,UAAU,oUACX,sBAKF,EAAgB,MAAM,CAAG,EACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6EAA6E,KAAK,kBAC/F,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,wBAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yCACX,EAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAkB,GAAV,SAKf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mFAAmF,KAAK,kBAAS,8DAKlH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mFACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qDAAqD,cAAY,SAChF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAM,GAAG,CAAC,CAAC,EAAM,KAChB,MAAM,EAAQ,CAAK,CAAC,EAAK,GAAG,CAAC,EAAI,GAC3B,EAAU,CAAC,EAAM,IAAI,GAC3B,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAmB,UAAU,2BAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,gHAAgH,EAC1H,EAAU,eAAiB,eAAA,CAC3B,CACF,cAAY,gBAEX,EAAQ,IAEX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAW,CAAC,iCAAiC,EAC3C,EAAU,kCAAoC,kCAAA,CAC9C,WAEF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kDAA0C,EAAK,KAAK,GAClE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,UAAW,CAAC,qEAAqE,EAC/E,EAAU,8BAAgC,kCAAA,CAC1C,UAED,EAAU,eAAiB,aAGhC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uCAA+B,EAAK,IAAI,GACrD,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,GAAI,EAAK,GAAG,CACZ,KAAM,EAAK,GAAG,CACd,MAAO,EACP,QAAA,EA3HG,AA2HO,EAAY,EAAK,GAAG,CA3HjB,AAAC,IAC9B,EAAY,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,CAAC,EAAM,CAAE,EAAM,MAAM,CAAC,KAAK,CAAC,CAAC,CACjE,GA0HkB,KAAM,EACN,UAAU,wKA/BN,EAAK,GAAG,CAoCtB,UAKV"}}]
}