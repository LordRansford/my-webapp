{
  "version": 3,
  "sources": [],
  "debugId": "08144092-b5b7-8a60-6b73-eac4fa8f4d82",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/dashboards/cybersecurity/advanced/DetectionRuleTuner.jsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\n\nconst EVENTS = [\n  { id: 1, score: 15, malicious: false },\n  { id: 2, score: 62, malicious: true },\n  { id: 3, score: 40, malicious: false },\n  { id: 4, score: 78, malicious: true },\n  { id: 5, score: 22, malicious: false },\n  { id: 6, score: 90, malicious: true },\n  { id: 7, score: 55, malicious: false },\n  { id: 8, score: 68, malicious: true },\n];\n\nexport default function DetectionRuleTuner() {\n  const [threshold, setThreshold] = useState(50);\n\n  const stats = useMemo(() => {\n    let tp = 0,\n      fp = 0,\n      tn = 0,\n      fn = 0;\n    EVENTS.forEach((e) => {\n      const alert = e.score >= threshold;\n      if (alert && e.malicious) tp++;\n      else if (alert && !e.malicious) fp++;\n      else if (!alert && !e.malicious) tn++;\n      else fn++;\n    });\n    return { tp, fp, tn, fn };\n  }, [threshold]);\n\n  const summary =\n    threshold > 70\n      ? \"High threshold: fewer alerts and false positives, but higher chance of missing attacks.\"\n      : threshold < 40\n      ? \"Low threshold: more attacks caught, but expect more noise.\"\n      : \"Balanced threshold: watch noise vs miss rate.\";\n\n  return (\n    <div className=\"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200\">\n      <h4 className=\"text-base font-semibold text-slate-900\">Tune the rule threshold</h4>\n      <p className=\"text-sm text-slate-700\">Events with score above the threshold raise alerts.</p>\n\n      <div className=\"mt-3\">\n        <input\n          type=\"range\"\n          min={0}\n          max={100}\n          value={threshold}\n          onChange={(e) => setThreshold(Number(e.target.value))}\n          className=\"w-full accent-sky-500\"\n          aria-label=\"Threshold\"\n        />\n        <div className=\"mt-1 text-sm text-slate-800\">Threshold: {threshold}</div>\n      </div>\n\n      <div className=\"mt-3 grid gap-3 md:grid-cols-2\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Event scores</h5>\n          <div className=\"mt-2 flex flex-wrap gap-2 text-sm\">\n            {EVENTS.map((e) => (\n              <span\n                key={e.id}\n                className={`rounded-full border px-3 py-1 font-semibold shadow-sm ${\n                  e.score >= threshold ? \"border-sky-300 bg-sky-50 text-slate-900\" : \"border-slate-200 bg-white text-slate-800\"\n                }`}\n              >\n                {e.score}\n              </span>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"rounded-xl border border-slate-200 bg-white p-4 shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Results</h5>\n          <div className=\"mt-2 grid grid-cols-2 gap-2 text-sm\">\n            <Stat label=\"True positives\" value={stats.tp} tone=\"emerald\" />\n            <Stat label=\"False positives\" value={stats.fp} tone=\"amber\" />\n            <Stat label=\"True negatives\" value={stats.tn} tone=\"emerald\" />\n            <Stat label=\"False negatives\" value={stats.fn} tone=\"rose\" />\n          </div>\n          <p className=\"mt-2 text-sm text-slate-800\">{summary}</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction Stat({ label, value, tone }) {\n  const color =\n    tone === \"emerald\"\n      ? \"border-emerald-200 bg-emerald-50 text-slate-900\"\n      : tone === \"amber\"\n      ? \"border-amber-200 bg-amber-50 text-slate-900\"\n      : \"border-rose-200 bg-rose-50 text-slate-900\";\n  return (\n    <div className={`rounded-lg border px-3 py-2 text-sm shadow-sm ${color}`}>\n      <div className=\"text-xs font-semibold text-slate-700\">{label}</div>\n      <div className=\"text-sm font-semibold text-slate-900\">{value}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAS,CACb,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAM,EACrC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAK,EACpC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAM,EACrC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAK,EACpC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAM,EACrC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAK,EACpC,CAAE,GAAI,EAAG,MAAO,GAAI,UAAW,EAAM,EACrC,CAAE,GAAI,EAAG,MAAO,GAAI,WAAW,CAAK,EACrC,CAEc,SAAS,IACtB,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IAErC,EAAQ,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACpB,IAAI,EAAK,EACP,EAAK,EACL,EAAK,EACL,EAAK,EAQP,OAPA,EAAO,OAAO,CAAC,AAAC,IACd,IAAM,EAAQ,EAAE,KAAK,EAAI,EACrB,GAAS,EAAE,SAAS,CAAE,IACjB,GAAS,CAAC,EAAE,SAAS,CAAE,IACvB,AAAC,GAAU,EAAE,IAAH,KAAY,CAC1B,IAD4B,GAEnC,GACO,IAAE,KAAI,KAAI,KAAI,CAAG,CAC1B,EAAG,CAAC,EAAU,EAER,EACJ,EAAY,GACR,0FACA,EAAY,GACZ,6DACA,gDAEN,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kDAAyC,4BACvD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,kCAAyB,wDAEtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,IACL,MAAO,EACP,SAAW,AAAD,GAAO,EAAa,OAAO,EAAE,MAAM,CAAC,KAAK,GACnD,UAAU,wBACV,aAAW,cAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAA8B,cAAY,QAG3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gDAAuC,iBACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6CACZ,EAAO,GAAG,CAAE,AAAD,GACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAEC,UAAW,CAAC,sDAAsD,EAChE,EAAE,KAAK,EAAI,EAAY,0CAA4C,2CAAA,CACnE,UAED,EAAE,KAAK,EALH,EAAE,EAAE,QAWjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gDAAuC,YACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAK,MAAM,iBAAiB,MAAO,EAAM,EAAE,CAAE,KAAK,YACnD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAK,MAAM,kBAAkB,MAAO,EAAM,EAAE,CAAE,KAAK,UACpD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAK,MAAM,iBAAiB,MAAO,EAAM,EAAE,CAAE,KAAK,YACnD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAK,MAAM,kBAAkB,MAAO,EAAM,EAAE,CAAE,KAAK,YAEtD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uCAA+B,YAKtD,CAEA,SAAS,EAAK,OAAE,CAAK,OAAE,CAAK,MAAE,CAAI,CAAE,EAOlC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,8CAA8C,EANtD,AAMwD,YANjE,EACI,kDACS,UAAT,EACA,8CACA,4CAE6D,CAAO,WACtE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDAAwC,IACvD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gDAAwC,MAG7D"}}]
}