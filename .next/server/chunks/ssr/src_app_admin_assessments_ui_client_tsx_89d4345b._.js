;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="d093393b-be12-c54e-45c1-521d388cdbcc")}catch(e){}}();
module.exports=[899146,a=>{"use strict";var b=a.i(218282),c=a.i(572131);function d(a){return new Set(String(a||"").split(",").map(a=>a.trim()).filter(Boolean))}function e(a){for(let b of d(a))if(b.startsWith("domain:"))return b.slice(7);return""}function f(a){let[f,g]=(0,c.useState)("cybersecurity"),[h,i]=(0,c.useState)("foundations"),[j,k]=(0,c.useState)("2025.01"),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(""),B=(0,c.useMemo)(()=>({courseId:f,levelId:h,version:j}),[f,h,j]),C=async()=>{m(!0),o("");try{let a=`/api/admin/assessments/questions?courseId=${encodeURIComponent(B.courseId)}&levelId=${encodeURIComponent(B.levelId)}&version=${encodeURIComponent(B.version)}`,b=await fetch(a),c=await b.json().catch(()=>null);if(!b.ok)return void o(c?.error||"Unable to load assessment.");s(c);let d=`/api/admin/assessments/analysis?courseId=${encodeURIComponent(B.courseId)}&levelId=${encodeURIComponent(B.levelId)}&version=${encodeURIComponent(B.version)}`,e=await fetch(d),f=await e.json().catch(()=>null);e.ok?u(f):u(null);let g=`/api/admin/assessments/quality?courseId=${encodeURIComponent(B.courseId)}&levelId=${encodeURIComponent(B.levelId)}&version=${encodeURIComponent(B.version)}`,h=await fetch(g),i=await h.json().catch(()=>null);h.ok?w(i):w(null)}catch{o("Unable to load assessment.")}finally{m(!1)}};(0,c.useEffect)(()=>{C()},[B.courseId,B.levelId,B.version]);let D=(0,c.useMemo)(()=>{let a=r?.questions||[],b=a.filter(a=>a.published).length;return{total:a.length,published:b,draft:a.length-b}},[r?.questions]),E=(0,c.useMemo)(()=>z?new Set(v?.issues?.[z]||v?.samples?.[z]||[]):null,[z,v?.issues,v?.samples]),F=(0,c.useMemo)(()=>{let a=r?.questions||[];return E?a.filter(a=>E.has(a.id)):a},[r?.questions,E]),G=(0,c.useMemo)(()=>"network-models"===B.courseId?"foundations"===h?["models","encapsulation","layers","addressing","dns","subnetting"]:"applied"===h?["tcp","udp","dns","routing","nat","tls"]:["security","observability","captures","segmentation","operations","troubleshooting"]:"foundations"===h?["basics","identity","network","crypto","risk","response"]:"applied"===h?["web","api","auth","secrets","cloud","logging"]:["sdlc","zero-trust","runtime","vulnerability","detection","governance"],[h,B.courseId]),H=async b=>{if(!a.canManage)return;let c=p.trim();if(!c)return void o("Reason required.");m(!0),o("");try{var e,f;let a,g=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(b.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:c,version:B.version,published:!b.published,patch:{tags:(e=b.tags,f=!b.published,a=d(e),f?a.add("published"):a.delete("published"),Array.from(a).join(", "))}})}),h=await g.json().catch(()=>null);if(!g.ok)return void o(h?.error||"Unable to update question.");q(""),await C()}catch{o("Unable to update question.")}finally{m(!1)}},I=async b=>{if(!a.canManage)return;let c=p.trim();if(!c)return void o("Reason required.");m(!0),o("");try{let a=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(b.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:c,version:B.version,patch:{question:b.question,options:b.options,correctAnswer:b.correctAnswer,explanation:b.explanation,optionRationales:b.optionRationales,tags:b.tags,bloomLevel:b.bloomLevel}})}),d=await a.json().catch(()=>null);if(!a.ok)return void o(d?.error||"Unable to update question.");y(null),q(""),await C()}catch{o("Unable to update question.")}finally{m(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"course",children:"Course"}),(0,b.jsxs)("select",{id:"course",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:f,onChange:a=>g(a.target.value),children:[(0,b.jsx)("option",{value:"cybersecurity",children:"Cybersecurity"}),(0,b.jsx)("option",{value:"network-models",children:"Network models"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"level",children:"Level"}),(0,b.jsxs)("select",{id:"level",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:h,onChange:a=>i(a.target.value),children:[(0,b.jsx)("option",{value:"foundations",children:"Foundations"}),(0,b.jsx)("option",{value:"applied",children:"Applied"}),(0,b.jsx)("option",{value:"practice",children:"Practice"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"version",children:"Course version"}),(0,b.jsx)("input",{id:"version",value:j,onChange:a=>k(a.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",placeholder:"Example 2025.01"})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Questions"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:D.total})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Published"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:D.published})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Draft"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:D.draft})]})]}),(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-[1fr_auto]",children:[(0,b.jsx)("input",{value:p,onChange:a=>q(a.target.value),placeholder:"Reason for change",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"}),(0,b.jsx)("button",{type:"button",disabled:l,onClick:C,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:l?"Loading":"Refresh"})]}),t?(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Attempt analytics"}),(0,b.jsxs)("div",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Attempts"}),(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:t.attempts.total})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Pass rate"}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[t.attempts.passRatePercent," percent"]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Average score"}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[t.attempts.avgScore," percent"]})]})]})]}):null,n?(0,b.jsx)("div",{className:"text-sm font-semibold text-rose-700",children:n}):null]}),(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Questions"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,b.jsx)("span",{children:"Tag `published` is required for exam selection"}),(0,b.jsx)("a",{className:"font-semibold text-emerald-700 hover:underline",href:`/api/admin/assessments/answer-key?courseId=${encodeURIComponent(B.courseId)}&levelId=${encodeURIComponent(B.levelId)}&version=${encodeURIComponent(B.version)}`,children:"Download answer key"})]})]}),v?(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Quality checks"}),(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:Object.entries(v.totals||{}).map(([a,c])=>(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:a}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:c})]},a))}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("button",{type:"button",className:["rounded-full border px-3 py-1 text-xs font-semibold shadow-sm",!z?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-900 hover:bg-slate-50"].join(" "),onClick:()=>A(""),children:"Show all"}),Object.entries(v.totals||{}).filter(([,a])=>Number(a)>0).slice(0,10).map(([a])=>(0,b.jsx)("button",{type:"button",className:["rounded-full border px-3 py-1 text-xs font-semibold shadow-sm",z===a?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-900 hover:bg-slate-50"].join(" "),onClick:()=>A(a),title:"Filter questions by this issue",children:a},a))]}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Prioritise missing rationales first so the exported answer key is worth paying for."})]}):null,(0,b.jsx)("div",{className:"space-y-3",children:F.map(c=>{let f=x===c.id,g=e(c.tags);return(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:c.id}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[c.type," Bloom ",c.bloomLevel]}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:c.published?"Published":"Draft"}),g?(0,b.jsxs)("div",{className:"text-xs font-semibold text-slate-700",children:["Domain ",g]}):(0,b.jsx)("div",{className:"text-xs font-semibold text-rose-700",children:"Domain missing"})]}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:a.canManage?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",disabled:l,onClick:()=>y(f?null:c.id),className:"rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:f?"Close":"Edit"}),(0,b.jsx)("button",{type:"button",disabled:l,onClick:()=>H(c),className:"rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:c.published?"Unpublish":"Publish"})]}):(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Read only"})})]}),f?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Question"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:c.question,onChange:a=>{let b=a.target.value;s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,question:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Options"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(c.options||[]).join("\n"),onChange:a=>{let b=a.target.value.split("\n").map(a=>a.trim()).filter(Boolean);s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,options:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Correct answer index"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:"number"==typeof c.correctAnswer?String(c.correctAnswer):"",onChange:a=>{let b=Number(a.target.value);s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,correctAnswer:Number.isFinite(b)?b:0}:a)}:a)}}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"This editor supports MCQ index answers for now"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Explanation"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:c.explanation,onChange:a=>{let b=a.target.value;s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,explanation:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Option rationales"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(c.optionRationales||[]).join("\n"),onChange:a=>{let b=a.target.value.split("\n").map(a=>a.trimEnd());s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,optionRationales:b}:a)}:a)},placeholder:"One line per option. Include why each option is correct or wrong."}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Keep the number of lines aligned with options"})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Bloom level"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:String(c.bloomLevel),onChange:a=>{let b=Math.max(1,Math.min(6,Number(a.target.value)||1));s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,bloomLevel:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tags"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:c.tags,onChange:a=>{let b=a.target.value;s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,tags:b}:a)}:a)}}),(0,b.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Domain tag"}),(0,b.jsxs)("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:e(c.tags)||"",onChange:a=>{let b=a.target.value;s(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,tags:function(a,b){let c=d(a);for(let a of Array.from(c))a.startsWith("domain:")&&c.delete(a);let e=String(b||"").trim();return e&&c.add(`domain:${e}`),Array.from(c).join(", ")}(a.tags,b)}:a)}:a)},children:[(0,b.jsx)("option",{value:"",children:"Choose domain"}),G.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tip"}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Use exactly one domain tag. Keep it consistent with the blueprint so the learning report links correctly."})]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("button",{type:"button",disabled:l,onClick:()=>I(c),className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"}),(0,b.jsx)("button",{type:"button",disabled:l,onClick:()=>y(null),className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:c.question}),(0,b.jsx)("ol",{className:"ml-5 list-decimal space-y-1 text-sm text-slate-700",children:(c.options||[]).map((a,c)=>(0,b.jsx)("li",{children:a},c))}),(0,b.jsxs)("div",{className:"text-xs text-slate-600",children:["Tags ",c.tags]})]})]},c.id)})})]})]})}a.s(["default",()=>f])}];

//# debugId=d093393b-be12-c54e-45c1-521d388cdbcc
//# sourceMappingURL=src_app_admin_assessments_ui_client_tsx_89d4345b._.js.map