;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="924e16da-5594-00b1-9eed-a4f97a4ee71f")}catch(e){}}();
module.exports=[899146,a=>{"use strict";var b=a.i(218282),c=a.i(572131);function d(a){let[d,e]=(0,c.useState)("foundations"),[f,g]=(0,c.useState)("2025.01"),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),v=(0,c.useMemo)(()=>({courseId:"cybersecurity",levelId:d,version:f}),[d,f]),w=async()=>{i(!0),k("");try{let a=`/api/admin/assessments/questions?courseId=${encodeURIComponent(v.courseId)}&levelId=${encodeURIComponent(v.levelId)}&version=${encodeURIComponent(v.version)}`,b=await fetch(a),c=await b.json().catch(()=>null);if(!b.ok)return void k(c?.error||"Unable to load assessment.");o(c);let d=`/api/admin/assessments/analysis?courseId=${encodeURIComponent(v.courseId)}&levelId=${encodeURIComponent(v.levelId)}&version=${encodeURIComponent(v.version)}`,e=await fetch(d),f=await e.json().catch(()=>null);e.ok?q(f):q(null);let g=`/api/admin/assessments/quality?courseId=${encodeURIComponent(v.courseId)}&levelId=${encodeURIComponent(v.levelId)}&version=${encodeURIComponent(v.version)}`,h=await fetch(g),i=await h.json().catch(()=>null);h.ok?s(i):s(null)}catch{k("Unable to load assessment.")}finally{i(!1)}};(0,c.useEffect)(()=>{w()},[v.courseId,v.levelId,v.version]);let x=(0,c.useMemo)(()=>{let a=n?.questions||[],b=a.filter(a=>a.published).length;return{total:a.length,published:b,draft:a.length-b}},[n?.questions]),y=async b=>{if(!a.canManage)return;let c=l.trim();if(!c)return void k("Reason required.");i(!0),k("");try{var d,e;let a,f=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(b.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:c,version:v.version,published:!b.published,patch:{tags:(d=b.tags,e=!b.published,a=new Set(String(d||"").split(",").map(a=>a.trim()).filter(Boolean)),e?a.add("published"):a.delete("published"),Array.from(a).join(", "))}})}),g=await f.json().catch(()=>null);if(!f.ok)return void k(g?.error||"Unable to update question.");m(""),await w()}catch{k("Unable to update question.")}finally{i(!1)}},z=async b=>{if(!a.canManage)return;let c=l.trim();if(!c)return void k("Reason required.");i(!0),k("");try{let a=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(b.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:c,version:v.version,patch:{question:b.question,options:b.options,correctAnswer:b.correctAnswer,explanation:b.explanation,optionRationales:b.optionRationales,tags:b.tags,bloomLevel:b.bloomLevel}})}),d=await a.json().catch(()=>null);if(!a.ok)return void k(d?.error||"Unable to update question.");u(null),m(""),await w()}catch{k("Unable to update question.")}finally{i(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Course"}),(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Cybersecurity"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"level",children:"Level"}),(0,b.jsxs)("select",{id:"level",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:d,onChange:a=>e(a.target.value),children:[(0,b.jsx)("option",{value:"foundations",children:"Foundations"}),(0,b.jsx)("option",{value:"applied",children:"Applied"}),(0,b.jsx)("option",{value:"practice",children:"Practice"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"version",children:"Course version"}),(0,b.jsx)("input",{id:"version",value:f,onChange:a=>g(a.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",placeholder:"Example 2025.01"})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Questions"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:x.total})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Published"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:x.published})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Draft"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:x.draft})]})]}),(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-[1fr_auto]",children:[(0,b.jsx)("input",{value:l,onChange:a=>m(a.target.value),placeholder:"Reason for change",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"}),(0,b.jsx)("button",{type:"button",disabled:h,onClick:w,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:h?"Loading":"Refresh"})]}),p?(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Attempt analytics"}),(0,b.jsxs)("div",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Attempts"}),(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:p.attempts.total})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Pass rate"}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[p.attempts.passRatePercent," percent"]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Average score"}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[p.attempts.avgScore," percent"]})]})]})]}):null,j?(0,b.jsx)("div",{className:"text-sm font-semibold text-rose-700",children:j}):null]}),(0,b.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Questions"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,b.jsx)("span",{children:"Tag `published` is required for exam selection"}),(0,b.jsx)("a",{className:"font-semibold text-emerald-700 hover:underline",href:`/api/admin/assessments/answer-key?courseId=${encodeURIComponent(v.courseId)}&levelId=${encodeURIComponent(v.levelId)}&version=${encodeURIComponent(v.version)}`,children:"Download answer key"})]})]}),r?(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Quality checks"}),(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:Object.entries(r.totals||{}).map(([a,c])=>(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:a}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:c})]},a))}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Prioritise missing rationales first so the exported answer key is worth paying for."})]}):null,(0,b.jsx)("div",{className:"space-y-3",children:(n?.questions||[]).map(c=>{let d=t===c.id;return(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:c.id}),(0,b.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[c.type," Bloom ",c.bloomLevel]}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:c.published?"Published":"Draft"})]}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:a.canManage?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",disabled:h,onClick:()=>u(d?null:c.id),className:"rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:d?"Close":"Edit"}),(0,b.jsx)("button",{type:"button",disabled:h,onClick:()=>y(c),className:"rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:c.published?"Unpublish":"Publish"})]}):(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Read only"})})]}),d?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Question"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:c.question,onChange:a=>{let b=a.target.value;o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,question:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Options"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(c.options||[]).join("\n"),onChange:a=>{let b=a.target.value.split("\n").map(a=>a.trim()).filter(Boolean);o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,options:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Correct answer index"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:"number"==typeof c.correctAnswer?String(c.correctAnswer):"",onChange:a=>{let b=Number(a.target.value);o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,correctAnswer:Number.isFinite(b)?b:0}:a)}:a)}}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"This editor supports MCQ index answers for now"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Explanation"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:c.explanation,onChange:a=>{let b=a.target.value;o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,explanation:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Option rationales"}),(0,b.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(c.optionRationales||[]).join("\n"),onChange:a=>{let b=a.target.value.split("\n").map(a=>a.trimEnd());o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,optionRationales:b}:a)}:a)},placeholder:"One line per option. Include why each option is correct or wrong."}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Keep the number of lines aligned with options"})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Bloom level"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:String(c.bloomLevel),onChange:a=>{let b=Math.max(1,Math.min(6,Number(a.target.value)||1));o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,bloomLevel:b}:a)}:a)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tags"}),(0,b.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:c.tags,onChange:a=>{let b=a.target.value;o(a=>a?{...a,questions:a.questions.map(a=>a.id===c.id?{...a,tags:b}:a)}:a)}})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("button",{type:"button",disabled:h,onClick:()=>z(c),className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"}),(0,b.jsx)("button",{type:"button",disabled:h,onClick:()=>u(null),className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:c.question}),(0,b.jsx)("ol",{className:"ml-5 list-decimal space-y-1 text-sm text-slate-700",children:(c.options||[]).map((a,c)=>(0,b.jsx)("li",{children:a},c))}),(0,b.jsxs)("div",{className:"text-xs text-slate-600",children:["Tags ",c.tags]})]})]},c.id)})})]})]})}a.s(["default",()=>d])}];

//# debugId=924e16da-5594-00b1-9eed-a4f97a4ee71f
//# sourceMappingURL=src_app_admin_assessments_ui_client_tsx_89d4345b._.js.map