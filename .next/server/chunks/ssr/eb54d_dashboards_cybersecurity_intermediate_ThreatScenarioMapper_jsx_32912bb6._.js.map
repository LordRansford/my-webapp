{
  "version": 3,
  "sources": [],
  "debugId": "4393bc8c-028a-cc24-f235-68d628fd37d5",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/dashboards/cybersecurity/intermediate/ThreatScenarioMapper.jsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\n\nconst DEFAULT_ASSETS = [\n  { id: \"asset1\", name: \"Customer data\", value: \"high\" },\n  { id: \"asset2\", name: \"Payment API\", value: \"high\" },\n  { id: \"asset3\", name: \"Support inbox\", value: \"medium\" },\n];\n\nconst DEFAULT_ATTACKERS = [\n  { id: \"att1\", name: \"External attacker\" },\n  { id: \"att2\", name: \"Insider\" },\n  { id: \"att3\", name: \"Bot/scanner\" },\n];\n\nconst DEFAULT_ENTRIES = [\n  { id: \"entry1\", name: \"Web portal\" },\n  { id: \"entry2\", name: \"API\" },\n  { id: \"entry3\", name: \"Support inbox\" },\n];\n\nexport default function ThreatScenarioMapper() {\n  const [assets, setAssets] = useState(DEFAULT_ASSETS);\n  const [attackers, setAttackers] = useState(DEFAULT_ATTACKERS);\n  const [entries, setEntries] = useState(DEFAULT_ENTRIES);\n  const [selectedAttacker, setSelectedAttacker] = useState(null);\n  const [selectedEntry, setSelectedEntry] = useState(null);\n  const [links, setLinks] = useState({ attToEntry: [], entryToAsset: [] });\n  const [summary, setSummary] = useState(\"\");\n\n  const addAsset = () => {\n    if (assets.length >= 5) return;\n    setAssets([...assets, { id: `asset-${Date.now()}`, name: \"New asset\", value: \"low\" }]);\n  };\n  const addAttacker = () => {\n    if (attackers.length >= 4) return;\n    setAttackers([...attackers, { id: `att-${Date.now()}`, name: \"New attacker\" }]);\n  };\n  const addEntry = () => {\n    if (entries.length >= 5) return;\n    setEntries([...entries, { id: `entry-${Date.now()}`, name: \"New entry point\" }]);\n  };\n\n  const toggleLink = (from, to, type) => {\n    setLinks((prev) => {\n      const list = type === \"attToEntry\" ? prev.attToEntry : prev.entryToAsset;\n      const exists = list.find((l) => l.from === from && l.to === to);\n      const updated = exists ? list.filter((l) => !(l.from === from && l.to === to)) : [...list, { from, to }];\n      return type === \"attToEntry\" ? { ...prev, attToEntry: updated } : { ...prev, entryToAsset: updated };\n    });\n  };\n\n  useMemo(() => {\n    const entryCounts = {};\n    links.entryToAsset.forEach((l) => {\n      entryCounts[l.to] = (entryCounts[l.to] || 0) + 1;\n    });\n    const topAssetId = Object.entries(entryCounts).sort((a, b) => b[1] - a[1])[0]?.[0];\n    const topAsset = assets.find((a) => a.id === topAssetId) || assets[0];\n    const pathsToTop = links.attToEntry\n      .filter((l) => links.entryToAsset.some((ea) => ea.from === l.to && ea.to === topAsset?.id))\n      .map((l) => l.from);\n    const attackerCounts = pathsToTop.reduce((acc, id) => ({ ...acc, [id]: (acc[id] || 0) + 1 }), {});\n    const topAttackerId = Object.entries(attackerCounts).sort((a, b) => b[1] - a[1])[0]?.[0];\n    const topAttacker = attackers.find((a) => a.id === topAttackerId) || attackers[0];\n    if (topAsset && topAttacker) {\n      setSummary(\n        `${topAsset.name} (value: ${topAsset.value}) has the most connected entry points. ${topAttacker.name} has the most paths to it.`\n      );\n    } else {\n      setSummary(\"Add links to see which attacker can most easily reach which asset.\");\n    }\n  }, [assets, attackers, links]);\n\n  return (\n    <div className=\"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200\">\n      <div className=\"grid gap-3 md:grid-cols-3\">\n        <Column\n          title=\"Assets\"\n          items={assets}\n          onAdd={addAsset}\n          selected={null}\n          onSelect={() => {}}\n          type=\"asset\"\n        />\n        <Column\n          title=\"Entry points\"\n          items={entries}\n          onAdd={addEntry}\n          selected={selectedEntry}\n          onSelect={setSelectedEntry}\n          type=\"entry\"\n        />\n        <Column\n          title=\"Attacker types\"\n          items={attackers}\n          onAdd={addAttacker}\n          selected={selectedAttacker}\n          onSelect={setSelectedAttacker}\n          type=\"attacker\"\n        />\n      </div>\n\n      <div className=\"mt-4 grid gap-3 md:grid-cols-2\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Link attackers to entry points</h5>\n          <LinkGrid\n            rows={attackers}\n            cols={entries}\n            links={links.attToEntry}\n            onToggle={(from, to) => toggleLink(from, to, \"attToEntry\")}\n          />\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Link entry points to assets</h5>\n          <LinkGrid\n            rows={entries}\n            cols={assets}\n            links={links.entryToAsset}\n            onToggle={(from, to) => toggleLink(from, to, \"entryToAsset\")}\n          />\n        </div>\n      </div>\n\n      <div className=\"mt-4 rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-sm\">\n        {summary}\n      </div>\n    </div>\n  );\n}\n\nfunction Column({ title, items, onAdd, selected, onSelect, type }) {\n  return (\n    <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-3 shadow-sm\">\n      <div className=\"mb-2 flex items-center justify-between\">\n        <h4 className=\"text-sm font-semibold text-slate-900\">{title}</h4>\n        <button\n          onClick={onAdd}\n          className=\"rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300\"\n        >\n          Add\n        </button>\n      </div>\n      <div className=\"space-y-2\">\n        {items.map((item) => (\n          <button\n            key={item.id}\n            onClick={() => onSelect && onSelect(item.id)}\n            className={`w-full rounded-lg border px-3 py-2 text-left text-sm font-medium transition focus:outline-none focus:ring-2 focus:ring-sky-300 ${\n              selected === item.id ? \"border-sky-300 bg-sky-50 text-slate-900\" : \"border-slate-200 bg-white text-slate-800\"\n            }`}\n          >\n            <div className=\"font-semibold\">{item.name}</div>\n            {item.value ? <div className=\"text-xs text-slate-700\">Value: {item.value}</div> : null}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction LinkGrid({ rows, cols, links, onToggle }) {\n  return (\n    <div className=\"overflow-auto\">\n      <table className=\"w-full border-collapse text-xs\">\n        <thead>\n          <tr>\n            <th className=\"p-2 text-left text-slate-700\">From \\\\ To</th>\n            {cols.map((c) => (\n              <th key={c.id} className=\"p-2 text-left text-slate-700\">\n                {c.name}\n              </th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {rows.map((r) => (\n            <tr key={r.id} className=\"border-t border-slate-200\">\n              <td className=\"p-2 font-semibold text-slate-800\">{r.name}</td>\n              {cols.map((c) => {\n                const active = links.some((l) => l.from === r.id && l.to === c.id);\n                return (\n                  <td key={c.id} className=\"p-2\">\n                    <button\n                      onClick={() => onToggle(r.id, c.id)}\n                      className={`h-6 w-6 rounded-full border ${\n                        active ? \"border-emerald-300 bg-emerald-100\" : \"border-slate-300 bg-white\"\n                      } focus:outline-none focus:ring-2 focus:ring-sky-300`}\n                      aria-label=\"Toggle link\"\n                    />\n                  </td>\n                );\n              })}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}