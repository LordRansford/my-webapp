{
  "version": 3,
  "sources": [],
  "debugId": "4899c91e-def0-3beb-e975-820425154d65",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/notes/hooks/use_tool_state.jsx","../../../../src/components/notes/ToolStateActions.jsx","../../../../src/components/ui/CheckPill.tsx","../../../../src/components/notes/tools/cybersecurity/advanced/CertificateChainTool.jsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useMemo, useRef, useState } from 'react'\n\nfunction safe_json_parse(value, fallback) {\n  try {\n    return JSON.parse(value)\n  } catch {\n    return fallback\n  }\n}\n\nfunction encode_state(obj) {\n  const json = JSON.stringify(obj)\n  const bytes = new TextEncoder().encode(json)\n  let binary = ''\n  bytes.forEach((b) => {\n    binary += String.fromCharCode(b)\n  })\n  return btoa(binary)\n}\n\nfunction decode_state(b64) {\n  const binary = atob(b64)\n  const bytes = Uint8Array.from(binary, (c) => c.charCodeAt(0))\n  const json = new TextDecoder().decode(bytes)\n  return safe_json_parse(json, null)\n}\n\nexport function useToolState({ tool_id, initial_state }) {\n  const [state, set_state] = useState(initial_state)\n  const [is_ready, set_is_ready] = useState(false)\n  const initial_ref = useRef(initial_state)\n\n  const url_key = useMemo(() => {\n    if (typeof window === 'undefined') return null\n    const params = new URLSearchParams(window.location.search)\n    return params.get(`s_${tool_id}`)\n  }, [tool_id])\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return\n    const from_url = url_key ? decode_state(url_key) : null\n    if (from_url) {\n      set_state(from_url)\n      set_is_ready(true)\n      return\n    }\n    const saved = window.localStorage.getItem(`rn_tool_${tool_id}`)\n    if (saved) {\n      set_state(safe_json_parse(saved, initial_ref.current))\n      set_is_ready(true)\n      return\n    }\n    set_is_ready(true)\n  }, [tool_id, url_key])\n\n  useEffect(() => {\n    if (!is_ready) return\n    if (typeof window === 'undefined') return\n    window.localStorage.setItem(`rn_tool_${tool_id}`, JSON.stringify(state))\n  }, [state, tool_id, is_ready])\n\n  function reset() {\n    set_state(initial_ref.current)\n    if (typeof window !== 'undefined') {\n      window.localStorage.removeItem(`rn_tool_${tool_id}`)\n    }\n  }\n\n  function copy_share_link() {\n    if (typeof window === 'undefined') return\n    const params = new URLSearchParams(window.location.search)\n    params.set(`s_${tool_id}`, encode_state(state))\n    const url = `${window.location.pathname}?${params.toString()}`\n    navigator.clipboard.writeText(`${window.location.origin}${url}`)\n  }\n\n  function export_json() {\n    const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application_json' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = `${tool_id}_state.json`\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  async function import_json(file) {\n    const text = await file.text()\n    const parsed = safe_json_parse(text, null)\n    if (parsed) set_state(parsed)\n  }\n\n  return {\n    state,\n    set_state,\n    reset,\n    copy_share_link,\n    export_json,\n    import_json,\n    is_ready,\n  }\n}\n\n// Temporary alias to avoid breaking existing imports while keeping hook naming compliant.\nexport const use_tool_state = useToolState\n","'use client'\n\nexport function ToolStateActions({ onReset, onCopy, onExport, onImport }) {\n  return (\n    <div className=\"mt-3 flex flex-wrap gap-2 text-xs\">\n      {onReset ? (\n        <button\n          onClick={onReset}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Reset\n        </button>\n      ) : null}\n      {onCopy ? (\n        <button\n          onClick={onCopy}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Copy link\n        </button>\n      ) : null}\n      {onExport ? (\n        <button\n          onClick={onExport}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Export\n        </button>\n      ) : null}\n      {onImport ? (\n        <label className=\"inline-flex cursor-pointer items-center gap-1 rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus-within:ring focus-within:ring-blue-200\">\n          <span>Import</span>\n          <input\n            type=\"file\"\n            accept=\"application/json\"\n            onChange={(e) => {\n              const file = e.target.files?.[0]\n              if (file) onImport(file)\n              e.target.value = ''\n            }}\n            className=\"hidden\"\n          />\n        </label>\n      ) : null}\n    </div>\n  )\n}\n\nexport default ToolStateActions\n","import React from \"react\";\n\ntype Tone = \"sky\" | \"emerald\" | \"violet\" | \"amber\" | \"rose\" | \"slate\";\n\ntype Props = {\n  checked: boolean;\n  onCheckedChange: (checked: boolean) => void;\n  children: React.ReactNode;\n  after?: React.ReactNode;\n  tone?: Tone;\n  className?: string;\n  size?: \"sm\" | \"xs\";\n  disabled?: boolean;\n};\n\nconst toneClasses: Record<Tone, { border: string; bg: string; ring: string }> = {\n  sky: { border: \"border-sky-400/40\", bg: \"bg-sky-500/15\", ring: \"focus-visible:ring-sky-300/40\" },\n  emerald: { border: \"border-emerald-400/40\", bg: \"bg-emerald-500/15\", ring: \"focus-visible:ring-emerald-300/40\" },\n  violet: { border: \"border-violet-400/40\", bg: \"bg-violet-500/15\", ring: \"focus-visible:ring-violet-300/40\" },\n  amber: { border: \"border-amber-400/40\", bg: \"bg-amber-500/15\", ring: \"focus-visible:ring-amber-300/40\" },\n  rose: { border: \"border-rose-400/40\", bg: \"bg-rose-500/15\", ring: \"focus-visible:ring-rose-300/40\" },\n  slate: { border: \"border-slate-400/40\", bg: \"bg-slate-500/10\", ring: \"focus-visible:ring-slate-300/30\" },\n};\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nexport function CheckPill({\n  checked,\n  onCheckedChange,\n  children,\n  after,\n  tone = \"sky\",\n  className,\n  size = \"sm\",\n  disabled = false,\n}: Props) {\n  const toneStyle = toneClasses[tone] || toneClasses.sky;\n  const padding = size === \"xs\" ? \"px-3 py-2\" : \"px-3.5 py-2.5\";\n  const text = size === \"xs\" ? \"text-[0.7rem]\" : \"text-xs\";\n  const toggle = size === \"xs\" ? \"h-5 w-9\" : \"h-6 w-11\";\n  const knob = size === \"xs\" ? \"h-4 w-4\" : \"h-5 w-5\";\n  const knobOn = size === \"xs\" ? \"translate-x-4\" : \"translate-x-5\";\n  const knobOff = \"translate-x-1\";\n\n  return (\n    <button\n      type=\"button\"\n      role=\"switch\"\n      aria-checked={checked}\n      disabled={disabled}\n      onClick={() => onCheckedChange(!checked)}\n      className={cx(\n        \"inline-flex w-full items-center justify-between gap-3 rounded-2xl border transition\",\n        padding,\n        text,\n        \"bg-white/80 text-slate-900 hover:bg-white\",\n        \"dark:bg-slate-950/40 dark:text-slate-100 dark:hover:bg-slate-900/60 dark:border-slate-700\",\n        checked ? cx(toneStyle.bg, toneStyle.border) : \"border-slate-200\",\n        \"focus-visible:outline-none focus-visible:ring-2\",\n        toneStyle.ring,\n        disabled && \"cursor-not-allowed opacity-60\",\n        className\n      )}\n    >\n      <span className=\"min-w-0\">{children}</span>\n      <span className=\"inline-flex shrink-0 items-center gap-2\">\n        {after ? <span className=\"shrink-0\">{after}</span> : null}\n        <span\n          className={cx(\n            \"relative inline-flex items-center rounded-full border transition\",\n            toggle,\n            checked ? cx(toneStyle.border, toneStyle.bg) : \"border-slate-300 bg-slate-200\",\n            \"dark:border-slate-600 dark:bg-slate-800\"\n          )}\n          aria-hidden=\"true\"\n        >\n          <span\n            className={cx(\n              \"inline-block transform rounded-full bg-white shadow-sm transition\",\n              knob,\n              checked ? knobOn : knobOff\n            )}\n          />\n        </span>\n      </span>\n    </button>\n  );\n}\n","\"use client\";\n\nimport { use_tool_state } from \"@/components/notes/hooks/use_tool_state\";\nimport ToolStateActions from \"@/components/notes/ToolStateActions\";\nimport { CheckPill } from \"@/components/ui/CheckPill\";\n\nconst steps = [\"Root CA\", \"Intermediate CA\", \"Leaf certificate\"];\n\nexport default function CertificateChainTool() {\n  const { state, set_state, reset, copy_share_link, export_json, import_json, is_ready } = use_tool_state({\n    tool_id: \"certificate-chain-tool\",\n    initial_state: { broken: false, missing: false, nameMismatch: false },\n  });\n\n  if (!is_ready) return <p className=\"text-sm text-gray-600\">Loading.</p>;\n\n  const issues = [];\n  if (state.broken) issues.push(\"Signature invalid\");\n  if (state.missing) issues.push(\"Missing intermediate\");\n  if (state.nameMismatch) issues.push(\"Hostname mismatch\");\n\n  const status = issues.length ? \"Chain should fail validation\" : \"Chain should validate\";\n\n  return (\n    <div className=\"space-y-4 text-sm\">\n      <p className=\"text-gray-700\">Toggle failures in the chain and see what the validator should do.</p>\n\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-3\">\n        {steps.map((s, idx) => (\n          <div key={s} className=\"rounded-lg border px-3 py-3 bg-gray-50\">\n            <div className=\"text-xs uppercase tracking-wide text-gray-500\">Step {idx + 1}</div>\n            <div className=\"font-semibold text-gray-900\">{s}</div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex flex-wrap gap-2\">\n        <Toggle label=\"Break signature\" checked={state.broken} onChange={(v) => set_state((p) => ({ ...p, broken: v }))} />\n        <Toggle label=\"Remove intermediate\" checked={state.missing} onChange={(v) => set_state((p) => ({ ...p, missing: v }))} />\n        <Toggle label=\"Name mismatch\" checked={state.nameMismatch} onChange={(v) => set_state((p) => ({ ...p, nameMismatch: v }))} />\n      </div>\n\n      <div className=\"rounded-lg border px-3 py-2 bg-white\">\n        <div className=\"text-xs font-semibold text-gray-700\">Expected outcome</div>\n        <p className=\"text-gray-800\">{status}</p>\n        <p className=\"text-xs text-gray-600 mt-1\">If validation still passes when these are set, your validation is broken.</p>\n      </div>\n\n      <ToolStateActions\n        onReset={reset}\n        onCopy={copy_share_link}\n        onExport={export_json}\n        onImport={import_json}\n      />\n    </div>\n  );\n}\n\nfunction Toggle({ label, checked, onChange }) {\n  return (\n    <div className=\"w-auto\">\n      <CheckPill checked={checked} onCheckedChange={onChange} tone=\"emerald\" size=\"xs\" className=\"w-auto\">\n        {label}\n      </CheckPill>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}