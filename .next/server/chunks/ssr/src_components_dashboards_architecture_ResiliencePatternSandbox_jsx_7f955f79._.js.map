{
  "version": 3,
  "sources": [],
  "debugId": "7d0c987d-e159-2d27-4421-c7d1285ecc32",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/dashboards/architecture/ResiliencePatternSandbox.jsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\n\nexport function ResiliencePatternSandbox() {\n  const [baseFailureRate, setBaseFailureRate] = useState(5);\n  const [retries, setRetries] = useState(2);\n  const [timeoutMs, setTimeoutMs] = useState(500);\n  const [circuitThreshold, setCircuitThreshold] = useState(50);\n\n  const stats = useMemo(() => {\n    const p = baseFailureRate / 100;\n    const attempts = retries + 1;\n    const userFailureProbability = Math.pow(p, attempts);\n\n    const extraLoadFactor = attempts;\n    const likelyCircuitTrip = baseFailureRate >= circuitThreshold ? \"High chance of opening\" : \"Unlikely to open\";\n\n    return {\n      userFailureProbability,\n      extraLoadFactor,\n      likelyCircuitTrip,\n    };\n  }, [baseFailureRate, retries, circuitThreshold]);\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      <p className=\"text-sm text-slate-600\">\n        This sandbox lets you see how retries, timeouts and circuit breakers interact. It is not a full reliability model. It helps\n        you feel how quickly extra retries can create extra load.\n      </p>\n\n      <div className=\"grid gap-4 md:grid-cols-[2fr,1fr]\">\n        <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm\">\n          <div className=\"space-y-4\">\n            <label className=\"block text-xs text-slate-600\">\n              Base failure rate of a single call\n              <input\n                type=\"range\"\n                min={1}\n                max={60}\n                value={baseFailureRate}\n                onChange={(e) => setBaseFailureRate(Number(e.target.value) || 1)}\n                className=\"mt-1 w-full\"\n              />\n              <span className=\"mt-1 inline-block text-xs text-slate-700\">\n                {baseFailureRate}% of calls fail before resilience patterns.\n              </span>\n            </label>\n\n            <label className=\"block text-xs text-slate-600\">\n              Retries\n              <input\n                type=\"range\"\n                min={0}\n                max={4}\n                value={retries}\n                onChange={(e) => setRetries(Number(e.target.value) || 0)}\n                className=\"mt-1 w-full\"\n              />\n              <span className=\"mt-1 inline-block text-xs text-slate-700\">\n                {retries} retry attempt{retries === 1 ? \"\" : \"s\"} after the first call.\n              </span>\n            </label>\n\n            <label className=\"block text-xs text-slate-600\">\n              Timeout per attempt\n              <input\n                type=\"range\"\n                min={200}\n                max={3000}\n                step={100}\n                value={timeoutMs}\n                onChange={(e) => setTimeoutMs(Number(e.target.value) || 200)}\n                className=\"mt-1 w-full\"\n              />\n              <span className=\"mt-1 inline-block text-xs text-slate-700\">{timeoutMs} ms per attempt.</span>\n            </label>\n\n            <label className=\"block text-xs text-slate-600\">\n              Circuit breaker failure threshold\n              <input\n                type=\"range\"\n                min={10}\n                max={80}\n                step={5}\n                value={circuitThreshold}\n                onChange={(e) => setCircuitThreshold(Number(e.target.value) || 10)}\n                className=\"mt-1 w-full\"\n              />\n              <span className=\"mt-1 inline-block text-xs text-slate-700\">\n                Circuit opens when failure rate is around {circuitThreshold}% or higher.\n              </span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"space-y-3\">\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm\">\n            <p className=\"mb-2 text-xs font-medium uppercase tracking-wide text-slate-500\">Estimated outcomes</p>\n            <p className=\"text-xs text-slate-700\">\n              Probability that a user still sees a failure after all retries:{\" \"}\n              <span className=\"font-semibold\">{(stats.userFailureProbability * 100).toFixed(2)}%</span>\n            </p>\n            <p className=\"text-xs text-slate-700\">\n              Relative extra load due to retries: <span className=\"font-semibold\">{stats.extraLoadFactor.toFixed(1)} times</span> the\n              original request volume.\n            </p>\n            <p className=\"text-xs text-slate-700\">\n              Circuit breaker behaviour: <span className=\"font-semibold\">{stats.likelyCircuitTrip}</span>\n            </p>\n            <p className=\"mt-2 text-xs text-slate-600\">\n              Total worst case time for one user is roughly {(timeoutMs * (retries + 1)) / 1000} seconds if every attempt hits the\n              full timeout.\n            </p>\n          </div>\n\n          <div className=\"rounded-2xl bg-slate-50 p-3 text-xs text-slate-700\">\n            <p className=\"mb-1 font-medium\">Discussion prompts</p>\n            <ul className=\"list-disc space-y-1 pl-4\">\n              <li>Is the extra load factor acceptable for the downstream service during an incident.</li>\n              <li>Would a shorter timeout with fewer retries give users a faster, clearer failure.</li>\n              <li>Are there some operations where you prefer no retries at all, for example payments.</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QAEO,SAAS,IACd,GAAM,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACjD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACjC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,KACrC,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAEnD,EAAQ,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAEpB,IAAM,EAAW,EAAU,EAM3B,MAAO,CACL,uBAN6B,KAAK,GAAG,CAF7B,AAE8B,EAFZ,IAEe,GAOzC,gBALsB,EAMtB,kBALwB,GAAmB,EAAmB,yBAA2B,kBAM3F,CACF,EAAG,CAAC,EAAiB,EAAS,EAAiB,EAE/C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gCACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,kCAAyB,0LAKtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yCAA+B,qCAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,GACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAmB,OAAO,EAAE,MAAM,CAAC,KAAK,GAAK,GAC9D,UAAU,gBAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,qDACb,EAAgB,oDAIrB,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yCAA+B,UAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,IAAK,EACL,IAAK,EACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,OAAO,EAAE,MAAM,CAAC,KAAK,GAAK,GACtD,UAAU,gBAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,qDACb,EAAQ,iBAA2B,IAAZ,EAAgB,GAAK,IAAI,+BAIrD,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yCAA+B,sBAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,IAAK,IACL,IAAK,IACL,KAAM,IACN,MAAO,EACP,SAAU,AAAC,GAAM,EAAa,OAAO,EAAE,MAAM,CAAC,KAAK,GAAK,KACxD,UAAU,gBAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,qDAA4C,EAAU,yBAGxE,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yCAA+B,oCAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,IAAK,GACL,IAAK,GACL,KAAM,EACN,MAAO,EACP,SAAW,AAAD,GAAO,EAAoB,OAAO,EAAE,MAAM,CAAC,KAAK,GAAK,IAC/D,UAAU,gBAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,qDAA2C,6CACd,EAAiB,0BAMpE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EAAkE,uBAC/E,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mCAAyB,kEAC4B,IAChE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0BAAiB,CAAgC,IAA/B,EAAM,sBAAyB,AAAH,CAAM,CAAE,OAAO,CAAC,GAAG,UAEnF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mCAAyB,uCACA,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0BAAiB,EAAM,eAAe,CAAC,OAAO,CAAC,GAAG,YAAa,mCAGrH,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mCAAyB,8BACT,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAiB,EAAM,iBAAiB,MAErF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,wCAA8B,iDACO,GAAa,GAAU,CAAC,CAAK,IAAjB,AAAsB,yDAKtF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4BAAmB,uBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,qCACZ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,uFACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,qFACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,sGAOlB"}}]
}