{
  "version": 3,
  "sources": [],
  "debugId": "8acd28a7-4006-91eb-4522-85fda3680665",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/tools/cybersecurity/SafeLinkInspector.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\n\ntype Analysis = {\n  ok: boolean;\n  issues: string[];\n  parts?: {\n    scheme: string;\n    host: string;\n    registrableDomain: string;\n    tld: string;\n    path: string;\n    query: string;\n  };\n};\n\nfunction analyseUrl(input: string): Analysis {\n  const trimmed = input.trim();\n  if (!trimmed) return { ok: true, issues: [] };\n\n  try {\n    const url = new URL(\n      trimmed.match(/^https?:\\/\\//i) ? trimmed : \"https://\" + trimmed\n    );\n    const host = url.hostname;\n    const bits = host.split(\".\");\n    const tld = bits.length > 1 ? bits[bits.length - 1] : \"\";\n    const registrableDomain =\n      bits.length > 1 ? bits.slice(bits.length - 2).join(\".\") : host;\n\n    const issues: string[] = [];\n\n    if (url.username || url.password) {\n      issues.push(\"The address contains a username or password section.\");\n    }\n    if (host.includes(\"@\")) {\n      issues.push(\"The address uses an @ symbol inside the host name.\");\n    }\n    if (host.startsWith(\"xn--\")) {\n      issues.push(\"The host uses punycode which can hide look alike letters.\");\n    }\n    if (url.search.includes(\"@\") || url.search.includes(\"%40\")) {\n      issues.push(\"The query string contains an @ symbol.\");\n    }\n    if (url.hash) {\n      issues.push(\"The address has a fragment part after #.\");\n    }\n\n    return {\n      ok: issues.length === 0,\n      issues,\n      parts: {\n        scheme: url.protocol.replace(\":\", \"\"),\n        host,\n        registrableDomain,\n        tld,\n        path: url.pathname === \"/\" ? \"\" : url.pathname,\n        query: url.search.replace(/^\\?/, \"\"),\n      },\n    };\n  } catch {\n    return {\n      ok: false,\n      issues: [\"The text could not be parsed as a web address.\"],\n    };\n  }\n}\n\nexport function SafeLinkInspector() {\n  const [input, setInput] = useState(\"\");\n  const analysis = analyseUrl(input);\n  const verdictColor =\n    input.trim().length === 0\n      ? \"bg-slate-50 text-slate-700 border-slate-200\"\n      : analysis.ok\n      ? \"bg-emerald-50 text-emerald-800 border-emerald-200\"\n      : \"bg-amber-50 text-amber-800 border-amber-200\";\n\n  return (\n    <section\n      aria-labelledby=\"safe-link-inspector-title\"\n      className=\"rounded-3xl bg-white shadow-sm ring-1 ring-slate-100 p-6 sm:p-8 space-y-6\"\n    >\n      <header className=\"space-y-2\">\n        <h2\n          id=\"safe-link-inspector-title\"\n          className=\"text-lg sm:text-xl font-semibold text-slate-900\"\n        >\n          Safe link inspector\n        </h2>\n        <p className=\"text-sm text-slate-600 max-w-xl\">\n          Paste or type a web address to see how the browser interprets it. The\n          goal is not to say if a site is safe. The goal is to help you read the\n          address with more confidence.\n        </p>\n      </header>\n\n      <div className=\"space-y-4\">\n        <div className=\"flex flex-col sm:flex-row gap-3 sm:items-center\">\n          <label\n            htmlFor=\"safe-link-input\"\n            className=\"text-xs font-medium uppercase tracking-wide text-slate-500 sm:w-32\"\n          >\n            Web address\n          </label>\n          <input\n            id=\"safe-link-input\"\n            type=\"text\"\n            className=\"flex-1 rounded-2xl border border-slate-200 bg-slate-50/60 px-3 py-2 text-sm text-slate-800 shadow-inner focus:border-sky-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-200\"\n            placeholder=\"For example: https://signin.example.com/payments\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n          />\n        </div>\n\n        <div\n          className={`rounded-2xl border px-4 py-3 text-sm ${verdictColor}`}\n        >\n          <p className=\"text-xs uppercase tracking-wide mb-1\">\n            What this tells you\n          </p>\n          {input.trim().length === 0 ? (\n            <p>\n              Start typing a link or domain. The tool will not open it or send\n              it anywhere. It only shows how the browser would read it.\n            </p>\n          ) : analysis.ok ? (\n            <p>\n              The structure of this address is valid. That does not mean the\n              site is trustworthy. Always confirm the registrable domain matches\n              the service you expect.\n            </p>\n          ) : (\n            <p>\n              Something about this address deserves closer attention. Read the\n              notes below before you decide whether to visit it.\n            </p>\n          )}\n        </div>\n\n        <div className=\"grid gap-4 lg:grid-cols-2\">\n          <div className=\"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-3\">\n            <h3 className=\"text-sm font-semibold text-slate-900\">\n              Address breakdown\n            </h3>\n            {analysis.parts ? (\n              <dl className=\"grid grid-cols-2 gap-y-2 gap-x-4 text-xs text-slate-700\">\n                <dt className=\"font-semibold\">Scheme</dt>\n                <dd>{analysis.parts.scheme || \"Not found\"}</dd>\n                <dt className=\"font-semibold\">Host name</dt>\n                <dd>{analysis.parts.host || \"Not found\"}</dd>\n                <dt className=\"font-semibold\">Registrable domain</dt>\n                <dd>{analysis.parts.registrableDomain || \"Not found\"}</dd>\n                <dt className=\"font-semibold\">Top level domain</dt>\n                <dd>{analysis.parts.tld || \"Not found\"}</dd>\n                <dt className=\"font-semibold\">Path</dt>\n                <dd>{analysis.parts.path || \"None\"}</dd>\n                <dt className=\"font-semibold\">Query</dt>\n                <dd>{analysis.parts.query || \"None\"}</dd>\n              </dl>\n            ) : (\n              <p className=\"text-xs text-slate-500\">\n                Once you enter a valid address, this panel will show how the\n                browser splits it into parts.\n              </p>\n            )}\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-100 bg-white p-4 space-y-2\">\n            <h3 className=\"text-sm font-semibold text-slate-900\">\n              Things to slow down for\n            </h3>\n            {analysis.issues.length > 0 ? (\n              <ul className=\"list-disc pl-5 space-y-1.5 text-xs text-slate-700\">\n                {analysis.issues.map((issue, idx) => (\n                  <li key={idx}>{issue}</li>\n                ))}\n                <li>\n                  If you did not expect this link or you feel even slightly\n                  unsure, open a fresh tab and type the address of the service\n                  manually instead of clicking.\n                </li>\n              </ul>\n            ) : (\n              <p className=\"text-xs text-slate-500\">\n                No structural red flags were detected. This is not a guarantee\n                that the site is safe. Combine this with content and context.\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}