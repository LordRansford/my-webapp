;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="dfcad99c-b2ae-4bf3-8563-081ed1f9fcbc")}catch(e){}}();
module.exports=[388480,a=>{"use strict";let b=new class{storageKey="studio-audit-logs";maxLogs=1e3;log(a,b,c){}getLogs(){return[]}getLogsForStudio(a){return this.getLogs().filter(b=>b.studio===a)}clearLogs(){}exportLogs(){return JSON.stringify(this.getLogs(),null,2)}};a.s(["AuditActions",0,{TOOL_OPENED:"tool_opened",FILE_UPLOADED:"file_uploaded",PROJECT_CREATED:"project_created",PROJECT_DELETED:"project_deleted",DEPLOYMENT_INITIATED:"deployment_initiated",CREDITS_CONSUMED:"credits_consumed",SETTINGS_CHANGED:"settings_changed",ERROR_OCCURRED:"error_occurred",ERROR_BOUNDARY_TRIGGERED:"error_boundary_triggered",ERROR_BOUNDARY_RESET:"error_boundary_reset",PERFORMANCE_ISSUE:"performance_issue",RETRY_ATTEMPTED:"retry_attempted"},"auditLogger",0,b])},582257,a=>{"use strict";function b(a,c=1e3){if("string"!=typeof a)return"";let d=a.replace(/<[^>]*>/g,"");return(d=(d=d.replace(/[<>\"']/g,"")).trim()).length>c&&(d=d.slice(0,c)),d}function c(a){if(!a||"string"!=typeof a)return"file";let b=a.replace(/[\/\\]/g,"_").replace(/[<>:"|?*]/g,"_").replace(/\.\./g,"_").trim();if((b=b.replace(/^\.+/,"")).length>255){let a=b.split(".").pop(),c=b.slice(0,255-(a?a.length+1:0));b=a?`${c}.${a}`:c}return b||(b="file"),b}function d(a){if("string"!=typeof a)return{valid:!1,data:null,error:"Input must be a string"};try{let c=JSON.parse(a),d=function a(c,d,e){if(d>e)return null;if(null==c)return c;if("object"!=typeof c)return"string"==typeof c?b(c,1e4):c;if(Array.isArray(c))return c.map(b=>a(b,d+1,e));let f={};for(let g in c){if(!Object.prototype.hasOwnProperty.call(c,g))continue;let h=b(g,100);!h||h.startsWith("__proto__")||h.startsWith("constructor")||(f[h]=a(c[g],d+1,e))}return f}(c,0,10);return{valid:!0,data:d}}catch(a){return{valid:!1,data:null,error:"Invalid JSON format"}}}function e(a){return"string"==typeof a&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)&&a.length<=254}function f(a,b=["https:","http:"]){if("string"!=typeof a)return{valid:!1,error:"URL must be a string"};try{let c=new URL(a);if(!b.includes(c.protocol))return{valid:!1,error:`Protocol ${c.protocol} is not allowed`};let d=c.hostname.toLowerCase();if("localhost"===d||"127.0.0.1"===d||d.startsWith("192.168.")||d.startsWith("10.")||d.startsWith("172.16.")||d.startsWith("172.17.")||d.startsWith("172.18.")||d.startsWith("172.19.")||d.startsWith("172.20.")||d.startsWith("172.21.")||d.startsWith("172.22.")||d.startsWith("172.23.")||d.startsWith("172.24.")||d.startsWith("172.25.")||d.startsWith("172.26.")||d.startsWith("172.27.")||d.startsWith("172.28.")||d.startsWith("172.29.")||d.startsWith("172.30.")||d.startsWith("172.31."))return{valid:!1,error:"Local and private IP addresses are not allowed"};return{valid:!0,url:c}}catch(a){return{valid:!1,error:"Invalid URL format"}}}function g(a,b,c){if(b.length>0&&!b.includes(a.type))return{valid:!1,error:`File type ${a.type} is not allowed`};let d="."+a.name.split(".").pop()?.toLowerCase();return c.length>0&&!c.includes(d)?{valid:!1,error:`File extension ${d} is not allowed`}:{valid:!0}}a.s(["sanitizeFileName",()=>c,"sanitizeJson",()=>d,"sanitizeText",()=>b,"validateEmail",()=>e,"validateFileType",()=>g,"validateUrl",()=>f])}];

//# debugId=dfcad99c-b2ae-4bf3-8563-081ed1f9fcbc
//# sourceMappingURL=src_lib_studios_security_d06f8099._.js.map