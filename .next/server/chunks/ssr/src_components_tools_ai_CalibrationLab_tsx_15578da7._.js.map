{
  "version": 3,
  "sources": [],
  "debugId": "f21b2d6b-b46d-869a-a23c-ebbe57172807",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/tools/ai/CalibrationLab.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { Target, UploadCloud } from \"lucide-react\";\nimport Papa from \"papaparse\";\nimport { Line, LineChart, ResponsiveContainer, Tooltip, XAxis, YAxis, CartesianGrid, BarChart, Bar } from \"recharts\";\nimport { AiToolCard } from \"./AiToolCard\";\nimport { validateUpload } from \"@/utils/validateUpload\";\nimport { SecurityBanner } from \"@/components/dev-studios/SecurityBanner\";\n\ntype Row = {\n  [key: string]: string | number | null;\n};\n\ntype ParsedData = {\n  columns: string[];\n  rows: Row[];\n};\n\ntype BinRow = {\n  binCenter: number;\n  avgPred: number;\n  fracPos: number;\n  count: number;\n};\n\ntype HistogramRow = {\n  binCenter: number;\n  count: number;\n};\n\nfunction safeNumber(value: unknown): number | null {\n  if (value === null || value === undefined) return null;\n  if (typeof value === \"number\" && Number.isFinite(value)) return value;\n  const num = Number(String(value).replace(\",\", \".\"));\n  return Number.isFinite(num) ? num : null;\n}\n\nfunction buildBins(labels: (string | number)[], scores: number[], positiveLabel: string, binCount: number) {\n  const bins: { sumPred: number; sumPos: number; count: number; binCenter: number }[] = [];\n  const histBins: { count: number; binCenter: number }[] = [];\n  const step = 1 / binCount;\n\n  for (let i = 0; i < binCount; i += 1) {\n    const center = (i + 0.5) * step;\n    bins.push({ sumPred: 0, sumPos: 0, count: 0, binCenter: center });\n    histBins.push({ count: 0, binCenter: center });\n  }\n\n  for (let i = 0; i < scores.length; i += 1) {\n    const s = scores[i];\n    const label = String(labels[i]).trim();\n    if (!Number.isFinite(s)) continue;\n    const index = Math.min(binCount - 1, Math.max(0, Math.floor(s / step)));\n    const bin = bins[index];\n    bin.sumPred += s;\n    bin.sumPos += label === positiveLabel ? 1 : 0;\n    bin.count += 1;\n\n    histBins[index].count += 1;\n  }\n\n  const outBins: BinRow[] = bins.map((b) => ({\n    binCenter: Number(b.binCenter.toFixed(2)),\n    avgPred: b.count === 0 ? 0 : b.sumPred / b.count,\n    fracPos: b.count === 0 ? 0 : b.sumPos / b.count,\n    count: b.count,\n  }));\n\n  const outHist: HistogramRow[] = histBins.map((h) => ({\n    binCenter: Number(h.binCenter.toFixed(2)),\n    count: h.count,\n  }));\n\n  return { bins: outBins, histogram: outHist };\n}\n\nfunction computeBrier(labels: (string | number)[], scores: number[], positiveLabel: string): number {\n  if (!labels.length || labels.length !== scores.length) return 0;\n  let sum = 0;\n  for (let i = 0; i < labels.length; i += 1) {\n    const y = String(labels[i]).trim() === positiveLabel ? 1 : 0;\n    const p = scores[i];\n    if (!Number.isFinite(p)) continue;\n    const diff = p - y;\n    sum += diff * diff;\n  }\n  return sum / labels.length;\n}\n\nexport function CalibrationLab() {\n  const [parsedData, setParsedData] = useState<ParsedData | null>(null);\n  const [labelColumn, setLabelColumn] = useState<string>(\"\");\n  const [scoreColumn, setScoreColumn] = useState<string>(\"\");\n  const [positiveLabel, setPositiveLabel] = useState<string>(\"\");\n  const [binCount, setBinCount] = useState<number>(10);\n  const [statusMsg, setStatusMsg] = useState<string>(\n    \"Upload a CSV with true labels and model probabilities to explore calibration.\"\n  );\n\n  const handleFileChange = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const { safeFiles, errors } = validateUpload(e.target.files, { maxBytes: 8 * 1024 * 1024, allowedExtensions: [\".csv\"] });\n      if (errors.length) alert(errors.join(\"\\n\"));\n      const file = safeFiles[0];\n      if (!file) return;\n\n      setStatusMsg(\"Parsing CSVâ€¦\");\n      setParsedData(null);\n\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        dynamicTyping: true,\n        complete: (results) => {\n          const rows = results.data as Row[];\n          if (!rows || rows.length === 0) {\n            setStatusMsg(\"The CSV file appears to be empty or malformed.\");\n            return;\n          }\n          const first = rows[0];\n          const columns = Object.keys(first);\n          if (!columns.length) {\n            setStatusMsg(\"Could not detect any columns in the CSV file.\");\n            return;\n          }\n\n          setParsedData({ columns, rows });\n          setStatusMsg(\"File loaded. Now choose the label column, the probability column and the positive label.\");\n\n          if (!labelColumn) setLabelColumn(columns[0]);\n          if (!scoreColumn && columns.length > 1) setScoreColumn(columns[1]);\n        },\n        error: (err) => {\n          setStatusMsg(`Failed to parse CSV: ${err.message}`);\n        },\n      });\n    },\n    [labelColumn, scoreColumn]\n  );\n\n  const currentColumns = parsedData?.columns ?? [];\n\n  const labelValues = useMemo<(string | number)[]>(() => {\n    if (!parsedData || !labelColumn) return [];\n    return parsedData.rows.map((row) => row[labelColumn]).filter((v) => v !== null && v !== undefined) as (string | number)[];\n  }, [parsedData, labelColumn]);\n\n  const scoreValues = useMemo<number[]>(() => {\n    if (!parsedData || !scoreColumn) return [];\n    const out: number[] = [];\n    for (const row of parsedData.rows) {\n      const n = safeNumber(row[scoreColumn]);\n      if (n !== null) out.push(n);\n    }\n    return out;\n  }, [parsedData, scoreColumn]);\n\n  const distinctLabels = useMemo<string[]>(() => {\n    if (!labelValues.length) return [];\n    const set = new Set<string>();\n    for (const v of labelValues) {\n      const s = String(v).trim();\n      if (s.length > 0) set.add(s);\n    }\n    return Array.from(set.values());\n  }, [labelValues]);\n\n  const canCompute =\n    parsedData &&\n    labelColumn &&\n    scoreColumn &&\n    positiveLabel &&\n    labelValues.length === scoreValues.length &&\n    labelValues.length > 0;\n\n  const { bins, histogram } = useMemo(() => {\n    if (!canCompute) return { bins: [] as BinRow[], histogram: [] as HistogramRow[] };\n    return buildBins(labelValues, scoreValues, positiveLabel, binCount);\n  }, [canCompute, labelValues, scoreValues, positiveLabel, binCount]);\n\n  const brierScore = useMemo(() => {\n    if (!canCompute) return null as number | null;\n    return computeBrier(labelValues, scoreValues, positiveLabel);\n  }, [canCompute, labelValues, scoreValues, positiveLabel]);\n\n  function calibrationNarrative(): string {\n    if (!canCompute || !bins.length || brierScore === null) {\n      return \"Once you upload data and choose the positive label this area will explain whether the model tends to be over confident or under confident.\";\n    }\n\n    const overConfidentBins = bins.filter((b) => b.count > 0 && b.avgPred > b.fracPos + 0.05);\n    const underConfidentBins = bins.filter((b) => b.count > 0 && b.avgPred < b.fracPos - 0.05);\n\n    if (overConfidentBins.length && !underConfidentBins.length) {\n      return `Across many bins the average predicted probability is higher than the observed fraction of positives. This means the model tends to be over confident. The Brier score of ${brierScore.toFixed(\n        3\n      )} summarises this mismatch across all rows.`;\n    }\n    if (underConfidentBins.length && !overConfidentBins.length) {\n      return `Across many bins the average predicted probability is lower than the observed fraction of positives. This means the model tends to be under confident. The Brier score of ${brierScore.toFixed(\n        3\n      )} summarises how gently or sharply the predictions deviate from reality.`;\n    }\n\n    return `Some regions look over confident and some under confident, which is common in real systems. The Brier score of ${brierScore.toFixed(\n      3\n    )} gives a single measure of how well the probabilities line up with the outcomes. Use this together with the reliability diagram to decide where recalibration or threshold adjustments might help.`;\n  }\n\n  const formattedBins = bins.map((b) => ({\n    ...b,\n    avgPredDisplay: Number(b.avgPred.toFixed(3)),\n    fracPosDisplay: Number(b.fracPos.toFixed(3)),\n  }));\n\n  return (\n    <AiToolCard\n      id=\"calibration-lab-title\"\n      title=\"Calibration and reliability lab\"\n      icon={<Target className=\"h-4 w-4\" aria-hidden=\"true\" />}\n      description=\"Upload model probabilities and true labels to see whether the numbers your model outputs match reality.\"\n    >\n      <SecurityBanner />\n\n      <div className=\"grid gap-6 xl:grid-cols-3\">\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 1 - Upload model probabilities</p>\n          <p className=\"text-sm text-slate-600\">\n            Use a CSV where each row is a prediction. Include a true label column and a probability column between 0 and 1. Only\n            your browser sees this data.\n          </p>\n\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"calibration-upload\" className=\"block text-sm font-medium text-slate-700\">\n                CSV file\n              </label>\n              <div className=\"flex items-center gap-3\">\n                <label\n                  htmlFor=\"calibration-upload\"\n                  className=\"inline-flex cursor-pointer items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm hover:border-sky-300 hover:text-sky-700\"\n                >\n                  <UploadCloud className=\"h-4 w-4\" aria-hidden=\"true\" />\n                  <span>Choose file</span>\n                </label>\n                <input id=\"calibration-upload\" type=\"file\" accept=\".csv,text/csv\" className=\"hidden\" onChange={handleFileChange} />\n              <span className=\"text-sm text-slate-500\">CSV only, max 8MB. Processed locally.</span>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"calib-label-column\" className=\"block text-sm font-medium text-slate-700\">\n                Label column\n              </label>\n              <select\n                id=\"calib-label-column\"\n                value={labelColumn}\n                onChange={(e) => setLabelColumn(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select label column</option>\n                {currentColumns.map((col) => (\n                  <option key={col} value={col}>\n                    {col}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"calib-score-column\" className=\"block text-sm font-medium text-slate-700\">\n                Probability column\n              </label>\n              <select\n                id=\"calib-score-column\"\n                value={scoreColumn}\n                onChange={(e) => setScoreColumn(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select probability column</option>\n                {currentColumns.map((col) => (\n                  <option key={col} value={col}>\n                    {col}\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-sm text-slate-500\">These are the model&apos;s predicted probabilities that a case is positive. Values should be between 0 and 1.</p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"calib-positive-label\" className=\"block text-sm font-medium text-slate-700\">\n                Positive label\n              </label>\n              <select\n                id=\"calib-positive-label\"\n                value={positiveLabel}\n                onChange={(e) => setPositiveLabel(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select positive label</option>\n                {distinctLabels.map((lab) => (\n                  <option key={lab} value={lab}>\n                    {lab}\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-sm text-slate-500\">This is the outcome you are treating as positive. For example, fraud, unsafe, complaint or churn.</p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"calib-bin-count\" className=\"block text-sm font-medium text-slate-700\">\n                Number of bins\n              </label>\n              <select\n                id=\"calib-bin-count\"\n                value={binCount}\n                onChange={(e) => setBinCount(Number(e.target.value))}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value={5}>5 bins</option>\n                <option value={10}>10 bins</option>\n                <option value={20}>20 bins</option>\n              </select>\n              <p className=\"text-sm text-slate-500\">More bins show more detail but need more data. Fewer bins are smoother.</p>\n            </div>\n          </div>\n\n          <p className=\"text-sm text-slate-500\">{statusMsg}</p>\n        </div>\n\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 2 - Reliability diagram</p>\n          <p className=\"text-sm text-slate-600\">\n            The reliability diagram compares what the model says to what actually happens. If the model is perfectly calibrated, the\n            points will sit close to the diagonal line.\n          </p>\n\n          <div className=\"h-48 rounded-2xl border border-slate-200 bg-white px-3 py-2\">\n            {canCompute && formattedBins.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <LineChart data={formattedBins}>\n                  <CartesianGrid stroke=\"#e5e7eb\" strokeDasharray=\"3 3\" />\n                  <XAxis\n                    dataKey=\"avgPredDisplay\"\n                    tick={{ fontSize: 9 }}\n                    label={{ value: \"Average predicted probability\", position: \"insideBottom\", offset: -4, fontSize: 10 }}\n                    type=\"number\"\n                    domain={[0, 1]}\n                  />\n                  <YAxis\n                    dataKey=\"fracPosDisplay\"\n                    tick={{ fontSize: 9 }}\n                    label={{ value: \"Observed fraction positive\", angle: -90, position: \"insideLeft\", fontSize: 10 }}\n                    type=\"number\"\n                    domain={[0, 1]}\n                  />\n                  <Tooltip\n                    contentStyle={{ fontSize: 10, borderRadius: 12, padding: 8 }}\n                    formatter={(value: any, name: string) => {\n                      if (name === \"avgPredDisplay\") return [value, \"Average predicted\"];\n                      if (name === \"fracPosDisplay\") return [value, \"Observed fraction positive\"];\n                      if (name === \"count\") return [value, \"Count\"];\n                      return [value, name];\n                    }}\n                  />\n                  <Line type=\"linear\" dataKey=\"avgPredDisplay\" stroke=\"#cbd5f5\" strokeWidth={1} dot={false} isAnimationActive={false} />\n                  <Line type=\"linear\" dataKey=\"fracPosDisplay\" stroke=\"#0f766e\" strokeWidth={2} dot={{ r: 3 }} name=\"Calibration\" />\n                </LineChart>\n              </ResponsiveContainer>\n            ) : (\n              <p className=\"text-sm text-slate-500\">Once you upload data and choose the positive label the reliability diagram will appear here.</p>\n            )}\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700\">\n            <p className=\"mb-1 text-sm font-semibold text-slate-900\">Bin summary</p>\n            {canCompute && bins.length > 0 ? (\n              <div className=\"max-h-32 overflow-auto pr-1\">\n                <table className=\"w-full border-collapse text-sm\">\n                  <thead>\n                    <tr className=\"text-slate-500\">\n                      <th className=\"pb-1 pr-2 text-left font-medium\">Bin center</th>\n                      <th className=\"pb-1 pr-2 text-left font-medium\">Avg predicted</th>\n                      <th className=\"pb-1 pr-2 text-left font-medium\">Observed positive</th>\n                      <th className=\"pb-1 text-left font-medium\">Count</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {formattedBins.map((b) => (\n                      <tr key={b.binCenter}>\n                        <td className=\"py-0.5 pr-2 text-slate-700\">{b.binCenter.toFixed(2)}</td>\n                        <td className=\"py-0.5 pr-2 text-slate-700\">{b.avgPredDisplay.toFixed(3)}</td>\n                        <td className=\"py-0.5 pr-2 text-slate-700\">{b.fracPosDisplay.toFixed(3)}</td>\n                        <td className=\"py-0.5 text-slate-700\">{b.count}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <p className=\"text-sm text-slate-500\">\n                Each row will show a bin such as all cases with predicted probability between 0.4 and 0.5, the average prediction in\n                that bin and the fraction of positives that actually occurred.\n              </p>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 3 - Score distribution and interpretation</p>\n          <p className=\"text-sm text-slate-600\">\n            The histogram shows how many examples fall into each probability region. This helps you see whether the model uses the\n            full range from 0 to 1 or clusters around certain values.\n          </p>\n\n          <div className=\"h-40 rounded-2xl border border-slate-200 bg-white px-3 py-2\">\n            {canCompute && histogram.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <BarChart data={histogram}>\n                  <XAxis\n                    dataKey=\"binCenter\"\n                    tick={{ fontSize: 9 }}\n                    label={{ value: \"Score bins\", position: \"insideBottom\", offset: -4, fontSize: 10 }}\n                  />\n                  <YAxis tick={{ fontSize: 9 }} />\n                  <Tooltip contentStyle={{ fontSize: 10, borderRadius: 12, padding: 8 }} />\n                  <Bar dataKey=\"count\" fill=\"#6366f1\" radius={[8, 8, 0, 0]} name=\"Count\" />\n                </BarChart>\n              </ResponsiveContainer>\n            ) : (\n              <p className=\"text-sm text-slate-500\">Once data is loaded this chart will show how many predictions land in each probability bin.</p>\n            )}\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700 space-y-1\">\n            <p className=\"font-semibold text-slate-900\">How well calibrated is the model</p>\n            <p>{calibrationNarrative()}</p>\n            {brierScore !== null && canCompute && (\n              <p className=\"mt-1\">\n                Brier score: <span className=\"font-semibold text-slate-900\">{brierScore.toFixed(3)}</span>. Lower is better. A score close to\n                zero means the probabilities usually match reality. Higher scores mean the model regularly assigns very confident probabilities\n                to outcomes that do not happen.\n              </p>\n            )}\n            <p className=\"text-slate-500\">\n              Calibration is separate from discrimination. A model can rank cases well but still be badly calibrated. This lab focuses only on\n              whether the probabilities you see are trustworthy.\n            </p>\n          </div>\n        </div>\n      </div>\n    </AiToolCard>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}