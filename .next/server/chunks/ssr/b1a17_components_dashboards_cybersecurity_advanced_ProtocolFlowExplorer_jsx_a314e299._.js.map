{
  "version": 3,
  "sources": [],
  "debugId": "b16120d5-9686-aec3-8c3e-4c51bf751555",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/dashboards/cybersecurity/advanced/ProtocolFlowExplorer.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nconst STEPS = [\n  {\n    id: 1,\n    title: \"Redirect to authorisation server\",\n    detail: \"Client sends user to the authorisation server with client_id and redirect_uri.\",\n    mistakes: [\"Leaking client secrets in the URL\", \"Using insecure redirect URIs\"],\n  },\n  {\n    id: 2,\n    title: \"User grants consent\",\n    detail: \"User authenticates and approves requested scopes.\",\n    mistakes: [\"Over-broad scopes\", \"Click-jacking the consent page\"],\n  },\n  {\n    id: 3,\n    title: \"Auth code returned\",\n    detail: \"Authorisation code is sent to the client on the redirect_uri.\",\n    mistakes: [\"Putting code in fragments where scripts can read it\", \"Logging codes in plaintext\"],\n  },\n  {\n    id: 4,\n    title: \"Client swaps code for token\",\n    detail: \"Client posts code plus client secret to get an access token.\",\n    mistakes: [\"Sending secrets over http\", \"Storing tokens in localStorage without rotation\"],\n  },\n  {\n    id: 5,\n    title: \"Client calls resource server\",\n    detail: \"Client calls API with the bearer token in the Authorization header.\",\n    mistakes: [\"Leaking tokens in URLs\", \"Not validating audience or expiry\"],\n  },\n];\n\nexport default function ProtocolFlowExplorer() {\n  const [step, setStep] = useState(0);\n\n  const current = STEPS[step];\n\n  return (\n    <div className=\"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200\">\n      <div className=\"flex items-center justify-between text-sm text-slate-700\">\n        <span>\n          Step {step + 1} / {STEPS.length}\n        </span>\n      </div>\n\n      <div className=\"mt-3 grid gap-3 md:grid-cols-2\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm\">\n          <h4 className=\"text-base font-semibold text-slate-900\">{current.title}</h4>\n          <p className=\"mt-1 text-sm text-slate-800\">{current.detail}</p>\n          <div className=\"mt-3 text-sm text-slate-900\">\n            Parties:\n            <ul className=\"mt-1 list-disc space-y-1 pl-5 text-slate-800\">\n              <li>Client</li>\n              <li>Authorisation server</li>\n              <li>Resource server</li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-white p-4 shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Common mistakes</h5>\n          <ul className=\"mt-2 list-disc space-y-1 pl-5 text-sm text-slate-800\">\n            {current.mistakes.map((m) => (\n              <li key={m}>{m}</li>\n            ))}\n          </ul>\n        </div>\n      </div>\n\n      <div className=\"mt-3 flex gap-2\">\n        <button\n          onClick={() => setStep((s) => Math.max(0, s - 1))}\n          className=\"rounded-full border border-slate-300 px-4 py-2 text-sm font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300 disabled:opacity-50\"\n          disabled={step === 0}\n        >\n          Previous\n        </button>\n        <button\n          onClick={() => setStep((s) => Math.min(STEPS.length - 1, s + 1))}\n          className=\"rounded-full border border-slate-300 px-4 py-2 text-sm font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300 disabled:opacity-50\"\n          disabled={step === STEPS.length - 1}\n        >\n          Next\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAQ,CACZ,CACE,GAAI,EACJ,MAAO,mCACP,OAAQ,iFACR,SAAU,CAAC,oCAAqC,+BAA+B,AACjF,EACA,CACE,GAAI,EACJ,MAAO,sBACP,OAAQ,oDACR,SAAU,CAAC,oBAAqB,iCAAiC,AACnE,EACA,CACE,GAAI,EACJ,MAAO,qBACP,OAAQ,gEACR,SAAU,CAAC,sDAAuD,6BAA6B,AACjG,EACA,CACE,GAAI,EACJ,MAAO,8BACP,OAAQ,+DACR,SAAU,CAAC,4BAA6B,kDAAkD,AAC5F,EACA,CACE,GAAI,EACJ,MAAO,+BACP,OAAQ,sEACR,SAAU,CAAC,yBAA0B,oCAAoC,AAC3E,EACD,CAEc,SAAS,IACtB,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAE3B,EAAU,CAAK,CAAC,EAAK,CAE3B,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,QACE,EAAO,EAAE,MAAI,EAAM,MAAM,MAInC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kDAA0C,EAAQ,KAAK,GACrE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uCAA+B,EAAQ,MAAM,GAC1D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAA8B,WAE3C,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,yDACZ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,WACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,yBACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,6BAIV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gDAAuC,oBACrD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gEACX,EAAQ,QAAQ,CAAC,GAAG,CAAC,AAAC,GACrB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAY,GAAJ,YAMjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAG,EAAI,IAC9C,UAAU,0LACV,SAAmB,IAAT,WACX,aAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAM,MAAM,CAAG,EAAG,EAAI,IAC7D,UAAU,0LACV,SAAU,IAAS,EAAM,MAAM,CAAG,WACnC,cAMT"}}]
}