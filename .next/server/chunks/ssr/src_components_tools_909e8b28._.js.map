{
  "version": 3,
  "sources": [],
  "debugId": "4823c5f9-9a36-b3c3-b8be-236a57deb944",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/tools/ToolOutputNotes.tsx","../../../../src/components/tools/cyber/CyberToolCard.tsx","../../../../src/components/tools/cyber/SecurityHeaderTool.tsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\n\ntype NotesProps = {\n  whatThisTellsYou?: string[];\n  interpretationTips?: string[];\n  limitations?: string[];\n};\n\nfunction Section({ title, items }: { title: string; items?: string[] }) {\n  if (!items || items.length === 0) return null;\n  return (\n    <div className=\"rounded-2xl border border-slate-100 bg-slate-50/60 p-4\">\n      <p className=\"text-xs font-semibold text-slate-800\">{title}</p>\n      <ul className=\"mt-2 space-y-1 text-sm text-slate-700\">\n        {items.map((x, idx) => (\n          <li key={`${title}-${idx}`}>â€¢ {x}</li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport function ToolOutputNotes({\n  whatThisTellsYou,\n  interpretationTips,\n  limitations,\n}: NotesProps) {\n  const hasAny =\n    (whatThisTellsYou && whatThisTellsYou.length > 0) ||\n    (interpretationTips && interpretationTips.length > 0) ||\n    (limitations && limitations.length > 0);\n\n  if (!hasAny) return null;\n\n  return (\n    <div className=\"grid gap-4 md:grid-cols-3\">\n      <Section title=\"What this tells you\" items={whatThisTellsYou} />\n      <Section title=\"Interpretation tips\" items={interpretationTips} />\n      <Section title=\"Limitations\" items={limitations} />\n    </div>\n  );\n}\n\n\n","\"use client\";\n\nimport React from \"react\";\nimport { ToolOutputNotes } from \"@/components/tools/ToolOutputNotes\";\n\ninterface CyberToolCardProps {\n  id: string;\n  title: string;\n  icon: React.ReactNode;\n  description: string;\n  whatThisTellsYou?: string[];\n  interpretationTips?: string[];\n  limitations?: string[];\n  children: React.ReactNode;\n}\n\nexport function CyberToolCard({\n  id,\n  title,\n  icon,\n  description,\n  whatThisTellsYou,\n  interpretationTips,\n  limitations,\n  children,\n}: CyberToolCardProps) {\n  return (\n    <section\n      aria-labelledby={id}\n      className=\"rounded-3xl bg-white shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 p-6 sm:p-8 space-y-6 transition-transform duration-200 ease-out hover:-translate-y-0.5 hover:shadow-[0_22px_55px_rgba(15,23,42,0.10)]\"\n    >\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n        <div className=\"flex items-center gap-3\">\n          <span className=\"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-50 text-slate-700 ring-1 ring-slate-100\">\n            {icon}\n          </span>\n          <div className=\"space-y-1\">\n            <h2 id={id} className=\"text-lg sm:text-xl font-semibold text-slate-900\">\n              {title}\n            </h2>\n            <p className=\"text-xs sm:text-sm text-slate-600 max-w-xl\">{description}</p>\n          </div>\n        </div>\n      </header>\n\n      {children}\n\n      <ToolOutputNotes\n        whatThisTellsYou={\n          whatThisTellsYou ?? [\"A quick, client-side interpretation of what you pasted or selected.\"]\n        }\n        interpretationTips={\n          interpretationTips ?? [\"Use this as a starting point, then confirm against your own standards and threat model.\"]\n        }\n        limitations={\n          limitations ?? [\"This is educational. It does not fetch live data or confirm server-side behaviour.\"]\n        }\n      />\n    </section>\n  );\n}\n","\"use client\";\n\nimport React, { useMemo, useState } from \"react\";\nimport { Shield } from \"lucide-react\";\nimport { CyberToolCard } from \"./CyberToolCard\";\n\ntype HeaderInfo = {\n  name: string;\n  value: string;\n};\n\nfunction parseHeaders(raw: string): HeaderInfo[] {\n  return raw\n    .split(/\\r?\\n/)\n    .map((line) => line.trim())\n    .filter(Boolean)\n    .map((line) => {\n      const [name, ...rest] = line.split(\":\");\n      return {\n        name: name?.trim() || \"\",\n        value: rest.join(\":\").trim(),\n      };\n    })\n    .filter((h) => h.name !== \"\");\n}\n\nfunction describeHeader(header: HeaderInfo): string {\n  const name = header.name.toLowerCase();\n  const value = header.value;\n\n  if (name === \"content-security-policy\") {\n    if (!value) {\n      return \"Content Security Policy is present but empty. This offers no protection.\";\n    }\n    if (value.includes(\"unsafe-inline\") || value.includes(\"unsafe-eval\")) {\n      return \"CSP allows unsafe-inline or unsafe-eval. This makes script injection easier. Consider replacing them with explicit script hashes or nonces.\";\n    }\n    if (value.includes(\"*\")) {\n      return \"CSP uses wildcard sources. This can undermine isolation. Try to list specific domains instead.\";\n    }\n    return \"CSP is present. Review the allowed sources to ensure they are as tight as your application can tolerate.\";\n  }\n\n  if (name === \"strict-transport-security\" || name === \"strict-transport-security-policy\") {\n    if (!value.toLowerCase().includes(\"max-age\")) {\n      return \"HSTS is present but max-age is missing or unclear. Set an explicit max-age to enforce HTTPS over time.\";\n    }\n    return \"HSTS is present. This helps force browsers to use HTTPS after the first visit.\";\n  }\n\n  if (name === \"x-frame-options\") {\n    if (value.toLowerCase().includes(\"deny\") || value.toLowerCase().includes(\"sameorigin\")) {\n      return \"X-Frame-Options is set, which helps protect against clickjacking.\";\n    }\n    return \"X-Frame-Options is present but not set to DENY or SAMEORIGIN. Review if your site should be framed at all.\";\n  }\n\n  if (name === \"x-content-type-options\") {\n    if (value.toLowerCase().includes(\"nosniff\")) {\n      return \"X-Content-Type-Options is set to nosniff. This reduces certain content type confusion attacks.\";\n    }\n    return \"X-Content-Type-Options is present but not set to nosniff. Consider using nosniff for most sites.\";\n  }\n\n  if (name === \"referrer-policy\") {\n    return \"Referrer-Policy controls how much URL information your site sends to other sites. Stricter policies can reduce leakage of sensitive paths.\";\n  }\n\n  return \"This header may provide security or privacy benefits. Check your security baseline to see if the value matches your standard.\";\n}\n\nexport function SecurityHeaderTool() {\n  const [rawHeaders, setRawHeaders] = useState(\n    \"Content-Security-Policy: default-src 'self'; script-src 'self'\\nStrict-Transport-Security: max-age=31536000; includeSubDomains\\nX-Frame-Options: SAMEORIGIN\\nX-Content-Type-Options: nosniff\"\n  );\n\n  const parsed = useMemo(() => parseHeaders(rawHeaders), [rawHeaders]);\n\n  const interesting = parsed.filter((h) =>\n    [\"content-security-policy\", \"strict-transport-security\", \"x-frame-options\", \"x-content-type-options\", \"referrer-policy\"].includes(\n      h.name.toLowerCase()\n    )\n  );\n\n  const others = parsed.filter(\n    (h) => !interesting.some((i) => i.name.toLowerCase() === h.name.toLowerCase())\n  );\n\n  return (\n    <CyberToolCard\n      id=\"security-header-title\"\n      title=\"Security header and CSP explainer\"\n      icon={<Shield className=\"h-4 w-4\" aria-hidden=\"true\" />}\n      description=\"Paste HTTP response headers and see how Content Security Policy, HSTS and other headers contribute to your defence layers.\"\n      whatThisTellsYou={[\n        \"Whether the header set looks aligned with a modern baseline (CSP, HSTS, clickjacking protection, nosniff, referrer policy).\",\n        \"Where values are empty or unusually permissive and worth a second look.\",\n      ]}\n      interpretationTips={[\n        \"Treat CSP as an allowlist. If you need a broad exception, isolate it to a narrow route or use nonces or hashes.\",\n        \"HSTS only helps after the first HTTPS visit unless you preload. Do not preload until you are confident.\",\n      ]}\n      limitations={[\n        \"This tool only parses the text you paste. It does not verify what your server actually sends on every route.\",\n        \"Some headers are best enforced via CSP (frame-ancestors) rather than legacy headers. Your standard should be consistent.\",\n      ]}\n    >\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-3 rounded-2xl border border-slate-100 bg-slate-50/60 p-4\">\n          <label htmlFor=\"header-input\" className=\"block text-xs font-semibold text-slate-700\">\n            Paste HTTP response headers\n          </label>\n          <textarea\n            id=\"header-input\"\n            value={rawHeaders}\n            onChange={(e) => setRawHeaders(e.target.value)}\n            className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-2 text-xs sm:text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200 min-h-[120px] resize-vertical\"\n            placeholder=\"Paste raw response headers from your browser developer tools.\"\n          />\n          <p className=\"text-xs text-slate-500\">\n            You can copy headers from the network tab of your browser developer tools. This tool does not contact your\n            site, it just parses the text you paste.\n          </p>\n        </div>\n\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4\">\n          <p className=\"text-xs font-semibold text-slate-700\">Security related headers</p>\n          <div className=\"space-y-2 max-h-56 overflow-y-auto pr-1\">\n            {interesting.length === 0 && (\n              <p className=\"text-xs text-slate-500\">\n                No recognised security headers detected yet. Add CSP, HSTS, X-Frame-Options, X-Content-Type-Options or\n                Referrer-Policy and recheck.\n              </p>\n            )}\n            {interesting.map((h) => (\n              <div key={h.name} className=\"rounded-2xl border border-slate-200 bg-white p-3 text-xs text-slate-700 space-y-1\">\n                <p className=\"font-semibold text-slate-900\">{h.name}</p>\n                <p className=\"text-sm text-slate-500 break-all\">{h.value}</p>\n                <p className=\"text-sm text-slate-700\">{describeHeader(h)}</p>\n              </div>\n            ))}\n          </div>\n          {others.length > 0 && (\n            <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-600 space-y-1\">\n              <p className=\"font-semibold text-slate-900\">Other headers detected</p>\n              <p>These may also play a role in security or privacy, but they are not analysed in detail here.</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </CyberToolCard>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}