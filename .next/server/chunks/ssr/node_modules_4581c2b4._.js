;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="d83f4953-5cf9-890d-b1cd-c5922402ca53")}catch(e){}}();
module.exports=[379996,112882,a=>{"use strict";a.s(["default",0,function(a){return function(){return a}}],379996);let b=Math.PI,c=2*b,d=c-1e-6;function e(a){this._+=a[0];for(let b=1,c=a.length;b<c;++b)this._+=arguments[b]+a[b]}class f{constructor(a){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==a?e:function(a){let b=Math.floor(a);if(!(b>=0))throw Error(`invalid digits: ${a}`);if(b>15)return e;let c=10**b;return function(a){this._+=a[0];for(let b=1,d=a.length;b<d;++b)this._+=Math.round(arguments[b]*c)/c+a[b]}}(a)}moveTo(a,b){this._append`M${this._x0=this._x1=+a},${this._y0=this._y1=+b}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(a,b){this._append`L${this._x1=+a},${this._y1=+b}`}quadraticCurveTo(a,b,c,d){this._append`Q${+a},${+b},${this._x1=+c},${this._y1=+d}`}bezierCurveTo(a,b,c,d,e,f){this._append`C${+a},${+b},${+c},${+d},${this._x1=+e},${this._y1=+f}`}arcTo(a,c,d,e,f){if(a*=1,c*=1,d*=1,e*=1,(f*=1)<0)throw Error(`negative radius: ${f}`);let g=this._x1,h=this._y1,i=d-a,j=e-c,k=g-a,l=h-c,m=k*k+l*l;if(null===this._x1)this._append`M${this._x1=a},${this._y1=c}`;else if(m>1e-6)if(Math.abs(l*i-j*k)>1e-6&&f){let n=d-g,o=e-h,p=i*i+j*j,q=Math.sqrt(p),r=Math.sqrt(m),s=f*Math.tan((b-Math.acos((p+m-(n*n+o*o))/(2*q*r)))/2),t=s/r,u=s/q;Math.abs(t-1)>1e-6&&this._append`L${a+t*k},${c+t*l}`,this._append`A${f},${f},0,0,${+(l*n>k*o)},${this._x1=a+u*i},${this._y1=c+u*j}`}else this._append`L${this._x1=a},${this._y1=c}`}arc(a,e,f,g,h,i){if(a*=1,e*=1,f*=1,i=!!i,f<0)throw Error(`negative radius: ${f}`);let j=f*Math.cos(g),k=f*Math.sin(g),l=a+j,m=e+k,n=1^i,o=i?g-h:h-g;null===this._x1?this._append`M${l},${m}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-m)>1e-6)&&this._append`L${l},${m}`,f&&(o<0&&(o=o%c+c),o>d?this._append`A${f},${f},0,1,${n},${a-j},${e-k}A${f},${f},0,1,${n},${this._x1=l},${this._y1=m}`:o>1e-6&&this._append`A${f},${f},0,${+(o>=b)},${n},${this._x1=a+f*Math.cos(h)},${this._y1=e+f*Math.sin(h)}`)}rect(a,b,c,d){this._append`M${this._x0=this._x1=+a},${this._y0=this._y1=+b}h${c*=1}v${+d}h${-c}Z`}toString(){return this._}}function g(a){let b=3;return a.digits=function(c){if(!arguments.length)return b;if(null==c)b=null;else{let a=Math.floor(c);if(!(a>=0))throw RangeError(`invalid digits: ${c}`);b=a}return a},()=>new f(b)}f.prototype,a.s(["withPath",()=>g],112882)},884885,a=>{"use strict";Array.prototype.slice,a.s(["default",0,function(a){return"object"==typeof a&&"length"in a?a:Array.from(a)}])},398153,a=>{"use strict";var b=a.i(884885),c=a.i(379996),d=a.i(632794),e=a.i(112882);function f(a){return a[0]}function g(a){return a[1]}a.s(["line",0,function(a,h){var i=(0,c.default)(!0),j=null,k=d.default,l=null,m=(0,e.withPath)(n);function n(c){var d,e,f,g=(c=(0,b.default)(c)).length,n=!1;for(null==j&&(l=k(f=m())),d=0;d<=g;++d)!(d<g&&i(e=c[d],d,c))===n&&((n=!n)?l.lineStart():l.lineEnd()),n&&l.point(+a(e,d,c),+h(e,d,c));if(f)return l=null,f+""||null}return a="function"==typeof a?a:void 0===a?f:(0,c.default)(a),h="function"==typeof h?h:void 0===h?g:(0,c.default)(h),n.x=function(b){return arguments.length?(a="function"==typeof b?b:(0,c.default)(+b),n):a},n.y=function(a){return arguments.length?(h="function"==typeof a?a:(0,c.default)(+a),n):h},n.defined=function(a){return arguments.length?(i="function"==typeof a?a:(0,c.default)(!!a),n):i},n.curve=function(a){return arguments.length?(k=a,null!=j&&(l=k(j)),n):k},n.context=function(a){return arguments.length?(null==a?j=l=null:l=k(j=a),n):j},n}],398153)},574782,a=>{"use strict";let b;var c=a.i(123829);a.i(975930);var d=a.i(398153),e=a.i(737645),f=a.i(671731);a.i(858762);var g=a.i(783287);a.i(797774);var h=a.i(661256),i=a.i(407860);a.i(554757),a.i(951772),a.i(670773),a.i(737132);let j={},k=(a,b,c)=>{let d,e=(0,i.c)().state.padding,f=2*(0,i.c)().state.padding,g=a.node().getBBox(),h=g.width,j=g.x,k=a.append("text").attr("x",0).attr("y",(0,i.c)().state.titleShift).attr("font-size",(0,i.c)().state.fontSize).attr("class","state-title").text(b.id),l=k.node().getBBox().width+f,m=Math.max(l,h);m===h&&(m+=f);let n=a.node().getBBox();b.doc,d=j-e,l>h&&(d=(h-m)/2+e),Math.abs(j-n.x)<e&&l>h&&(d=j-(l-h)/2);let o=1-(0,i.c)().state.textHeight;return a.insert("rect",":first-child").attr("x",d).attr("y",o).attr("class",c?"alt-composit":"composit").attr("width",m).attr("height",n.height+(0,i.c)().state.textHeight+(0,i.c)().state.titleShift+1).attr("rx","0"),k.attr("x",d+e),l<=h&&k.attr("x",j+(m-f)/2-l/2+e),a.insert("rect",":first-child").attr("x",d).attr("y",(0,i.c)().state.titleShift-(0,i.c)().state.textHeight-(0,i.c)().state.padding).attr("width",m).attr("height",3*(0,i.c)().state.textHeight).attr("rx",(0,i.c)().state.radius),a.insert("rect",":first-child").attr("x",d).attr("y",(0,i.c)().state.titleShift-(0,i.c)().state.textHeight-(0,i.c)().state.padding).attr("width",m).attr("height",n.height+3+2*(0,i.c)().state.textHeight).attr("rx",(0,i.c)().state.radius),a},l=function(a,b){var c,d;let e,f,g,h,k,l,m,n,o,p,q=b.id,r={id:q,label:b.id,width:0,height:0},s=a.append("g").attr("id",q).attr("class","stateGroup");"start"===b.type&&s.append("circle").attr("class","start-state").attr("r",(0,i.c)().state.sizeUnit).attr("cx",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit).attr("cy",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit),"end"===b.type&&(s.append("circle").attr("class","end-state-outer").attr("r",(0,i.c)().state.sizeUnit+(0,i.c)().state.miniPadding).attr("cx",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit+(0,i.c)().state.miniPadding).attr("cy",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit+(0,i.c)().state.miniPadding),s.append("circle").attr("class","end-state-inner").attr("r",(0,i.c)().state.sizeUnit).attr("cx",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit+2).attr("cy",(0,i.c)().state.padding+(0,i.c)().state.sizeUnit+2)),("fork"===b.type||"join"===b.type)&&((a,b)=>{let c=(0,i.c)().state.forkWidth,d=(0,i.c)().state.forkHeight;if(b.parentId){let a=c;c=d,d=a}return a.append("rect").style("stroke","black").style("fill","black").attr("width",c).attr("height",d).attr("x",(0,i.c)().state.padding).attr("y",(0,i.c)().state.padding)})(s,b),"note"===b.type&&((a,b)=>{b.attr("class","state-note");let c=b.append("rect").attr("x",0).attr("y",(0,i.c)().state.padding),{textWidth:d,textHeight:e}=((a,b,c,d)=>{let e=0,f=d.append("text");f.style("text-anchor","start"),f.attr("class","noteText");let g=a.replace(/\r\n/g,"<br/>"),h=(g=g.replace(/\n/g,"<br/>")).split(i.e.lineBreakRegex),j=1.25*(0,i.c)().state.noteMargin;for(let a of h){let d=a.trim();if(d.length>0){let a=f.append("tspan");a.text(d),0===j&&(j+=a.node().getBBox().height),e+=j,a.attr("x",b+(0,i.c)().state.noteMargin),a.attr("y",c+e+1.25*(0,i.c)().state.noteMargin)}}return{textWidth:f.node().getBBox().width,textHeight:e}})(a,0,0,b.append("g"));return c.attr("height",e+2*(0,i.c)().state.noteMargin),c.attr("width",d+2*(0,i.c)().state.noteMargin)})(b.note.text,s),"divider"===b.type&&s.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",(0,i.c)().state.textHeight).attr("class","divider").attr("x2",2*(0,i.c)().state.textHeight).attr("y1",0).attr("y2",0),"default"===b.type&&0===b.descriptions.length&&(e=s.append("text").attr("x",2*(0,i.c)().state.padding).attr("y",(0,i.c)().state.textHeight+2*(0,i.c)().state.padding).attr("font-size",(0,i.c)().state.fontSize).attr("class","state-title").text(b.id).node().getBBox(),s.insert("rect",":first-child").attr("x",(0,i.c)().state.padding).attr("y",(0,i.c)().state.padding).attr("width",e.width+2*(0,i.c)().state.padding).attr("height",e.height+2*(0,i.c)().state.padding).attr("rx",(0,i.c)().state.radius)),"default"===b.type&&b.descriptions.length>0&&(f=function(a,b,c){let d=a.append("tspan").attr("x",2*(0,i.c)().state.padding).text(b);c||d.attr("dy",(0,i.c)().state.textHeight)},h=(g=s.append("text").attr("x",2*(0,i.c)().state.padding).attr("y",(0,i.c)().state.textHeight+1.3*(0,i.c)().state.padding).attr("font-size",(0,i.c)().state.fontSize).attr("class","state-title").text(b.descriptions[0]).node().getBBox()).height,k=s.append("text").attr("x",(0,i.c)().state.padding).attr("y",h+.4*(0,i.c)().state.padding+(0,i.c)().state.dividerMargin+(0,i.c)().state.textHeight).attr("class","state-description"),l=!0,m=!0,b.descriptions.forEach(function(a){l||(f(k,a,m),m=!1),l=!1}),n=s.append("line").attr("x1",(0,i.c)().state.padding).attr("y1",(0,i.c)().state.padding+h+(0,i.c)().state.dividerMargin/2).attr("y2",(0,i.c)().state.padding+h+(0,i.c)().state.dividerMargin/2).attr("class","descr-divider"),p=Math.max((o=k.node().getBBox()).width,g.width),n.attr("x2",p+3*(0,i.c)().state.padding),s.insert("rect",":first-child").attr("x",(0,i.c)().state.padding).attr("y",(0,i.c)().state.padding).attr("width",p+2*(0,i.c)().state.padding).attr("height",o.height+h+2*(0,i.c)().state.padding).attr("rx",(0,i.c)().state.radius));let t=s.node().getBBox();return r.width=t.width+2*(0,i.c)().state.padding,r.height=t.height+2*(0,i.c)().state.padding,c=q,d=r,j[c]=d,r},m=0,n=function(a,b,f){b.points=b.points.filter(a=>!Number.isNaN(a.y));let g=b.points,h=(0,d.line)().x(function(a){return a.x}).y(function(a){return a.y}).curve(e.curveBasis),j=a.append("path").attr("d",h(g)).attr("id","edge"+m).attr("class","transition"),k="";if((0,i.c)().state.arrowMarkerAbsolute&&(k=(k=(k=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")),j.attr("marker-end","url("+k+"#"+function(a){switch(a){case c.d.relationType.AGGREGATION:return"aggregation";case c.d.relationType.EXTENSION:return"extension";case c.d.relationType.COMPOSITION:return"composition";case c.d.relationType.DEPENDENCY:return"dependency"}}(c.d.relationType.DEPENDENCY)+"End)"),void 0!==f.title){let c=a.append("g").attr("class","stateLabel"),{x:d,y:e}=i.u.calcLabelPosition(b.points),g=i.e.getRows(f.title),h=0,j=[],k=0,l=0;for(let a=0;a<=g.length;a++){let b=c.append("text").attr("text-anchor","middle").text(g[a]).attr("x",d).attr("y",e+h),f=b.node().getBBox();k=Math.max(k,f.width),l=Math.min(l,f.x),i.l.info(f.x,d,e+h),0===h&&(h=b.node().getBBox().height,i.l.info("Title height",h,e)),j.push(b)}let m=h*g.length;if(g.length>1){let a=(g.length-1)*h*.5;j.forEach((b,c)=>b.attr("y",e+c*h-a)),m=h*g.length}let n=c.node().getBBox();c.insert("rect",":first-child").attr("class","box").attr("x",d-k/2-(0,i.c)().state.padding/2).attr("y",e-m/2-(0,i.c)().state.padding/2-3.5).attr("width",k+(0,i.c)().state.padding).attr("height",m+(0,i.c)().state.padding),i.l.info(n)}m++},o={},p=function(a){a.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},q=(a,c,d,e,f,j,m)=>{let p,r=new h.Graph({compound:!0,multigraph:!0}),s=!0;for(p=0;p<a.length;p++)if("relation"===a[p].stmt){s=!1;break}d?r.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:s?1:b.edgeLengthFactor,nodeSep:s?1:50,isMultiGraph:!0}):r.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:s?1:b.edgeLengthFactor,nodeSep:s?1:50,ranker:"tight-tree",isMultiGraph:!0}),r.setDefaultEdgeLabel(function(){return{}}),m.db.extract(a);let t=m.db.getStates(),u=m.db.getRelations();for(let a of Object.keys(t)){let g,h=t[a];if(d&&(h.parentId=d),h.doc){let a=c.append("g").attr("id",h.id).attr("class","stateGroup");g=q(h.doc,a,h.id,!e,f,j,m);{let c=(a=k(a,h,e)).node().getBBox();g.width=c.width,g.height=c.height+b.padding/2,o[h.id]={y:b.compositTitleSize}}}else g=l(c,h);if(h.note){let a=l(c,{descriptions:[],id:h.id+"-note",note:h.note,type:"note"});"left of"===h.note.position?(r.setNode(g.id+"-note",a),r.setNode(g.id,g)):(r.setNode(g.id,g),r.setNode(g.id+"-note",a)),r.setParent(g.id,g.id+"-group"),r.setParent(g.id+"-note",g.id+"-group")}else r.setNode(g.id,g)}i.l.debug("Count=",r.nodeCount(),r);let v=0;u.forEach(function(a){let c;v++,i.l.debug("Setting edge",a),r.setEdge(a.id1,a.id2,{relation:a,width:(c=a.title)?c.length*b.fontSizeFactor:1,height:b.labelHeight*i.e.getRows(a.title).length,labelpos:"c"},"id"+v)}),(0,g.layout)(r),i.l.debug("Graph after layout",r.nodes());let w=c.node();r.nodes().forEach(function(a){void 0!==a&&void 0!==r.node(a)?(i.l.warn("Node "+a+": "+JSON.stringify(r.node(a))),f.select("#"+w.id+" #"+a).attr("transform","translate("+(r.node(a).x-r.node(a).width/2)+","+(r.node(a).y+(o[a]?o[a].y:0)-r.node(a).height/2)+" )"),f.select("#"+w.id+" #"+a).attr("data-x-shift",r.node(a).x-r.node(a).width/2),j.querySelectorAll("#"+w.id+" #"+a+" .divider").forEach(a=>{let b=a.parentElement,c=0,d=0;b&&(b.parentElement&&(c=b.parentElement.getBBox().width),Number.isNaN(d=parseInt(b.getAttribute("data-x-shift"),10))&&(d=0)),a.setAttribute("x1",0-d+8),a.setAttribute("x2",c-d-8)})):i.l.debug("No Node "+a+": "+JSON.stringify(r.node(a)))});let x=w.getBBox();r.edges().forEach(function(a){void 0!==a&&void 0!==r.edge(a)&&(i.l.debug("Edge "+a.v+" -> "+a.w+": "+JSON.stringify(r.edge(a))),n(c,r.edge(a),r.edge(a).relation))});let y={id:d||"root",label:d||"root",width:0,height:0};return y.width=(x=w.getBBox()).width+2*b.padding,y.height=x.height+2*b.padding,i.l.debug("Doc rendered",y,r),y},r={parser:c.p,db:c.d,renderer:{setConf:function(){},draw:function(a,c,d,e){let g;b=(0,i.c)().state;let h=(0,i.c)().securityLevel;"sandbox"===h&&(g=(0,f.select)("#i"+c));let j="sandbox"===h?(0,f.select)(g.nodes()[0].contentDocument.body):(0,f.select)("body"),k="sandbox"===h?g.nodes()[0].contentDocument:document;i.l.debug("Rendering diagram "+a);let l=j.select(`[id='${c}']`);p(l),q(e.db.getRootDoc(),l,void 0,!1,j,k,e);let m=b.padding,n=l.node().getBBox(),o=n.width+2*m,r=n.height+2*m;(0,i.i)(l,r,1.75*o,b.useMaxWidth),l.attr("viewBox",`${n.x-b.padding}  ${n.y-b.padding} `+o+" "+r)}},styles:c.s,init:a=>{a.state||(a.state={}),a.state.arrowMarkerAbsolute=a.arrowMarkerAbsolute,c.d.clear()}};a.s(["diagram",()=>r])}];

//# debugId=d83f4953-5cf9-890d-b1cd-c5922402ca53
//# sourceMappingURL=node_modules_4581c2b4._.js.map