{
  "version": 3,
  "sources": [],
  "debugId": "c70d7950-ae0c-3dca-6ce8-464e44f671df",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/notes/tools/network-models/overview/EncapsulationLab.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\n\ntype ScenarioId = \"dns\" | \"https\" | \"ssh\";\n\nconst SCENARIOS: Record<\n  ScenarioId,\n  {\n    title: string;\n    payloadExample: string;\n    appProtocol: string;\n    transport: \"UDP\" | \"TCP\";\n    port: number;\n    note: string;\n  }\n> = {\n  dns: {\n    title: \"DNS lookup\",\n    payloadExample: \"Query A record for www.example.com\",\n    appProtocol: \"DNS\",\n    transport: \"UDP\",\n    port: 53,\n    note: \"DNS often uses UDP. If the message is too large or reliability is needed, TCP can be used.\",\n  },\n  https: {\n    title: \"HTTPS page load\",\n    payloadExample: \"GET / over HTTPS for www.example.com\",\n    appProtocol: \"HTTP over TLS\",\n    transport: \"TCP\",\n    port: 443,\n    note: \"HTTPS is HTTP protected by TLS. TLS runs over a reliable transport in almost all common deployments.\",\n  },\n  ssh: {\n    title: \"SSH remote login\",\n    payloadExample: \"Open SSH session to a server and run a command\",\n    appProtocol: \"SSH\",\n    transport: \"TCP\",\n    port: 22,\n    note: \"SSH uses TCP. The encryption and integrity checks are part of the SSH protocol itself.\",\n  },\n};\n\nfunction cleanText(input: string, maxLen: number) {\n  return String(input || \"\")\n    .replace(/[\\u0000-\\u0008\\u000B\\u000C\\u000E-\\u001F\\u007F]/g, \"\")\n    .trim()\n    .slice(0, maxLen);\n}\n\nfunction byteLen(text: string) {\n  try {\n    return new TextEncoder().encode(text).byteLength;\n  } catch {\n    return Math.max(0, String(text || \"\").length);\n  }\n}\n\nexport default function EncapsulationLab() {\n  const [scenarioId, setScenarioId] = useState<ScenarioId>(\"https\");\n  const scenario = SCENARIOS[scenarioId];\n  const [payload, setPayload] = useState(scenario.payloadExample);\n\n  const safePayload = useMemo(() => cleanText(payload, 400), [payload]);\n\n  const example = useMemo(() => {\n    const srcIp = \"192.0.2.10\";\n    const dstIp = \"203.0.113.20\";\n    const srcMac = \"02:11:22:33:44:55\";\n    const dstMac = \"02:aa:bb:cc:dd:ee\";\n    const srcPort = 51512;\n    const dstPort = scenario.port;\n\n    const appData = safePayload || scenario.payloadExample;\n    const appBytes = byteLen(appData);\n\n    const tlsOverhead = scenarioId === \"https\" ? 85 : 0;\n    const appPduLabel = scenario.appProtocol;\n\n    const transportHeader = scenario.transport === \"TCP\" ? 20 : 8;\n    const ipHeader = 20;\n    const ethernetHeader = 14;\n    const ethernetFcs = 4;\n\n    const totalBytes = ethernetHeader + ipHeader + transportHeader + tlsOverhead + appBytes + ethernetFcs;\n\n    return {\n      srcIp,\n      dstIp,\n      srcMac,\n      dstMac,\n      srcPort,\n      dstPort,\n      appPduLabel,\n      tlsOverhead,\n      transportHeader,\n      ipHeader,\n      ethernetHeader,\n      ethernetFcs,\n      appBytes,\n      totalBytes,\n    };\n  }, [safePayload, scenario.appProtocol, scenario.port, scenario.transport, scenarioId]);\n\n  return (\n    <div className=\"not-prose space-y-4\">\n      <div className=\"grid gap-3 md:grid-cols-[1fr_1fr]\">\n        <div className=\"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm\">\n          <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600\">Scenario</div>\n          <div className=\"mt-2 flex flex-wrap gap-2\">\n            {Object.entries(SCENARIOS).map(([id, s]) => (\n              <button\n                key={id}\n                type=\"button\"\n                onClick={() => {\n                  const next = id as ScenarioId;\n                  setScenarioId(next);\n                  setPayload(SCENARIOS[next].payloadExample);\n                }}\n                className={[\n                  \"rounded-full border px-3 py-1 text-sm font-semibold shadow-sm transition\",\n                  scenarioId === id ? \"border-slate-900 bg-slate-900 text-white\" : \"border-slate-200 bg-white text-slate-900 hover:bg-slate-50\",\n                ].join(\" \")}\n              >\n                {s.title}\n              </button>\n            ))}\n          </div>\n          <div className=\"mt-3 text-sm text-slate-700\">{scenario.note}</div>\n        </div>\n\n        <div className=\"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm\">\n          <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600\">Application data</div>\n          <textarea\n            value={payload}\n            onChange={(e) => setPayload(e.target.value)}\n            rows={4}\n            className=\"mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-inner focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-500\"\n            placeholder=\"Describe what the application is trying to send\"\n          />\n          <div className=\"mt-2 text-xs text-slate-600\">Keep this descriptive. Do not paste secrets.</div>\n        </div>\n      </div>\n\n      <div className=\"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm\">\n        <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600\">Encapsulation stack</div>\n        <div className=\"mt-3 grid gap-3 lg:grid-cols-5\">\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\n            <div className=\"text-xs font-semibold text-slate-700\">Application</div>\n            <div className=\"mt-1 text-sm font-semibold text-slate-900\">{example.appPduLabel}</div>\n            <div className=\"mt-2 text-xs text-slate-700\">Data {example.appBytes} bytes</div>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\n            <div className=\"text-xs font-semibold text-slate-700\">Security layer</div>\n            <div className=\"mt-1 text-sm font-semibold text-slate-900\">{scenarioId === \"https\" ? \"TLS record\" : \"None\"}</div>\n            <div className=\"mt-2 text-xs text-slate-700\">Overhead {example.tlsOverhead} bytes</div>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\n            <div className=\"text-xs font-semibold text-slate-700\">Transport</div>\n            <div className=\"mt-1 text-sm font-semibold text-slate-900\">\n              {scenario.transport} {scenario.transport === \"TCP\" ? \"segment\" : \"datagram\"}\n            </div>\n            <div className=\"mt-2 text-xs text-slate-700\">\n              Src port {example.srcPort} to dst port {example.dstPort}\n            </div>\n            <div className=\"mt-1 text-xs text-slate-700\">Header {example.transportHeader} bytes</div>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\n            <div className=\"text-xs font-semibold text-slate-700\">Internet</div>\n            <div className=\"mt-1 text-sm font-semibold text-slate-900\">IP packet</div>\n            <div className=\"mt-2 text-xs text-slate-700\">\n              Src {example.srcIp} to dst {example.dstIp}\n            </div>\n            <div className=\"mt-1 text-xs text-slate-700\">Header {example.ipHeader} bytes</div>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50 p-3\">\n            <div className=\"text-xs font-semibold text-slate-700\">Link</div>\n            <div className=\"mt-1 text-sm font-semibold text-slate-900\">Ethernet frame</div>\n            <div className=\"mt-2 text-xs text-slate-700\">\n              Src {example.srcMac} to dst {example.dstMac}\n            </div>\n            <div className=\"mt-1 text-xs text-slate-700\">\n              Header {example.ethernetHeader} bytes and FCS {example.ethernetFcs} bytes\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mt-4 rounded-xl border border-slate-200 bg-white p-3\">\n          <div className=\"text-sm font-semibold text-slate-900\">Total size estimate</div>\n          <div className=\"mt-1 text-sm text-slate-700\">\n            About {example.totalBytes} bytes on the wire for this single message, excluding lower level timing and retransmissions.\n          </div>\n          <div className=\"mt-2 text-xs text-slate-600\">\n            This is a teaching model. Real sizes depend on options, extensions, path MTU, and whether the payload is split across multiple packets.\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}