;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="d215ce32-e8f7-8920-54b3-658da1b2a5de")}catch(e){}}();
module.exports=[371245,a=>{"use strict";var b=a.i(508171),c=a.i(127669);let d=`Return-Path: <billing@example-payments.com>
Received: from mail-ot1-f45.google.com (mail-ot1-f45.google.com. [209.85.210.45])
        by mx.example.org with ESMTPS id f19si123456qkf.123.2024.01.15.09.13.10
        for <you@example.org>
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384);
        Mon, 15 Jan 2024 09:13:10 +0000 (UTC)
Authentication-Results: mx.example.org;
        spf=softfail (google.com: domain of transitioning billing@example-payments.com does not designate 209.85.210.45 as permitted sender) smtp.mailfrom=billing@example-payments.com;
        dkim=fail;
        dmarc=fail;
From: "Payments team" <billing@example-payments.com>
To: you@example.org
Subject: Urgent: account suspended, update details now
Date: Mon, 15 Jan 2024 09:12:58 +0000`;function e(){let a,e,f,g,[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(!1),l=j?d:h,{verdict:m,reasons:n}=l.trim()?(a=l.toLowerCase(),e=[],a.includes("authentication-results")||e.push("No Authentication-Results header was found."),a.includes("spf=")?(a.includes("spf=fail")||a.includes("spf=softfail"))&&e.push("SPF check failed for this message."):e.push("No SPF result was found in Authentication-Results."),a.includes("dkim=fail")&&e.push("DKIM signature failed validation."),a.includes("dmarc=")?a.includes("dmarc=fail")&&e.push("DMARC evaluation failed for this message."):e.push("No DMARC result was found in Authentication-Results."),(a.match(/received:/g)||[]).length<2&&e.push("Only one Received header was found which is unusual."),f="safe",((g=e.join(" ").toLowerCase()).includes("failed")||g.includes("unusual")||g.includes("no dmarc"))&&(f="caution"),(g.includes("spf check failed")||g.includes("dkim signature failed")||g.includes("dmarc evaluation failed"))&&(f="risky"),{verdict:f,reasons:e}):{verdict:"safe",reasons:[]};return(0,b.jsxs)("section",{"aria-labelledby":"email-header-lab-title",className:"rounded-3xl bg-white shadow-sm ring-1 ring-slate-100 p-6 sm:p-8 space-y-6",children:[(0,b.jsxs)("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{id:"email-header-lab-title",className:"text-lg sm:text-xl font-semibold text-slate-900",children:"Email header explainer"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-slate-600 max-w-xl",children:"Paste an email header and see how SPF, DKIM and DMARC results affect your trust in the message. Nothing leaves your browser."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>k(a=>!a),className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2",children:j?"Use your own header":"Use example header"})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{htmlFor:"email-header-input",className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Header text"}),(0,b.jsx)("textarea",{id:"email-header-input",className:"h-56 w-full resize-none rounded-2xl border border-slate-200 bg-slate-50/60 px-3 py-2 text-sm font-mono text-slate-800 shadow-inner focus:border-sky-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Paste the full email header here...",value:j?d:h,onChange:a=>{k(!1),i(a.target.value)}}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Tip: In most email clients you can view the raw header via menu options like View original or Show source. Never paste sensitive content from private or confidential emails."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:`rounded-2xl border px-4 py-3 text-sm font-medium ${"safe"===m?"bg-emerald-50 text-emerald-800 border-emerald-200":"caution"===m?"bg-amber-50 text-amber-800 border-amber-200":"bg-rose-50 text-rose-800 border-rose-200"}`,children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-wide mb-1",children:"Overall signal"}),(0,b.jsx)("p",{children:l.trim()?"safe"===m?"Signals are mostly consistent. Still stay alert.":"caution"===m?"Signals are mixed. Treat this message with caution.":"Multiple signals look risky. Treat this message as suspicious.":"Waiting for a header."})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"How to read this"}),(0,b.jsxs)("ul",{className:"space-y-1.5 text-xs text-slate-700",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"SPF"})," confirms the sending server is allowed to send mail for this domain."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"DKIM"})," is a digital signature that proves the message has not been changed in transit."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"DMARC"})," tells receivers how strictly to treat failures and can signal phishing."]})]})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 space-y-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Signals from this header"}),l.trim()?(0,b.jsxs)("ul",{className:"list-disc pl-5 space-y-1.5 text-xs text-slate-700",children:[0===n.length&&(0,b.jsx)("li",{children:"No obvious red flags were found. This does not guarantee the message is safe. Always check the content and context."}),n.map((a,c)=>(0,b.jsx)("li",{children:a},c))]}):(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Paste a header to see a breakdown of the main signals."})]})]})]})]})}a.s(["EmailHeaderLab",()=>e])},269312,a=>{a.n(a.i(371245))}];

//# debugId=d215ce32-e8f7-8920-54b3-658da1b2a5de
//# sourceMappingURL=src_components_tools_cybersecurity_EmailHeaderLab_tsx_ee4e6a87._.js.map