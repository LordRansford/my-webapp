{
  "version": 3,
  "sources": [],
  "debugId": "0aa4fb36-3b4f-f0af-af06-3eb135d610e3",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/app/games/missions/page.tsx","../../../../src/games/missions/definitions.ts","../../../../src/games/missions/progress.ts","../../../../src/components/games/CampaignMap.tsx","../../../../src/games/characters/types.ts","../../../../src/components/games/PreGameSelection.tsx","../../../../src/components/games/MissionBriefing.tsx","../../../../src/components/games/FullscreenGameModal.tsx","../../../../src/games/engine/canvasView.ts","../../../../src/games/engine/loop.ts","../../../../src/games/engine/input.ts","../../../../src/games/engine/audio.ts","../../../../src/components/games/MissionGameShell.tsx","../../../../src/games/scenes/missionScene.ts","../../../../src/games/collectibles/types.ts","../../../../src/games/characters/voice.ts","../../../../src/games/enemies/types.ts","../../../../src/games/enemies/ai.ts","../../../../src/games/shooting/types.ts","../../../../src/games/shooting/weapons.ts","../../../../src/games/movement/force.ts","../../../../src/games/effects/projectiles.ts","../../../../src/games/effects/explosions.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { CampaignMap } from \"@/components/games/CampaignMap\";\nimport { PreGameSelection } from \"@/components/games/PreGameSelection\";\nimport { MissionBriefing } from \"@/components/games/MissionBriefing\";\nimport { FullscreenGameModal } from \"@/components/games/FullscreenGameModal\";\nimport { MissionGameShell } from \"@/components/games/MissionGameShell\";\nimport type { MissionId } from \"@/games/missions/types\";\nimport type { PlayerChoice } from \"@/games/characters/types\";\nimport { getMission } from \"@/games/missions/definitions\";\nimport { PersistStore } from \"@/games/engine/persist\";\nimport { CharisVoice } from \"@/games/characters/voice\";\n\nexport default function MissionsPage() {\n  const store = useMemo(() => new PersistStore({ prefix: \"rn_games\", version: \"v1\" }), []);\n  const [selectedMission, setSelectedMission] = useState<MissionId | null>(null);\n  const [playerChoice, setPlayerChoice] = useState<PlayerChoice | null>(null);\n  const [showBriefing, setShowBriefing] = useState(false);\n  const [gameStarted, setGameStarted] = useState(false);\n  const [charisVoice] = useState(() => new CharisVoice());\n\n  const handleSelectMission = (missionId: MissionId) => {\n    setSelectedMission(missionId);\n    setPlayerChoice(null);\n    setShowBriefing(false);\n    setGameStarted(false);\n  };\n\n  const handlePlayerChoice = (choice: PlayerChoice) => {\n    setPlayerChoice(choice);\n    setShowBriefing(true);\n  };\n\n  const handleStartGame = () => {\n    setShowBriefing(false);\n    setGameStarted(true);\n  };\n\n  const handleGameComplete = (\n    won: boolean,\n    stars: 0 | 1 | 2 | 3,\n    objectivesCompleted: string[],\n    sideQuestsCompleted: string[],\n    timeMs: number\n  ) => {\n    // Progress will be saved by MissionGameShell\n    setGameStarted(false);\n    setSelectedMission(null);\n    setPlayerChoice(null);\n  };\n\n  const handleCancel = () => {\n    setSelectedMission(null);\n    setPlayerChoice(null);\n    setShowBriefing(false);\n    setGameStarted(false);\n  };\n\n  if (gameStarted && selectedMission && playerChoice) {\n    return (\n      <FullscreenGameModal isOpen={true} onClose={handleCancel} title={`Mission ${selectedMission}`}>\n        <MissionGameShell\n          missionId={selectedMission}\n          playerChoice={playerChoice}\n          onComplete={handleGameComplete}\n          onCancel={handleCancel}\n        />\n      </FullscreenGameModal>\n    );\n  }\n\n  if (showBriefing && selectedMission) {\n    const mission = getMission(selectedMission);\n    if (mission) {\n      return (\n        <MissionBriefing\n          mission={mission}\n          onStart={handleStartGame}\n          onSkip={handleStartGame}\n          charisVoice={charisVoice}\n        />\n      );\n    }\n  }\n\n  if (selectedMission && !playerChoice) {\n    return (\n      <div className=\"min-h-screen bg-slate-50 py-8\">\n        <div className=\"container mx-auto px-4\">\n          <PreGameSelection onStart={handlePlayerChoice} onCancel={handleCancel} />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 py-8\">\n      <div className=\"container mx-auto px-4\">\n        <CampaignMap onSelectMission={handleSelectMission} store={store} />\n      </div>\n    </div>\n  );\n}\n\n","import type { MissionDefinition, MissionId } from \"./types\";\n\nexport const MISSION_DEFINITIONS: MissionDefinition[] = [\n  {\n    id: 1,\n    title: \"First Steps\",\n    description: \"Learn the basics. Survive the initial wave.\",\n    briefing: \"Welcome, agent. This is your first mission. Charis has prepared a simple test. Survive for 60 seconds and prove you're ready for what comes next.\",\n    durationMs: 60_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 60 seconds\", type: \"survive\", target: 60_000, completed: false },\n      { id: \"collect-5\", description: \"Collect 5 bonus items\", type: \"collect\", target: 5, completed: false },\n    ],\n    sideQuests: [\n      { id: \"combo-3\", description: \"Achieve a 3x combo\", reward: 50, completed: false },\n    ],\n    difficulty: 0.2,\n  },\n  {\n    id: 2,\n    title: \"Rising Tension\",\n    description: \"The pace quickens. Stay focused.\",\n    briefing: \"Good work. Charis is impressed, but she's not done with you yet. The obstacles will come faster now. Can you handle the pressure?\",\n    durationMs: 60_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 60 seconds\", type: \"survive\", target: 60_000, completed: false },\n      { id: \"combo-5\", description: \"Achieve a 5x combo\", type: \"combo\", target: 5, completed: false },\n    ],\n    sideQuests: [\n      { id: \"collect-10\", description: \"Collect 10 bonus items\", reward: 100, completed: false },\n      { id: \"no-hits\", description: \"Complete without taking damage (if shield available)\", reward: 200, completed: false },\n    ],\n    difficulty: 0.3,\n    unlockRequirement: 1,\n  },\n  {\n    id: 3,\n    title: \"Pattern Recognition\",\n    description: \"See the patterns. Predict the danger.\",\n    briefing: \"Charis says: 'You're learning, but can you see what's coming?' Watch the patterns. They're not random. Survive and show me you understand.\",\n    durationMs: 75_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 75 seconds\", type: \"survive\", target: 75_000, completed: false },\n      { id: \"collect-15\", description: \"Collect 15 bonus items\", type: \"collect\", target: 15, completed: false },\n    ],\n    sideQuests: [\n      { id: \"perfect-10\", description: \"Perform 10 perfect dodges\", type: \"perfect\", target: 10, completed: false, reward: 150 },\n      { id: \"combo-8\", description: \"Achieve an 8x combo\", reward: 120, completed: false },\n    ],\n    difficulty: 0.4,\n    unlockRequirement: 2,\n  },\n  {\n    id: 4,\n    title: \"Speed Test\",\n    description: \"Everything moves faster. Can you keep up?\",\n    briefing: \"Charis laughs: 'Too slow! Everything moves faster now. Keep up or fail.' This is where many agents break. Don't be one of them.\",\n    durationMs: 90_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 90 seconds\", type: \"survive\", target: 90_000, completed: false },\n      { id: \"combo-10\", description: \"Achieve a 10x combo\", type: \"combo\", target: 10, completed: false },\n    ],\n    sideQuests: [\n      { id: \"collect-20\", description: \"Collect 20 bonus items\", reward: 200, completed: false },\n      { id: \"speed-run\", description: \"Complete in under 85 seconds\", type: \"time\", target: 85_000, completed: false, reward: 250 },\n    ],\n    difficulty: 0.5,\n    unlockRequirement: 3,\n  },\n  {\n    id: 5,\n    title: \"The Gauntlet\",\n    description: \"Multiple threats. One path forward.\",\n    briefing: \"Charis warns: 'This is where it gets real. Multiple obstacles. Tight windows. One mistake and you're done. Are you ready?'\",\n    durationMs: 90_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 90 seconds\", type: \"survive\", target: 90_000, completed: false },\n      { id: \"perfect-15\", description: \"Perform 15 perfect dodges\", type: \"perfect\", target: 15, completed: false },\n    ],\n    sideQuests: [\n      { id: \"combo-12\", description: \"Achieve a 12x combo\", reward: 300, completed: false },\n      { id: \"collect-25\", description: \"Collect 25 bonus items\", reward: 250, completed: false },\n    ],\n    difficulty: 0.6,\n    unlockRequirement: 4,\n  },\n  {\n    id: 6,\n    title: \"Midpoint Crisis\",\n    description: \"Halfway there. The real challenge begins.\",\n    briefing: \"Charis: 'You've made it halfway. Most don't. But I'm not done testing you. The next phase will push you to your limits.'\",\n    durationMs: 120_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 120 seconds\", type: \"survive\", target: 120_000, completed: false },\n      { id: \"combo-15\", description: \"Achieve a 15x combo\", type: \"combo\", target: 15, completed: false },\n      { id: \"collect-30\", description: \"Collect 30 bonus items\", type: \"collect\", target: 30, completed: false },\n    ],\n    sideQuests: [\n      { id: \"perfect-20\", description: \"Perform 20 perfect dodges\", type: \"perfect\", target: 20, completed: false, reward: 400 },\n      { id: \"no-powerups\", description: \"Complete without using power-ups\", reward: 500, completed: false },\n    ],\n    difficulty: 0.65,\n    unlockRequirement: 5,\n  },\n  {\n    id: 7,\n    title: \"Adaptation\",\n    description: \"The rules change. You must adapt.\",\n    briefing: \"Charis: 'I'm changing the rules. Adapt or fail. The obstacles will come from unexpected angles. Trust your instincts.'\",\n    durationMs: 120_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 120 seconds\", type: \"survive\", target: 120_000, completed: false },\n      { id: \"perfect-25\", description: \"Perform 25 perfect dodges\", type: \"perfect\", target: 25, completed: false },\n    ],\n    sideQuests: [\n      { id: \"combo-18\", description: \"Achieve an 18x combo\", reward: 450, completed: false },\n      { id: \"collect-35\", description: \"Collect 35 bonus items\", reward: 350, completed: false },\n    ],\n    difficulty: 0.7,\n    unlockRequirement: 6,\n  },\n  {\n    id: 8,\n    title: \"Pressure Cooker\",\n    description: \"Maximum intensity. Hold the line.\",\n    briefing: \"Charis: 'This is where most agents break. Maximum pressure. No room for error. Can you hold the line?'\",\n    durationMs: 150_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 150 seconds\", type: \"survive\", target: 150_000, completed: false },\n      { id: \"combo-20\", description: \"Achieve a 20x combo\", type: \"combo\", target: 20, completed: false },\n    ],\n    sideQuests: [\n      { id: \"perfect-30\", description: \"Perform 30 perfect dodges\", type: \"perfect\", target: 30, completed: false, reward: 600 },\n      { id: \"collect-40\", description: \"Collect 40 bonus items\", reward: 400, completed: false },\n    ],\n    difficulty: 0.75,\n    unlockRequirement: 7,\n  },\n  {\n    id: 9,\n    title: \"The Test\",\n    description: \"Charis's personal challenge for you.\",\n    briefing: \"Charis: 'I've designed this one myself. This is my test. Pass it, and you'll have proven yourself worthy. Fail, and start over.'\",\n    durationMs: 180_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 180 seconds\", type: \"survive\", target: 180_000, completed: false },\n      { id: \"combo-25\", description: \"Achieve a 25x combo\", type: \"combo\", target: 25, completed: false },\n      { id: \"perfect-35\", description: \"Perform 35 perfect dodges\", type: \"perfect\", target: 35, completed: false },\n    ],\n    sideQuests: [\n      { id: \"collect-50\", description: \"Collect 50 bonus items\", reward: 500, completed: false },\n      { id: \"flawless\", description: \"Complete with zero mistakes (perfect run)\", reward: 1000, completed: false },\n    ],\n    difficulty: 0.8,\n    unlockRequirement: 8,\n  },\n  {\n    id: 10,\n    title: \"Endurance\",\n    description: \"Long haul. Mental fortitude required.\",\n    briefing: \"Charis: 'Endurance. That's what this is about. Can you maintain focus for the long haul? Most can't. Show me you're different.'\",\n    durationMs: 240_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 240 seconds\", type: \"survive\", target: 240_000, completed: false },\n      { id: \"combo-30\", description: \"Achieve a 30x combo\", type: \"combo\", target: 30, completed: false },\n    ],\n    sideQuests: [\n      { id: \"perfect-40\", description: \"Perform 40 perfect dodges\", type: \"perfect\", target: 40, completed: false, reward: 800 },\n      { id: \"collect-60\", description: \"Collect 60 bonus items\", reward: 600, completed: false },\n    ],\n    difficulty: 0.85,\n    unlockRequirement: 9,\n  },\n  {\n    id: 11,\n    title: \"The Final Gauntlet\",\n    description: \"Everything you've learned. One final test.\",\n    briefing: \"Charis: 'Everything you've learned comes down to this. One final gauntlet. Pass this, and you're ready for the ultimate challenge.'\",\n    durationMs: 300_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 300 seconds\", type: \"survive\", target: 300_000, completed: false },\n      { id: \"combo-35\", description: \"Achieve a 35x combo\", type: \"combo\", target: 35, completed: false },\n      { id: \"perfect-50\", description: \"Perform 50 perfect dodges\", type: \"perfect\", target: 50, completed: false },\n    ],\n    sideQuests: [\n      { id: \"collect-75\", description: \"Collect 75 bonus items\", reward: 750, completed: false },\n      { id: \"master\", description: \"Complete all objectives and side quests\", reward: 1500, completed: false },\n    ],\n    difficulty: 0.9,\n    unlockRequirement: 10,\n  },\n  {\n    id: 12,\n    title: \"Charis's Challenge\",\n    description: \"The ultimate test. Dedicated to Charis Chung Amponsah.\",\n    briefing: \"Charis: 'This is it. My ultimate challenge. Dedicated to me, designed by me, perfected for you. Survive this, and you've earned my respect. Good luck, agent. You'll need it.'\",\n    durationMs: 300_000,\n    objectives: [\n      { id: \"survive\", description: \"Survive for 300 seconds\", type: \"survive\", target: 300_000, completed: false },\n      { id: \"combo-40\", description: \"Achieve a 40x combo\", type: \"combo\", target: 40, completed: false },\n      { id: \"perfect-60\", description: \"Perform 60 perfect dodges\", type: \"perfect\", target: 60, completed: false },\n      { id: \"collect-100\", description: \"Collect 100 bonus items\", type: \"collect\", target: 100, completed: false },\n    ],\n    sideQuests: [\n      { id: \"legend\", description: \"Complete with 3 stars and all side quests\", reward: 2000, completed: false },\n      { id: \"dedication\", description: \"Complete in honor of Charis Chung Amponsah\", reward: 5000, completed: false },\n    ],\n    difficulty: 0.95,\n    unlockRequirement: 11,\n  },\n];\n\nexport function getMission(id: MissionId): MissionDefinition | null {\n  return MISSION_DEFINITIONS.find((m) => m.id === id) ?? null;\n}\n\nexport function getNextMission(currentId: MissionId): MissionDefinition | null {\n  const nextId = (currentId + 1) as MissionId;\n  return getMission(nextId);\n}\n\n","import { PersistStore } from \"@/games/engine/persist\";\nimport type { CampaignProgress, MissionId, MissionProgress, MissionStatus, StarRating } from \"./types\";\nimport { MISSION_DEFINITIONS } from \"./definitions\";\n\nconst DEFAULT_CAMPAIGN: CampaignProgress = {\n  currentMission: 1,\n  missions: {} as Record<MissionId, MissionProgress>,\n  totalStars: 0,\n  totalPoints: 0,\n  badges: [],\n};\n\nconst KEY = \"campaign_progress\";\n\nexport function createCampaignProgressStore(store: PersistStore) {\n  const read = (): CampaignProgress => {\n    const stored = store.get(KEY, DEFAULT_CAMPAIGN);\n    // Ensure all missions have progress entries\n    const missions: Record<MissionId, MissionProgress> = { ...(stored.missions || {}) } as Record<MissionId, MissionProgress>;\n    for (const def of MISSION_DEFINITIONS) {\n      if (!missions[def.id]) {\n        missions[def.id] = {\n          missionId: def.id,\n          status: def.id === 1 ? \"available\" : \"locked\",\n          stars: 0,\n          objectivesCompleted: [],\n          sideQuestsCompleted: [],\n          attempts: 0,\n        };\n      }\n    }\n    return { ...stored, missions };\n  };\n\n  const write = (progress: CampaignProgress) => {\n    store.set(KEY, progress);\n  };\n\n  const get = () => read();\n\n  const getMissionProgress = (missionId: MissionId): MissionProgress => {\n    const p = read();\n    return p.missions[missionId] ?? {\n      missionId,\n      status: missionId === 1 ? \"available\" : \"locked\",\n      stars: 0,\n      objectivesCompleted: [],\n      sideQuestsCompleted: [],\n      attempts: 0,\n    };\n  };\n\n  const updateMissionStatus = (missionId: MissionId, status: MissionStatus) => {\n    const p = read();\n    const mission = p.missions[missionId];\n    if (mission) {\n      mission.status = status;\n      write(p);\n    }\n  };\n\n  const completeMission = (\n    missionId: MissionId,\n    stars: StarRating,\n    objectivesCompleted: string[],\n    sideQuestsCompleted: string[],\n    timeMs: number\n  ) => {\n    const p = read();\n    const mission = p.missions[missionId];\n    if (mission) {\n      mission.status = \"completed\";\n      mission.stars = Math.max(mission.stars, stars) as StarRating;\n      if (!mission.bestTimeMs || timeMs < mission.bestTimeMs) {\n        mission.bestTimeMs = timeMs;\n      }\n      mission.objectivesCompleted = [...new Set([...mission.objectivesCompleted, ...objectivesCompleted])];\n      mission.sideQuestsCompleted = [...new Set([...mission.sideQuestsCompleted, ...sideQuestsCompleted])];\n      mission.completedAt = Date.now();\n\n      // Update totals\n      p.totalStars = Object.values(p.missions).reduce((sum, m) => sum + m.stars, 0);\n      \n      // Unlock next mission\n      const nextId = (missionId + 1) as MissionId;\n      if (nextId <= 12 && p.missions[nextId]) {\n        p.missions[nextId].status = \"available\";\n      }\n\n      // Update current mission if needed\n      if (nextId <= 12 && p.currentMission < nextId) {\n        p.currentMission = nextId;\n      }\n\n      write(p);\n    }\n  };\n\n  const incrementAttempts = (missionId: MissionId) => {\n    const p = read();\n    const mission = p.missions[missionId];\n    if (mission) {\n      mission.attempts += 1;\n      write(p);\n    }\n  };\n\n  const addPoints = (points: number) => {\n    const p = read();\n    p.totalPoints += points;\n    write(p);\n  };\n\n  const addBadge = (badgeId: string) => {\n    const p = read();\n    if (!p.badges.includes(badgeId)) {\n      p.badges.push(badgeId);\n      write(p);\n    }\n  };\n\n  return {\n    get,\n    getMissionProgress,\n    updateMissionStatus,\n    completeMission,\n    incrementAttempts,\n    addPoints,\n    addBadge,\n  };\n}\n\n","\"use client\";\n\nimport { useMemo } from \"react\";\nimport type { MissionId } from \"@/games/missions/types\";\nimport { MISSION_DEFINITIONS } from \"@/games/missions/definitions\";\nimport { createCampaignProgressStore } from \"@/games/missions/progress\";\nimport { PersistStore } from \"@/games/engine/persist\";\nimport { Lock, Star, CheckCircle2 } from \"lucide-react\";\n\ninterface CampaignMapProps {\n  onSelectMission: (missionId: MissionId) => void;\n  store: PersistStore;\n}\n\nexport function CampaignMap({ onSelectMission, store }: CampaignMapProps) {\n  const progressStore = useMemo(() => createCampaignProgressStore(store), [store]);\n  const progress = progressStore.get();\n\n  const getMissionStatus = (missionId: MissionId) => {\n    const missionProgress = progress.missions[missionId];\n    if (!missionProgress) return \"locked\";\n    return missionProgress.status;\n  };\n\n  const getMissionStars = (missionId: MissionId) => {\n    const missionProgress = progress.missions[missionId];\n    return missionProgress?.stars ?? 0;\n  };\n\n  return (\n    <div className=\"w-full max-w-6xl mx-auto p-6\">\n      <h2 className=\"text-3xl font-bold text-slate-900 mb-2\">Campaign: Charis's Challenge</h2>\n      <p className=\"text-slate-600 mb-8\">12 missions dedicated to Charis Chung Amponsah</p>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n        {MISSION_DEFINITIONS.map((mission) => {\n          const status = getMissionStatus(mission.id);\n          const stars = getMissionStars(mission.id);\n          const isLocked = status === \"locked\";\n          const isCompleted = status === \"completed\";\n          const isAvailable = status === \"available\" || status === \"in-progress\";\n\n          return (\n            <button\n              key={mission.id}\n              onClick={() => !isLocked && onSelectMission(mission.id)}\n              disabled={isLocked}\n              className={`relative p-6 rounded-xl border-2 transition-all text-left ${\n                isLocked\n                  ? \"border-slate-200 bg-slate-50 opacity-60 cursor-not-allowed\"\n                  : isCompleted\n                    ? \"border-green-500 bg-green-50 hover:border-green-600 hover:shadow-lg\"\n                    : isAvailable\n                      ? \"border-blue-500 bg-blue-50 hover:border-blue-600 hover:shadow-lg\"\n                      : \"border-slate-300 bg-white hover:border-slate-400\"\n              }`}\n            >\n              {isLocked && (\n                <div className=\"absolute top-4 right-4\">\n                  <Lock className=\"w-5 h-5 text-slate-400\" />\n                </div>\n              )}\n\n              {isCompleted && (\n                <div className=\"absolute top-4 right-4\">\n                  <CheckCircle2 className=\"w-5 h-5 text-green-600\" />\n                </div>\n              )}\n\n              <div className=\"mb-2\">\n                <div className=\"text-sm font-semibold text-slate-500\">Mission {mission.id}</div>\n                <div className=\"text-lg font-bold text-slate-900\">{mission.title}</div>\n              </div>\n\n              <p className=\"text-sm text-slate-600 mb-4\">{mission.description}</p>\n\n              {stars > 0 && (\n                <div className=\"flex items-center gap-1 mb-2\">\n                  {[1, 2, 3].map((star) => (\n                    <Star\n                      key={star}\n                      className={`w-4 h-4 ${\n                        star <= stars ? \"fill-yellow-400 text-yellow-400\" : \"text-slate-300\"\n                      }`}\n                    />\n                  ))}\n                </div>\n              )}\n\n              <div className=\"text-xs text-slate-500\">\n                ~{Math.round(mission.durationMs / 1000 / 60)} min\n              </div>\n            </button>\n          );\n        })}\n      </div>\n\n      <div className=\"mt-8 p-4 bg-slate-50 rounded-xl\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <div className=\"text-sm font-semibold text-slate-700\">Total Progress</div>\n            <div className=\"text-2xl font-bold text-slate-900\">\n              {progress.totalStars} / {MISSION_DEFINITIONS.length * 3} Stars\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm font-semibold text-slate-700\">Total Points</div>\n            <div className=\"text-2xl font-bold text-slate-900\">{progress.totalPoints.toLocaleString()}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","// Character and player choice system types\n\nexport type CharacterId = \"agent\" | \"speedster\" | \"tank\" | \"collector\" | \"perfectionist\";\n\nexport type CharacterStats = {\n  speed: number; // Movement speed multiplier (0.8 - 1.2)\n  shieldDuration: number; // Shield power-up duration multiplier (0.8 - 1.5)\n  comboMultiplier: number; // Combo point multiplier (0.9 - 1.3)\n  collectibleMagnet: number; // Attraction radius for collectibles (0 - 50)\n  perfectDodgeWindow: number; // Perfect dodge timing window in ms (50 - 150)\n};\n\nexport type DifficultyModifier = {\n  id: string;\n  name: string;\n  description: string;\n  advantage: string;\n  disadvantage: string;\n  intensityMultiplier: number; // 0.8 - 1.2\n  pointMultiplier: number; // 0.8 - 1.5\n};\n\nexport type PowerUpPreference = {\n  slowTime: boolean;\n  shield: boolean;\n  doublePoints: boolean;\n  speedBoost: boolean;\n};\n\nexport type PlayerChoice = {\n  character: CharacterId;\n  difficultyModifier?: string;\n  powerUpPreferences: PowerUpPreference;\n};\n\nexport const CHARACTERS: Record<CharacterId, { name: string; description: string; stats: CharacterStats }> = {\n  agent: {\n    name: \"Agent\",\n    description: \"Balanced. Reliable. The standard choice.\",\n    stats: {\n      speed: 1.0,\n      shieldDuration: 1.0,\n      comboMultiplier: 1.0,\n      collectibleMagnet: 0,\n      perfectDodgeWindow: 100,\n    },\n  },\n  speedster: {\n    name: \"Speedster\",\n    description: \"Fast movement, but harder to control. Perfect for those who like speed.\",\n    stats: {\n      speed: 1.2,\n      shieldDuration: 0.8,\n      comboMultiplier: 1.1,\n      collectibleMagnet: 20,\n      perfectDodgeWindow: 80,\n    },\n  },\n  tank: {\n    name: \"Tank\",\n    description: \"Slower but more durable. Shield power-ups last longer.\",\n    stats: {\n      speed: 0.85,\n      shieldDuration: 1.5,\n      comboMultiplier: 0.9,\n      collectibleMagnet: 0,\n      perfectDodgeWindow: 120,\n    },\n  },\n  collector: {\n    name: \"Collector\",\n    description: \"Magnet for collectibles, but slightly slower. Great for side quests.\",\n    stats: {\n      speed: 0.9,\n      shieldDuration: 1.0,\n      comboMultiplier: 1.2,\n      collectibleMagnet: 50,\n      perfectDodgeWindow: 100,\n    },\n  },\n  perfectionist: {\n    name: \"Perfectionist\",\n    description: \"Larger perfect dodge window, but lower combo multiplier. For precision players.\",\n    stats: {\n      speed: 1.0,\n      shieldDuration: 0.9,\n      comboMultiplier: 0.95,\n      collectibleMagnet: 10,\n      perfectDodgeWindow: 150,\n    },\n  },\n};\n\nexport const DIFFICULTY_MODIFIERS: DifficultyModifier[] = [\n  {\n    id: \"none\",\n    name: \"Standard\",\n    description: \"No modifier. Balanced gameplay.\",\n    advantage: \"No penalties\",\n    disadvantage: \"No bonuses\",\n    intensityMultiplier: 1.0,\n    pointMultiplier: 1.0,\n  },\n  {\n    id: \"hard-mode\",\n    name: \"Hard Mode\",\n    description: \"20% harder obstacles, but 30% more points.\",\n    advantage: \"+30% points\",\n    disadvantage: \"20% harder\",\n    intensityMultiplier: 1.2,\n    pointMultiplier: 1.3,\n  },\n  {\n    id: \"easy-mode\",\n    name: \"Easy Mode\",\n    description: \"20% easier obstacles, but 20% fewer points.\",\n    advantage: \"20% easier\",\n    disadvantage: \"-20% points\",\n    intensityMultiplier: 0.8,\n    pointMultiplier: 0.8,\n  },\n  {\n    id: \"nightmare\",\n    name: \"Nightmare\",\n    description: \"50% harder obstacles, but 100% more points. For the truly brave.\",\n    advantage: \"+100% points\",\n    disadvantage: \"50% harder\",\n    intensityMultiplier: 1.5,\n    pointMultiplier: 2.0,\n  },\n];\n\n","\"use client\";\n\nimport { useState } from \"react\";\nimport type { CharacterId, PlayerChoice, DifficultyModifier } from \"@/games/characters/types\";\nimport { CHARACTERS, DIFFICULTY_MODIFIERS } from \"@/games/characters/types\";\nimport { Play, Zap, Shield, Target, Star } from \"lucide-react\";\n\ninterface PreGameSelectionProps {\n  onStart: (choice: PlayerChoice) => void;\n  onCancel: () => void;\n}\n\nexport function PreGameSelection({ onStart, onCancel }: PreGameSelectionProps) {\n  const [selectedCharacter, setSelectedCharacter] = useState<CharacterId>(\"agent\");\n  const [selectedModifier, setSelectedModifier] = useState<string>(\"none\");\n  const [powerUps, setPowerUps] = useState({\n    slowTime: true,\n    shield: true,\n    doublePoints: true,\n    speedBoost: true,\n  });\n\n  const handleStart = () => {\n    const choice: PlayerChoice = {\n      character: selectedCharacter,\n      difficultyModifier: selectedModifier === \"none\" ? undefined : selectedModifier,\n      powerUpPreferences: powerUps,\n    };\n    onStart(choice);\n  };\n\n  const selectedModifierData = DIFFICULTY_MODIFIERS.find((m) => m.id === selectedModifier) || DIFFICULTY_MODIFIERS[0];\n  const selectedCharacterData = CHARACTERS[selectedCharacter];\n\n  return (\n    <div className=\"w-full max-w-4xl mx-auto p-6 bg-white rounded-2xl shadow-lg\">\n      <h2 className=\"text-2xl font-bold text-slate-900 mb-6\">Prepare for Mission</h2>\n\n      {/* Character Selection */}\n      <section className=\"mb-8\">\n        <h3 className=\"text-lg font-semibold text-slate-700 mb-4\">Choose Your Character</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          {Object.entries(CHARACTERS).map(([id, char]) => (\n            <button\n              key={id}\n              onClick={() => setSelectedCharacter(id as CharacterId)}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedCharacter === id\n                  ? \"border-blue-500 bg-blue-50 shadow-md\"\n                  : \"border-slate-200 bg-white hover:border-slate-300\"\n              }`}\n            >\n              <div className=\"font-semibold text-slate-900 mb-1\">{char.name}</div>\n              <div className=\"text-sm text-slate-600 mb-3\">{char.description}</div>\n              <div className=\"space-y-1 text-xs text-slate-500\">\n                <div>Speed: {(char.stats.speed * 100).toFixed(0)}%</div>\n                <div>Shield: {(char.stats.shieldDuration * 100).toFixed(0)}%</div>\n                <div>Combo: {(char.stats.comboMultiplier * 100).toFixed(0)}%</div>\n                {char.stats.collectibleMagnet > 0 && (\n                  <div>Magnet: {char.stats.collectibleMagnet}px</div>\n                )}\n              </div>\n            </button>\n          ))}\n        </div>\n      </section>\n\n      {/* Difficulty Modifier */}\n      <section className=\"mb-8\">\n        <h3 className=\"text-lg font-semibold text-slate-700 mb-4\">Difficulty Modifier</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {DIFFICULTY_MODIFIERS.map((mod) => (\n            <button\n              key={mod.id}\n              onClick={() => setSelectedModifier(mod.id)}\n              className={`p-4 rounded-xl border-2 transition-all text-left ${\n                selectedModifier === mod.id\n                  ? \"border-blue-500 bg-blue-50 shadow-md\"\n                  : \"border-slate-200 bg-white hover:border-slate-300\"\n              }`}\n            >\n              <div className=\"font-semibold text-slate-900 mb-1\">{mod.name}</div>\n              <div className=\"text-sm text-slate-600 mb-2\">{mod.description}</div>\n              <div className=\"space-y-1 text-xs\">\n                <div className=\"text-green-600\">✓ {mod.advantage}</div>\n                <div className=\"text-red-600\">✗ {mod.disadvantage}</div>\n              </div>\n            </button>\n          ))}\n        </div>\n      </section>\n\n      {/* Power-up Preferences */}\n      <section className=\"mb-8\">\n        <h3 className=\"text-lg font-semibold text-slate-700 mb-4\">Power-up Preferences</h3>\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          {[\n            { key: \"slowTime\", label: \"Slow Time\", icon: Zap },\n            { key: \"shield\", label: \"Shield\", icon: Shield },\n            { key: \"doublePoints\", label: \"Double Points\", icon: Star },\n            { key: \"speedBoost\", label: \"Speed Boost\", icon: Target },\n          ].map(({ key, label, icon: Icon }) => (\n            <label\n              key={key}\n              className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${\n                powerUps[key as keyof typeof powerUps]\n                  ? \"border-blue-500 bg-blue-50\"\n                  : \"border-slate-200 bg-white hover:border-slate-300\"\n              }`}\n            >\n              <input\n                type=\"checkbox\"\n                checked={powerUps[key as keyof typeof powerUps]}\n                onChange={(e) =>\n                  setPowerUps((prev) => ({\n                    ...prev,\n                    [key]: e.target.checked,\n                  }))\n                }\n                className=\"sr-only\"\n              />\n              <div className=\"flex flex-col items-center gap-2\">\n                <Icon className=\"w-6 h-6 text-slate-700\" />\n                <div className=\"text-sm font-medium text-slate-900\">{label}</div>\n              </div>\n            </label>\n          ))}\n        </div>\n      </section>\n\n      {/* Summary */}\n      <div className=\"mb-6 p-4 bg-slate-50 rounded-xl\">\n        <div className=\"text-sm font-medium text-slate-700 mb-2\">Your Setup:</div>\n        <div className=\"text-sm text-slate-600 space-y-1\">\n          <div>\n            <strong>Character:</strong> {selectedCharacterData.name} - {selectedCharacterData.description}\n          </div>\n          <div>\n            <strong>Modifier:</strong> {selectedModifierData.name} - {selectedModifierData.description}\n          </div>\n          <div>\n            <strong>Power-ups enabled:</strong> {Object.values(powerUps).filter(Boolean).length}/4\n          </div>\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex gap-4 justify-end\">\n        <button\n          onClick={onCancel}\n          className=\"px-6 py-3 rounded-xl border border-slate-300 bg-white text-slate-700 font-semibold hover:bg-slate-50 transition-colors\"\n        >\n          Cancel\n        </button>\n        <button\n          onClick={handleStart}\n          className=\"px-6 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold hover:from-blue-700 hover:to-blue-800 transition-all shadow-lg flex items-center gap-2\"\n        >\n          <Play className=\"w-5 h-5\" />\n          Start Mission\n        </button>\n      </div>\n    </div>\n  );\n}\n\n","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport type { MissionDefinition } from \"@/games/missions/types\";\nimport { X, Target, Star, Clock } from \"lucide-react\";\n\ninterface MissionBriefingProps {\n  mission: MissionDefinition;\n  onStart: () => void;\n  onSkip: () => void;\n  charisVoice?: { speak: (text: string) => void };\n}\n\nexport function MissionBriefing({ mission, onStart, onSkip, charisVoice }: MissionBriefingProps) {\n  const [showBriefing, setShowBriefing] = useState(true);\n  const [autoStartTimer, setAutoStartTimer] = useState(5);\n\n  useEffect(() => {\n    // Speak the briefing\n    if (charisVoice && showBriefing) {\n      // Type guard for CharisVoice instance\n      if ('speak' in charisVoice && typeof (charisVoice as any).speak === 'function') {\n        // Try calling with interrupt parameter\n        try {\n          (charisVoice as any).speak(mission.briefing, 10, true);\n        } catch {\n          // Fallback to single parameter\n          (charisVoice as any).speak(mission.briefing);\n        }\n      }\n    }\n\n    // Auto-start countdown\n    const timer = setInterval(() => {\n      setAutoStartTimer((prev) => {\n        if (prev <= 1) {\n          clearInterval(timer);\n          handleStart();\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [mission.briefing, charisVoice, showBriefing]);\n\n  const handleStart = () => {\n    setShowBriefing(false);\n    onStart();\n  };\n\n  if (!showBriefing) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\">\n      <div className=\"w-full max-w-2xl mx-4 bg-white rounded-2xl shadow-2xl p-8 relative\">\n        <button\n          onClick={onSkip}\n          className=\"absolute top-4 right-4 p-2 rounded-lg hover:bg-slate-100 transition-colors\"\n          aria-label=\"Skip briefing\"\n        >\n          <X className=\"w-5 h-5 text-slate-600\" />\n        </button>\n\n        <div className=\"mb-6\">\n          <h2 className=\"text-3xl font-bold text-slate-900 mb-2\">Mission {mission.id}: {mission.title}</h2>\n          <p className=\"text-lg text-slate-600\">{mission.description}</p>\n        </div>\n\n        <div className=\"mb-6 p-6 bg-slate-50 rounded-xl\">\n          <h3 className=\"text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2\">\n            <Target className=\"w-5 h-5\" />\n            Briefing\n          </h3>\n          <p className=\"text-slate-700 leading-relaxed\">{mission.briefing}</p>\n        </div>\n\n        <div className=\"mb-6\">\n          <h3 className=\"text-lg font-semibold text-slate-700 mb-3\">Objectives</h3>\n          <div className=\"space-y-2\">\n            {mission.objectives.map((obj) => (\n              <div key={obj.id} className=\"flex items-start gap-3 p-3 bg-white border border-slate-200 rounded-lg\">\n                <div className=\"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 mt-0.5\">\n                  <div className=\"w-2 h-2 rounded-full bg-blue-600\" />\n                </div>\n                <div className=\"flex-1\">\n                  <div className=\"font-medium text-slate-900\">{obj.description}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {mission.sideQuests.length > 0 && (\n          <div className=\"mb-6\">\n            <h3 className=\"text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2\">\n              <Star className=\"w-5 h-5\" />\n              Side Quests\n            </h3>\n            <div className=\"space-y-2\">\n              {mission.sideQuests.map((quest) => (\n                <div key={quest.id} className=\"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                  <Star className=\"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5\" />\n                  <div className=\"flex-1\">\n                    <div className=\"font-medium text-slate-900\">{quest.description}</div>\n                    <div className=\"text-sm text-slate-600 mt-1\">Reward: {quest.reward} points</div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        <div className=\"flex items-center justify-between pt-4 border-t border-slate-200\">\n          <div className=\"flex items-center gap-2 text-slate-600\">\n            <Clock className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Duration: ~{Math.round(mission.durationMs / 1000 / 60)} minutes</span>\n          </div>\n          <div className=\"flex gap-3\">\n            <button\n              onClick={onSkip}\n              className=\"px-6 py-2 rounded-xl border border-slate-300 bg-white text-slate-700 font-semibold hover:bg-slate-50 transition-colors\"\n            >\n              Skip\n            </button>\n            <button\n              onClick={handleStart}\n              className=\"px-6 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold hover:from-blue-700 hover:to-blue-800 transition-all shadow-lg\"\n            >\n              {autoStartTimer > 0 ? `Start in ${autoStartTimer}s` : \"Start Now\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n","\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { X } from \"lucide-react\";\n\ninterface FullscreenGameModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  title?: string;\n}\n\nexport function FullscreenGameModal({ isOpen, onClose, children, title }: FullscreenGameModalProps) {\n  const modalRef = useRef<HTMLDivElement>(null);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  useEffect(() => {\n    if (!isOpen) return;\n\n    // Try to enter fullscreen\n    const enterFullscreen = async () => {\n      const element = modalRef.current;\n      if (!element) return;\n\n      try {\n        if (element.requestFullscreen) {\n          await element.requestFullscreen();\n        } else if ((element as any).webkitRequestFullscreen) {\n          await (element as any).webkitRequestFullscreen();\n        } else if ((element as any).mozRequestFullScreen) {\n          await (element as any).mozRequestFullScreen();\n        } else if ((element as any).msRequestFullscreen) {\n          await (element as any).msRequestFullscreen();\n        }\n        setIsFullscreen(true);\n      } catch (err) {\n        console.log(\"Fullscreen not available:\", err);\n        setIsFullscreen(false);\n      }\n    };\n\n    enterFullscreen();\n\n    const handleFullscreenChange = () => {\n      const isCurrentlyFullscreen = !!(\n        document.fullscreenElement ||\n        (document as any).webkitFullscreenElement ||\n        (document as any).mozFullScreenElement ||\n        (document as any).msFullscreenElement\n      );\n      setIsFullscreen(isCurrentlyFullscreen);\n    };\n\n    document.addEventListener(\"fullscreenchange\", handleFullscreenChange);\n    document.addEventListener(\"webkitfullscreenchange\", handleFullscreenChange);\n    document.addEventListener(\"mozfullscreenchange\", handleFullscreenChange);\n    document.addEventListener(\"MSFullscreenChange\", handleFullscreenChange);\n\n    return () => {\n      document.removeEventListener(\"fullscreenchange\", handleFullscreenChange);\n      document.removeEventListener(\"webkitfullscreenchange\", handleFullscreenChange);\n      document.removeEventListener(\"mozfullscreenchange\", handleFullscreenChange);\n      document.removeEventListener(\"MSFullscreenChange\", handleFullscreenChange);\n    };\n  }, [isOpen]);\n\n  const exitFullscreen = async () => {\n    try {\n      if (document.exitFullscreen) {\n        await document.exitFullscreen();\n      } else if ((document as any).webkitExitFullscreen) {\n        await (document as any).webkitExitFullscreen();\n      } else if ((document as any).mozCancelFullScreen) {\n        await (document as any).mozCancelFullScreen();\n      } else if ((document as any).msExitFullscreen) {\n        await (document as any).msExitFullscreen();\n      }\n    } catch (err) {\n      console.log(\"Error exiting fullscreen:\", err);\n    }\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      ref={modalRef}\n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black\"\n      style={{ display: isOpen ? \"flex\" : \"none\" }}\n    >\n      <div className=\"relative w-full h-full flex flex-col\">\n        {title && (\n          <div className=\"absolute top-0 left-0 right-0 z-10 bg-black/80 backdrop-blur-sm border-b border-white/10 p-4\">\n            <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\n              <h2 className=\"text-white font-semibold text-lg\">{title}</h2>\n              <button\n                onClick={exitFullscreen}\n                className=\"p-2 rounded-lg hover:bg-white/10 transition-colors\"\n                aria-label=\"Close\"\n              >\n                <X className=\"w-5 h-5 text-white\" />\n              </button>\n            </div>\n          </div>\n        )}\n        <div className=\"flex-1 w-full h-full overflow-hidden\">{children}</div>\n      </div>\n    </div>\n  );\n}\n\n","export type CanvasView = {\n  canvas: HTMLCanvasElement;\n  ctx2d: CanvasRenderingContext2D;\n  width: number;\n  height: number;\n  dpr: number;\n  dispose: () => void;\n};\n\nfunction clamp(n: number, min: number, max: number) {\n  return Math.max(min, Math.min(max, n));\n}\n\nexport function createCanvasView(canvas: HTMLCanvasElement): CanvasView {\n  const ctx2d = canvas.getContext(\"2d\", { alpha: true, desynchronized: true });\n  if (!ctx2d) throw new Error(\"Canvas 2D context unavailable\");\n\n  const state: CanvasView = {\n    canvas,\n    ctx2d,\n    width: 1,\n    height: 1,\n    dpr: 1,\n    dispose: () => {},\n  };\n\n  const resize = () => {\n    const rect = canvas.getBoundingClientRect();\n    const dpr = clamp(typeof window !== \"undefined\" ? window.devicePixelRatio || 1 : 1, 1, 3);\n    const w = Math.max(1, Math.round(rect.width));\n    const h = Math.max(1, Math.round(rect.height));\n    state.dpr = dpr;\n    state.width = w;\n    state.height = h;\n    canvas.width = Math.max(1, Math.round(w * dpr));\n    canvas.height = Math.max(1, Math.round(h * dpr));\n    ctx2d.setTransform(dpr, 0, 0, dpr, 0, 0);\n  };\n\n  const ro = new ResizeObserver(() => resize());\n  ro.observe(canvas);\n  resize();\n\n  state.dispose = () => {\n    try {\n      ro.disconnect();\n    } catch {\n      // ignore\n    }\n  };\n\n  return state;\n}\n\n\n","import type { GameContext, GameScene, GameSceneWithSignals, GameSettings, InputState } from \"./types\";\n\nexport type LoopHandle = {\n  start: () => void;\n  stop: () => void;\n  setPaused: (paused: boolean) => void;\n  isPaused: () => boolean;\n  dispose: () => void;\n};\n\nexport function createFixedTimestepLoop(opts: {\n  canvas: HTMLCanvasElement;\n  ctx2d: CanvasRenderingContext2D;\n  getSize: () => { width: number; height: number; dpr: number };\n  scene: GameScene;\n  getInput: () => InputState;\n  getSettings: () => GameSettings;\n  onFrameEnd?: () => void;\n  onStep?: (ctx: GameContext) => void;\n  onRender?: (ctx: GameContext) => void;\n}): LoopHandle {\n  const dtMs = 1000 / 60;\n  const maxFrameMs = 1000 / 10;\n  const maxSteps = 6;\n\n  let running = false;\n  let paused = false;\n  let raf = 0;\n  let last = 0;\n  let acc = 0;\n\n  const onVis = () => {\n    if (document.visibilityState === \"hidden\") {\n      acc = 0;\n      last = performance.now();\n    }\n  };\n  document.addEventListener(\"visibilitychange\", onVis);\n\n  const tick = (now: number) => {\n    if (!running) return;\n    raf = requestAnimationFrame(tick);\n    if (paused) return;\n\n    if (!last) last = now;\n    const frameMs = Math.min(maxFrameMs, Math.max(0, now - last));\n    last = now;\n    acc += frameMs;\n\n    const size = opts.getSize();\n    const input = opts.getInput();\n    const settings = opts.getSettings();\n\n    let steps = 0;\n    while (acc >= dtMs && steps < maxSteps) {\n      const ctx: GameContext = {\n        nowMs: now,\n        dtMs,\n        canvas: opts.canvas,\n        ctx2d: opts.ctx2d,\n        width: size.width,\n        height: size.height,\n        dpr: size.dpr,\n        input,\n        settings,\n      };\n      opts.onStep?.(ctx);\n      opts.scene.update(ctx);\n      acc -= dtMs;\n      steps += 1;\n    }\n\n    const renderCtx: GameContext = {\n      nowMs: now,\n      dtMs,\n      canvas: opts.canvas,\n      ctx2d: opts.ctx2d,\n      width: size.width,\n      height: size.height,\n      dpr: size.dpr,\n      input,\n      settings,\n    };\n    opts.onRender?.(renderCtx);\n    opts.scene.render(renderCtx);\n    opts.onFrameEnd?.();\n  };\n\n  return {\n    start: () => {\n      if (running) return;\n      running = true;\n      paused = false;\n      last = 0;\n      acc = 0;\n      opts.scene.init();\n      raf = requestAnimationFrame(tick);\n    },\n    stop: () => {\n      running = false;\n      paused = false;\n      if (raf) cancelAnimationFrame(raf);\n      raf = 0;\n      acc = 0;\n      last = 0;\n    },\n    setPaused: (p) => {\n      paused = Boolean(p);\n      if (!paused) {\n        acc = 0;\n        last = performance.now();\n      }\n    },\n    isPaused: () => paused,\n    dispose: () => {\n      running = false;\n      if (raf) cancelAnimationFrame(raf);\n      document.removeEventListener(\"visibilitychange\", onVis);\n    },\n  };\n}\n\n\n","import type { InputState } from \"./types\";\n\nexport type InputBindings = {\n  left: string[];\n  right: string[];\n  up: string[];\n  down: string[];\n  pause: string[];\n};\n\nconst DEFAULT_BINDINGS: InputBindings = {\n  left: [\"ArrowLeft\", \"a\"],\n  right: [\"ArrowRight\", \"d\"],\n  up: [\"ArrowUp\", \"w\"],\n  down: [\"ArrowDown\", \"s\"],\n  pause: [\"Escape\", \"p\"],\n};\n\nexport type InputController = {\n  getState: () => InputState;\n  resetFrame: () => void;\n  dispose: () => void;\n  bindings: InputBindings;\n};\n\nexport function createInputController(target: HTMLElement | Window, bindings: Partial<InputBindings> = {}): InputController {\n  const b: InputBindings = { ...DEFAULT_BINDINGS, ...bindings };\n  const pressed = new Set<string>();\n  let pausePressed = false;\n  let actionPressed = false;\n  let actionJustPressed = false;\n  let lastActionState = false;\n\n  const state: InputState = {\n    moveX: 0,\n    moveY: 0,\n    pausePressed: false,\n    actionPressed: false,\n    shootPressed: false,\n    shootJustPressed: false,\n  };\n\n  const recomputeAxes = () => {\n    // Keyboard input\n    const left = b.left.some((k) => pressed.has(k));\n    const right = b.right.some((k) => pressed.has(k));\n    const up = b.up.some((k) => pressed.has(k));\n    const down = b.down.some((k) => pressed.has(k));\n    \n    let keyX = (right ? 1 : 0) + (left ? -1 : 0);\n    let keyY = (down ? 1 : 0) + (up ? -1 : 0);\n    \n    // Touch input: continuous movement relative to touch start\n    if (touchActive) {\n      const touchDx = touchCurrentX - touchStartX;\n      const touchDy = touchCurrentY - touchStartY;\n      const touchDist = Math.sqrt(touchDx * touchDx + touchDy * touchDy);\n      \n      if (touchDist > CONTINUOUS_TOUCH_THRESHOLD) {\n        // Normalize and scale touch input\n        const scale = Math.min(1, touchDist / 100); // Max movement at 100px\n        const touchX = (touchDx / touchDist) * scale;\n        const touchY = (touchDy / touchDist) * scale;\n        // Touch takes priority over keyboard\n        state.moveX = touchX;\n        state.moveY = touchY;\n        return;\n      }\n    }\n    \n    // Use keyboard input\n    state.moveX = keyX;\n    state.moveY = keyY;\n  };\n\n  const onKeyDown = (e: KeyboardEvent) => {\n    pressed.add(e.key);\n    if (b.pause.includes(e.key)) pausePressed = true;\n    // Handle shooting keys (Space, Enter, Z, X)\n    if (e.key === \" \" || e.key === \"Enter\" || e.key === \"z\" || e.key === \"Z\" || e.key === \"x\" || e.key === \"X\") {\n      if (!lastActionState) {\n        actionJustPressed = true;\n      }\n      actionPressed = true;\n      lastActionState = true;\n    }\n    recomputeAxes();\n  };\n  const onKeyUp = (e: KeyboardEvent) => {\n    pressed.delete(e.key);\n    // Handle shooting keys release\n    if (e.key === \" \" || e.key === \"Enter\" || e.key === \"z\" || e.key === \"Z\" || e.key === \"x\" || e.key === \"X\") {\n      actionPressed = false;\n      lastActionState = false;\n    }\n    recomputeAxes();\n  };\n\n  // Pointer/touch input: supports both continuous movement (for touch) and swipe impulses\n  let touchActive = false;\n  let touchStartX = 0;\n  let touchStartY = 0;\n  let touchCurrentX = 0;\n  let touchCurrentY = 0;\n  let swipeStart: { x: number; y: number; t: number } | null = null;\n  const SWIPE_MIN_PX = 22;\n  const SWIPE_MAX_MS = 700;\n  const TAP_MAX_PX = 10;\n  const TAP_MAX_MS = 350;\n  const CONTINUOUS_TOUCH_THRESHOLD = 5; // Pixels to move before registering continuous input\n\n  const onPointerDown = (e: PointerEvent) => {\n    if (e.pointerType === \"mouse\" && e.button !== 0) return;\n    \n    // For touch devices, enable continuous movement\n    if (e.pointerType === \"touch\") {\n      touchActive = true;\n      touchStartX = e.clientX;\n      touchStartY = e.clientY;\n      touchCurrentX = e.clientX;\n      touchCurrentY = e.clientY;\n      swipeStart = { x: e.clientX, y: e.clientY, t: Date.now() };\n    } else {\n      // For mouse, use swipe behavior\n      swipeStart = { x: e.clientX, y: e.clientY, t: Date.now() };\n    }\n  };\n  \n  const onPointerMove = (e: PointerEvent) => {\n    if (!touchActive || e.pointerType !== \"touch\") return;\n    touchCurrentX = e.clientX;\n    touchCurrentY = e.clientY;\n  };\n  \n  const onPointerUp = (e: PointerEvent) => {\n    if (!swipeStart) {\n      touchActive = false;\n      state.moveX = 0;\n      state.moveY = 0;\n      return;\n    }\n    \n    const dt = Date.now() - swipeStart.t;\n    const dx = e.clientX - swipeStart.x;\n    const dy = e.clientY - swipeStart.y;\n    \n    if (touchActive && e.pointerType === \"touch\") {\n      // Touch device: check if it was a swipe or continuous movement\n      touchActive = false;\n      const moveDx = touchCurrentX - touchStartX;\n      const moveDy = touchCurrentY - touchStartY;\n      \n      // If moved significantly, treat as continuous (already handled in move handler)\n      if (Math.abs(moveDx) > CONTINUOUS_TOUCH_THRESHOLD || Math.abs(moveDy) > CONTINUOUS_TOUCH_THRESHOLD) {\n        swipeStart = null;\n        state.moveX = 0;\n        state.moveY = 0;\n        return;\n      }\n    }\n    \n    swipeStart = null;\n    touchActive = false;\n    \n    if (dt > SWIPE_MAX_MS) return;\n    const adx = Math.abs(dx);\n    const ady = Math.abs(dy);\n    // Tap => one-frame action (shooting)\n    if (dt <= TAP_MAX_MS && Math.max(adx, ady) <= TAP_MAX_PX) {\n      actionPressed = true;\n      actionJustPressed = true;\n      return;\n    }\n    if (Math.max(adx, ady) < SWIPE_MIN_PX) return;\n    // impulse for one frame\n    if (adx >= ady) {\n      state.moveX = dx > 0 ? 1 : -1;\n      state.moveY = 0;\n    } else {\n      state.moveY = dy > 0 ? 1 : -1;\n      state.moveX = 0;\n    }\n  };\n  \n  const onPointerCancel = () => {\n    touchActive = false;\n    swipeStart = null;\n    state.moveX = 0;\n    state.moveY = 0;\n  };\n\n  const add = (t: any, type: string, fn: any, opts?: any) => t.addEventListener(type, fn, opts);\n  const remove = (t: any, type: string, fn: any, opts?: any) => t.removeEventListener(type, fn, opts);\n\n  add(target, \"keydown\", onKeyDown);\n  add(target, \"keyup\", onKeyUp);\n  // Pointer events only if target is an Element\n  if (typeof (target as any).addEventListener === \"function\") {\n    add(target, \"pointerdown\", onPointerDown, { passive: true } as any);\n    add(target, \"pointermove\", onPointerMove, { passive: true } as any);\n    add(target, \"pointerup\", onPointerUp, { passive: true } as any);\n    add(target, \"pointercancel\", onPointerCancel, { passive: true } as any);\n  }\n\n  return {\n    bindings: b,\n    getState: (): InputState => {\n      recomputeAxes(); // Always recompute to handle continuous touch input\n      state.pausePressed = pausePressed;\n      state.actionPressed = actionPressed;\n      state.shootPressed = actionPressed;\n      state.shootJustPressed = actionJustPressed;\n      const result: InputState = {\n        moveX: state.moveX,\n        moveY: state.moveY,\n        pausePressed: state.pausePressed,\n        actionPressed: state.actionPressed,\n        shootPressed: state.shootPressed,\n        shootJustPressed: state.shootJustPressed,\n      };\n      return result;\n    },\n    resetFrame: () => {\n      pausePressed = false;\n      actionPressed = false;\n      actionJustPressed = false;\n      // Clear swipe impulses (keyboard state will be recomputed via key events).\n      recomputeAxes();\n    },\n    dispose: () => {\n      remove(target, \"keydown\", onKeyDown);\n      remove(target, \"keyup\", onKeyUp);\n      if (typeof (target as any).removeEventListener === \"function\") {\n        remove(target, \"pointerdown\", onPointerDown, { passive: true } as any);\n        remove(target, \"pointermove\", onPointerMove, { passive: true } as any);\n        remove(target, \"pointerup\", onPointerUp, { passive: true } as any);\n        remove(target, \"pointercancel\", onPointerCancel, { passive: true } as any);\n      }\n      touchActive = false;\n      swipeStart = null;\n    },\n  };\n}\n\n\n","export type AudioController = {\n  setMuted: (muted: boolean) => void;\n  start: () => void;\n  stop: () => void;\n  setIntensity: (v: number) => void; // 0..1\n  setTension: (v: number) => void; // 0..1\n  cueMilestone: () => void;\n  cueFail: () => void;\n  playClick: () => void;\n  dispose: () => void;\n};\n\nfunction clamp01(v: number) {\n  if (!Number.isFinite(v)) return 0;\n  return Math.max(0, Math.min(1, v));\n}\n\n// Tiny oscillator-based adaptive audio; no external assets required.\nexport function createAudioController(): AudioController {\n  let muted = false;\n  let ctx: AudioContext | null = null;\n  let master: GainNode | null = null;\n  let musicGain: GainNode | null = null;\n  let tensionGain: GainNode | null = null;\n  let filter: BiquadFilterNode | null = null;\n  let bass: OscillatorNode | null = null;\n  let lead: OscillatorNode | null = null;\n  let lfo: OscillatorNode | null = null;\n  let lfoGain: GainNode | null = null;\n  let started = false;\n  let intensity = 0;\n  let tension = 0;\n\n  const ensure = () => {\n    if (ctx) return ctx;\n    const A = (window as any).AudioContext || (window as any).webkitAudioContext;\n    if (!A) return null;\n    const c: AudioContext = new A();\n    ctx = c;\n    master = c.createGain();\n    master.gain.value = 0.0;\n    master.connect(c.destination);\n    return c;\n  };\n\n  const ensureGraph = () => {\n    const c = ensure();\n    if (!c) return null;\n    if (musicGain && filter && bass && lead && lfo && lfoGain && tensionGain && master) return c;\n\n    musicGain = c.createGain();\n    musicGain.gain.value = 0.06;\n\n    tensionGain = c.createGain();\n    tensionGain.gain.value = 0.0;\n\n    filter = c.createBiquadFilter();\n    filter.type = \"lowpass\";\n    filter.frequency.value = 520;\n    filter.Q.value = 0.7;\n\n    bass = c.createOscillator();\n    bass.type = \"sine\";\n    bass.frequency.value = 110;\n\n    lead = c.createOscillator();\n    lead.type = \"triangle\";\n    lead.frequency.value = 220;\n\n    lfo = c.createOscillator();\n    lfo.type = \"sine\";\n    lfo.frequency.value = 0.8;\n    lfoGain = c.createGain();\n    lfoGain.gain.value = 12;\n\n    // LFO gently wobbles lead pitch.\n    lfo.connect(lfoGain);\n    lfoGain.connect(lead.frequency);\n\n    // Routing: bass + lead -> filter -> musicGain -> master\n    bass.connect(filter);\n    lead.connect(filter);\n    filter.connect(musicGain);\n\n    // Tension layer: a quiet high sine that fades in as tension rises.\n    const tensionOsc = c.createOscillator();\n    tensionOsc.type = \"sine\";\n    tensionOsc.frequency.value = 660;\n    tensionOsc.connect(tensionGain);\n    tensionGain.connect(master!);\n\n    musicGain.connect(master!);\n\n    bass.start();\n    lead.start();\n    lfo.start();\n    tensionOsc.start();\n\n    return c;\n  };\n\n  const applyParams = () => {\n    if (!ctx || !master || !musicGain || !filter || !lead || !bass || !tensionGain) return;\n    const t = ctx.currentTime;\n\n    // Master volume with a gentle attack/decay.\n    const targetMaster = muted ? 0 : 0.85;\n    master.gain.cancelScheduledValues(t);\n    master.gain.setTargetAtTime(targetMaster, t, 0.06);\n\n    // Intensity increases perceived tempo: raise filter cutoff + subtle pitch lift.\n    const i = clamp01(intensity);\n    const te = clamp01(tension);\n\n    const cutoff = 420 + i * 1200;\n    filter.frequency.cancelScheduledValues(t);\n    filter.frequency.setTargetAtTime(cutoff, t, 0.08);\n\n    lead.frequency.cancelScheduledValues(t);\n    lead.frequency.setTargetAtTime(200 + i * 140, t, 0.08);\n    bass.frequency.cancelScheduledValues(t);\n    bass.frequency.setTargetAtTime(96 + i * 48, t, 0.08);\n\n    // Tension layer: fade in and slightly raise pitch.\n    tensionGain.gain.cancelScheduledValues(t);\n    tensionGain.gain.setTargetAtTime(muted ? 0 : te * 0.06, t, 0.08);\n  };\n\n  const playClick = () => {\n    if (muted) return;\n    const c = ensure();\n    if (!c) return;\n    try {\n      const o = c.createOscillator();\n      const g = c.createGain();\n      o.type = \"triangle\";\n      o.frequency.value = 440;\n      g.gain.value = 0.0001;\n      o.connect(g);\n      g.connect(c.destination);\n      const t = c.currentTime;\n      g.gain.setValueAtTime(0.0001, t);\n      g.gain.exponentialRampToValueAtTime(0.05, t + 0.01);\n      g.gain.exponentialRampToValueAtTime(0.0001, t + 0.08);\n      o.start(t);\n      o.stop(t + 0.09);\n    } catch {\n      // ignore\n    }\n  };\n\n  return {\n    setMuted: (m) => {\n      muted = Boolean(m);\n      applyParams();\n    },\n    start: () => {\n      if (started) return;\n      const c = ensureGraph();\n      if (!c) return;\n      started = true;\n      try {\n        // Some browsers require user gesture; resume if suspended.\n        if (c.state === \"suspended\") c.resume().catch(() => {});\n      } catch {\n        // ignore\n      }\n      applyParams();\n    },\n    stop: () => {\n      if (!ctx || !master) return;\n      const t = ctx.currentTime;\n      try {\n        master.gain.cancelScheduledValues(t);\n        master.gain.setTargetAtTime(0, t, 0.08);\n      } catch {\n        // ignore\n      }\n    },\n    setIntensity: (v) => {\n      intensity = clamp01(v);\n      applyParams();\n    },\n    setTension: (v) => {\n      tension = clamp01(v);\n      applyParams();\n    },\n    cueMilestone: () => {\n      if (muted) return;\n      const c = ensure();\n      if (!c) return;\n      try {\n        const o = c.createOscillator();\n        const g = c.createGain();\n        o.type = \"sine\";\n        o.frequency.value = 880;\n        g.gain.value = 0.0001;\n        o.connect(g);\n        g.connect(c.destination);\n        const t = c.currentTime;\n        g.gain.setValueAtTime(0.0001, t);\n        g.gain.exponentialRampToValueAtTime(0.03, t + 0.02);\n        g.gain.exponentialRampToValueAtTime(0.0001, t + 0.18);\n        o.start(t);\n        o.stop(t + 0.2);\n      } catch {\n        // ignore\n      }\n    },\n    cueFail: () => {\n      if (!ctx || !master) return;\n      const t = ctx.currentTime;\n      try {\n        master.gain.cancelScheduledValues(t);\n        master.gain.setTargetAtTime(0, t, 0.04);\n      } catch {\n        // ignore\n      }\n    },\n    playClick,\n    dispose: () => {\n      try {\n        ctx?.close();\n      } catch {\n        // ignore\n      }\n      ctx = null;\n      master = null;\n      musicGain = null;\n      tensionGain = null;\n      filter = null;\n      bass = null;\n      lead = null;\n      lfo = null;\n      lfoGain = null;\n      started = false;\n    },\n  };\n}\n\n\n","\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { createCanvasView } from \"@/games/engine/canvasView\";\nimport { createFixedTimestepLoop } from \"@/games/engine/loop\";\nimport { createInputController } from \"@/games/engine/input\";\nimport { createAudioController } from \"@/games/engine/audio\";\nimport { PersistStore } from \"@/games/engine/persist\";\nimport type { GameSettings, InputState } from \"@/games/engine/types\";\nimport type { MissionId } from \"@/games/missions/types\";\nimport type { PlayerChoice } from \"@/games/characters/types\";\nimport { createMissionScene } from \"@/games/scenes/missionScene\";\nimport { createCampaignProgressStore } from \"@/games/missions/progress\";\nimport { useAccessibility } from \"@/components/accessibility/AccessibilityProvider\";\n\ninterface MissionGameShellProps {\n  missionId: MissionId;\n  playerChoice: PlayerChoice;\n  onComplete: (won: boolean, stars: 0 | 1 | 2 | 3, objectivesCompleted: string[], sideQuestsCompleted: string[], timeMs: number) => void;\n  onCancel: () => void;\n}\n\nexport function MissionGameShell({ missionId, playerChoice, onComplete, onCancel }: MissionGameShellProps) {\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const store = useMemo(() => new PersistStore({ prefix: \"rn_games\", version: \"v1\" }), []);\n  const campaignProgress = useMemo(() => createCampaignProgressStore(store), [store]);\n  const [paused, setPaused] = useState(false);\n  const { prefs } = useAccessibility();\n  const [settings, setSettings] = useState<GameSettings>(() => ({\n    muted: store.get(\"muted\", false),\n    reduceMotion: store.get(\"reduceMotion\", false),\n    highContrast: store.get(\"highContrast\", true),\n  }));\n\n  useEffect(() => {\n    setSettings((s) => ({\n      ...s,\n      reduceMotion: prefs.reducedMotion,\n      highContrast: prefs.highContrast ?? s.highContrast ?? true,\n    }));\n  }, [prefs.reducedMotion, prefs.highContrast]);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const view = createCanvasView(canvas);\n    const canvasInput = createInputController(canvas);\n    const windowInput = createInputController(window);\n    const input = {\n      getState: (): InputState => {\n        const canvasState = canvasInput.getState();\n        const windowState = windowInput.getState();\n        return {\n          moveX: canvasState.moveX || windowState.moveX,\n          moveY: canvasState.moveY || windowState.moveY,\n          pausePressed: canvasState.pausePressed || windowState.pausePressed,\n          actionPressed: canvasState.actionPressed || windowState.actionPressed,\n          shootPressed: canvasState.shootPressed || windowState.shootPressed,\n          shootJustPressed: canvasState.shootJustPressed || windowState.shootJustPressed,\n        };\n      },\n      resetFrame: () => {\n        canvasInput.resetFrame();\n        windowInput.resetFrame();\n      },\n      dispose: () => {\n        canvasInput.dispose();\n        windowInput.dispose();\n      },\n      bindings: canvasInput.bindings,\n    };\n\n    const audio = createAudioController();\n    audio.setMuted(settings.muted);\n    audio.start();\n\n    campaignProgress.incrementAttempts(missionId);\n    campaignProgress.updateMissionStatus(missionId, \"in-progress\");\n\n    const scene = createMissionScene({\n      missionId,\n      playerChoice,\n      onComplete: (won, stars, objectivesCompleted, sideQuestsCompleted, timeMs) => {\n        if (won) {\n          campaignProgress.completeMission(missionId, stars, objectivesCompleted, sideQuestsCompleted, timeMs);\n          campaignProgress.addPoints(Math.floor(timeMs / 100) + stars * 100);\n        }\n        campaignProgress.updateMissionStatus(missionId, won ? \"completed\" : \"available\");\n        onComplete(won, stars, objectivesCompleted, sideQuestsCompleted, timeMs);\n      },\n      onAudio: (p) => {\n        audio.setIntensity(p.intensity);\n        audio.setTension(p.tension);\n      },\n      onMilestone: () => audio.cueMilestone(),\n    });\n\n    const loop = createFixedTimestepLoop({\n      canvas: view.canvas,\n      ctx2d: view.ctx2d,\n      getSize: () => ({ width: view.width, height: view.height, dpr: view.dpr }),\n      scene,\n      getInput: () => input.getState(),\n      getSettings: () => settings,\n      onFrameEnd: () => {\n        input.resetFrame();\n      },\n    });\n\n    loop.start();\n    loop.setPaused(paused);\n\n    const onKey = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") setPaused((p) => !p);\n    };\n    window.addEventListener(\"keydown\", onKey);\n\n    return () => {\n      window.removeEventListener(\"keydown\", onKey);\n      loop.dispose();\n      loop.stop();\n      scene.dispose();\n      view.dispose();\n      input.dispose();\n      audio.stop();\n      audio.dispose();\n    };\n  }, [missionId, playerChoice, settings, paused, campaignProgress, onComplete]);\n\n  return (\n    <div className=\"relative w-full h-full flex flex-col\">\n      <div className=\"absolute top-0 left-0 right-0 z-10 bg-black/80 backdrop-blur-sm border-b border-white/10 p-4\">\n        <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={onCancel}\n              className=\"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white font-semibold transition-colors\"\n            >\n              Exit\n            </button>\n            <button\n              onClick={() => setPaused((p) => !p)}\n              className=\"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white font-semibold transition-colors\"\n            >\n              {paused ? \"Resume\" : \"Pause\"}\n            </button>\n            <button\n              onClick={() => setSettings((s) => ({ ...s, muted: !s.muted }))}\n              className=\"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white font-semibold transition-colors\"\n            >\n              {settings.muted ? \"Unmute\" : \"Mute\"}\n            </button>\n          </div>\n        </div>\n      </div>\n      <div className=\"flex-1 w-full h-full overflow-hidden\">\n        <canvas ref={canvasRef} className=\"w-full h-full touch-none\" aria-label=\"Game canvas\" role=\"img\" />\n      </div>\n    </div>\n  );\n}\n\n","import type { GameScene } from \"@/games/engine/types\";\nimport { clear, drawHudText } from \"@/games/engine/ui\";\nimport type { MissionId, MissionDefinition } from \"@/games/missions/types\";\nimport { getMission } from \"@/games/missions/definitions\";\nimport type { PlayerChoice } from \"@/games/characters/types\";\nimport { CHARACTERS, DIFFICULTY_MODIFIERS } from \"@/games/characters/types\";\nimport type { Collectible, PowerUp, PowerUpType } from \"@/games/collectibles/types\";\nimport { COLLECTIBLE_VALUES, COLLECTIBLE_SPAWN_WEIGHTS, POWER_UP_DURATIONS, POWER_UP_SPAWN_WEIGHT } from \"@/games/collectibles/types\";\nimport type { Particle, ScreenShake, FlashEffect, ComboIndicator } from \"@/games/effects/types\";\nimport { CharisVoice } from \"@/games/characters/voice\";\nimport { hashStringToUint32, mulberry32 } from \"@/games/seed\";\nimport type { Enemy, EnemyType, EnemyPattern } from \"@/games/enemies/types\";\nimport { ENEMY_TYPE_WEIGHTS, ENEMY_PATTERN_WEIGHTS, ENEMY_HEALTH_BY_TYPE } from \"@/games/enemies/types\";\nimport { updateEnemyPattern, shouldSpawnHomingEnemy } from \"@/games/enemies/ai\";\nimport type { Projectile, WeaponType } from \"@/games/shooting/types\";\nimport { WEAPON_STATS, WEAPON_UPGRADE_PATH } from \"@/games/shooting/types\";\nimport { createWeaponState, addUpgradePoints, upgradeWeapon, createProjectile, updateProjectile } from \"@/games/shooting/weapons\";\nimport { createMovementTracker, createDangerZone, updateDangerZone, checkDangerZoneCollision, type DangerZone } from \"@/games/movement/force\";\nimport { renderProjectile } from \"@/games/effects/projectiles\";\nimport { createExplosion, updateExplosion, renderExplosion, createExplosionParticles, type Explosion } from \"@/games/effects/explosions\";\n\nexport function createMissionScene(opts?: {\n  missionId: MissionId;\n  playerChoice?: PlayerChoice;\n  onComplete?: (won: boolean, stars: 0 | 1 | 2 | 3, objectivesCompleted: string[], sideQuestsCompleted: string[], timeMs: number) => void;\n  onAudio?: (p: { intensity: number; tension: number }) => void;\n  onMilestone?: (s: number) => void;\n}): GameScene {\n  const missionId = opts?.missionId ?? 1;\n  const mission = getMission(missionId);\n  if (!mission) throw new Error(`Mission ${missionId} not found`);\n\n  const playerChoice = opts?.playerChoice ?? {\n    character: \"agent\",\n    powerUpPreferences: { slowTime: true, shield: true, doublePoints: true, speedBoost: true },\n  };\n  const character = CHARACTERS[playerChoice.character];\n  const difficultyModifier = playerChoice.difficultyModifier\n    ? DIFFICULTY_MODIFIERS.find((m) => m.id === playerChoice.difficultyModifier)\n    : null;\n\n  const seed = hashStringToUint32(`rn:mission:${missionId}:${Date.now()}`);\n  let rand = mulberry32(seed);\n\n  let startedAt = 0;\n  let runMs = 0;\n  let won = false;\n  let dead = false;\n\n  let px = 0;\n  let py = 0;\n  let pr = 9;\n\n  let t = 0;\n  const enemies: Enemy[] = [];\n  let nextSpawnMs = 0;\n  let lastMilestone = 0;\n\n  // Collectibles and power-ups\n  const collectibles: Collectible[] = [];\n  const powerUps: PowerUp[] = [];\n  let activePowerUps: Map<PowerUpType, { startTime: number; duration: number }> = new Map();\n\n  // Shooting system\n  const projectiles: Projectile[] = [];\n  const weaponState = createWeaponState();\n  let lastShotTime = 0;\n  let playerLives = 1; // Start with 1 life, can be extended\n  const maxLives = 3;\n\n  // Movement tracking and danger zones\n  const movementTracker = createMovementTracker();\n  const dangerZones: DangerZone[] = [];\n\n  // Combo system\n  let combo = 0;\n  let lastDodgeTime = 0;\n  const PERFECT_DODGE_WINDOW = character.stats.perfectDodgeWindow;\n  let perfectDodges = 0;\n  let totalPoints = 0;\n\n  // Visual effects\n  const particles: Particle[] = [];\n  let screenShake: ScreenShake | null = null;\n  let flashEffect: FlashEffect | null = null;\n  const comboIndicators: ComboIndicator[] = [];\n  const explosions: Explosion[] = [];\n\n  // Objectives tracking\n  const objectivesCompleted: string[] = [];\n  const sideQuestsCompleted: string[] = [];\n  let collectiblesCollected = 0;\n  let enemiesDestroyed = 0;\n\n  // Charis voice\n  const charisVoice = new CharisVoice();\n\n  // Difficulty calculation\n  const baseDifficulty = mission.difficulty;\n  const modifierMultiplier = difficultyModifier?.intensityMultiplier ?? 1.0;\n  const effectiveDifficulty = Math.min(1.0, baseDifficulty * modifierMultiplier);\n\n  const getDifficultyPhase = (ms: number): { phase: number; intensity: number } => {\n    const progress = ms / mission.durationMs;\n    const baseIntensity = 0.3 + effectiveDifficulty * 0.7;\n    const ramp = progress * 0.4;\n    return {\n      phase: Math.floor(progress * 5) + 1,\n      intensity: Math.min(0.99, baseIntensity + ramp),\n    };\n  };\n\n  const spawnEnemy = (w: number, h: number, intensity: number, playerStationary: boolean = false, playerStationaryTime: number = 0) => {\n    const lane = Math.floor(rand() * 5);\n    const gap = w / 6;\n    const x = Math.round((lane + 1) * gap);\n    const size = (18 + Math.round(rand() * 22)) * (0.9 + intensity * 0.3);\n    const speed = (80 + rand() * 120) * (0.8 + intensity * 0.6);\n\n    // Determine enemy type\n    let enemyType: EnemyType = \"destructible\";\n    const typeRoll = rand();\n    if (typeRoll < ENEMY_TYPE_WEIGHTS.destructible) {\n      enemyType = \"destructible\";\n    } else if (typeRoll < ENEMY_TYPE_WEIGHTS.destructible + ENEMY_TYPE_WEIGHTS.indestructible) {\n      enemyType = \"indestructible\";\n    } else if (shouldSpawnHomingEnemy(playerStationary, playerStationaryTime, ENEMY_TYPE_WEIGHTS.homing)) {\n      enemyType = \"homing\";\n    }\n\n    // Determine pattern\n    let pattern: EnemyPattern = \"straight\";\n    const patternRoll = rand();\n    if (patternRoll < ENEMY_PATTERN_WEIGHTS.straight) {\n      pattern = \"straight\";\n    } else if (patternRoll < ENEMY_PATTERN_WEIGHTS.straight + ENEMY_PATTERN_WEIGHTS.homing) {\n      pattern = \"homing\";\n    } else if (patternRoll < ENEMY_PATTERN_WEIGHTS.straight + ENEMY_PATTERN_WEIGHTS.homing + ENEMY_PATTERN_WEIGHTS.zigzag) {\n      pattern = \"zigzag\";\n    } else if (patternRoll < ENEMY_PATTERN_WEIGHTS.straight + ENEMY_PATTERN_WEIGHTS.homing + ENEMY_PATTERN_WEIGHTS.zigzag + ENEMY_PATTERN_WEIGHTS.spiral) {\n      pattern = \"spiral\";\n    } else if (patternRoll < ENEMY_PATTERN_WEIGHTS.straight + ENEMY_PATTERN_WEIGHTS.homing + ENEMY_PATTERN_WEIGHTS.zigzag + ENEMY_PATTERN_WEIGHTS.spiral + ENEMY_PATTERN_WEIGHTS.kamikaze) {\n      pattern = \"kamikaze\";\n    }\n\n    // Determine rewards for destructible enemies\n    let dropReward: \"points\" | \"life\" | \"star\" | \"weapon\" | \"powerup\" | undefined = undefined;\n    let rewardValue = 0;\n    if (enemyType === \"destructible\") {\n      const rewardRoll = rand();\n      if (rewardRoll < 0.5) {\n        dropReward = \"points\";\n        rewardValue = 10 + Math.floor(rand() * 20);\n      } else if (rewardRoll < 0.7) {\n        dropReward = \"powerup\";\n      } else if (rewardRoll < 0.85) {\n        dropReward = \"weapon\";\n      } else if (rewardRoll < 0.95) {\n        dropReward = \"star\";\n      } else {\n        dropReward = \"life\";\n      }\n    }\n\n    const health = ENEMY_HEALTH_BY_TYPE[enemyType];\n    const enemy: Enemy = {\n      id: `enemy-${Date.now()}-${rand()}`,\n      x,\n      y: -size - 6,\n      w: size,\n      h: size,\n      speed,\n      type: enemyType,\n      pattern,\n      health,\n      maxHealth: health,\n      dropReward,\n      rewardValue,\n    };\n\n    // Initialize pattern-specific data\n    if (pattern === \"zigzag\") {\n      enemy.patternData = {\n        zigzag: {\n          direction: rand() < 0.5 ? 1 : -1,\n          amplitude: 40,\n          frequency: 2,\n        },\n      };\n    } else if (pattern === \"spiral\") {\n      enemy.patternData = {\n        spiral: {\n          angle: 0,\n          radius: 30,\n          centerX: x,\n          centerY: -size - 6,\n        },\n      };\n    } else if (pattern === \"homing\" || enemyType === \"homing\") {\n      enemy.patternData = {\n        homing: {\n          targetX: px || w / 2,\n          targetY: py || h * 0.75,\n          prediction: 0.3,\n        },\n      };\n    }\n\n    enemies.push(enemy);\n  };\n\n  const spawnCollectible = (w: number, h: number) => {\n    const rarityRoll = rand();\n    let rarity: \"common\" | \"rare\" | \"epic\" = \"common\";\n    if (rarityRoll < COLLECTIBLE_SPAWN_WEIGHTS.epic) {\n      rarity = \"epic\";\n    } else if (rarityRoll < COLLECTIBLE_SPAWN_WEIGHTS.epic + COLLECTIBLE_SPAWN_WEIGHTS.rare) {\n      rarity = \"rare\";\n    }\n\n    const lane = Math.floor(rand() * 5);\n    const gap = w / 6;\n    const x = Math.round((lane + 1) * gap);\n    const y = -20;\n    collectibles.push({\n      id: `collect-${Date.now()}-${rand()}`,\n      x,\n      y,\n      radius: 8,\n      rarity,\n      value: COLLECTIBLE_VALUES[rarity],\n      collected: false,\n      spawnTime: runMs,\n      magnetRadius: character.stats.collectibleMagnet,\n    });\n  };\n\n  const spawnPowerUp = (w: number, h: number) => {\n    if (rand() > POWER_UP_SPAWN_WEIGHT) return;\n\n    const types: PowerUpType[] = [];\n    if (playerChoice.powerUpPreferences.slowTime) types.push(\"slow-time\");\n    if (playerChoice.powerUpPreferences.shield) types.push(\"shield\");\n    if (playerChoice.powerUpPreferences.doublePoints) types.push(\"double-points\");\n    if (playerChoice.powerUpPreferences.speedBoost) types.push(\"speed-boost\");\n\n    if (types.length === 0) return;\n\n    const type = types[Math.floor(rand() * types.length)];\n    const lane = Math.floor(rand() * 5);\n    const gap = w / 6;\n    const x = Math.round((lane + 1) * gap);\n    const y = -20;\n\n    powerUps.push({\n      id: `powerup-${Date.now()}-${rand()}`,\n      x,\n      y,\n      radius: 12,\n      type,\n      collected: false,\n      spawnTime: runMs,\n      active: false,\n      duration: POWER_UP_DURATIONS[type] * character.stats.shieldDuration,\n    });\n  };\n\n  const collideCircleRect = (cx: number, cy: number, cr: number, r: Enemy) => {\n    const rx = r.x - r.w / 2;\n    const ry = r.y - r.h / 2;\n    const closestX = Math.max(rx, Math.min(cx, rx + r.w));\n    const closestY = Math.max(ry, Math.min(cy, ry + r.h));\n    const dx = cx - closestX;\n    const dy = cy - closestY;\n    return dx * dx + dy * dy <= cr * cr;\n  };\n\n  const collideProjectileEnemy = (proj: Projectile, enemy: Enemy): boolean => {\n    const dx = proj.x - enemy.x;\n    const dy = proj.y - enemy.y;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n    return dist < proj.radius + Math.max(enemy.w, enemy.h) / 2;\n  };\n\n  const collideCircleCircle = (x1: number, y1: number, r1: number, x2: number, y2: number, r2: number) => {\n    const dx = x1 - x2;\n    const dy = y1 - y2;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n    return dist < r1 + r2;\n  };\n\n  const addParticles = (x: number, y: number, color: string, count = 10) => {\n    for (let i = 0; i < count; i++) {\n      particles.push({\n        x,\n        y,\n        vx: (rand() - 0.5) * 200,\n        vy: (rand() - 0.5) * 200,\n        life: 1.0,\n        maxLife: 0.5 + rand() * 0.5,\n        size: 2 + rand() * 4,\n        color,\n        alpha: 1.0,\n      });\n    }\n  };\n\n  const triggerScreenShake = (intensity: number, duration: number) => {\n    screenShake = { intensity, duration, startTime: runMs };\n  };\n\n  const triggerFlash = (color: string, intensity: number, duration: number) => {\n    flashEffect = { color, intensity, duration, startTime: runMs };\n  };\n\n  const dropReward = (x: number, y: number, rewardType: \"points\" | \"life\" | \"star\" | \"weapon\" | \"powerup\", value: number = 0) => {\n    if (rewardType === \"life\") {\n      if (playerLives < maxLives) {\n        playerLives++;\n        addParticles(x, y, \"#00ff00\", 20);\n        triggerFlash(\"#00ff00\", 0.3, 200);\n        charisVoice.speak(\"Life extended!\", 8, false);\n      }\n    } else if (rewardType === \"star\") {\n      activePowerUps.set(\"star-mode\", { startTime: runMs, duration: POWER_UP_DURATIONS[\"star-mode\"] });\n      addParticles(x, y, \"#ffff00\", 25);\n      triggerFlash(\"#ffff00\", 0.4, 300);\n      charisVoice.speak(\"Star mode activated!\", 9, false);\n    } else if (rewardType === \"weapon\") {\n      if (upgradeWeapon(weaponState)) {\n        addParticles(x, y, \"#ff00ff\", 20);\n        triggerFlash(\"#ff00ff\", 0.3, 200);\n        charisVoice.speak(\"Weapon upgraded!\", 9, false);\n      } else {\n        // Already at max, give points instead\n        totalPoints += 100;\n      }\n    } else if (rewardType === \"powerup\") {\n      const powerUpTypes: PowerUpType[] = [\"slow-time\", \"shield\", \"double-points\", \"speed-boost\", \"rapid-fire\", \"explosive-shots\"];\n      const type = powerUpTypes[Math.floor(rand() * powerUpTypes.length)];\n      powerUps.push({\n        id: `powerup-drop-${Date.now()}-${rand()}`,\n        x,\n        y,\n        radius: 12,\n        type,\n        collected: false,\n        spawnTime: runMs,\n        active: false,\n        duration: POWER_UP_DURATIONS[type] * character.stats.shieldDuration,\n      });\n    } else if (rewardType === \"points\") {\n      totalPoints += value;\n    }\n  };\n\n  const checkObjectives = () => {\n    // Check survive objective\n    const surviveObj = mission.objectives.find((o) => o.type === \"survive\");\n    if (surviveObj && runMs >= surviveObj.target && !objectivesCompleted.includes(surviveObj.id)) {\n      objectivesCompleted.push(surviveObj.id);\n    }\n\n    // Check collect objective\n    const collectObj = mission.objectives.find((o) => o.type === \"collect\");\n    if (collectObj && collectiblesCollected >= collectObj.target && !objectivesCompleted.includes(collectObj.id)) {\n      objectivesCompleted.push(collectObj.id);\n    }\n\n    // Check combo objective\n    const comboObj = mission.objectives.find((o) => o.type === \"combo\");\n    if (comboObj && combo >= comboObj.target && !objectivesCompleted.includes(comboObj.id)) {\n      objectivesCompleted.push(comboObj.id);\n    }\n\n    // Check perfect dodge objective\n    const perfectObj = mission.objectives.find((o) => o.type === \"perfect\");\n    if (perfectObj && perfectDodges >= perfectObj.target && !objectivesCompleted.includes(perfectObj.id)) {\n      objectivesCompleted.push(perfectObj.id);\n    }\n\n    // Check side quests\n    for (const quest of mission.sideQuests) {\n      if (sideQuestsCompleted.includes(quest.id)) continue;\n\n      let completed = false;\n      if (quest.id.includes(\"combo-\")) {\n        const target = parseInt(quest.id.match(/combo-(\\d+)/)?.[1] || \"0\");\n        if (combo >= target) completed = true;\n      } else if (quest.id.includes(\"collect-\")) {\n        const target = parseInt(quest.id.match(/collect-(\\d+)/)?.[1] || \"0\");\n        if (collectiblesCollected >= target) completed = true;\n      } else if (quest.id.includes(\"perfect-\")) {\n        const target = parseInt(quest.id.match(/perfect-(\\d+)/)?.[1] || \"0\");\n        if (perfectDodges >= target) completed = true;\n      } else if (quest.id.includes(\"no-hits\") || quest.id.includes(\"no-powerups\") || quest.id.includes(\"flawless\") || quest.id.includes(\"master\") || quest.id.includes(\"dedication\") || quest.id.includes(\"legend\")) {\n        // These are checked at mission end\n        continue;\n      }\n\n      if (completed) {\n        sideQuestsCompleted.push(quest.id);\n        totalPoints += quest.reward;\n      }\n    }\n  };\n\n  const calculateStars = (): 0 | 1 | 2 | 3 => {\n    const objectivesComplete = objectivesCompleted.length;\n    const sideQuestsComplete = sideQuestsCompleted.length;\n    const totalObjectives = mission.objectives.length;\n    const totalSideQuests = mission.sideQuests.length;\n\n    if (objectivesComplete === totalObjectives && sideQuestsComplete === totalSideQuests) return 3;\n    if (objectivesComplete === totalObjectives) return 2;\n    if (objectivesComplete >= totalObjectives * 0.7) return 1;\n    return 0;\n  };\n\n  return {\n    init() {\n      rand = mulberry32(seed);\n      startedAt = 0;\n      runMs = 0;\n      won = false;\n      dead = false;\n      t = 0;\n      enemies.length = 0;\n      collectibles.length = 0;\n      powerUps.length = 0;\n      activePowerUps.clear();\n      nextSpawnMs = 400;\n      px = 0;\n      py = 0;\n      combo = 0;\n      perfectDodges = 0;\n      totalPoints = 0;\n      collectiblesCollected = 0;\n      enemiesDestroyed = 0;\n      objectivesCompleted.length = 0;\n      sideQuestsCompleted.length = 0;\n      particles.length = 0;\n      comboIndicators.length = 0;\n      projectiles.length = 0;\n      dangerZones.length = 0;\n      explosions.length = 0;\n      screenShake = null;\n      flashEffect = null;\n      lastMilestone = 0;\n      lastShotTime = 0;\n      playerLives = 1;\n      weaponState.currentWeapon = \"basic\";\n      weaponState.upgradePoints = 0;\n      movementTracker.reset(px || 0, py || 0, 0);\n    },\n    update(ctx) {\n      if (!startedAt) {\n        startedAt = ctx.nowMs;\n        px = ctx.width / 2;\n        py = ctx.height * 0.75;\n        return;\n      }\n\n      if (dead) return;\n\n      const dt = ctx.dtMs;\n      t += dt;\n      runMs = ctx.nowMs - startedAt;\n\n      // Apply slow time power-up\n      const slowTimeActive = activePowerUps.has(\"slow-time\");\n      const effectiveDt = slowTimeActive ? dt * 0.5 : dt;\n\n      // Update power-ups\n      for (const [type, data] of activePowerUps.entries()) {\n        if (runMs - data.startTime >= data.duration) {\n          activePowerUps.delete(type);\n        }\n      }\n\n      // Difficulty-based spawn schedule\n      const { phase, intensity } = getDifficultyPhase(runMs);\n      if (t >= nextSpawnMs) {\n        const spawnMovementInfo = movementTracker.update(px, py, runMs);\n        spawnEnemy(ctx.width, ctx.height, intensity, spawnMovementInfo.isStationary, spawnMovementInfo.stationaryTime);\n        const base = 400 + rand() * 300;\n        const ramp = Math.max(150, 500 - (runMs / 1000) * 8 * intensity);\n        nextSpawnMs = t + Math.min(ramp, base);\n\n        // Spawn collectibles\n        if (rand() < 0.4) {\n          spawnCollectible(ctx.width, ctx.height);\n        }\n\n        // Spawn power-ups\n        spawnPowerUp(ctx.width, ctx.height);\n\n        // Multiple enemies in later phases\n        if (phase >= 3 && rand() < 0.3) {\n          spawnEnemy(ctx.width, ctx.height, intensity, spawnMovementInfo.isStationary, spawnMovementInfo.stationaryTime);\n        }\n        if (phase >= 5 && rand() < 0.2) {\n          spawnEnemy(ctx.width, ctx.height, intensity, spawnMovementInfo.isStationary, spawnMovementInfo.stationaryTime);\n        }\n      }\n\n      // Audio parameters\n      const audioIntensity = Math.max(0, Math.min(1, runMs / mission.durationMs));\n      const timeLeft = Math.max(0, mission.durationMs - runMs);\n      const tension = Math.max(0, Math.min(1, 1 - timeLeft / (mission.durationMs * 0.2)));\n      opts?.onAudio?.({ intensity: audioIntensity, tension });\n\n      // Milestones\n      const milestoneS = Math.floor((runMs / 1000) / (mission.durationMs / 1000 / 4)) * (mission.durationMs / 1000 / 4);\n      if (milestoneS > lastMilestone && milestoneS > 0) {\n        lastMilestone = milestoneS;\n        opts?.onMilestone?.(milestoneS);\n        charisVoice.speakLine(\"milestone\", false);\n      }\n\n      // Player movement\n      const speedMultiplier = activePowerUps.has(\"speed-boost\") ? 1.3 : 1.0;\n      const speed = (ctx.settings.reduceMotion ? 200 : 260) * character.stats.speed * speedMultiplier;\n      const oldPx = px;\n      const oldPy = py;\n      px += (ctx.input.moveX * speed * effectiveDt) / 1000;\n      py += (ctx.input.moveY * speed * effectiveDt) / 1000;\n      px = Math.max(14, Math.min(ctx.width - 14, px));\n      py = Math.max(14, Math.min(ctx.height - 14, py));\n\n      // Movement tracking\n      const movementInfo = movementTracker.update(px, py, runMs);\n      if (movementInfo.shouldSpawnDangerZone && dangerZones.length < 3) {\n        dangerZones.push(createDangerZone(px, py, runMs));\n      }\n\n      // Shooting system\n      const rapidFireMultiplier = activePowerUps.has(\"rapid-fire\") ? 0.5 : 1.0;\n      const weaponStats = WEAPON_STATS[weaponState.currentWeapon];\n      const cooldown = weaponStats.cooldown * rapidFireMultiplier;\n      const canShoot = runMs - lastShotTime >= cooldown;\n      const shouldShoot = ctx.input.shootPressed || ctx.input.shootJustPressed;\n\n      if (shouldShoot && canShoot) {\n        const newProjectiles = createProjectile(weaponState.currentWeapon, px, py);\n        projectiles.push(...newProjectiles);\n        lastShotTime = runMs;\n        addParticles(px, py - 10, \"#ffffff\", 5); // Muzzle flash\n      }\n\n      // Update enemies with AI patterns\n      const obstacleSpeedMultiplier = slowTimeActive ? 0.5 : 1.0;\n      for (const enemy of enemies) {\n        if (enemy.type === \"indestructible\" || enemy.health > 0) {\n          updateEnemyPattern(enemy, px, py, effectiveDt, ctx.width, ctx.height);\n          const s = enemy.speed * (ctx.settings.reduceMotion ? 0.9 : 1) * obstacleSpeedMultiplier;\n          if (enemy.pattern === \"straight\") {\n            enemy.y += (s * effectiveDt) / 1000;\n          }\n        }\n      }\n      while (enemies.length && enemies[0].y - enemies[0].h / 2 > ctx.height + 40) enemies.shift();\n\n      // Update projectiles\n      for (let i = projectiles.length - 1; i >= 0; i--) {\n        const proj = projectiles[i];\n        // Find nearest enemy for homing\n        let nearestEnemy: { x: number; y: number; id: string } | undefined = undefined;\n        let minDist = Infinity;\n        for (const enemy of enemies) {\n          if (enemy.type !== \"indestructible\" && enemy.health > 0) {\n            const dx = enemy.x - proj.x;\n            const dy = enemy.y - proj.y;\n            const dist = Math.sqrt(dx * dx + dy * dy);\n            if (dist < minDist) {\n              minDist = dist;\n              nearestEnemy = { x: enemy.x, y: enemy.y, id: enemy.id };\n            }\n          }\n        }\n\n        const keep = updateProjectile(proj, effectiveDt, ctx.width, ctx.height, nearestEnemy);\n        if (!keep) {\n          projectiles.splice(i, 1);\n          continue;\n        }\n\n        // Check projectile-enemy collisions\n        for (let j = enemies.length - 1; j >= 0; j--) {\n          const enemy = enemies[j];\n          if (enemy.type === \"indestructible\" || enemy.health <= 0) continue;\n\n          if (collideProjectileEnemy(proj, enemy)) {\n            // Hit!\n            enemy.health -= proj.damage;\n            if (activePowerUps.has(\"explosive-shots\")) {\n              // Area damage\n              for (const otherEnemy of enemies) {\n                if (otherEnemy.id !== enemy.id && otherEnemy.type !== \"indestructible\" && otherEnemy.health > 0) {\n                  const dx = otherEnemy.x - enemy.x;\n                  const dy = otherEnemy.y - enemy.y;\n                  const dist = Math.sqrt(dx * dx + dy * dy);\n                  if (dist < 60) {\n                    otherEnemy.health -= proj.damage * 0.5;\n                  }\n                }\n              }\n            }\n\n            // Create explosion\n            explosions.push(createExplosion(enemy.x, enemy.y, \"#ff8800\", 1.0));\n            particles.push(...createExplosionParticles(enemy.x, enemy.y, \"#ff8800\", 15));\n            triggerScreenShake(0.2, 150);\n\n            if (enemy.health <= 0) {\n              // Enemy destroyed\n              enemiesDestroyed++;\n              if (enemy.dropReward) {\n                dropReward(enemy.x, enemy.y, enemy.dropReward, enemy.rewardValue);\n              }\n              addUpgradePoints(weaponState, 10);\n              combo++;\n              totalPoints += 20 * (1 + combo * 0.1) * movementInfo.movementBonus;\n              enemies.splice(j, 1);\n            }\n\n            projectiles.splice(i, 1);\n            break;\n          }\n        }\n      }\n\n      // Update danger zones\n      for (let i = dangerZones.length - 1; i >= 0; i--) {\n        const zone = dangerZones[i];\n        if (!updateDangerZone(zone, runMs, effectiveDt)) {\n          dangerZones.splice(i, 1);\n          continue;\n        }\n\n        // Check player collision with danger zone\n        if (checkDangerZoneCollision(zone, px, py, pr) && !activePowerUps.has(\"star-mode\") && !activePowerUps.has(\"shield\")) {\n          playerLives--;\n          if (playerLives <= 0) {\n            dead = true;\n            won = false;\n            combo = 0;\n            triggerScreenShake(0.5, 300);\n            triggerFlash(\"#ff0000\", 0.5, 300);\n            charisVoice.speakLine(\"failure\", true);\n            const stars = calculateStars();\n            checkObjectives();\n            opts?.onComplete?.(false, stars, objectivesCompleted, sideQuestsCompleted, runMs);\n          } else {\n            triggerFlash(\"#ff8800\", 0.3, 200);\n            charisVoice.speak(\"Life lost!\", 7, false);\n          }\n          dangerZones.splice(i, 1);\n        }\n      }\n\n      // Update explosions\n      for (let i = explosions.length - 1; i >= 0; i--) {\n        if (!updateExplosion(explosions[i], effectiveDt)) {\n          explosions.splice(i, 1);\n        }\n      }\n\n      // Update collectibles\n      for (const c of collectibles) {\n        if (c.collected) continue;\n\n        // Magnet effect\n        if (c.magnetRadius && c.magnetRadius > 0) {\n          const dx = px - c.x;\n          const dy = py - c.y;\n          const dist = Math.sqrt(dx * dx + dy * dy);\n          if (dist < c.magnetRadius) {\n            const pull = (c.magnetRadius - dist) / c.magnetRadius;\n            c.x += (dx / dist) * pull * 300 * (effectiveDt / 1000);\n            c.y += (dy / dist) * pull * 300 * (effectiveDt / 1000);\n          }\n        }\n\n        c.y += 100 * (effectiveDt / 1000);\n        if (collideCircleCircle(px, py, pr, c.x, c.y, c.radius)) {\n          c.collected = true;\n          collectiblesCollected++;\n          const pointValue = c.value * (activePowerUps.has(\"double-points\") ? 2 : 1) * character.stats.comboMultiplier * (1 + combo * 0.1);\n          totalPoints += pointValue;\n          combo++;\n          addParticles(c.x, c.y, c.rarity === \"epic\" ? \"#ff00ff\" : c.rarity === \"rare\" ? \"#00ffff\" : \"#ffff00\", 8);\n          triggerScreenShake(0.1, 100);\n        }\n      }\n      collectibles.filter((c) => !c.collected && c.y > ctx.height + 40).forEach((c) => (c.collected = true));\n\n      // Update power-ups\n      for (const p of powerUps) {\n        if (p.collected) continue;\n        p.y += 100 * (effectiveDt / 1000);\n        if (collideCircleCircle(px, py, pr, p.x, p.y, p.radius)) {\n          p.collected = true;\n          p.active = true;\n          p.startTime = runMs;\n          if (p.type === \"life-extension\") {\n            if (playerLives < maxLives) {\n              playerLives++;\n              addParticles(p.x, p.y, \"#00ff00\", 20);\n              triggerFlash(\"#00ff00\", 0.3, 200);\n              charisVoice.speak(\"Life extended!\", 8, false);\n            }\n          } else {\n            activePowerUps.set(p.type, { startTime: runMs, duration: p.duration });\n            addParticles(p.x, p.y, \"#00ff00\", 15);\n            triggerScreenShake(0.2, 150);\n            triggerFlash(\"#00ff00\", 0.3, 200);\n            charisVoice.speakLine(\"encouragement\", false);\n          }\n        }\n      }\n      powerUps.filter((p) => !p.collected && p.y > ctx.height + 40).forEach((p) => (p.collected = true));\n\n      // Perfect dodge detection (check before collision)\n      for (const enemy of enemies) {\n        if (enemy.type === \"indestructible\" || enemy.health <= 0) continue;\n        const dx = px - enemy.x;\n        const dy = py - enemy.y;\n        const dist = Math.sqrt(dx * dx + dy * dy);\n        const minDist = pr + Math.max(enemy.w, enemy.h) / 2;\n        // Perfect dodge: very close but not colliding\n        if (dist < minDist + 25 && dist > minDist - 5 && !collideCircleRect(px, py, pr, enemy)) {\n          const timeSinceLastDodge = runMs - lastDodgeTime;\n          if (timeSinceLastDodge > PERFECT_DODGE_WINDOW) {\n            perfectDodges++;\n            combo++;\n            lastDodgeTime = runMs;\n            addParticles(enemy.x, enemy.y, \"#ffffff\", 12);\n            comboIndicators.push({\n              combo,\n              x: enemy.x,\n              y: enemy.y,\n              life: 1.0,\n              maxLife: 1.0,\n            });\n            charisVoice.speakLine(\"encouragement\", false);\n          }\n        }\n      }\n\n      // Collisions (check shield and star mode)\n      if (!activePowerUps.has(\"shield\") && !activePowerUps.has(\"star-mode\")) {\n        for (const enemy of enemies) {\n          if (enemy.type === \"indestructible\" || enemy.health <= 0) continue;\n          if (collideCircleRect(px, py, pr, enemy)) {\n            playerLives--;\n            if (playerLives <= 0) {\n              dead = true;\n              won = false;\n              combo = 0;\n              triggerScreenShake(0.5, 300);\n              triggerFlash(\"#ff0000\", 0.5, 300);\n              charisVoice.speakLine(\"failure\", true);\n              const stars = calculateStars();\n              checkObjectives();\n              opts?.onComplete?.(false, stars, objectivesCompleted, sideQuestsCompleted, runMs);\n            } else {\n              triggerFlash(\"#ff8800\", 0.3, 200);\n              charisVoice.speak(\"Life lost!\", 7, false);\n              // Remove the enemy that hit\n              const index = enemies.indexOf(enemy);\n              if (index >= 0) enemies.splice(index, 1);\n            }\n            break;\n          }\n        }\n      }\n\n      // Win condition\n      if (!dead && runMs >= mission.durationMs) {\n        dead = true;\n        won = true;\n        checkObjectives();\n        \n        // Check end-of-mission side quests\n        for (const quest of mission.sideQuests) {\n          if (sideQuestsCompleted.includes(quest.id)) continue;\n          \n          if (quest.id === \"no-hits\" && perfectDodges > 0) {\n            // Check if no hits were taken (shield might have been used, but no actual collisions)\n            sideQuestsCompleted.push(quest.id);\n            totalPoints += quest.reward;\n          } else if (quest.id === \"no-powerups\" && activePowerUps.size === 0) {\n            sideQuestsCompleted.push(quest.id);\n            totalPoints += quest.reward;\n          } else if (quest.id === \"flawless\") {\n            const perfectObj = mission.objectives.find(o => o.type === \"perfect\");\n            if (perfectObj && perfectDodges >= perfectObj.target) {\n              sideQuestsCompleted.push(quest.id);\n              totalPoints += quest.reward;\n            }\n          } else if (quest.id === \"master\" && objectivesCompleted.length === mission.objectives.length && sideQuestsCompleted.length === mission.sideQuests.length - 1) {\n            sideQuestsCompleted.push(quest.id);\n            totalPoints += quest.reward;\n          } else if (quest.id === \"dedication\" || quest.id === \"legend\") {\n            // Always complete dedication/legend if mission is completed\n            sideQuestsCompleted.push(quest.id);\n            totalPoints += quest.reward;\n          }\n        }\n        \n        const stars = calculateStars();\n        triggerScreenShake(0.3, 400);\n        triggerFlash(\"#00ff00\", 0.4, 500);\n        charisVoice.speakLine(\"victory\", true);\n        opts?.onComplete?.(true, stars, objectivesCompleted, sideQuestsCompleted, runMs);\n      }\n\n      // Update particles\n      for (let i = particles.length - 1; i >= 0; i--) {\n        const p = particles[i];\n        p.x += p.vx * (effectiveDt / 1000);\n        p.y += p.vy * (effectiveDt / 1000);\n        p.life -= effectiveDt / 1000 / p.maxLife;\n        p.alpha = p.life;\n        if (p.life <= 0) {\n          particles.splice(i, 1);\n        }\n      }\n\n      // Update combo indicators\n      for (let i = comboIndicators.length - 1; i >= 0; i--) {\n        const ind = comboIndicators[i];\n        ind.y -= 50 * (effectiveDt / 1000);\n        ind.life -= effectiveDt / 1000 / ind.maxLife;\n        if (ind.life <= 0) {\n          comboIndicators.splice(i, 1);\n        }\n      }\n\n      // Update screen shake\n      if (screenShake && runMs - screenShake.startTime >= screenShake.duration) {\n        screenShake = null;\n      }\n\n      // Update flash\n      if (flashEffect && runMs - flashEffect.startTime >= flashEffect.duration) {\n        flashEffect = null;\n      }\n\n      // Reset combo if too much time passes\n      if (runMs - lastDodgeTime > 2000) {\n        combo = 0;\n      }\n    },\n    render(ctx) {\n      clear(ctx.ctx2d, ctx.width, ctx.height);\n\n      // Screen shake offset\n      let shakeX = 0;\n      let shakeY = 0;\n      if (screenShake && !ctx.settings.reduceMotion) {\n        const elapsed = runMs - screenShake.startTime;\n        const progress = elapsed / screenShake.duration;\n        const intensity = screenShake.intensity * (1 - progress);\n        shakeX = (rand() - 0.5) * intensity * 20;\n        shakeY = (rand() - 0.5) * intensity * 20;\n      }\n\n      ctx.ctx2d.save();\n      ctx.ctx2d.translate(shakeX, shakeY);\n\n      // Background\n      ctx.ctx2d.save();\n      ctx.ctx2d.fillStyle = \"rgba(2,6,23,0.96)\";\n      ctx.ctx2d.fillRect(0, 0, ctx.width, ctx.height);\n      ctx.ctx2d.restore();\n\n      // Flash effect\n      if (flashEffect && !ctx.settings.reduceMotion) {\n        const elapsed = runMs - flashEffect.startTime;\n        const progress = elapsed / flashEffect.duration;\n        const alpha = flashEffect.intensity * (1 - progress);\n        ctx.ctx2d.save();\n        ctx.ctx2d.fillStyle = flashEffect.color;\n        ctx.ctx2d.globalAlpha = alpha;\n        ctx.ctx2d.fillRect(0, 0, ctx.width, ctx.height);\n        ctx.ctx2d.restore();\n      }\n\n      // Danger zones\n      for (const zone of dangerZones) {\n        if (!zone.active) continue;\n        ctx.ctx2d.save();\n        const alpha = 0.3 + Math.sin((runMs - zone.startTime) / 100) * 0.2;\n        ctx.ctx2d.globalAlpha = alpha;\n        ctx.ctx2d.strokeStyle = \"#ff0000\";\n        ctx.ctx2d.lineWidth = 3;\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(zone.x, zone.y, zone.radius, 0, Math.PI * 2);\n        ctx.ctx2d.stroke();\n        ctx.ctx2d.fillStyle = \"#ff0000\";\n        ctx.ctx2d.globalAlpha = alpha * 0.2;\n        ctx.ctx2d.fill();\n        ctx.ctx2d.restore();\n      }\n\n      // Enemies\n      ctx.ctx2d.save();\n      const brightColors = [\"#00ffff\", \"#ffff00\", \"#ff00ff\", \"#00ff00\", \"#ff8800\", \"#ff0088\"];\n      for (const enemy of enemies) {\n        if (enemy.health <= 0) continue;\n        const colorIndex = Math.floor((enemy.x + enemy.y) / 50) % brightColors.length;\n        let brightColor = brightColors[colorIndex];\n\n        // Different visuals for different enemy types\n        if (enemy.type === \"indestructible\") {\n          brightColor = \"#ff0000\";\n          ctx.ctx2d.shadowBlur = 30;\n        } else if (enemy.type === \"homing\") {\n          brightColor = \"#ff0088\";\n          ctx.ctx2d.shadowBlur = 30;\n        } else {\n          ctx.ctx2d.shadowBlur = 25;\n        }\n\n        ctx.ctx2d.shadowColor = brightColor;\n        ctx.ctx2d.fillStyle = brightColor;\n        ctx.ctx2d.fillRect(enemy.x - enemy.w / 2, enemy.y - enemy.h / 2, enemy.w, enemy.h);\n        ctx.ctx2d.strokeStyle = \"#ffffff\";\n        ctx.ctx2d.lineWidth = 3;\n        ctx.ctx2d.strokeRect(enemy.x - enemy.w / 2, enemy.y - enemy.h / 2, enemy.w, enemy.h);\n\n        // Health bar for destructible enemies\n        if (enemy.type !== \"indestructible\" && enemy.maxHealth > 1) {\n          const healthPercent = enemy.health / enemy.maxHealth;\n          ctx.ctx2d.fillStyle = \"#ff0000\";\n          ctx.ctx2d.fillRect(enemy.x - enemy.w / 2, enemy.y - enemy.h / 2 - 8, enemy.w, 4);\n          ctx.ctx2d.fillStyle = \"#00ff00\";\n          ctx.ctx2d.fillRect(enemy.x - enemy.w / 2, enemy.y - enemy.h / 2 - 8, enemy.w * healthPercent, 4);\n        }\n      }\n      ctx.ctx2d.restore();\n\n      // Projectiles\n      for (const proj of projectiles) {\n        renderProjectile(ctx.ctx2d, proj, ctx.settings.reduceMotion);\n      }\n\n      // Explosions\n      for (const explosion of explosions) {\n        renderExplosion(ctx.ctx2d, explosion, ctx.settings.reduceMotion);\n      }\n\n      // Collectibles\n      for (const c of collectibles) {\n        if (c.collected) continue;\n        ctx.ctx2d.save();\n        const color = c.rarity === \"epic\" ? \"#ff00ff\" : c.rarity === \"rare\" ? \"#00ffff\" : \"#ffff00\";\n        ctx.ctx2d.shadowBlur = 15;\n        ctx.ctx2d.shadowColor = color;\n        ctx.ctx2d.fillStyle = color;\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(c.x, c.y, c.radius, 0, Math.PI * 2);\n        ctx.ctx2d.fill();\n        ctx.ctx2d.restore();\n      }\n\n      // Power-ups\n      for (const p of powerUps) {\n        if (p.collected) continue;\n        ctx.ctx2d.save();\n        const color = p.type === \"slow-time\" ? \"#00ffff\" : p.type === \"shield\" ? \"#0000ff\" : p.type === \"double-points\" ? \"#ffff00\" : \"#00ff00\";\n        ctx.ctx2d.shadowBlur = 20;\n        ctx.ctx2d.shadowColor = color;\n        ctx.ctx2d.fillStyle = color;\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\n        ctx.ctx2d.fill();\n        ctx.ctx2d.strokeStyle = \"#ffffff\";\n        ctx.ctx2d.lineWidth = 2;\n        ctx.ctx2d.stroke();\n        ctx.ctx2d.restore();\n      }\n\n      // Charis visual indicator (appears during milestones and important moments)\n      if (!ctx.settings.reduceMotion && (runMs % 30000 < 2000 || combo > 10)) {\n        ctx.ctx2d.save();\n        const charisX = ctx.width - 60;\n        const charisY = 60;\n        const pulse = Math.sin((runMs / 500) % (Math.PI * 2)) * 0.2 + 1;\n        ctx.ctx2d.globalAlpha = 0.8;\n        ctx.ctx2d.shadowBlur = 20;\n        ctx.ctx2d.shadowColor = \"#ff00ff\";\n        ctx.ctx2d.fillStyle = \"#ff00ff\";\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(charisX, charisY, 15 * pulse, 0, Math.PI * 2);\n        ctx.ctx2d.fill();\n        ctx.ctx2d.strokeStyle = \"#ffffff\";\n        ctx.ctx2d.lineWidth = 2;\n        ctx.ctx2d.stroke();\n        // Draw \"C\" for Charis\n        ctx.ctx2d.fillStyle = \"#ffffff\";\n        ctx.ctx2d.font = \"bold 16px system-ui\";\n        ctx.ctx2d.textAlign = \"center\";\n        ctx.ctx2d.textBaseline = \"middle\";\n        ctx.ctx2d.fillText(\"C\", charisX, charisY);\n        ctx.ctx2d.restore();\n      }\n\n      // Player (with shield and star mode effects)\n      ctx.ctx2d.save();\n      if (activePowerUps.has(\"star-mode\")) {\n        // Star mode: pulsing rainbow effect\n        const pulse = Math.sin((runMs / 200) % (Math.PI * 2)) * 0.3 + 0.7;\n        ctx.ctx2d.shadowBlur = 40;\n        ctx.ctx2d.shadowColor = \"#ffff00\";\n        ctx.ctx2d.strokeStyle = \"#ffff00\";\n        ctx.ctx2d.lineWidth = 5;\n        ctx.ctx2d.globalAlpha = pulse;\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(px, py, pr + 8, 0, Math.PI * 2);\n        ctx.ctx2d.stroke();\n        ctx.ctx2d.globalAlpha = 1.0;\n      }\n      if (activePowerUps.has(\"shield\")) {\n        ctx.ctx2d.shadowBlur = 30;\n        ctx.ctx2d.shadowColor = \"#0000ff\";\n        ctx.ctx2d.strokeStyle = \"#0000ff\";\n        ctx.ctx2d.lineWidth = 4;\n        ctx.ctx2d.beginPath();\n        ctx.ctx2d.arc(px, py, pr + 5, 0, Math.PI * 2);\n        ctx.ctx2d.stroke();\n      }\n      ctx.ctx2d.shadowBlur = 20;\n      ctx.ctx2d.shadowColor = \"#6366f1\";\n      ctx.ctx2d.fillStyle = \"rgba(99,102,241,0.95)\";\n      ctx.ctx2d.beginPath();\n      ctx.ctx2d.arc(px, py, pr, 0, Math.PI * 2);\n      ctx.ctx2d.fill();\n      ctx.ctx2d.strokeStyle = \"#ffffff\";\n      ctx.ctx2d.lineWidth = 3;\n      ctx.ctx2d.stroke();\n      ctx.ctx2d.restore();\n\n      // Particles\n      if (!ctx.settings.reduceMotion) {\n        for (const p of particles) {\n          ctx.ctx2d.save();\n          ctx.ctx2d.globalAlpha = p.alpha;\n          ctx.ctx2d.fillStyle = p.color;\n          ctx.ctx2d.beginPath();\n          ctx.ctx2d.arc(p.x, p.y, p.size, 0, Math.PI * 2);\n          ctx.ctx2d.fill();\n          ctx.ctx2d.restore();\n        }\n      }\n\n      // Combo indicators\n      for (const ind of comboIndicators) {\n        ctx.ctx2d.save();\n        ctx.ctx2d.globalAlpha = ind.life;\n        ctx.ctx2d.font = \"bold 24px system-ui\";\n        ctx.ctx2d.fillStyle = \"#ffffff\";\n        ctx.ctx2d.strokeStyle = \"#000000\";\n        ctx.ctx2d.lineWidth = 4;\n        const text = `${ind.combo}x COMBO!`;\n        ctx.ctx2d.strokeText(text, ind.x - 60, ind.y);\n        ctx.ctx2d.fillText(text, ind.x - 60, ind.y);\n        ctx.ctx2d.restore();\n      }\n\n      ctx.ctx2d.restore(); // End shake transform\n\n      // HUD\n      const left = Math.max(0, mission.durationMs - runMs);\n      const leftS = Math.max(0, Math.ceil(left / 1000));\n      const progress = Math.min(1, runMs / mission.durationMs);\n\n      drawHudText(ctx.ctx2d, `Mission ${mission.id}: ${mission.title}`, 16, 26);\n      drawHudText(ctx.ctx2d, `Time: ${leftS}s`, 16, 48);\n      drawHudText(ctx.ctx2d, `Points: ${Math.floor(totalPoints)}`, 16, 70);\n      drawHudText(ctx.ctx2d, `Lives: ${playerLives}/${maxLives}`, 16, 92);\n      drawHudText(ctx.ctx2d, `Weapon: ${weaponState.currentWeapon.toUpperCase()}`, 16, 114);\n      if (combo > 0) {\n        drawHudText(ctx.ctx2d, `Combo: ${combo}x`, 16, 136);\n      }\n      if (activePowerUps.size > 0) {\n        const powerUpNames: string[] = [];\n        if (activePowerUps.has(\"slow-time\")) powerUpNames.push(\"SLOW\");\n        if (activePowerUps.has(\"shield\")) powerUpNames.push(\"SHIELD\");\n        if (activePowerUps.has(\"double-points\")) powerUpNames.push(\"2X\");\n        if (activePowerUps.has(\"speed-boost\")) powerUpNames.push(\"SPEED\");\n        if (activePowerUps.has(\"rapid-fire\")) powerUpNames.push(\"RAPID\");\n        if (activePowerUps.has(\"explosive-shots\")) powerUpNames.push(\"EXPLOSIVE\");\n        if (activePowerUps.has(\"star-mode\")) powerUpNames.push(\"STAR\");\n        drawHudText(ctx.ctx2d, `Active: ${powerUpNames.join(\", \")}`, 16, 158);\n      }\n\n      // Progress bar\n      ctx.ctx2d.save();\n      ctx.ctx2d.fillStyle = \"rgba(255,255,255,0.2)\";\n      ctx.ctx2d.fillRect(16, ctx.height - 40, ctx.width - 32, 8);\n      ctx.ctx2d.fillStyle = \"#00ff00\";\n      ctx.ctx2d.fillRect(16, ctx.height - 40, (ctx.width - 32) * progress, 8);\n      ctx.ctx2d.restore();\n\n      // Objectives status\n      let yOffset = 180;\n      for (const obj of mission.objectives) {\n        const completed = objectivesCompleted.includes(obj.id);\n        const text = `${completed ? \"✓\" : \"○\"} ${obj.description}`;\n        ctx.ctx2d.save();\n        ctx.ctx2d.fillStyle = completed ? \"rgba(0,255,0,0.9)\" : \"rgba(255,255,255,0.7)\";\n        ctx.ctx2d.font = \"600 12px system-ui\";\n        ctx.ctx2d.fillText(text, 16, yOffset);\n        ctx.ctx2d.restore();\n        yOffset += 18;\n      }\n\n      if (dead) {\n        ctx.ctx2d.save();\n        ctx.ctx2d.fillStyle = \"rgba(0,0,0,0.55)\";\n        ctx.ctx2d.fillRect(0, 0, ctx.width, ctx.height);\n        ctx.ctx2d.restore();\n        const title = won ? \"Mission Complete!\" : \"Mission Failed\";\n        drawHudText(ctx.ctx2d, title, 16, 84);\n        if (won) {\n          const stars = calculateStars();\n          drawHudText(ctx.ctx2d, `Stars: ${\"★\".repeat(stars)}${\"☆\".repeat(3 - stars)}`, 16, 106);\n          drawHudText(ctx.ctx2d, `Points: ${Math.floor(totalPoints)}`, 16, 128);\n        }\n        drawHudText(ctx.ctx2d, \"Return to the hub for another mission.\", 16, 150);\n      }\n    },\n    dispose() {\n      charisVoice.dispose();\n    },\n  };\n}\n\n","// Collectible and power-up system types\n\nexport type CollectibleRarity = \"common\" | \"rare\" | \"epic\";\n\nexport type Collectible = {\n  id: string;\n  x: number;\n  y: number;\n  radius: number;\n  rarity: CollectibleRarity;\n  value: number;\n  collected: boolean;\n  spawnTime: number;\n  magnetRadius?: number; // For character magnet ability\n};\n\nexport type PowerUpType = \"slow-time\" | \"shield\" | \"double-points\" | \"speed-boost\" | \"rapid-fire\" | \"explosive-shots\" | \"life-extension\" | \"star-mode\";\n\nexport type PowerUp = {\n  id: string;\n  x: number;\n  y: number;\n  radius: number;\n  type: PowerUpType;\n  collected: boolean;\n  spawnTime: number;\n  active: boolean;\n  duration: number; // in ms\n  startTime?: number;\n};\n\nexport const COLLECTIBLE_VALUES: Record<CollectibleRarity, number> = {\n  common: 10,\n  rare: 25,\n  epic: 50,\n};\n\nexport const COLLECTIBLE_SPAWN_WEIGHTS: Record<CollectibleRarity, number> = {\n  common: 0.7,\n  rare: 0.25,\n  epic: 0.05,\n};\n\nexport const POWER_UP_DURATIONS: Record<PowerUpType, number> = {\n  \"slow-time\": 5000,\n  shield: 8000,\n  \"double-points\": 10000,\n  \"speed-boost\": 6000,\n  \"rapid-fire\": 8000,\n  \"explosive-shots\": 10000,\n  \"life-extension\": 0, // Instant (adds hit point)\n  \"star-mode\": 7000, // Invincibility\n};\n\nexport const POWER_UP_SPAWN_WEIGHT = 0.15; // 15% chance per spawn cycle\n\n","// Charis voice system using Web Speech API\n\nexport type VoiceLineType = \"briefing\" | \"warning\" | \"encouragement\" | \"taunt\" | \"victory\" | \"failure\" | \"milestone\";\n\nexport type VoiceLine = {\n  type: VoiceLineType;\n  text: string;\n  priority: number; // Higher = more important\n};\n\nconst VOICE_LINES: Record<VoiceLineType, string[]> = {\n  briefing: [\n    \"Welcome, agent. This mission won't be easy, but I believe you can do it.\",\n    \"Charis here. I've prepared something special for you. Don't disappoint me.\",\n    \"Listen carefully. The obstacles are getting smarter. Stay sharp.\",\n    \"This is your moment to prove yourself. Show me what you're made of.\",\n    \"I've seen many agents attempt this. Most fail. Will you be different?\",\n  ],\n  warning: [\n    \"Watch out! Danger ahead!\",\n    \"Incoming! Move now!\",\n    \"That was close. Stay focused.\",\n    \"Don't get complacent. It gets harder.\",\n    \"Multiple threats detected. Be careful.\",\n  ],\n  encouragement: [\n    \"Good work! Keep it up!\",\n    \"You're doing great. Stay calm.\",\n    \"Excellent dodge! That's what I like to see.\",\n    \"You're getting the hang of this. Don't stop now.\",\n    \"Impressive. Charis would be proud.\",\n  ],\n  taunt: [\n    \"Too slow! Can you keep up?\",\n    \"Is that the best you can do?\",\n    \"I expected more from you.\",\n    \"Come on, agent. Show me something.\",\n    \"This is too easy for you, isn't it?\",\n  ],\n  victory: [\n    \"Outstanding! You've completed the mission!\",\n    \"Well done, agent. You've earned my respect.\",\n    \"Congratulations! Charis is impressed.\",\n    \"Mission complete. You're ready for the next challenge.\",\n    \"Excellent work. You've proven yourself worthy.\",\n  ],\n  failure: [\n    \"Mission failed. Try again when you're ready.\",\n    \"Not this time. Learn from your mistakes.\",\n    \"You were close. Don't give up.\",\n    \"Failure is part of learning. Try again.\",\n    \"Charis says: one more attempt. You can do this.\",\n  ],\n  milestone: [\n    \"Quarter way there. Keep going!\",\n    \"Halfway point. You're doing well.\",\n    \"Three quarters done. Almost there!\",\n    \"Final stretch. Don't give up now!\",\n    \"You're in the home stretch. Finish strong!\",\n  ],\n};\n\nexport class CharisVoice {\n  private synth: SpeechSynthesis | null = null;\n  private currentUtterance: SpeechSynthesisUtterance | null = null;\n  private queue: VoiceLine[] = [];\n  private isSpeaking = false;\n  private voice: SpeechSynthesisVoice | null = null;\n\n  constructor() {\n    if (typeof window !== \"undefined\" && \"speechSynthesis\" in window) {\n      this.synth = window.speechSynthesis;\n      this.initializeVoice();\n    }\n  }\n\n  private initializeVoice() {\n    if (!this.synth) return;\n\n    // Try to find a female voice (Charis)\n    const voices = this.synth.getVoices();\n    const preferredVoices = [\n      \"Google UK English Female\",\n      \"Microsoft Zira - English (United States)\",\n      \"Samantha\",\n      \"Victoria\",\n      \"Karen\",\n    ];\n\n    for (const preferred of preferredVoices) {\n      const found = voices.find((v) => v.name.includes(preferred) || v.name.toLowerCase().includes(\"female\"));\n      if (found) {\n        this.voice = found;\n        break;\n      }\n    }\n\n    // Fallback to any available voice\n    if (!this.voice && voices.length > 0) {\n      this.voice = voices[0];\n    }\n\n    // If voices aren't loaded yet, wait for them\n    if (voices.length === 0) {\n      this.synth.onvoiceschanged = () => {\n        this.initializeVoice();\n      };\n    }\n  }\n\n  speak(text: string, priority = 0, interrupt = false) {\n    if (!this.synth || !this.voice) return;\n\n    const line: VoiceLine = { type: \"briefing\", text, priority };\n\n    if (interrupt) {\n      this.stop();\n      this.queue = [line];\n      this.processQueue();\n    } else {\n      this.queue.push(line);\n      this.queue.sort((a, b) => b.priority - a.priority);\n      if (!this.isSpeaking) {\n        this.processQueue();\n      }\n    }\n  }\n\n  speakLine(type: VoiceLineType, interrupt = false) {\n    const lines = VOICE_LINES[type];\n    if (lines.length === 0) return;\n\n    const text = lines[Math.floor(Math.random() * lines.length)];\n    this.speak(text, this.getPriority(type), interrupt);\n  }\n\n  speakCustom(type: VoiceLineType, text: string, interrupt = false) {\n    this.speak(text, this.getPriority(type), interrupt);\n  }\n\n  private getPriority(type: VoiceLineType): number {\n    switch (type) {\n      case \"briefing\":\n        return 10;\n      case \"warning\":\n        return 8;\n      case \"victory\":\n        return 9;\n      case \"failure\":\n        return 7;\n      case \"milestone\":\n        return 5;\n      case \"encouragement\":\n        return 4;\n      case \"taunt\":\n        return 3;\n      default:\n        return 0;\n    }\n  }\n\n  private processQueue() {\n    if (this.queue.length === 0 || !this.synth || !this.voice) {\n      this.isSpeaking = false;\n      return;\n    }\n\n    const line = this.queue.shift()!;\n    this.isSpeaking = true;\n\n    const utterance = new window.SpeechSynthesisUtterance(line.text);\n    utterance.voice = this.voice;\n    utterance.rate = 1.0;\n    utterance.pitch = 1.0;\n    utterance.volume = 0.8;\n\n    utterance.onend = () => {\n      this.isSpeaking = false;\n      this.processQueue();\n    };\n\n    utterance.onerror = () => {\n      this.isSpeaking = false;\n      this.processQueue();\n    };\n\n    this.currentUtterance = utterance;\n    this.synth.speak(utterance);\n  }\n\n  stop() {\n    if (this.synth && this.currentUtterance) {\n      this.synth.cancel();\n      this.currentUtterance = null;\n      this.isSpeaking = false;\n      this.queue = [];\n    }\n  }\n\n  dispose() {\n    this.stop();\n    this.synth = null;\n    this.voice = null;\n  }\n}\n\n","// Enemy/obstacle type definitions\n\nexport type EnemyType = \"destructible\" | \"indestructible\" | \"homing\" | \"zigzag\" | \"spiral\" | \"formation\" | \"kamikaze\";\n\nexport type EnemyPattern = \"straight\" | \"homing\" | \"zigzag\" | \"spiral\" | \"formation\" | \"kamikaze\";\n\nexport type Enemy = {\n  id: string;\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n  speed: number;\n  type: EnemyType;\n  pattern: EnemyPattern;\n  health: number; // For destructible enemies\n  maxHealth: number;\n  // Pattern-specific data\n  patternData?: {\n    zigzag?: { direction: number; amplitude: number; frequency: number };\n    spiral?: { angle: number; radius: number; centerX: number; centerY: number };\n    formation?: { groupId: string; offsetX: number; offsetY: number };\n    homing?: { targetX: number; targetY: number; prediction: number };\n  };\n  // Rewards\n  dropReward?: \"points\" | \"life\" | \"star\" | \"weapon\" | \"powerup\";\n  rewardValue?: number;\n};\n\nexport const ENEMY_TYPE_WEIGHTS: Record<EnemyType, number> = {\n  destructible: 0.6, // 60%\n  indestructible: 0.3, // 30%\n  homing: 0.1, // 10%\n  zigzag: 0.0, // Spawned separately\n  spiral: 0.0, // Spawned separately\n  formation: 0.0, // Spawned separately\n  kamikaze: 0.0, // Spawned separately\n};\n\nexport const ENEMY_PATTERN_WEIGHTS: Record<EnemyPattern, number> = {\n  straight: 0.5,\n  homing: 0.3,\n  zigzag: 0.1,\n  spiral: 0.05,\n  formation: 0.03,\n  kamikaze: 0.02,\n};\n\nexport const ENEMY_HEALTH_BY_TYPE: Record<EnemyType, number> = {\n  destructible: 1,\n  indestructible: Infinity,\n  homing: 2,\n  zigzag: 1,\n  spiral: 1,\n  formation: 1,\n  kamikaze: 1,\n};\n\n","// Enhanced enemy AI patterns\n\nimport type { Enemy, EnemyPattern } from \"./types\";\n\nexport function updateEnemyPattern(\n  enemy: Enemy,\n  playerX: number,\n  playerY: number,\n  dt: number,\n  canvasWidth: number,\n  canvasHeight: number\n): void {\n  switch (enemy.pattern) {\n    case \"straight\":\n      // Simple vertical movement (default)\n      break;\n\n    case \"homing\": {\n      if (!enemy.patternData?.homing) {\n        enemy.patternData = {\n          homing: {\n            targetX: playerX,\n            targetY: playerY,\n            prediction: 0.3, // Predict 30% ahead\n          },\n        };\n      }\n\n      const homing = enemy.patternData.homing;\n      if (!homing) break; // Safety check\n      \n      // Update target with prediction\n      const dx = playerX - enemy.x;\n      const dy = playerY - enemy.y;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n      const speed = enemy.speed;\n\n      // Predict player movement\n      const predictionTime = dist / speed * homing.prediction;\n      homing.targetX = playerX;\n      homing.targetY = playerY;\n\n      // Move toward predicted position\n      const targetDx = homing.targetX - enemy.x;\n      const targetDy = homing.targetY - enemy.y;\n      const targetDist = Math.sqrt(targetDx * targetDx + targetDy * targetDy);\n\n      if (targetDist > 5) {\n        const moveX = (targetDx / targetDist) * speed * (dt / 1000);\n        const moveY = (targetDy / targetDist) * speed * (dt / 1000);\n        enemy.x += moveX;\n        enemy.y += moveY * 1.2; // Still move down primarily\n      } else {\n        enemy.y += speed * (dt / 1000);\n      }\n      break;\n    }\n\n    case \"zigzag\": {\n      if (!enemy.patternData?.zigzag) {\n        enemy.patternData = {\n          zigzag: {\n            direction: 1, // 1 or -1\n            amplitude: 40,\n            frequency: 2, // cycles per second\n          },\n        };\n      }\n\n      const zigzag = enemy.patternData.zigzag;\n      if (!zigzag) break; // Safety check\n      \n      const time = Date.now() / 1000;\n      const horizontalOffset = Math.sin(time * zigzag.frequency * Math.PI * 2) * zigzag.amplitude;\n      enemy.x += horizontalOffset * (dt / 1000) * zigzag.direction;\n      enemy.y += enemy.speed * (dt / 1000);\n\n      // Bounce off edges\n      if (enemy.x < enemy.w / 2 || enemy.x > canvasWidth - enemy.w / 2) {\n        zigzag.direction *= -1;\n      }\n      break;\n    }\n\n    case \"spiral\": {\n      if (!enemy.patternData?.spiral) {\n        enemy.patternData = {\n          spiral: {\n            angle: 0,\n            radius: 30,\n            centerX: enemy.x,\n            centerY: enemy.y,\n          },\n        };\n      }\n\n      const spiral = enemy.patternData.spiral;\n      if (!spiral) break; // Safety check\n      \n      spiral.angle += (dt / 1000) * 3; // Rotate 3 radians per second\n      spiral.radius += (dt / 1000) * 20; // Expand radius\n\n      enemy.x = spiral.centerX + Math.cos(spiral.angle) * spiral.radius;\n      enemy.y = spiral.centerY + Math.sin(spiral.angle) * spiral.radius;\n      spiral.centerY += enemy.speed * (dt / 1000); // Move center down\n      break;\n    }\n\n    case \"formation\": {\n      // Formation enemies move together (handled by formation system)\n      enemy.y += enemy.speed * (dt / 1000);\n      break;\n    }\n\n    case \"kamikaze\": {\n      // Direct path to player, very fast\n      const dx = playerX - enemy.x;\n      const dy = playerY - enemy.y;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n\n      if (dist > 5) {\n        const speed = enemy.speed * 1.5; // 50% faster\n        enemy.x += (dx / dist) * speed * (dt / 1000);\n        enemy.y += (dy / dist) * speed * (dt / 1000);\n      }\n      break;\n    }\n  }\n}\n\nexport function shouldSpawnHomingEnemy(\n  playerStationary: boolean,\n  playerStationaryTime: number,\n  baseHomingChance: number\n): boolean {\n  if (playerStationary && playerStationaryTime > 2000) {\n    // Much higher chance if player stands still\n    return Math.random() < baseHomingChance * 3;\n  }\n  return Math.random() < baseHomingChance;\n}\n\n","// Projectile and weapon type definitions\n\nexport type WeaponType = \"basic\" | \"spread\" | \"multi\" | \"laser\" | \"homing\";\n\nexport type Projectile = {\n  id: string;\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  speed: number;\n  damage: number;\n  radius: number;\n  life: number;\n  maxLife: number;\n  weaponType: WeaponType;\n  // For homing projectiles\n  targetId?: string;\n  targetX?: number;\n  targetY?: number;\n};\n\nexport type WeaponStats = {\n  type: WeaponType;\n  damage: number;\n  speed: number;\n  cooldown: number; // ms between shots\n  projectileCount: number;\n  spreadAngle?: number; // For spread weapons\n  directions?: number[]; // For multi-directional (angles in radians)\n  duration?: number; // For laser (ms)\n  homingStrength?: number; // For homing projectiles (0-1)\n};\n\nexport const WEAPON_STATS: Record<WeaponType, WeaponStats> = {\n  basic: {\n    type: \"basic\",\n    damage: 1,\n    speed: 400,\n    cooldown: 200,\n    projectileCount: 1,\n  },\n  spread: {\n    type: \"spread\",\n    damage: 1,\n    speed: 400,\n    cooldown: 250,\n    projectileCount: 3,\n    spreadAngle: Math.PI / 6, // 30 degrees\n  },\n  multi: {\n    type: \"multi\",\n    damage: 1,\n    speed: 400,\n    cooldown: 300,\n    projectileCount: 5,\n    directions: [Math.PI / 2, Math.PI / 2 + Math.PI / 4, Math.PI / 2 - Math.PI / 4, Math.PI, 0], // up, up-left, up-right, left, right\n  },\n  laser: {\n    type: \"laser\",\n    damage: 2,\n    speed: 600,\n    cooldown: 100,\n    projectileCount: 1,\n    duration: 500, // 0.5 seconds\n  },\n  homing: {\n    type: \"homing\",\n    damage: 1,\n    speed: 350,\n    cooldown: 350,\n    projectileCount: 1,\n    homingStrength: 0.15, // 15% correction per frame\n  },\n};\n\nexport const WEAPON_UPGRADE_COST: Record<WeaponType, number> = {\n  basic: 0, // Starting weapon\n  spread: 500,\n  multi: 1500,\n  laser: 3000,\n  homing: 5000,\n};\n\nexport const WEAPON_UPGRADE_PATH: WeaponType[] = [\"basic\", \"spread\", \"multi\", \"laser\", \"homing\"];\n\n","// Weapon upgrade system and stats\n\nimport type { WeaponType, Projectile, WeaponStats } from \"./types\";\nimport { WEAPON_STATS, WEAPON_UPGRADE_PATH, WEAPON_UPGRADE_COST } from \"./types\";\n\nexport type WeaponState = {\n  currentWeapon: WeaponType;\n  points: number;\n  upgradePoints: number; // Points toward next upgrade\n  rapidFireActive: boolean; // 2x fire rate power-up\n  rapidFireEndTime?: number;\n};\n\nexport function createWeaponState(): WeaponState {\n  return {\n    currentWeapon: \"basic\",\n    points: 0,\n    upgradePoints: 0,\n    rapidFireActive: false,\n  };\n}\n\nexport function canUpgradeWeapon(state: WeaponState): boolean {\n  const currentIndex = WEAPON_UPGRADE_PATH.indexOf(state.currentWeapon);\n  if (currentIndex === -1 || currentIndex >= WEAPON_UPGRADE_PATH.length - 1) {\n    return false; // Already at max or invalid weapon\n  }\n\n  const nextWeapon = WEAPON_UPGRADE_PATH[currentIndex + 1];\n  const cost = WEAPON_UPGRADE_COST[nextWeapon];\n  return state.upgradePoints >= cost;\n}\n\nexport function upgradeWeapon(state: WeaponState): boolean {\n  if (!canUpgradeWeapon(state)) return false;\n\n  const currentIndex = WEAPON_UPGRADE_PATH.indexOf(state.currentWeapon);\n  const nextWeapon = WEAPON_UPGRADE_PATH[currentIndex + 1];\n  const cost = WEAPON_UPGRADE_COST[nextWeapon];\n\n  state.currentWeapon = nextWeapon;\n  state.upgradePoints -= cost;\n  return true;\n}\n\nexport function addUpgradePoints(state: WeaponState, points: number) {\n  state.upgradePoints += points;\n  // Auto-upgrade if possible\n  while (canUpgradeWeapon(state)) {\n    upgradeWeapon(state);\n  }\n}\n\nexport function createProjectile(\n  weaponType: WeaponType,\n  playerX: number,\n  playerY: number,\n  targetX?: number,\n  targetY?: number\n): Projectile[] {\n  const stats = WEAPON_STATS[weaponType];\n  const projectiles: Projectile[] = [];\n\n  switch (weaponType) {\n    case \"basic\": {\n      const angle = Math.PI / 2; // Straight up\n      projectiles.push({\n        id: `proj-${Date.now()}-${Math.random()}`,\n        x: playerX,\n        y: playerY,\n        vx: Math.cos(angle) * stats.speed,\n        vy: -Math.sin(angle) * stats.speed,\n        speed: stats.speed,\n        damage: stats.damage,\n        radius: 4,\n        life: 1.0,\n        maxLife: 2.0,\n        weaponType,\n      });\n      break;\n    }\n\n    case \"spread\": {\n      const centerAngle = Math.PI / 2; // Up\n      const spread = stats.spreadAngle || Math.PI / 6;\n      for (let i = 0; i < stats.projectileCount; i++) {\n        const angle = centerAngle - spread / 2 + (spread / (stats.projectileCount - 1)) * i;\n        projectiles.push({\n          id: `proj-${Date.now()}-${i}-${Math.random()}`,\n          x: playerX,\n          y: playerY,\n          vx: Math.cos(angle) * stats.speed,\n          vy: -Math.sin(angle) * stats.speed,\n          speed: stats.speed,\n          damage: stats.damage,\n          radius: 4,\n          life: 1.0,\n          maxLife: 2.0,\n          weaponType,\n        });\n      }\n      break;\n    }\n\n    case \"multi\": {\n      const directions = stats.directions || [Math.PI / 2];\n      for (let i = 0; i < directions.length; i++) {\n        const angle = directions[i];\n        projectiles.push({\n          id: `proj-${Date.now()}-${i}-${Math.random()}`,\n          x: playerX,\n          y: playerY,\n          vx: Math.cos(angle) * stats.speed,\n          vy: -Math.sin(angle) * stats.speed,\n          speed: stats.speed,\n          damage: stats.damage,\n          radius: 4,\n          life: 1.0,\n          maxLife: 2.0,\n          weaponType,\n        });\n      }\n      break;\n    }\n\n    case \"laser\": {\n      // Laser is a continuous beam, represented as a fast, long projectile\n      projectiles.push({\n        id: `proj-${Date.now()}-${Math.random()}`,\n        x: playerX,\n        y: playerY,\n        vx: 0,\n        vy: -stats.speed,\n        speed: stats.speed,\n        damage: stats.damage,\n        radius: 6,\n        life: 1.0,\n        maxLife: (stats.duration || 500) / 1000,\n        weaponType,\n      });\n      break;\n    }\n\n    case \"homing\": {\n      // Homing projectile initially goes up, then tracks target\n      const initialAngle = Math.PI / 2;\n      projectiles.push({\n        id: `proj-${Date.now()}-${Math.random()}`,\n        x: playerX,\n        y: playerY,\n        vx: Math.cos(initialAngle) * stats.speed,\n        vy: -Math.sin(initialAngle) * stats.speed,\n        speed: stats.speed,\n        damage: stats.damage,\n        radius: 5,\n        life: 1.0,\n        maxLife: 3.0,\n        weaponType,\n        targetX,\n        targetY,\n      });\n      break;\n    }\n  }\n\n  return projectiles;\n}\n\nexport function updateProjectile(\n  projectile: Projectile,\n  dt: number,\n  canvasWidth: number,\n  canvasHeight: number,\n  nearestEnemy?: { x: number; y: number; id: string }\n): boolean {\n  // Update homing projectiles\n  if (projectile.weaponType === \"homing\" && projectile.targetX !== undefined && projectile.targetY !== undefined) {\n    const dx = projectile.targetX - projectile.x;\n    const dy = projectile.targetY - projectile.y;\n    const dist = Math.sqrt(dx * dx + dy * dy);\n\n    if (dist > 5 && nearestEnemy) {\n      // Update target to nearest enemy\n      projectile.targetX = nearestEnemy.x;\n      projectile.targetY = nearestEnemy.y;\n\n      // Adjust velocity toward target\n      const homingStrength = WEAPON_STATS.homing.homingStrength || 0.15;\n      const targetDx = projectile.targetX - projectile.x;\n      const targetDy = projectile.targetY - projectile.y;\n      const targetDist = Math.sqrt(targetDx * targetDx + targetDy * targetDy);\n\n      if (targetDist > 0) {\n        const targetVx = (targetDx / targetDist) * projectile.speed;\n        const targetVy = (targetDy / targetDist) * projectile.speed;\n\n        // Interpolate toward target velocity\n        projectile.vx += (targetVx - projectile.vx) * homingStrength;\n        projectile.vy += (targetVy - projectile.vy) * homingStrength;\n\n        // Normalize to maintain speed\n        const currentSpeed = Math.sqrt(projectile.vx * projectile.vx + projectile.vy * projectile.vy);\n        if (currentSpeed > 0) {\n          const scale = projectile.speed / currentSpeed;\n          projectile.vx *= scale;\n          projectile.vy *= scale;\n        }\n      }\n    }\n  }\n\n  // Update position\n  projectile.x += (projectile.vx * dt) / 1000;\n  projectile.y += (projectile.vy * dt) / 1000;\n\n  // Update life\n  projectile.life -= dt / 1000 / projectile.maxLife;\n\n  // Check bounds\n  if (\n    projectile.x < -50 ||\n    projectile.x > canvasWidth + 50 ||\n    projectile.y < -50 ||\n    projectile.y > canvasHeight + 50 ||\n    projectile.life <= 0\n  ) {\n    return false; // Remove projectile\n  }\n\n  return true; // Keep projectile\n}\n\n","// Movement requirement tracking and danger zones\n\nexport type DangerZone = {\n  id: string;\n  x: number;\n  y: number;\n  radius: number;\n  maxRadius: number;\n  expansionRate: number;\n  damage: number;\n  startTime: number;\n  duration: number;\n  active: boolean;\n};\n\nexport type MovementTracker = {\n  lastPosition: { x: number; y: number };\n  lastMoveTime: number;\n  stationaryTime: number;\n  totalDistance: number;\n  movementBonus: number; // Point multiplier for constant movement\n};\n\nconst STATIONARY_THRESHOLD_MS = 1500; // 1.5 seconds\nconst MOVEMENT_THRESHOLD_PX = 50; // Must move 50px every 3 seconds\nconst MOVEMENT_CHECK_INTERVAL_MS = 3000; // Check every 3 seconds\nconst DANGER_ZONE_EXPANSION_RATE = 30; // pixels per second\nconst DANGER_ZONE_MAX_RADIUS = 80;\nconst DANGER_ZONE_DURATION_MS = 2000; // 2 seconds to expand\n\nexport function createMovementTracker() {\n  const tracker: MovementTracker = {\n    lastPosition: { x: 0, y: 0 },\n    lastMoveTime: 0,\n    stationaryTime: 0,\n    totalDistance: 0,\n    movementBonus: 1.0,\n  };\n\n  return {\n    update(currentX: number, currentY: number, currentTime: number): {\n      isStationary: boolean;\n      shouldSpawnDangerZone: boolean;\n      movementBonus: number;\n      stationaryTime: number;\n    } {\n      const dx = currentX - tracker.lastPosition.x;\n      const dy = currentY - tracker.lastPosition.y;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      // Check if player moved significantly\n      if (distance > 5) {\n        // Player moved\n        tracker.lastMoveTime = currentTime;\n        tracker.stationaryTime = 0;\n        tracker.totalDistance += distance;\n        tracker.lastPosition = { x: currentX, y: currentY };\n\n        // Calculate movement bonus (increases with constant movement)\n        const timeSinceLastCheck = currentTime - (tracker.lastMoveTime - MOVEMENT_CHECK_INTERVAL_MS);\n        if (timeSinceLastCheck < MOVEMENT_CHECK_INTERVAL_MS) {\n          tracker.movementBonus = Math.min(1.5, 1.0 + (tracker.totalDistance / 200) * 0.1);\n        } else {\n          tracker.totalDistance = 0;\n          tracker.movementBonus = 1.0;\n        }\n      } else {\n        // Player is stationary\n        tracker.stationaryTime = currentTime - tracker.lastMoveTime;\n      }\n\n      const isStationary = tracker.stationaryTime > STATIONARY_THRESHOLD_MS;\n      const shouldSpawnDangerZone = isStationary && tracker.stationaryTime > STATIONARY_THRESHOLD_MS;\n\n      return {\n        isStationary,\n        shouldSpawnDangerZone,\n        movementBonus: tracker.movementBonus,\n        stationaryTime: tracker.stationaryTime,\n      };\n    },\n\n    reset(x: number, y: number, time: number) {\n      tracker.lastPosition = { x, y };\n      tracker.lastMoveTime = time;\n      tracker.stationaryTime = 0;\n      tracker.totalDistance = 0;\n      tracker.movementBonus = 1.0;\n    },\n\n    getTracker() {\n      return tracker;\n    },\n  };\n}\n\nexport function createDangerZone(x: number, y: number, startTime: number): DangerZone {\n  return {\n    id: `danger-${Date.now()}-${Math.random()}`,\n    x,\n    y,\n    radius: 20,\n    maxRadius: DANGER_ZONE_MAX_RADIUS,\n    expansionRate: DANGER_ZONE_EXPANSION_RATE,\n    damage: 1,\n    startTime,\n    duration: DANGER_ZONE_DURATION_MS,\n    active: true,\n  };\n}\n\nexport function updateDangerZone(zone: DangerZone, currentTime: number, dt: number): boolean {\n  if (!zone.active) return false;\n\n  const elapsed = currentTime - zone.startTime;\n  if (elapsed >= zone.duration) {\n    zone.active = false;\n    return false;\n  }\n\n  // Expand radius\n  const expansion = (zone.expansionRate * dt) / 1000;\n  zone.radius = Math.min(zone.maxRadius, zone.radius + expansion);\n\n  return true;\n}\n\nexport function checkDangerZoneCollision(\n  zone: DangerZone,\n  playerX: number,\n  playerY: number,\n  playerRadius: number\n): boolean {\n  if (!zone.active) return false;\n\n  const dx = playerX - zone.x;\n  const dy = playerY - zone.y;\n  const dist = Math.sqrt(dx * dx + dy * dy);\n  return dist < zone.radius + playerRadius;\n}\n\n","// Projectile rendering and visual effects\n\nimport type { Projectile } from \"@/games/shooting/types\";\n\nexport function renderProjectile(ctx: CanvasRenderingContext2D, projectile: Projectile, reduceMotion: boolean) {\n  ctx.save();\n\n  // Weapon-specific visuals\n  switch (projectile.weaponType) {\n    case \"basic\": {\n      ctx.fillStyle = \"#00ffff\";\n      ctx.shadowBlur = 10;\n      ctx.shadowColor = \"#00ffff\";\n      ctx.beginPath();\n      ctx.arc(projectile.x, projectile.y, projectile.radius, 0, Math.PI * 2);\n      ctx.fill();\n      break;\n    }\n\n    case \"spread\": {\n      ctx.fillStyle = \"#ffff00\";\n      ctx.shadowBlur = 12;\n      ctx.shadowColor = \"#ffff00\";\n      ctx.beginPath();\n      ctx.arc(projectile.x, projectile.y, projectile.radius, 0, Math.PI * 2);\n      ctx.fill();\n      break;\n    }\n\n    case \"multi\": {\n      ctx.fillStyle = \"#ff00ff\";\n      ctx.shadowBlur = 15;\n      ctx.shadowColor = \"#ff00ff\";\n      ctx.beginPath();\n      ctx.arc(projectile.x, projectile.y, projectile.radius, 0, Math.PI * 2);\n      ctx.fill();\n      break;\n    }\n\n    case \"laser\": {\n      // Laser beam - draw as a line from player to projectile\n      ctx.strokeStyle = \"#00ff00\";\n      ctx.lineWidth = 8;\n      ctx.shadowBlur = 20;\n      ctx.shadowColor = \"#00ff00\";\n      ctx.beginPath();\n      ctx.moveTo(projectile.x, projectile.y + 100); // From below (player position)\n      ctx.lineTo(projectile.x, projectile.y);\n      ctx.stroke();\n      // Also draw the projectile itself\n      ctx.fillStyle = \"#00ff00\";\n      ctx.beginPath();\n      ctx.arc(projectile.x, projectile.y, projectile.radius, 0, Math.PI * 2);\n      ctx.fill();\n      break;\n    }\n\n    case \"homing\": {\n      ctx.fillStyle = \"#ff8800\";\n      ctx.shadowBlur = 15;\n      ctx.shadowColor = \"#ff8800\";\n      ctx.beginPath();\n      ctx.arc(projectile.x, projectile.y, projectile.radius, 0, Math.PI * 2);\n      ctx.fill();\n      // Draw trail for homing\n      if (!reduceMotion) {\n        ctx.strokeStyle = \"#ff8800\";\n        ctx.lineWidth = 2;\n        ctx.globalAlpha = 0.5;\n        ctx.beginPath();\n        ctx.moveTo(projectile.x - projectile.vx * 0.1, projectile.y - projectile.vy * 0.1);\n        ctx.lineTo(projectile.x, projectile.y);\n        ctx.stroke();\n      }\n      break;\n    }\n  }\n\n  ctx.restore();\n}\n\n","// Impact explosion effects\n\nimport type { Particle } from \"../effects/types\";\n\nexport type Explosion = {\n  x: number;\n  y: number;\n  radius: number;\n  maxRadius: number;\n  life: number;\n  maxLife: number;\n  color: string;\n  intensity: number;\n};\n\nexport function createExplosion(x: number, y: number, color: string = \"#ff8800\", intensity: number = 1.0): Explosion {\n  return {\n    x,\n    y,\n    radius: 10,\n    maxRadius: 30 + intensity * 20,\n    life: 1.0,\n    maxLife: 0.3,\n    color,\n    intensity,\n  };\n}\n\nexport function updateExplosion(explosion: Explosion, dt: number): boolean {\n  explosion.life -= dt / 1000 / explosion.maxLife;\n  const progress = 1 - explosion.life;\n  explosion.radius = explosion.maxRadius * (1 - progress * progress); // Ease out\n\n  return explosion.life > 0;\n}\n\nexport function renderExplosion(ctx: CanvasRenderingContext2D, explosion: Explosion, reduceMotion: boolean) {\n  if (reduceMotion) return; // Skip explosions in reduced motion mode\n\n  ctx.save();\n  const alpha = explosion.life;\n  ctx.globalAlpha = alpha;\n\n  // Outer glow\n  const gradient = ctx.createRadialGradient(explosion.x, explosion.y, 0, explosion.x, explosion.y, explosion.radius);\n  gradient.addColorStop(0, explosion.color);\n  gradient.addColorStop(0.5, explosion.color + \"80\");\n  gradient.addColorStop(1, explosion.color + \"00\");\n\n  ctx.fillStyle = gradient;\n  ctx.beginPath();\n  ctx.arc(explosion.x, explosion.y, explosion.radius, 0, Math.PI * 2);\n  ctx.fill();\n\n  // Inner bright core\n  ctx.fillStyle = \"#ffffff\";\n  ctx.globalAlpha = alpha * 0.8;\n  ctx.beginPath();\n  ctx.arc(explosion.x, explosion.y, explosion.radius * 0.3, 0, Math.PI * 2);\n  ctx.fill();\n\n  ctx.restore();\n}\n\nexport function createExplosionParticles(x: number, y: number, color: string, count: number = 15): Particle[] {\n  const particles: Particle[] = [];\n  for (let i = 0; i < count; i++) {\n    const angle = (Math.PI * 2 * i) / count + Math.random() * 0.5;\n    const speed = 100 + Math.random() * 150;\n    particles.push({\n      x,\n      y,\n      vx: Math.cos(angle) * speed,\n      vy: Math.sin(angle) * speed,\n      life: 1.0,\n      maxLife: 0.5 + Math.random() * 0.5,\n      size: 2 + Math.random() * 4,\n      color,\n      alpha: 1.0,\n    });\n  }\n  return particles;\n}\n\n"],"names":[],"mappings":"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"}}]
}