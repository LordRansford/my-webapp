;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="a454befa-8c23-a1af-f309-45ad42fbda01")}catch(e){}}();
module.exports=[892040,a=>{"use strict";var b=a.i(218282),c=a.i(572131),d=a.i(469124),e=a.i(831866);function f(a,b,c,d){return{id:`link-${a}-${b}`,from:a,to:b,capacity:c.linkCapacity+200*d.next(),latency:c.baseLatency+10*d.next(),currentLoad:0,failed:!1}}function g(a,b,c){let d=new e.SeededRNG(a+1e3*b),f=3+Math.floor(3*d.next()),g=[];for(let a=0;a<f;a++){let e=d.sample(c,1)[0],f=d.sample(c.filter(a=>a.id!==e.id),1)[0];g.push({id:`flow-${b}-${a}`,source:e.id,destination:f.id,rate:100+200*d.next(),route:[]})}return g}function h(a,b,c,d){let e=c.find(b=>b.id===a),f=c.find(a=>a.id===b);if(!e||!f)return[a];if(d.find(c=>c.from===a&&c.to===b&&!c.failed))return[a,b];for(let e of c){if(e.id===a||e.id===b)continue;let c=d.find(b=>b.from===a&&b.to===e.id&&!b.failed),f=d.find(a=>a.from===e.id&&a.to===b&&!a.failed);if(c&&f)return[a,e.id,b]}return[a]}function i(a){var b,c,d;let f,i,j,k,l,m,n,o,p,q,r;if("playing"!==a.status)return a;let s={...a},t=g(s.seed,s.currentTick,s.topology.nodes);s.trafficFlows=t;let u=(d=s.currentTick,d<=(r=s.totalTicks/4)?1:d<=2*r?2:d<=3*r?3:4),v=function(a,b,c,d){let f=new e.SeededRNG(a+2e3*b),g=function(a){switch(a){case 1:return .05;case 2:default:return .1;case 3:return .2;case 4:return .3}}(c),h=[];for(let a of d)!a.failed&&f.next()<g&&h.push(a.id);return h}(s.seed,s.currentTick,u,s.topology.links);return f=(b=s).topology.links.map(a=>({...a,failed:a.failed||v.includes(a.id)})),i=function(a){let b=[];for(let c of a.trafficFlows){let d=function(a,b,c,d,e){e.type;return h(a,b,c,d)}(c.source,c.destination,a.topology.nodes,a.topology.links,a.routingPolicy);b.push({...c,route:d})}return b}(c=s={...b,topology:{...b.topology,links:f},failures:[...b.failures,...v]}),j=c.topology.links.map(a=>{let b=0;for(let c of i)for(let d=0;d<c.route.length-1;d++)(c.route[d]===a.from&&c.route[d+1]===a.to||c.route[d]===a.to&&c.route[d+1]===a.from)&&(b+=c.rate);return{...a,currentLoad:Math.min(1,b/a.capacity)}}),k=i.reduce((a,b)=>{let c=0;for(let a=0;a<b.route.length-1;a++){let d=j.find(c=>c.from===b.route[a]&&c.to===b.route[a+1]||c.from===b.route[a+1]&&c.to===b.route[a]);d&&(c+=d.latency*(1+d.currentLoad))}return a+c},0),l=i.length>0?k/i.length:0,m=i.reduce((a,b)=>a+b.rate,0),n=j.reduce((a,b)=>a+Math.max(0,b.currentLoad-1),0)/j.length,o=j.reduce((a,b)=>a+b.currentLoad,0)/j.length,p=l<=c.slaTargets.maxLatency&&m>=c.slaTargets.minThroughput&&n<=c.slaTargets.maxLoss,q=.9*c.metrics.availability+.1*!!p,s={...c,topology:{...c.topology,links:j},trafficFlows:i,metrics:{averageLatency:l,throughput:m,packetLoss:n,congestionLevel:o,availability:q}},s.currentTick+=1,s.currentTick>s.totalTicks?(s.status="finished",s.outcome=s.metrics.availability>=.95?"win":"loss"):s.metrics.availability<.5&&(s.status="finished",s.outcome="loss"),s}function j(){return{version:1,xp:0,currentTier:"operator",tierProgress:0,unlockedTopologies:["mesh","star"],unlockedPolicyTypes:["shortest-path","load-balanced"],unlockedTools:[],personalBests:{},currentStreak:0,longestStreak:0,lastPlayedDate:"",completedChallenges:[],stats:{topologiesCompleted:0,averageLatency:0,averageThroughput:0,averageAvailability:0,bottleneckIdentifications:0,policyChanges:0,topologyTypeStats:{}}}}a.i(260054);var k=a.i(389158);a.i(671016);var l=a.i(682313),m=a.i(485827);a.i(264057);var n=a.i(648309);a.i(126482);var o=a.i(196613);a.i(649317);var p=a.i(301944);a.i(930929);var q=a.i(103121),r=a.i(550165),s=a.i(132333),t=a.i(442299);a.i(896088);var u=a.i(129739),v=a.i(606346);let w={id:"packet-route",title:"Packet Route",description:"Design routing policies for network topologies",category:"strategy",modes:["solo","daily"],supportsMultiplayer:!1,minPlayers:1,maxPlayers:1,estimatedMinutes:15,tutorialAvailable:!0},x="packet-route";function y(){let[a,h]=(0,c.useState)("idle"),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1);(0,c.useEffect)(()=>{"idle"!==a||y||O()},[a,y]),(0,c.useEffect)(()=>{if(M&&"playing"===a&&y){let a=setInterval(()=>{let a=i(y);z(a),"finished"===a.status&&(N(!1),h("finished"),S(a))},2e3);return()=>clearInterval(a)}},[M,a,y]);let O=(0,c.useCallback)(()=>{try{var a,b;let c,d=(0,k.getOrGenerateTodayChallenge)(x),h=function(a,b,c){let d=new e.SeededRNG(a),{nodes:g,links:h}=function(a,b,c){let d=[],e=[];for(let a=0;a<b.nodeCount;a++)d.push({id:`node-${a}`,name:`Node ${a}`,x:a%5*100+50,y:100*Math.floor(a/5)+50,capacity:1e3+500*c.next(),currentLoad:0});switch(a){case"mesh":for(let a=0;a<d.length;a++)for(let g=a+1;g<d.length;g++)e.push(f(d[a].id,d[g].id,b,c));break;case"star":let g=d[0];for(let a=1;a<d.length;a++)e.push(f(g.id,d[a].id,b,c));break;case"tree":for(let a=1;a<d.length;a++){let g=d[Math.floor((a-1)/2)];e.push(f(g.id,d[a].id,b,c))}break;case"ring":for(let a=0;a<d.length;a++){let g=d[(a+1)%d.length];e.push(f(d[a].id,g.id,b,c))}break;case"hybrid":for(let a=0;a<d.length;a++){let g=d[(a+1)%d.length];e.push(f(d[a].id,g.id,b,c))}for(let a=0;a<d.length/2;a++){let a=c.sample(d,1)[0],g=c.sample(d.filter(b=>b.id!==a.id),1)[0];e.find(b=>b.from===a.id&&b.to===g.id||b.from===g.id&&b.to===a.id)||e.push(f(a.id,g.id,b,c))}}return{nodes:d,links:e}}(b,function(a){switch(a){case"foundations":return{nodeCount:5,linkCapacity:1e3,baseLatency:10};case"intermediate":return{nodeCount:10,linkCapacity:800,baseLatency:15};case"advanced":return{nodeCount:15,linkCapacity:600,baseLatency:20};case"expert":return{nodeCount:20,linkCapacity:500,baseLatency:25}}}(c),d);return{id:`topology-${a}`,name:`${b} Network ${a}`,type:b,difficulty:c,nodes:g,links:h,seed:a}}(d.seed,"mesh","intermediate"),i=(a={maxLatency:50,minThroughput:500,maxLoss:.01},b=d.seed,c=g(b,1,h.nodes),{topology:h,currentTick:0,totalTicks:function(a){switch(a){case"foundations":return 20;case"intermediate":return 30;case"advanced":case"expert":return 40}}(h.difficulty),routingPolicy:{type:"shortest-path",parameters:{}},trafficFlows:c,slaTargets:a,metrics:{averageLatency:0,throughput:0,packetLoss:0,congestionLevel:0,availability:1},failures:[],seed:b,status:"idle"});z(i),B(null),D(null),F([]),H(null),J(null)}catch(a){console.error("Error initializing challenge:",a)}},[]),P=(0,c.useCallback)(()=>{y?(z({...y,status:"playing",currentTick:1}),h("playing"),L(Date.now())):O()},[y,O]),Q=(0,c.useCallback)(b=>{y&&"playing"===a&&z({...y,routingPolicy:b})},[y,a]),R=(0,c.useCallback)(()=>{if(!y||"playing"!==a)return;let b=i(y);z(b),"finished"===b.status&&(h("finished"),S(b))},[y,a]),S=(0,c.useCallback)(a=>{var b;let c,d,e,f,g,h,i,q;if(!a.outcome||!K)return;let r=Date.now()-K,s="win"===a.outcome,t=100*a.metrics.availability,w=Math.max(0,100-a.metrics.averageLatency/a.slaTargets.maxLatency*100),y=Math.min(100,a.metrics.throughput/a.slaTargets.minThroughput*100),z=s?Math.round(.5*t+.25*w+.25*y):Math.round(.3*t),A=(0,l.generateTodayChallengeCode)(x,a.seed);(0,m.storeChallengeCode)(A),B(A);let C=(0,u.calculateBaseXP)({win:s,score:z,efficiency:100*a.metrics.availability,time:r,difficulty:a.topology.difficulty,tier:j().currentTier}),E=(0,n.getStreakDataForGame)(x),G=(0,u.createRewardContext)({gameId:x,seed:a.seed,baseXP:C,performance:{score:z,efficiency:100*a.metrics.availability,time:r},streak:E.currentStreak,tier:j().currentTier}),I=(0,v.generateRewardResult)(G),L=(b=j(),c={...b},c.stats.topologiesCompleted+=1,c.stats.averageLatency=(c.stats.averageLatency*(c.stats.topologiesCompleted-1)+a.metrics.averageLatency)/c.stats.topologiesCompleted,c.stats.averageThroughput=(c.stats.averageThroughput*(c.stats.topologiesCompleted-1)+a.metrics.throughput)/c.stats.topologiesCompleted,c.stats.averageAvailability=(c.stats.averageAvailability*(c.stats.topologiesCompleted-1)+a.metrics.availability)/c.stats.topologiesCompleted,d=`topology-${a.seed}`,(e=c.personalBests[d])&&!(z>e.bestScore)||(c.personalBests[d]={bestScore:z,bestLatency:a.metrics.averageLatency,bestThroughput:a.metrics.throughput,bestAvailability:a.metrics.availability}),c);L.xp=I.totalXP;let M={score:z,time:r,scoreValue:z,timestamp:Date.now()};H(M),D((0,p.submitScore)(A.code,M)),(0,k.completeTodayChallenge)(x,{score:z,time:r,scoreValue:z}),(0,n.updateStreakForGame)(x,!0),F((0,o.checkAndUnlockAchievements)({gameId:x,currentStreak:E.currentStreak+1,gamesCompleted:L.stats.topologiesCompleted,score:z,time:r}).newlyUnlocked),J((f=[],g=[],h=[],(i=a.topology.links.filter(a=>a.currentLoad>.8)).length>0&&g.push({tick:a.currentTick,description:`${i.length} links are congested (>80% load)`,cost:"Increased latency and packet loss",recommendation:"Use load balancing policy to distribute traffic"}),a.failures.length>0&&f.push({tick:a.currentTick,description:`Handled ${a.failures.length} link failures`,impact:a.metrics.availability>.9?"positive":"negative",reasoning:a.metrics.availability>.9?"Failures handled well, maintained availability":"Failures caused availability issues"}),a.metrics.congestionLevel>.7&&h.push({type:"routing",description:"Switch to load-balanced routing policy",rationale:"High congestion indicates need for better traffic distribution"}),a.failures.length>0&&a.metrics.availability<.9&&h.push({type:"resilience",description:"Implement resilient routing with backup paths",rationale:"Failures caused availability issues, need better resilience"}),q="win"===a.outcome?`Successfully maintained SLA targets with ${(100*a.metrics.availability).toFixed(1)}% availability. Average latency: ${a.metrics.averageLatency.toFixed(1)}ms.`:`Failed to maintain SLA targets. Availability dropped to ${(100*a.metrics.availability).toFixed(1)}%.`,{keyDecisions:f.slice(0,3),mistakes:g.slice(0,3),recommendations:h,summary:q}))},[K]),T=(0,c.useCallback)(()=>{h("idle"),z(null),B(null),D(null),F([]),H(null),J(null),L(null),N(!1)},[]),U=y?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Tick"}),(0,b.jsxs)("div",{className:"text-lg font-bold",children:[y.currentTick," / ",y.totalTicks]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"SLA Status"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsxs)("div",{children:["Latency: ",y.metrics.averageLatency.toFixed(1),"ms / ",y.slaTargets.maxLatency,"ms"]}),(0,b.jsxs)("div",{children:["Throughput: ",y.metrics.throughput.toFixed(0)," / ",y.slaTargets.minThroughput]}),(0,b.jsxs)("div",{children:["Loss: ",(100*y.metrics.packetLoss).toFixed(2),"%"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Availability"}),(0,b.jsxs)("div",{className:`text-lg font-bold ${y.metrics.availability>=.95?"text-green-600":y.metrics.availability>=.8?"text-yellow-600":"text-red-600"}`,children:[(100*y.metrics.availability).toFixed(1),"%"]})]})]}):null;return(0,b.jsx)(d.default,{config:w,status:a,onStart:P,onReset:T,rightPanel:U,children:(0,b.jsx)("div",{className:"p-4",children:y?"idle"===a?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:y.topology.name}),(0,b.jsx)("p",{className:"text-slate-600",children:"Design routing policies to meet SLA targets"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Nodes:"})," ",y.topology.nodes.length]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Ticks:"})," ",y.totalTicks]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"SLA Targets:"})," Latency <",y.slaTargets.maxLatency,"ms, Throughput >",y.slaTargets.minThroughput]})]}),(0,b.jsx)("button",{onClick:P,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Start Simulation"})]}):"playing"===a||"finished"===a?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Network Topology"}),(0,b.jsx)("div",{className:"grid grid-cols-5 gap-2",children:y.topology.nodes.map(a=>(0,b.jsx)("div",{className:"p-2 border rounded text-center text-xs",children:a.name},a.id))}),(0,b.jsxs)("div",{className:"mt-2 text-xs text-slate-600",children:["Links: ",y.topology.links.filter(a=>!a.failed).length," active, ",y.failures.length," failed"]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Performance Metrics"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-slate-600",children:"Latency"}),(0,b.jsxs)("div",{className:`text-lg font-bold ${y.metrics.averageLatency<=y.slaTargets.maxLatency?"text-green-600":"text-red-600"}`,children:[y.metrics.averageLatency.toFixed(1),"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-slate-600",children:"Throughput"}),(0,b.jsx)("div",{className:`text-lg font-bold ${y.metrics.throughput>=y.slaTargets.minThroughput?"text-green-600":"text-red-600"}`,children:y.metrics.throughput.toFixed(0)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-slate-600",children:"Packet Loss"}),(0,b.jsxs)("div",{className:`text-lg font-bold ${y.metrics.packetLoss<=y.slaTargets.maxLoss?"text-green-600":"text-red-600"}`,children:[(100*y.metrics.packetLoss).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-slate-600",children:"Congestion"}),(0,b.jsxs)("div",{className:`text-lg font-bold ${y.metrics.congestionLevel<.7?"text-green-600":"text-red-600"}`,children:[(100*y.metrics.congestionLevel).toFixed(0),"%"]})]})]})]}),"playing"===a&&(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Routing Policy"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>Q({type:"shortest-path",parameters:{}}),className:`px-3 py-2 rounded ${"shortest-path"===y.routingPolicy.type?"bg-blue-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Shortest Path"}),(0,b.jsx)("button",{onClick:()=>Q({type:"load-balanced",parameters:{}}),className:`px-3 py-2 rounded ${"load-balanced"===y.routingPolicy.type?"bg-blue-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Load Balanced"}),(0,b.jsx)("button",{onClick:()=>Q({type:"resilient",parameters:{}}),className:`px-3 py-2 rounded ${"resilient"===y.routingPolicy.type?"bg-blue-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Resilient"})]})]}),"playing"===a&&(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:R,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Advance Tick"}),(0,b.jsx)("button",{onClick:()=>N(!M),className:`px-4 py-2 rounded-lg ${M?"bg-red-600 text-white":"bg-slate-200 text-slate-700"}`,children:M?"Stop Auto":"Auto Advance"})]}),"finished"===a&&A&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`text-3xl font-bold mb-2 ${"win"===y.outcome?"text-green-600":"text-red-600"}`,children:"win"===y.outcome?"Success!":"Failed"}),(0,b.jsxs)("div",{className:"text-sm text-slate-600",children:["Availability: ",(100*y.metrics.availability).toFixed(1),"%"]})]}),(0,b.jsx)(q.ChallengeCodeShare,{code:A,score:G?.score||0}),C&&(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(r.ScoreComparisonDisplay,{comparison:C})}),(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(t.LeaderboardView,{challengeCode:A.code,playerScore:G||void 0})}),E.length>0&&(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(s.AchievementDisplay,{achievementIds:E,compact:!0})}),I&&(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Analysis"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-slate-900 mb-1",children:"Summary"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:I.summary})]}),I.recommendations.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-slate-900 mb-1",children:"Recommendations"}),(0,b.jsx)("ul",{className:"text-sm text-slate-600 list-disc list-inside space-y-1",children:I.recommendations.map((a,c)=>(0,b.jsx)("li",{children:a.description},c))})]})]})]}),(0,b.jsx)("button",{onClick:T,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"New Challenge"})]})]}):null:(0,b.jsx)("div",{className:"text-center text-slate-600",children:"Loading topology..."})})})}a.s(["default",()=>y],892040)}];

//# debugId=a454befa-8c23-a1af-f309-45ad42fbda01
//# sourceMappingURL=src_lib_games_games_packet-route_PacketRoute_tsx_14d3907c._.js.map