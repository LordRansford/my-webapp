{
  "version": 3,
  "sources": [],
  "debugId": "c53f51cb-21a4-ff3c-ab62-d15a7bebb3f7",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/app/admin/users/%5Bid%5D/ui.client.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport Link from \"next/link\";\n\ntype AdminUser = {\n  userId: string;\n  email: string;\n  role: string;\n  accountStatus: string;\n  createdAt: string;\n  lastActiveAt: string;\n};\n\nfunction toHuman(iso: string) {\n  try {\n    return new Date(iso).toLocaleString();\n  } catch {\n    return iso;\n  }\n}\n\nasync function postJson(url: string, body: any) {\n  const res = await fetch(url, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify(body),\n  });\n  const data = await res.json().catch(() => ({}));\n  if (!res.ok) throw new Error(data?.error || data?.message || \"Request failed\");\n  return data;\n}\n\nexport default function AdminUserClient({ user }: { user: AdminUser }) {\n  const [busy, setBusy] = useState<null | \"role\" | \"status\">(null);\n  const [error, setError] = useState<string | null>(null);\n  const [ok, setOk] = useState<string | null>(null);\n  const [role, setRole] = useState<string>(user.role);\n  const [status, setStatus] = useState<string>(user.accountStatus);\n  const [reasonRole, setReasonRole] = useState(\"\");\n  const [reasonStatus, setReasonStatus] = useState(\"\");\n\n  const roleOptions = useMemo(() => [\"NONE\", \"READ_ONLY\", \"SUPPORT\", \"ADMIN\", \"OWNER\"], []);\n  const statusOptions = useMemo(() => [\"active\", \"pending\", \"suspended\"], []);\n\n  const changeRole = async () => {\n    setError(null);\n    setOk(null);\n    const reason = reasonRole.trim();\n    if (!reason) return setError(\"Reason is required.\");\n    if (!confirm(\"Confirm role change\")) return;\n    setBusy(\"role\");\n    try {\n      await postJson(`/api/admin/users/${encodeURIComponent(user.userId)}/role`, { role, reason });\n      setOk(\"Role updated.\");\n      setReasonRole(\"\");\n    } catch (e: any) {\n      setError(e.message || \"Failed to update role.\");\n    } finally {\n      setBusy(null);\n    }\n  };\n\n  const changeStatus = async () => {\n    setError(null);\n    setOk(null);\n    const reason = reasonStatus.trim();\n    if (!reason) return setError(\"Reason is required.\");\n    if (!confirm(\"Confirm status change\")) return;\n    setBusy(\"status\");\n    try {\n      await postJson(`/api/admin/users/${encodeURIComponent(user.userId)}/status`, { status, reason });\n      setOk(\"Status updated.\");\n      setReasonStatus(\"\");\n    } catch (e: any) {\n      setError(e.message || \"Failed to update status.\");\n    } finally {\n      setBusy(null);\n    }\n  };\n\n  return (\n    <main className=\"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-6\">\n      <div className=\"flex flex-wrap items-baseline justify-between gap-2\">\n        <div className=\"space-y-1\">\n          <p className=\"text-xs font-semibold text-slate-600\">Users</p>\n          <h1 className=\"text-2xl font-semibold text-slate-900\">{user.email}</h1>\n          <p className=\"text-xs text-slate-600 font-mono\">User ID: {user.userId}</p>\n        </div>\n        <Link href=\"/admin/users\" className=\"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400\">\n          Back to users\n        </Link>\n      </div>\n\n      {error ? <div className=\"rounded-2xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900\">{error}</div> : null}\n      {ok ? <div className=\"rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-900\">{ok}</div> : null}\n\n      <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-3\">\n        <h2 className=\"text-lg font-semibold text-slate-900\">Profile summary</h2>\n        <div className=\"grid gap-3 sm:grid-cols-2\">\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Created</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{toHuman(user.createdAt)}</p>\n          </div>\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Last active</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{toHuman(user.lastActiveAt)}</p>\n          </div>\n        </div>\n      </section>\n\n      <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4\">\n        <h2 className=\"text-lg font-semibold text-slate-900\">Roles and permissions</h2>\n        <p className=\"text-sm text-slate-700\">Role changes require a reason and are audited.</p>\n        <div className=\"grid gap-3 md:grid-cols-3\">\n          <label className=\"space-y-1\">\n            <span className=\"text-xs font-semibold text-slate-700\">Role</span>\n            <select\n              value={role}\n              onChange={(e) => setRole(e.target.value)}\n              className=\"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n            >\n              {roleOptions.map((r) => (\n                <option key={r} value={r}>\n                  {r}\n                </option>\n              ))}\n            </select>\n          </label>\n          <label className=\"space-y-1 md:col-span-2\">\n            <span className=\"text-xs font-semibold text-slate-700\">Reason</span>\n            <input\n              value={reasonRole}\n              onChange={(e) => setReasonRole(e.target.value)}\n              placeholder=\"Required\"\n              className=\"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n            />\n          </label>\n        </div>\n        <button type=\"button\" className=\"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300\" disabled={busy !== null} onClick={changeRole}>\n          {busy === \"role\" ? \"Updating...\" : \"Change role\"}\n        </button>\n      </section>\n\n      <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4\">\n        <h2 className=\"text-lg font-semibold text-slate-900\">Account status</h2>\n        <p className=\"text-sm text-slate-700\">Status changes require a reason and are audited.</p>\n        <div className=\"grid gap-3 md:grid-cols-3\">\n          <label className=\"space-y-1\">\n            <span className=\"text-xs font-semibold text-slate-700\">Status</span>\n            <select\n              value={status}\n              onChange={(e) => setStatus(e.target.value)}\n              className=\"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n            >\n              {statusOptions.map((s) => (\n                <option key={s} value={s}>\n                  {s}\n                </option>\n              ))}\n            </select>\n          </label>\n          <label className=\"space-y-1 md:col-span-2\">\n            <span className=\"text-xs font-semibold text-slate-700\">Reason</span>\n            <input\n              value={reasonStatus}\n              onChange={(e) => setReasonStatus(e.target.value)}\n              placeholder=\"Required\"\n              className=\"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n            />\n          </label>\n        </div>\n        <button type=\"button\" className=\"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300\" disabled={busy !== null} onClick={changeStatus}>\n          {busy === \"status\" ? \"Updating...\" : \"Change status\"}\n        </button>\n      </section>\n    </main>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}