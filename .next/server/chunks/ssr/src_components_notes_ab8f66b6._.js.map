{
  "version": 3,
  "sources": [],
  "debugId": "d5fad59d-ede4-83c2-fd7d-904fcbc0a479",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/notes/hooks/use_tool_state.jsx","../../../../src/components/notes/ToolStateActions.jsx","../../../../src/components/notes/tools/cybersecurity/advanced/FrameworkMappingTool.jsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useMemo, useRef, useState } from 'react'\n\nfunction safe_json_parse(value, fallback) {\n  try {\n    return JSON.parse(value)\n  } catch {\n    return fallback\n  }\n}\n\nfunction encode_state(obj) {\n  const json = JSON.stringify(obj)\n  const bytes = new TextEncoder().encode(json)\n  let binary = ''\n  bytes.forEach((b) => {\n    binary += String.fromCharCode(b)\n  })\n  return btoa(binary)\n}\n\nfunction decode_state(b64) {\n  const binary = atob(b64)\n  const bytes = Uint8Array.from(binary, (c) => c.charCodeAt(0))\n  const json = new TextDecoder().decode(bytes)\n  return safe_json_parse(json, null)\n}\n\nexport function useToolState({ tool_id, initial_state }) {\n  const [state, set_state] = useState(initial_state)\n  const [is_ready, set_is_ready] = useState(false)\n  const initial_ref = useRef(initial_state)\n\n  const url_key = useMemo(() => {\n    if (typeof window === 'undefined') return null\n    const params = new URLSearchParams(window.location.search)\n    return params.get(`s_${tool_id}`)\n  }, [tool_id])\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return\n    const from_url = url_key ? decode_state(url_key) : null\n    if (from_url) {\n      set_state(from_url)\n      set_is_ready(true)\n      return\n    }\n    const saved = window.localStorage.getItem(`rn_tool_${tool_id}`)\n    if (saved) {\n      set_state(safe_json_parse(saved, initial_ref.current))\n      set_is_ready(true)\n      return\n    }\n    set_is_ready(true)\n  }, [tool_id, url_key])\n\n  useEffect(() => {\n    if (!is_ready) return\n    if (typeof window === 'undefined') return\n    window.localStorage.setItem(`rn_tool_${tool_id}`, JSON.stringify(state))\n  }, [state, tool_id, is_ready])\n\n  function reset() {\n    set_state(initial_ref.current)\n    if (typeof window !== 'undefined') {\n      window.localStorage.removeItem(`rn_tool_${tool_id}`)\n    }\n  }\n\n  function copy_share_link() {\n    if (typeof window === 'undefined') return\n    const params = new URLSearchParams(window.location.search)\n    params.set(`s_${tool_id}`, encode_state(state))\n    const url = `${window.location.pathname}?${params.toString()}`\n    navigator.clipboard.writeText(`${window.location.origin}${url}`)\n  }\n\n  function export_json() {\n    const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application_json' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = `${tool_id}_state.json`\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  async function import_json(file) {\n    const text = await file.text()\n    const parsed = safe_json_parse(text, null)\n    if (parsed) set_state(parsed)\n  }\n\n  return {\n    state,\n    set_state,\n    reset,\n    copy_share_link,\n    export_json,\n    import_json,\n    is_ready,\n  }\n}\n\n// Temporary alias to avoid breaking existing imports while keeping hook naming compliant.\nexport const use_tool_state = useToolState\n","'use client'\n\nexport function ToolStateActions({ onReset, onCopy, onExport, onImport }) {\n  return (\n    <div className=\"mt-3 flex flex-wrap gap-2 text-xs\">\n      {onReset ? (\n        <button\n          onClick={onReset}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Reset\n        </button>\n      ) : null}\n      {onCopy ? (\n        <button\n          onClick={onCopy}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Copy link\n        </button>\n      ) : null}\n      {onExport ? (\n        <button\n          onClick={onExport}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Export\n        </button>\n      ) : null}\n      {onImport ? (\n        <label className=\"inline-flex cursor-pointer items-center gap-1 rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus-within:ring focus-within:ring-blue-200\">\n          <span>Import</span>\n          <input\n            type=\"file\"\n            accept=\"application/json\"\n            onChange={(e) => {\n              const file = e.target.files?.[0]\n              if (file) onImport(file)\n              e.target.value = ''\n            }}\n            className=\"hidden\"\n          />\n        </label>\n      ) : null}\n    </div>\n  )\n}\n\nexport default ToolStateActions\n","\"use client\";\n\nimport { useMemo } from \"react\";\nimport { use_tool_state } from \"@/components/notes/hooks/use_tool_state\";\nimport ToolStateActions from \"@/components/notes/ToolStateActions\";\n\nconst CONTROLS = [\n  { id: \"asset-inventory\", label: \"Asset inventory\", hint: \"Know what you own and where it lives.\" },\n  { id: \"access-reviews\", label: \"Access reviews\", hint: \"Check who can reach sensitive systems.\" },\n  { id: \"logging\", label: \"Security logging\", hint: \"Collect and retain audit evidence.\" },\n  { id: \"incident-playbook\", label: \"Incident playbook\", hint: \"Document response steps and owners.\" },\n  { id: \"backup-recovery\", label: \"Backup and recovery\", hint: \"Restore safely after a failure or attack.\" },\n];\n\nconst CATEGORIES = [\"Identify\", \"Protect\", \"Detect\", \"Respond\", \"Recover\"];\n\nexport default function FrameworkMappingTool() {\n  const { state, set_state, reset, copy_share_link, export_json, import_json, is_ready } = use_tool_state({\n    tool_id: \"framework-mapping-tool\",\n    initial_state: { mapping: {} },\n  });\n\n  const summary = useMemo(() => {\n    const counts = Object.fromEntries(CATEGORIES.map((c) => [c, 0]));\n    Object.values(state.mapping || {}).forEach((category) => {\n      if (counts[category] !== undefined) counts[category] += 1;\n    });\n    return counts;\n  }, [state.mapping]);\n\n  if (!is_ready) return <p className=\"text-sm text-gray-600\">Loading.</p>;\n\n  return (\n    <div className=\"space-y-4 text-sm\">\n      <p className=\"text-gray-700\">\n        Map each control to the NIST CSF function that fits best. This is a thinking exercise, not a strict rule.\n      </p>\n\n      <div className=\"grid gap-3\">\n        {CONTROLS.map((control) => (\n          <label key={control.id} className=\"block rounded-lg border bg-gray-50 px-3 py-3\">\n            <div className=\"font-medium text-gray-900\">{control.label}</div>\n            <div className=\"text-xs text-gray-600\">{control.hint}</div>\n            <select\n              className=\"mt-2 w-full rounded-md border px-2 py-2 text-sm\"\n              value={state.mapping?.[control.id] || \"\"}\n              onChange={(e) =>\n                set_state((prev) => ({\n                  ...prev,\n                  mapping: { ...prev.mapping, [control.id]: e.target.value },\n                }))\n              }\n            >\n              <option value=\"\">Choose a category</option>\n              {CATEGORIES.map((category) => (\n                <option key={category} value={category}>\n                  {category}\n                </option>\n              ))}\n            </select>\n          </label>\n        ))}\n      </div>\n\n      <div className=\"rounded-lg border bg-white px-3 py-3\">\n        <div className=\"text-xs font-semibold text-gray-700\">Coverage snapshot</div>\n        <div className=\"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-5\">\n          {CATEGORIES.map((category) => (\n            <div key={category} className=\"rounded-md border bg-gray-50 px-2 py-2 text-xs text-gray-800\">\n              <div className=\"font-semibold\">{category}</div>\n              <div>{summary[category]} mapped control{summary[category] === 1 ? \"\" : \"s\"}</div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      <ToolStateActions onReset={reset} onCopy={copy_share_link} onExport={export_json} onImport={import_json} />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}