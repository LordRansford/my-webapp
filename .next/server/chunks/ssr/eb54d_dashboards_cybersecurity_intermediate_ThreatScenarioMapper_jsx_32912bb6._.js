;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4393bc8c-028a-cc24-f235-68d628fd37d5")}catch(e){}}();
module.exports=[887297,a=>{"use strict";var b=a.i(508171),c=a.i(127669);let d=[{id:"asset1",name:"Customer data",value:"high"},{id:"asset2",name:"Payment API",value:"high"},{id:"asset3",name:"Support inbox",value:"medium"}],e=[{id:"att1",name:"External attacker"},{id:"att2",name:"Insider"},{id:"att3",name:"Bot/scanner"}],f=[{id:"entry1",name:"Web portal"},{id:"entry2",name:"API"},{id:"entry3",name:"Support inbox"}];function g(){let[a,g]=(0,c.useState)(d),[j,k]=(0,c.useState)(e),[l,m]=(0,c.useState)(f),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)({attToEntry:[],entryToAsset:[]}),[t,u]=(0,c.useState)(""),v=(a,b,c)=>{s(d=>{let e="attToEntry"===c?d.attToEntry:d.entryToAsset,f=e.find(c=>c.from===a&&c.to===b)?e.filter(c=>c.from!==a||c.to!==b):[...e,{from:a,to:b}];return"attToEntry"===c?{...d,attToEntry:f}:{...d,entryToAsset:f}})};return(0,c.useMemo)(()=>{let b={};r.entryToAsset.forEach(a=>{b[a.to]=(b[a.to]||0)+1});let c=Object.entries(b).sort((a,b)=>b[1]-a[1])[0]?.[0],d=a.find(a=>a.id===c)||a[0],e=r.attToEntry.filter(a=>r.entryToAsset.some(b=>b.from===a.to&&b.to===d?.id)).map(a=>a.from).reduce((a,b)=>({...a,[b]:(a[b]||0)+1}),{}),f=Object.entries(e).sort((a,b)=>b[1]-a[1])[0]?.[0],g=j.find(a=>a.id===f)||j[0];d&&g?u(`${d.name} (value: ${d.value}) has the most connected entry points. ${g.name} has the most paths to it.`):u("Add links to see which attacker can most easily reach which asset.")},[a,j,r]),(0,b.jsxs)("div",{className:"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200",children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsx)(h,{title:"Assets",items:a,onAdd:()=>{a.length>=5||g([...a,{id:`asset-${Date.now()}`,name:"New asset",value:"low"}])},selected:null,onSelect:()=>{},type:"asset"}),(0,b.jsx)(h,{title:"Entry points",items:l,onAdd:()=>{l.length>=5||m([...l,{id:`entry-${Date.now()}`,name:"New entry point"}])},selected:p,onSelect:q,type:"entry"}),(0,b.jsx)(h,{title:"Attacker types",items:j,onAdd:()=>{j.length>=4||k([...j,{id:`att-${Date.now()}`,name:"New attacker"}])},selected:n,onSelect:o,type:"attacker"})]}),(0,b.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm",children:[(0,b.jsx)("h5",{className:"text-sm font-semibold text-slate-900",children:"Link attackers to entry points"}),(0,b.jsx)(i,{rows:j,cols:l,links:r.attToEntry,onToggle:(a,b)=>v(a,b,"attToEntry")})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm",children:[(0,b.jsx)("h5",{className:"text-sm font-semibold text-slate-900",children:"Link entry points to assets"}),(0,b.jsx)(i,{rows:l,cols:a,links:r.entryToAsset,onToggle:(a,b)=>v(a,b,"entryToAsset")})]})]}),(0,b.jsx)("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-sm",children:t})]})}function h({title:a,items:c,onAdd:d,selected:e,onSelect:f,type:g}){return(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-slate-900",children:a}),(0,b.jsx)("button",{onClick:d,className:"rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300",children:"Add"})]}),(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsxs)("button",{onClick:()=>f&&f(a.id),className:`w-full rounded-lg border px-3 py-2 text-left text-sm font-medium transition focus:outline-none focus:ring-2 focus:ring-sky-300 ${e===a.id?"border-sky-300 bg-sky-50 text-slate-900":"border-slate-200 bg-white text-slate-800"}`,children:[(0,b.jsx)("div",{className:"font-semibold",children:a.name}),a.value?(0,b.jsxs)("div",{className:"text-xs text-slate-700",children:["Value: ",a.value]}):null]},a.id))})]})}function i({rows:a,cols:c,links:d,onToggle:e}){return(0,b.jsx)("div",{className:"overflow-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-2 text-left text-slate-700",children:"From \\\\ To"}),c.map(a=>(0,b.jsx)("th",{className:"p-2 text-left text-slate-700",children:a.name},a.id))]})}),(0,b.jsx)("tbody",{children:a.map(a=>(0,b.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,b.jsx)("td",{className:"p-2 font-semibold text-slate-800",children:a.name}),c.map(c=>{let f=d.some(b=>b.from===a.id&&b.to===c.id);return(0,b.jsx)("td",{className:"p-2",children:(0,b.jsx)("button",{onClick:()=>e(a.id,c.id),className:`h-6 w-6 rounded-full border ${f?"border-emerald-300 bg-emerald-100":"border-slate-300 bg-white"} focus:outline-none focus:ring-2 focus:ring-sky-300`,"aria-label":"Toggle link"})},c.id)})]},a.id))})]})})}a.s(["default",()=>g])},205964,a=>{a.n(a.i(887297))}];

//# debugId=4393bc8c-028a-cc24-f235-68d628fd37d5
//# sourceMappingURL=eb54d_dashboards_cybersecurity_intermediate_ThreatScenarioMapper_jsx_32912bb6._.js.map