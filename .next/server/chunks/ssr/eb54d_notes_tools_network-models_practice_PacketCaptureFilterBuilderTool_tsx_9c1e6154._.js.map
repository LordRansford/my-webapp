{
  "version": 3,
  "sources": [],
  "debugId": "614af2f5-0ffb-c57d-a73d-34352639e071",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/notes/tools/network-models/practice/PacketCaptureFilterBuilderTool.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\n\ntype Scenario = {\n  id: string;\n  title: string;\n  wireshark: string;\n  tcpdump: string;\n  whatItShows: string;\n  caveats: string;\n};\n\nconst SCENARIOS: Scenario[] = [\n  {\n    id: \"dns\",\n    title: \"DNS lookups\",\n    wireshark: \"dns\",\n    tcpdump: \"udp port 53 or tcp port 53\",\n    whatItShows: \"DNS queries and responses. Useful for slow resolution, NXDOMAIN, and SERVFAIL.\",\n    caveats: \"Encrypted DNS changes what you can see. DNS over HTTPS is inside TLS on port 443.\",\n  },\n  {\n    id: \"tls-handshake\",\n    title: \"TLS handshake and certificate exchange\",\n    wireshark: \"tls.handshake\",\n    tcpdump: \"tcp port 443\",\n    whatItShows: \"Handshake messages, SNI, certificate chain exchange, and alert codes.\",\n    caveats: \"Application data is encrypted. You can still observe timing and handshake failures.\",\n  },\n  {\n    id: \"tcp-reset\",\n    title: \"TCP resets\",\n    wireshark: \"tcp.flags.reset == 1\",\n    tcpdump: \"tcp[tcpflags] & tcp-rst != 0\",\n    whatItShows: \"Connections that are being reset. Useful when sessions drop or fail to establish.\",\n    caveats: \"A reset is a symptom. It can be caused by policy, idle timeouts, or application crashes.\",\n  },\n  {\n    id: \"retransmissions\",\n    title: \"Retransmissions and loss signals\",\n    wireshark: \"tcp.analysis.retransmission or tcp.analysis.fast_retransmission\",\n    tcpdump: \"tcp\",\n    whatItShows: \"Loss signals and retransmission behaviour. Useful when the site feels slow or flaky.\",\n    caveats: \"Retransmissions can also occur during reordering. Confirm with multiple signals.\",\n  },\n];\n\nexport default function PacketCaptureFilterBuilderTool() {\n  const [scenarioId, setScenarioId] = useState(SCENARIOS[0].id);\n  const scenario = useMemo(() => SCENARIOS.find((s) => s.id === scenarioId) || SCENARIOS[0], [scenarioId]);\n\n  return (\n    <div className=\"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-800 dark:bg-slate-900/60\">\n      <div className=\"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between\">\n        <div>\n          <div className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Scenario</div>\n          <div className=\"mt-1 text-sm text-slate-700 dark:text-slate-200\">{scenario.title}</div>\n        </div>\n        <div className=\"w-full sm:w-72\">\n          <label className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">Pick a filter</label>\n          <select\n            value={scenarioId}\n            onChange={(e) => setScenarioId(e.target.value)}\n            className=\"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm outline-none focus:border-sky-400 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100\"\n          >\n            {SCENARIOS.map((s) => (\n              <option key={s.id} value={s.id}>\n                {s.title}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"mt-4 grid gap-3 sm:grid-cols-2\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-3 dark:border-slate-800 dark:bg-slate-950/40\">\n          <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300\">Wireshark display filter</div>\n          <pre className=\"mt-2 overflow-x-auto rounded-lg bg-white/70 p-2 text-xs text-slate-900 dark:bg-black/30 dark:text-slate-100\">\n{scenario.wireshark}\n          </pre>\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-3 dark:border-slate-800 dark:bg-slate-950/40\">\n          <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300\">tcpdump capture filter</div>\n          <pre className=\"mt-2 overflow-x-auto rounded-lg bg-white/70 p-2 text-xs text-slate-900 dark:bg-black/30 dark:text-slate-100\">\n{scenario.tcpdump}\n          </pre>\n        </div>\n      </div>\n\n      <div className=\"mt-4 text-sm text-slate-700 dark:text-slate-200\">\n        <div className=\"font-semibold text-slate-900 dark:text-slate-100\">What it shows</div>\n        <div className=\"mt-1\">{scenario.whatItShows}</div>\n        <div className=\"mt-3 font-semibold text-slate-900 dark:text-slate-100\">Caveats</div>\n        <div className=\"mt-1 text-slate-600 dark:text-slate-300\">{scenario.caveats}</div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"yDAEA,EAAA,EAAA,CAAA,CAAA,QAWA,IAAM,EAAwB,CAC5B,CACE,GAAI,MACJ,MAAO,cACP,UAAW,MACX,QAAS,6BACT,YAAa,iFACb,QAAS,mFACX,EACA,CACE,GAAI,gBACJ,MAAO,yCACP,UAAW,gBACX,QAAS,eACT,YAAa,wEACb,QAAS,qFACX,EACA,CACE,GAAI,YACJ,MAAO,aACP,UAAW,uBACX,QAAS,+BACT,YAAa,oFACb,QAAS,0FACX,EACA,CACE,GAAI,kBACJ,MAAO,mCACP,UAAW,kEACX,QAAS,MACT,YAAa,uFACb,QAAS,kFACX,EACD,CAEc,SAAS,IACtB,GAAM,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAAS,CAAC,EAAE,CAAC,EAAE,EACtD,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAU,IAAI,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,IAAe,CAAS,CAAC,EAAE,CAAE,CAAC,EAAW,EAEvG,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kHACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4EACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEAA2D,aAC1E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2DAAmD,EAAS,KAAK,MAElF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,oEAA2D,kBAC5E,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAc,EAAE,MAAM,CAAC,KAAK,EAC7C,UAAU,4MAET,EAAU,GAAG,CAAC,AAAC,GACd,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,UAC3B,EAAE,KAAK,EADG,EAAE,EAAE,WAQzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0GACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4FAAmF,6BAClG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uHACxB,EAAS,SAAS,MAGX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0GACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4FAAmF,2BAClG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uHACxB,EAAS,OAAO,SAKX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4DAAmD,kBAClE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBAAQ,EAAS,WAAW,GAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iEAAwD,YACvE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDAA2C,EAAS,OAAO,QAIlF"}}]
}