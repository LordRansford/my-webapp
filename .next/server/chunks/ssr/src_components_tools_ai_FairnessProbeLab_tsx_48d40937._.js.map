{
  "version": 3,
  "sources": [],
  "debugId": "b8cff5d2-4909-e39d-0231-beee835049d3",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/tools/ai/FairnessProbeLab.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport { Scale, UploadCloud } from \"lucide-react\";\nimport Papa from \"papaparse\";\nimport { Bar, BarChart, ResponsiveContainer, Tooltip, XAxis, YAxis } from \"recharts\";\nimport { AiToolCard } from \"./AiToolCard\";\nimport { validateUpload } from \"@/utils/validateUpload\";\nimport { SecurityBanner } from \"@/components/dev-studios/SecurityBanner\";\n\ntype Row = {\n  [key: string]: string | number | null;\n};\n\ntype ParsedData = {\n  columns: string[];\n  rows: Row[];\n};\n\ntype GroupMetrics = {\n  group: string;\n  count: number;\n  positivesTrue: number;\n  predictedPositive: number;\n  truePositive: number;\n  falsePositive: number;\n  falseNegative: number;\n  negativeTrue: number;\n  positiveRate: number;\n  tpr: number;\n  fpr: number;\n};\n\ntype SummaryRatios = {\n  positiveRateMin: number;\n  positiveRateMax: number;\n  positiveRateRatio: number | null;\n  tprMin: number;\n  tprMax: number;\n  tprRatio: number | null;\n};\n\nexport function FairnessProbeLab() {\n  const [parsedData, setParsedData] = useState<ParsedData | null>(null);\n  const [labelColumn, setLabelColumn] = useState<string>(\"\");\n  const [scoreColumn, setScoreColumn] = useState<string>(\"\");\n  const [groupColumn, setGroupColumn] = useState<string>(\"\");\n  const [positiveLabel, setPositiveLabel] = useState<string>(\"\");\n  const [threshold, setThreshold] = useState<number>(0.5);\n  const [statusMsg, setStatusMsg] = useState<string>(\n    \"Upload model outputs with true labels, scores and a group column to begin.\"\n  );\n\n  const handleFileChange = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const { safeFiles, errors } = validateUpload(e.target.files, { maxBytes: 8 * 1024 * 1024, allowedExtensions: [\".csv\"] });\n      if (errors.length) alert(errors.join(\"\\n\"));\n      const file = safeFiles[0];\n      if (!file) return;\n\n      setStatusMsg(\"Parsing CSVâ€¦\");\n      setParsedData(null);\n\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        dynamicTyping: true,\n        complete: (results) => {\n          const rows = results.data as Row[];\n          if (!rows || rows.length === 0) {\n            setStatusMsg(\"The CSV file appears to be empty or malformed.\");\n            return;\n          }\n          const first = rows[0];\n          const columns = Object.keys(first);\n          if (!columns.length) {\n            setStatusMsg(\"Could not detect any columns in the CSV file.\");\n            return;\n          }\n\n          setParsedData({ columns, rows });\n          setStatusMsg(\n            \"File loaded. Now choose the label, score and group columns, then pick a positive label and threshold.\"\n          );\n\n          if (!labelColumn) {\n            setLabelColumn(columns[0]);\n          }\n          if (!scoreColumn && columns.length > 1) {\n            setScoreColumn(columns[1]);\n          }\n          if (!groupColumn && columns.length > 2) {\n            setGroupColumn(columns[2]);\n          }\n        },\n        error: (err) => {\n          setStatusMsg(`Failed to parse CSV: ${err.message}`);\n        },\n      });\n    },\n    [labelColumn, scoreColumn, groupColumn]\n  );\n\n  const distinctLabels: string[] = useMemo(() => {\n    if (!parsedData || !labelColumn) return [];\n    const set = new Set<string>();\n    for (const row of parsedData.rows) {\n      const value = row[labelColumn];\n      if (value === null || value === undefined) continue;\n      const s = String(value).trim();\n      if (s.length > 0) set.add(s);\n    }\n    return Array.from(set.values());\n  }, [parsedData, labelColumn]);\n\n  const distinctGroups: string[] = useMemo(() => {\n    if (!parsedData || !groupColumn) return [];\n    const set = new Set<string>();\n    for (const row of parsedData.rows) {\n      const value = row[groupColumn];\n      if (value === null || value === undefined) continue;\n      const s = String(value).trim();\n      if (s.length > 0) set.add(s);\n    }\n    return Array.from(set.values());\n  }, [parsedData, groupColumn]);\n\n  const groupMetrics: GroupMetrics[] = useMemo(() => {\n    if (!parsedData || !labelColumn || !scoreColumn || !groupColumn || !positiveLabel) {\n      return [];\n    }\n\n    const map = new Map<string, GroupMetrics>();\n\n    for (const row of parsedData.rows) {\n      const rawLabel = row[labelColumn];\n      const rawScore = row[scoreColumn];\n      const rawGroup = row[groupColumn];\n\n      if (rawLabel === null || rawLabel === undefined) continue;\n      if (rawScore === null || rawScore === undefined) continue;\n      if (rawGroup === null || rawGroup === undefined) continue;\n\n      const label = String(rawLabel).trim();\n      const group = String(rawGroup).trim();\n      const score = typeof rawScore === \"number\" ? rawScore : Number(String(rawScore).replace(\",\", \".\"));\n\n      if (!Number.isFinite(score)) continue;\n\n      let gm = map.get(group);\n      if (!gm) {\n        gm = {\n          group,\n          count: 0,\n          positivesTrue: 0,\n          predictedPositive: 0,\n          truePositive: 0,\n          falsePositive: 0,\n          falseNegative: 0,\n          negativeTrue: 0,\n          positiveRate: 0,\n          tpr: 0,\n          fpr: 0,\n        };\n        map.set(group, gm);\n      }\n\n      gm.count += 1;\n      const isPositiveTrue = label === positiveLabel;\n      const isPredictedPositive = score >= threshold;\n\n      if (isPositiveTrue) {\n        gm.positivesTrue += 1;\n      } else {\n        gm.negativeTrue += 1;\n      }\n\n      if (isPredictedPositive) {\n        gm.predictedPositive += 1;\n      }\n\n      if (isPositiveTrue && isPredictedPositive) {\n        gm.truePositive += 1;\n      } else if (!isPositiveTrue && isPredictedPositive) {\n        gm.falsePositive += 1;\n      } else if (isPositiveTrue && !isPredictedPositive) {\n        gm.falseNegative += 1;\n      }\n    }\n\n    const results: GroupMetrics[] = [];\n    for (const gm of map.values()) {\n      gm.positiveRate = gm.count > 0 ? gm.predictedPositive / gm.count : 0;\n      gm.tpr = gm.positivesTrue > 0 ? gm.truePositive / gm.positivesTrue : 0;\n      gm.fpr = gm.negativeTrue > 0 ? gm.falsePositive / gm.negativeTrue : 0;\n      results.push(gm);\n    }\n\n    results.sort((a, b) => a.group.localeCompare(b.group));\n    return results;\n  }, [parsedData, labelColumn, scoreColumn, groupColumn, positiveLabel, threshold]);\n\n  const summary: SummaryRatios | null = useMemo(() => {\n    if (!groupMetrics.length) return null;\n\n    const positiveRates = groupMetrics.map((g) => g.positiveRate);\n    const tprs = groupMetrics.map((g) => g.tpr);\n\n    const positiveRateMin = Math.min(...positiveRates);\n    const positiveRateMax = Math.max(...positiveRates);\n    const tprMin = Math.min(...tprs);\n    const tprMax = Math.max(...tprs);\n\n    const positiveRateRatio = positiveRateMax > 0 ? positiveRateMin / positiveRateMax : null;\n    const tprRatio = tprMax > 0 ? tprMin / tprMax : null;\n\n    return {\n      positiveRateMin,\n      positiveRateMax,\n      positiveRateRatio,\n      tprMin,\n      tprMax,\n      tprRatio,\n    };\n  }, [groupMetrics]);\n\n  const positiveRateChart = useMemo(\n    () =>\n      groupMetrics.map((g) => ({\n        group: g.group,\n        value: Number(g.positiveRate.toFixed(3)),\n      })),\n    [groupMetrics]\n  );\n\n  const tprChart = useMemo(\n    () =>\n      groupMetrics.map((g) => ({\n        group: g.group,\n        value: Number(g.tpr.toFixed(3)),\n      })),\n    [groupMetrics]\n  );\n\n  const canCompute = useMemo(\n    () =>\n      Boolean(parsedData) &&\n      Boolean(labelColumn) &&\n      Boolean(scoreColumn) &&\n      Boolean(groupColumn) &&\n      Boolean(positiveLabel) &&\n      groupMetrics.length > 0,\n    [parsedData, labelColumn, scoreColumn, groupColumn, positiveLabel, groupMetrics]\n  );\n\n  const currentColumns = parsedData?.columns ?? [];\n\n  return (\n    <AiToolCard\n      id=\"fairness-probe-lab-title\"\n      title=\"Bias and fairness probe\"\n      icon={<Scale className=\"h-4 w-4\" aria-hidden=\"true\" />}\n      description=\"Upload model outputs, choose a group column and see how positive rates and true positive rates vary between groups.\"\n    >\n      <SecurityBanner />\n\n      <div className=\"grid gap-6 xl:grid-cols-3\">\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 1 - Upload model outputs</p>\n          <p className=\"text-sm text-slate-600\">\n            Use a CSV with one row per prediction. Include the true label, a model score between 0 and 1 and at least one group\n            column such as gender, region or customer segment.\n          </p>\n\n          <div className=\"space-y-2\">\n            <label htmlFor=\"fairness-upload\" className=\"block text-sm font-medium text-slate-700\">\n              CSV file\n            </label>\n            <div className=\"flex items-center gap-3\">\n              <label\n                htmlFor=\"fairness-upload\"\n                className=\"inline-flex cursor-pointer items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm hover:border-sky-300 hover:text-sky-700\"\n              >\n                <UploadCloud className=\"h-4 w-4\" aria-hidden=\"true\" />\n                <span>Choose file</span>\n              </label>\n              <input id=\"fairness-upload\" type=\"file\" accept=\".csv,text/csv\" className=\"hidden\" onChange={handleFileChange} />\n              <span className=\"text-sm text-slate-500\">CSV only, max 8MB. Processed locally in your browser.</span>\n            </div>\n          </div>\n\n          <div className=\"space-y-3 pt-2\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"label-column\" className=\"block text-sm font-medium text-slate-700\">\n                True label column\n              </label>\n              <select\n                id=\"label-column\"\n                value={labelColumn}\n                onChange={(e) => setLabelColumn(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select label column</option>\n                {currentColumns.map((col) => (\n                  <option key={col} value={col}>\n                    {col}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"score-column\" className=\"block text-sm font-medium text-slate-700\">\n                Score or probability column\n              </label>\n              <select\n                id=\"score-column\"\n                value={scoreColumn}\n                onChange={(e) => setScoreColumn(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select score column</option>\n                {currentColumns.map((col) => (\n                  <option key={col} value={col}>\n                    {col}\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-sm text-slate-500\">\n                Scores should be between 0 and 1. They are treated as the model&apos;s confidence in the positive class.\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"group-column\" className=\"block text-sm font-medium text-slate-700\">\n                Group column\n              </label>\n              <select\n                id=\"group-column\"\n                value={groupColumn}\n                onChange={(e) => setGroupColumn(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select group column</option>\n                {currentColumns.map((col) => (\n                  <option key={col} value={col}>\n                    {col}\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-sm text-slate-500\">\n                Use a column like gender, country, customer segment, tariff type or any other group that you wish to analyse.\n              </p>\n            </div>\n          </div>\n\n          <p className=\"text-sm text-slate-500\">{statusMsg}</p>\n        </div>\n\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 2 - Choose positive class and threshold</p>\n          <p className=\"text-sm text-slate-600\">\n            The positive label is the outcome you are most concerned about. For example, in a fraud model it might be fraud, in a\n            safety model it might be unsafe.\n          </p>\n\n          <div className=\"grid gap-3 sm:grid-cols-2\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"positive-label\" className=\"block text-sm font-medium text-slate-700\">\n                Positive label\n              </label>\n              <select\n                id=\"positive-label\"\n                value={positiveLabel}\n                onChange={(e) => setPositiveLabel(e.target.value)}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              >\n                <option value=\"\">Select positive label</option>\n                {distinctLabels.map((lab) => (\n                  <option key={lab} value={lab}>\n                    {lab}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"threshold\" className=\"block text-sm font-medium text-slate-700\">\n                Decision threshold\n              </label>\n              <input\n                id=\"threshold\"\n                type=\"number\"\n                min={0}\n                max={1}\n                step={0.01}\n                value={threshold}\n                onChange={(e) => setThreshold(Math.min(1, Math.max(0, Number(e.target.value))))}\n                className=\"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200\"\n              />\n              <p className=\"text-sm text-slate-500\">\n                Scores greater than or equal to this value are treated as positive predictions.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <p className=\"text-sm font-medium text-slate-700\">Positive prediction rate by group</p>\n            <div className=\"h-44 rounded-2xl border border-slate-200 bg-white px-3 py-2\">\n              {canCompute ? (\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={positiveRateChart}>\n                    <XAxis dataKey=\"group\" tick={{ fontSize: 9 }} interval={0} />\n                    <YAxis\n                      tick={{ fontSize: 9 }}\n                      domain={[0, 1]}\n                      label={{ value: \"Positive rate\", angle: -90, position: \"insideLeft\", fontSize: 10 }}\n                    />\n                    <Tooltip contentStyle={{ fontSize: 10, borderRadius: 12, padding: 8 }} />\n                    <Bar dataKey=\"value\" fill=\"#0f766e\" radius={[8, 8, 0, 0]} />\n                  </BarChart>\n                </ResponsiveContainer>\n              ) : (\n                <p className=\"text-sm text-slate-500\">\n                  Once you have selected a positive label and threshold the chart will show how often each group is predicted as\n                  positive.\n                </p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <p className=\"text-sm font-medium text-slate-700\">True positive rate by group</p>\n            <div className=\"h-44 rounded-2xl border border-slate-200 bg-white px-3 py-2\">\n              {canCompute ? (\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={tprChart}>\n                    <XAxis dataKey=\"group\" tick={{ fontSize: 9 }} interval={0} />\n                    <YAxis\n                      tick={{ fontSize: 9 }}\n                      domain={[0, 1]}\n                      label={{ value: \"True positive rate\", angle: -90, position: \"insideLeft\", fontSize: 10 }}\n                    />\n                    <Tooltip contentStyle={{ fontSize: 10, borderRadius: 12, padding: 8 }} />\n                    <Bar dataKey=\"value\" fill=\"#6366f1\" radius={[8, 8, 0, 0]} />\n                  </BarChart>\n                </ResponsiveContainer>\n              ) : (\n                <p className=\"text-sm text-slate-500\">\n                  Once a positive label is chosen the chart will show how frequently the model correctly identifies positive cases\n                  for each group.\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 xl:col-span-1\">\n          <p className=\"text-xs font-semibold text-slate-700\">Step 3 - Inspect group metrics and ratios</p>\n          <p className=\"text-sm text-slate-600\">\n            Use this view to reason about whether the model treats groups consistently. You can adjust the threshold to see how\n            trade offs change.\n          </p>\n\n          <div className=\"max-h-56 overflow-auto rounded-2xl border border-slate-200 bg-white\">\n            <table className=\"min-w-full table-fixed border-collapse text-sm text-slate-700\">\n              <thead className=\"bg-slate-50\">\n                <tr>\n                  <th className=\"px-2 py-1 text-left font-semibold\">Group</th>\n                  <th className=\"px-2 py-1 text-right font-semibold\">Count</th>\n                  <th className=\"px-2 py-1 text-right font-semibold\">Pos rate</th>\n                  <th className=\"px-2 py-1 text-right font-semibold\">TPR</th>\n                  <th className=\"px-2 py-1 text-right font-semibold\">FPR</th>\n                </tr>\n              </thead>\n              <tbody>\n                {groupMetrics.length === 0 ? (\n                  <tr>\n                    <td colSpan={5} className=\"px-2 py-2 text-center text-sm text-slate-500\">\n                      Metrics will appear here after you upload data and choose columns.\n                    </td>\n                  </tr>\n                ) : (\n                  groupMetrics.map((g) => (\n                    <tr key={g.group} className=\"border-t border-slate-100\">\n                      <td className=\"px-2 py-1 text-left\">{g.group}</td>\n                      <td className=\"px-2 py-1 text-right\">{g.count}</td>\n                      <td className=\"px-2 py-1 text-right\">{g.positiveRate.toFixed(3)}</td>\n                      <td className=\"px-2 py-1 text-right\">{g.tpr.toFixed(3)}</td>\n                      <td className=\"px-2 py-1 text-right\">{g.fpr.toFixed(3)}</td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700 space-y-1\">\n            {summary && canCompute ? (\n              <>\n                <p className=\"font-semibold text-slate-900\">Quick fairness summary</p>\n                <p>\n                  The lowest positive prediction rate across groups is{\" \"}\n                  <span className=\"font-medium\">{summary.positiveRateMin.toFixed(3)}</span> and the highest is{\" \"}\n                  <span className=\"font-medium\">{summary.positiveRateMax.toFixed(3)}</span>.\n                </p>\n                {summary.positiveRateRatio !== null && (\n                  <p>\n                    The ratio of lowest to highest positive rate is{\" \"}\n                    <span className=\"font-medium\">{summary.positiveRateRatio.toFixed(3)}</span>. Values closer to 1 suggest more\n                    similar treatment between groups on this measure.\n                  </p>\n                )}\n                <p>\n                  The lowest true positive rate across groups is{\" \"}\n                  <span className=\"font-medium\">{summary.tprMin.toFixed(3)}</span> and the highest is{\" \"}\n                  <span className=\"font-medium\">{summary.tprMax.toFixed(3)}</span>.\n                </p>\n                {summary.tprRatio !== null && (\n                  <p>\n                    The ratio of lowest to highest true positive rate is{\" \"}\n                    <span className=\"font-medium\">{summary.tprRatio.toFixed(3)}</span>. This helps you see if some groups receive\n                    significantly fewer correct positive predictions.\n                  </p>\n                )}\n                <p className=\"text-slate-500\">\n                  This lab is not a full fairness audit. It is a practical way to see how different groups experience your model\n                  and to start conversations about whether those differences are acceptable, explainable or need action.\n                </p>\n              </>\n            ) : (\n              <p className=\"text-slate-500\">\n                Once you have uploaded data and chosen a positive label and threshold this box will highlight key differences\n                between groups.\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </AiToolCard>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}