{
  "version": 3,
  "sources": [],
  "debugId": "d215ce32-e8f7-8920-54b3-658da1b2a5de",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/tools/cybersecurity/EmailHeaderLab.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\n\ntype Verdict = \"safe\" | \"caution\" | \"risky\";\n\nfunction scoreHeader(raw: string): { verdict: Verdict; reasons: string[] } {\n  const text = raw.toLowerCase();\n  const reasons: string[] = [];\n\n  if (!text.includes(\"authentication-results\")) {\n    reasons.push(\"No Authentication-Results header was found.\");\n  }\n  if (!text.includes(\"spf=\")) {\n    reasons.push(\"No SPF result was found in Authentication-Results.\");\n  } else if (text.includes(\"spf=fail\") || text.includes(\"spf=softfail\")) {\n    reasons.push(\"SPF check failed for this message.\");\n  }\n  if (text.includes(\"dkim=fail\")) {\n    reasons.push(\"DKIM signature failed validation.\");\n  }\n  if (!text.includes(\"dmarc=\")) {\n    reasons.push(\"No DMARC result was found in Authentication-Results.\");\n  } else if (text.includes(\"dmarc=fail\")) {\n    reasons.push(\"DMARC evaluation failed for this message.\");\n  }\n\n  const receivedCount = (text.match(/received:/g) || []).length;\n  if (receivedCount < 2) {\n    reasons.push(\"Only one Received header was found which is unusual.\");\n  }\n\n  let verdict: Verdict = \"safe\";\n  const lowerReasons = reasons.join(\" \").toLowerCase();\n\n  if (\n    lowerReasons.includes(\"failed\") ||\n    lowerReasons.includes(\"unusual\") ||\n    lowerReasons.includes(\"no dmarc\")\n  ) {\n    verdict = \"caution\";\n  }\n  if (\n    lowerReasons.includes(\"spf check failed\") ||\n    lowerReasons.includes(\"dkim signature failed\") ||\n    lowerReasons.includes(\"dmarc evaluation failed\")\n  ) {\n    verdict = \"risky\";\n  }\n\n  return { verdict, reasons };\n}\n\nconst sampleHeader = `Return-Path: <billing@example-payments.com>\nReceived: from mail-ot1-f45.google.com (mail-ot1-f45.google.com. [209.85.210.45])\n        by mx.example.org with ESMTPS id f19si123456qkf.123.2024.01.15.09.13.10\n        for <you@example.org>\n        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384);\n        Mon, 15 Jan 2024 09:13:10 +0000 (UTC)\nAuthentication-Results: mx.example.org;\n        spf=softfail (google.com: domain of transitioning billing@example-payments.com does not designate 209.85.210.45 as permitted sender) smtp.mailfrom=billing@example-payments.com;\n        dkim=fail;\n        dmarc=fail;\nFrom: \"Payments team\" <billing@example-payments.com>\nTo: you@example.org\nSubject: Urgent: account suspended, update details now\nDate: Mon, 15 Jan 2024 09:12:58 +0000`;\n\nexport function EmailHeaderLab() {\n  const [header, setHeader] = useState(\"\");\n  const [useSample, setUseSample] = useState(false);\n\n  const activeHeader = useSample ? sampleHeader : header;\n  const { verdict, reasons } = activeHeader.trim()\n    ? scoreHeader(activeHeader)\n    : { verdict: \"safe\" as Verdict, reasons: [] };\n\n  const verdictLabel =\n    verdict === \"safe\"\n      ? \"Signals are mostly consistent. Still stay alert.\"\n      : verdict === \"caution\"\n      ? \"Signals are mixed. Treat this message with caution.\"\n      : \"Multiple signals look risky. Treat this message as suspicious.\";\n\n  const verdictColor =\n    verdict === \"safe\"\n      ? \"bg-emerald-50 text-emerald-800 border-emerald-200\"\n      : verdict === \"caution\"\n      ? \"bg-amber-50 text-amber-800 border-amber-200\"\n      : \"bg-rose-50 text-rose-800 border-rose-200\";\n\n  return (\n    <section\n      aria-labelledby=\"email-header-lab-title\"\n      className=\"rounded-3xl bg-white shadow-sm ring-1 ring-slate-100 p-6 sm:p-8 space-y-6\"\n    >\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n        <div>\n          <h2\n            id=\"email-header-lab-title\"\n            className=\"text-lg sm:text-xl font-semibold text-slate-900\"\n          >\n            Email header explainer\n          </h2>\n          <p className=\"mt-1 text-sm text-slate-600 max-w-xl\">\n            Paste an email header and see how SPF, DKIM and DMARC results\n            affect your trust in the message. Nothing leaves your browser.\n          </p>\n        </div>\n        <button\n          type=\"button\"\n          onClick={() => setUseSample((v) => !v)}\n          className=\"inline-flex items-center justify-center rounded-full border border-slate-200 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2\"\n        >\n          {useSample ? \"Use your own header\" : \"Use example header\"}\n        </button>\n      </header>\n\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        <div className=\"space-y-3\">\n          <label\n            htmlFor=\"email-header-input\"\n            className=\"text-xs font-medium uppercase tracking-wide text-slate-500\"\n          >\n            Header text\n          </label>\n          <textarea\n            id=\"email-header-input\"\n            className=\"h-56 w-full resize-none rounded-2xl border border-slate-200 bg-slate-50/60 px-3 py-2 text-sm font-mono text-slate-800 shadow-inner focus:border-sky-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-200\"\n            placeholder=\"Paste the full email header here...\"\n            value={useSample ? sampleHeader : header}\n            onChange={(e) => {\n              setUseSample(false);\n              setHeader(e.target.value);\n            }}\n          />\n          <p className=\"text-xs text-slate-500\">\n            Tip: In most email clients you can view the raw header via menu\n            options like View original or Show source. Never paste sensitive\n            content from private or confidential emails.\n          </p>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div\n            className={`rounded-2xl border px-4 py-3 text-sm font-medium ${verdictColor}`}\n          >\n            <p className=\"text-xs uppercase tracking-wide mb-1\">\n              Overall signal\n            </p>\n            <p>{activeHeader.trim() ? verdictLabel : \"Waiting for a header.\"}</p>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-3\">\n            <h3 className=\"text-sm font-semibold text-slate-900\">\n              How to read this\n            </h3>\n            <ul className=\"space-y-1.5 text-xs text-slate-700\">\n              <li>\n                <span className=\"font-semibold\">SPF</span> confirms the sending\n                server is allowed to send mail for this domain.\n              </li>\n              <li>\n                <span className=\"font-semibold\">DKIM</span> is a digital\n                signature that proves the message has not been changed in\n                transit.\n              </li>\n              <li>\n                <span className=\"font-semibold\">DMARC</span> tells receivers how\n                strictly to treat failures and can signal phishing.\n              </li>\n            </ul>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-100 bg-white p-4 space-y-2\">\n            <h3 className=\"text-sm font-semibold text-slate-900\">\n              Signals from this header\n            </h3>\n            {activeHeader.trim() ? (\n              <ul className=\"list-disc pl-5 space-y-1.5 text-xs text-slate-700\">\n                {reasons.length === 0 && (\n                  <li>\n                    No obvious red flags were found. This does not guarantee the\n                    message is safe. Always check the content and context.\n                  </li>\n                )}\n                {reasons.map((reason, idx) => (\n                  <li key={idx}>{reason}</li>\n                ))}\n              </ul>\n            ) : (\n              <p className=\"text-xs text-slate-500\">\n                Paste a header to see a breakdown of the main signals.\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}