;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="eed3b128-0da4-ff63-c667-c65f8c2fdc33")}catch(e){}}();
module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},569264,a=>{a.n(a.i(354832))},881967,a=>{a.n(a.i(429735))},900827,a=>{a.n(a.i(995845))},918554,a=>{a.n(a.i(316801))},517537,a=>{a.n(a.i(903363))},13718,a=>{a.n(a.i(685523))},118198,a=>{a.n(a.i(545518))},444067,a=>{a.n(a.i(436102))},989644,a=>{a.n(a.i(736900))},757013,a=>{"use strict";var b=a.i(907997),c=a.i(395936),d=a.i(929073);function e(a){let b=(a/100).toFixed(2);return`\xa3${b}`}async function f({searchParams:a}){let f=await a,g=(f.user||"").trim(),h=(f.toolId||"").trim(),i=(f.status||"").trim(),j=(f.from||"").trim(),k=(f.to||"").trim(),l=f.cursor||null,m={};g&&(m.userId=g),h&&(m.toolId=h),i&&(m.status=i),(j||k)&&(m.createdAt={},j&&(m.createdAt.gte=new Date(j)),k&&(m.createdAt.lte=new Date(k)));let n=[];try{n=await d.prisma.toolRun.findMany({where:m,take:31,...l?{cursor:{id:l},skip:1}:{},orderBy:{createdAt:"desc"},select:{id:!0,createdAt:!0,userId:!0,toolId:!0,computeMs:!0,computeUnits:!0,costPence:!0,freeTierCoveredPence:!0,paidTierChargedPence:!0,status:!0}})}catch{n=[]}let o=n.length>30?n[30]:null,p=n.slice(0,30);return(0,b.jsxs)("main",{className:"mx-auto max-w-6xl px-4 py-10 md:px-6 lg:px-8 space-y-6",children:[(0,b.jsxs)("header",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"Billing"}),(0,b.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Usage and costs"}),(0,b.jsx)("p",{className:"text-slate-700",children:"Read-only tool run ledger."})]}),(0,b.jsxs)("form",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm flex flex-wrap gap-3 items-end",action:"/admin/billing/usage",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"User"}),(0,b.jsx)("input",{name:"user",defaultValue:g,placeholder:"User ID",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Tool"}),(0,b.jsx)("input",{name:"toolId",defaultValue:h,placeholder:"tool id",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Status"}),(0,b.jsx)("input",{name:"status",defaultValue:i,placeholder:"success",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"From"}),(0,b.jsx)("input",{name:"from",defaultValue:j,placeholder:"YYYY-MM-DD",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"To"}),(0,b.jsx)("input",{name:"to",defaultValue:k,placeholder:"YYYY-MM-DD",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]}),(0,b.jsx)("button",{type:"submit",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800",children:"Apply"})]}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-slate-50 text-slate-700",children:(0,b.jsx)("tr",{children:["Created","User","Tool","Compute (ms)","Units","Cost","Free","Paid","Status"].map(a=>(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold",children:a},a))})}),(0,b.jsxs)("tbody",{children:[p.map(a=>(0,b.jsxs)("tr",{className:"border-t border-slate-100",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:function(a){try{return new Date(a).toLocaleString()}catch{return String(a)}}(a.createdAt)}),(0,b.jsx)("td",{className:"px-4 py-3 font-mono text-xs text-slate-700",children:a.userId||"anonymous"}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:(0,b.jsx)(c.default,{href:`/admin/billing/usage/${encodeURIComponent(a.id)}`,className:"font-semibold text-emerald-700 hover:underline",children:a.toolId})}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:a.computeMs}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:a.computeUnits}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:e(Number(a.costPence||0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e(Number(a.freeTierCoveredPence||0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e(Number(a.paidTierChargedPence||0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:a.status})]},a.id)),0===p.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:9,className:"px-4 py-8 text-center text-slate-600",children:"No tool runs recorded yet."})}):null]})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(c.default,{href:"/admin/billing",className:"text-sm font-semibold text-emerald-700 hover:underline",children:"Back to billing overview"}),o?(0,b.jsx)(c.default,{href:`/admin/billing/usage?user=${encodeURIComponent(g)}&toolId=${encodeURIComponent(h)}&status=${encodeURIComponent(i)}&from=${encodeURIComponent(j)}&to=${encodeURIComponent(k)}&cursor=${encodeURIComponent(o.id)}`,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400",children:"Next page"}):(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"End"})]})]})}a.s(["default",()=>f,"dynamic",0,"force-dynamic","metadata",0,{title:"Admin: Usage and costs",robots:{index:!1,follow:!1}}])}];

//# debugId=eed3b128-0da4-ff63-c667-c65f8c2fdc33
//# sourceMappingURL=%5Broot-of-the-server%5D__45d3a84f._.js.map