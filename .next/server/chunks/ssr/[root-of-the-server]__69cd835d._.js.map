{
  "version": 3,
  "sources": [],
  "debugId": "12a65614-4c35-229c-ff95-49992383ec65",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/app/admin/billing/usage/%5Bid%5D/page.tsx"],"sourcesContent":["import Link from \"next/link\";\nimport { prisma } from \"@/lib/db/prisma\";\n\nexport const dynamic = \"force-dynamic\";\n\nexport const metadata = {\n  title: \"Admin: Tool run detail\",\n  robots: { index: false, follow: false },\n};\n\nfunction toHuman(d: any) {\n  try {\n    return new Date(d).toLocaleString();\n  } catch {\n    return String(d);\n  }\n}\n\nfunction formatPence(pence: number) {\n  const pounds = (pence / 100).toFixed(2);\n  return `Â£${pounds}`;\n}\n\nexport default async function ToolRunDetailPage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = await params;\n  let r: any = null;\n  try {\n    r = await (prisma as any).toolRun.findUnique({\n      where: { id },\n      select: {\n        id: true,\n        userId: true,\n        toolId: true,\n        courseId: true,\n        pageId: true,\n        inputSizeBytes: true,\n        computeUnits: true,\n        computeMs: true,\n        costPence: true,\n        freeTierCoveredPence: true,\n        paidTierChargedPence: true,\n        status: true,\n        createdAt: true,\n        metadata: true,\n      },\n    });\n  } catch {\n    r = null;\n  }\n\n  if (!r) {\n    return (\n      <main className=\"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-3\">\n        <h1 className=\"text-2xl font-semibold text-slate-900\">Run not found</h1>\n        <p className=\"text-slate-700\">This tool run does not exist.</p>\n      </main>\n    );\n  }\n\n  return (\n    <main className=\"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-6\">\n      <header className=\"space-y-2\">\n        <p className=\"text-xs font-semibold text-slate-600\">Billing</p>\n        <h1 className=\"text-2xl font-semibold text-slate-900\">Tool run detail</h1>\n        <p className=\"text-slate-700\">Read-only breakdown with safe metadata only.</p>\n      </header>\n\n      <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-3\">\n        <div className=\"grid gap-3 sm:grid-cols-2\">\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Created</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{toHuman(r.createdAt)}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Status</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{r.status}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">User</p>\n            <p className=\"mt-1 font-mono text-xs text-slate-700\">{r.userId || \"anonymous\"}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Tool</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{r.toolId}</p>\n          </div>\n        </div>\n\n        <div className=\"grid gap-3 sm:grid-cols-3\">\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Compute</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{r.computeMs} ms</p>\n            <p className=\"text-xs text-slate-600\">Units: {r.computeUnits}</p>\n          </div>\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Cost</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{formatPence(Number(r.costPence || 0))}</p>\n            <p className=\"text-xs text-slate-600\">Free covered: {formatPence(Number(r.freeTierCoveredPence || 0))}</p>\n            <p className=\"text-xs text-slate-600\">Paid charged: {formatPence(Number(r.paidTierChargedPence || 0))}</p>\n          </div>\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Input</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{r.inputSizeBytes != null ? `${r.inputSizeBytes} bytes` : \"Not recorded\"}</p>\n            <p className=\"text-xs text-slate-600\">Course: {r.courseId || \"\"}</p>\n            <p className=\"text-xs text-slate-600\">Page: {r.pageId || \"\"}</p>\n          </div>\n        </div>\n\n        <div className=\"rounded-2xl border border-slate-200 bg-white p-4\">\n          <p className=\"text-xs font-semibold text-slate-700\">Safe metadata</p>\n          <pre className=\"mt-2 overflow-auto rounded-xl bg-slate-50 p-3 text-xs text-slate-800\">{JSON.stringify(r.metadata || {}, null, 2)}</pre>\n        </div>\n      </section>\n\n      <Link href=\"/admin/billing/usage\" className=\"text-sm font-semibold text-emerald-700 hover:underline\">\n        Back to usage and costs\n      </Link>\n    </main>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}