{
  "version": 3,
  "sources": [],
  "debugId": "6f733287-8dab-2183-2ab8-c9b24395846e",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/lib/credits/format.core.js","../../../../src/components/ComputeMeter.tsx"],"sourcesContent":["export function numberOrNull(value) {\n  if (typeof value !== \"number\") return null;\n  if (!Number.isFinite(value)) return null;\n  return value;\n}\n\nexport function msOrNull(value) {\n  const n = numberOrNull(value);\n  if (n == null) return null;\n  return Math.max(0, Math.round(n));\n}\n\nexport function formatMsSafe(ms) {\n  const n = msOrNull(ms);\n  if (n == null) return null;\n  const s = Math.max(0, Math.round(n / 1000));\n  if (s < 60) return `${s}s`;\n  const m = Math.floor(s / 60);\n  const r = s % 60;\n  return `${m}m ${r}s`;\n}\n\nexport function formatCreditsSafe(credits) {\n  const n = numberOrNull(credits);\n  if (n == null) return null;\n  return String(Math.max(0, Math.round(n)));\n}\n\n\n","\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport { formatCreditsSafe, formatMsSafe, msOrNull, numberOrNull } from \"@/lib/credits/format\";\nimport type { ComputeActual, ComputeError, ComputeEstimate, ComputeRunStatus } from \"@/lib/contracts/compute\";\n\nfunction safeList(v: unknown, max = 6): string[] {\n  if (!Array.isArray(v)) return [];\n  return v\n    .map((x) => (typeof x === \"string\" ? x.trim() : \"\"))\n    .filter(Boolean)\n    .slice(0, max);\n}\n\nexport default function ComputeMeter(props: {\n  estimate: ComputeEstimate | null;\n  actual: ComputeActual | null;\n  tier?: { freeMsRemainingToday?: number | null } | null;\n  remainingCredits?: number | null;\n  runStatus: ComputeRunStatus;\n  costHints?: string[];\n  error?: ComputeError | null;\n  compact?: boolean;\n}) {\n  const { estimate, actual, tier, remainingCredits, runStatus, costHints, error, compact = true } = props;\n  const [expanded, setExpanded] = useState(!compact);\n\n  const statusLabel = useMemo(() => {\n    if (runStatus === \"blocked\") return \"Blocked\";\n    if (runStatus === \"aborted\") return \"Stopped\";\n    if (runStatus === \"error\") return \"Error\";\n    return \"Complete\";\n  }, [runStatus]);\n\n  const freeRemaining = msOrNull(tier?.freeMsRemainingToday);\n\n  const estimateFree = msOrNull(estimate?.freeTierAppliedMs);\n  const estimatePaid = msOrNull(estimate?.paidMs);\n  const estimateCredits = numberOrNull(estimate?.estimatedCreditCost);\n\n  const actualFree = msOrNull(actual?.freeTierAppliedMs);\n  const actualPaid = msOrNull(actual?.paidMs);\n  const actualCredits = numberOrNull(actual?.creditsCharged);\n\n  const reasons = safeList(estimate?.reasons);\n  const hints = safeList(costHints);\n\n  const explanation = (() => {\n    if (runStatus === \"blocked\") {\n      return \"This run was blocked before it started.\";\n    }\n    if (runStatus === \"aborted\") {\n      return \"You stopped this run before it finished.\";\n    }\n    if (runStatus === \"error\") {\n      return \"This run did not complete successfully.\";\n    }\n    if (actual) {\n      if ((actualCredits || 0) > 0) return \"This run used free tier first, then used credits for the remainder.\";\n      return \"This run stayed within the free tier.\";\n    }\n    return \"This is an ESTIMATE based on your input size and the tool profile. Actual cost may be higher or lower.\";\n  })();\n\n  return (\n    <section className=\"rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm\" aria-label=\"Compute meter\">\n      <div className=\"flex flex-wrap items-start justify-between gap-3\">\n        <div>\n          <div className=\"text-xs font-semibold uppercase tracking-wide text-slate-600\">Compute and credits</div>\n          <div className=\"mt-1 text-sm font-semibold text-slate-900\">{statusLabel}</div>\n          <p className=\"mt-1 text-sm text-slate-700\">{explanation}</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Link href=\"/compute\" className=\"text-xs font-semibold text-slate-700 underline decoration-slate-300 underline-offset-4 hover:decoration-slate-600\">\n            How compute works\n          </Link>\n          <button\n            type=\"button\"\n            className=\"rounded-full border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-900 hover:border-slate-400\"\n            aria-expanded={expanded}\n            onClick={() => setExpanded((v) => !v)}\n          >\n            {expanded ? \"Less\" : \"More\"}\n          </button>\n        </div>\n      </div>\n\n      <div className=\"mt-3 grid gap-3 sm:grid-cols-3\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50/70 p-3\">\n          <div className=\"text-xs font-semibold text-slate-800\">Free remaining today</div>\n          <div className=\"mt-1 text-sm font-semibold text-slate-900\">{formatMsSafe(freeRemaining)}</div>\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50/70 p-3\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"text-xs font-semibold text-slate-800\">Estimate</div>\n            {estimate && estimateCredits && estimateCredits > 0 && (\n              <span className=\"text-xs font-semibold text-amber-700 bg-amber-50 px-1.5 py-0.5 rounded\">ESTIMATE</span>\n            )}\n          </div>\n          <div className=\"mt-1 text-sm font-semibold text-slate-900\">\n            {estimate ? (estimateCredits && estimateCredits > 0 ? `${formatCreditsSafe(estimateCredits)} credits` : \"0 credits\") : \"N/A\"}\n          </div>\n          <div className=\"mt-1 text-xs text-slate-700\">\n            {estimate ? `Time: ${formatMsSafe(estimate?.estimatedWallTimeMs)}` : \"No estimate yet\"}\n          </div>\n          {estimate && estimateCredits && estimateCredits > 0 && (\n            <div className=\"mt-2 text-xs font-medium text-amber-800 bg-amber-50 border border-amber-200 rounded px-2 py-1\">\n              ⚠️ This is an estimate. Actual cost may be higher or lower.\n            </div>\n          )}\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50/70 p-3\">\n          <div className=\"text-xs font-semibold text-slate-800\">After run</div>\n          <div className=\"mt-1 text-sm font-semibold text-slate-900\">\n            {actual ? (actualCredits && actualCredits > 0 ? `${formatCreditsSafe(actualCredits)} credits` : \"0 credits\") : \"N/A\"}\n          </div>\n          <div className=\"mt-1 text-xs text-slate-700\">{actual ? `Time: ${formatMsSafe(actual?.durationMs)}` : \"No receipt yet\"}</div>\n        </div>\n      </div>\n\n      {typeof remainingCredits === \"number\" ? (\n        <div className=\"mt-3 rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-800\">\n          Remaining credits: <span className=\"font-semibold text-slate-900\">{formatCreditsSafe(remainingCredits)}</span>\n        </div>\n      ) : null}\n\n      {expanded ? (\n        <div className=\"mt-3 space-y-3\">\n          {error ? (\n            <div className=\"rounded-2xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-900\">\n              <p className=\"m-0 font-semibold\">{error.message}</p>\n              {error.hint ? <p className=\"mt-1 m-0 text-sm text-rose-900\">Try: {error.hint}</p> : null}\n              {error.details ? <p className=\"mt-1 m-0 text-xs text-rose-800\">{error.details}</p> : null}\n            </div>\n          ) : null}\n          <div className=\"grid gap-3 sm:grid-cols-2\">\n            <div className=\"rounded-2xl border border-slate-200 bg-white p-3\">\n              <p className=\"text-xs font-semibold text-slate-800\">Free tier usage</p>\n              <p className=\"mt-1 text-sm text-slate-900\">\n                Estimate: <span className=\"font-semibold\">{formatMsSafe(estimateFree)}</span>\n              </p>\n              <p className=\"mt-1 text-sm text-slate-900\">\n                Actual: <span className=\"font-semibold\">{formatMsSafe(actualFree)}</span>\n              </p>\n            </div>\n            <div className=\"rounded-2xl border border-slate-200 bg-white p-3\">\n              <p className=\"text-xs font-semibold text-slate-800\">Paid usage</p>\n              <p className=\"mt-1 text-sm text-slate-900\">\n                Estimate: <span className=\"font-semibold\">{formatMsSafe(estimatePaid)}</span>\n              </p>\n              <p className=\"mt-1 text-sm text-slate-900\">\n                Actual: <span className=\"font-semibold\">{formatMsSafe(actualPaid)}</span>\n              </p>\n            </div>\n          </div>\n\n          {reasons.length ? (\n            <div className=\"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-900\">\n              <p className=\"m-0 font-semibold\">Notes</p>\n              <ul className=\"mt-2 list-disc space-y-1 pl-5\">\n                {reasons.map((r) => (\n                  <li key={r}>{r}</li>\n                ))}\n              </ul>\n            </div>\n          ) : null}\n\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-3\">\n            <p className=\"text-xs font-semibold text-slate-800\">How to reduce compute cost</p>\n            <ul className=\"mt-2 list-disc space-y-1 pl-5 text-sm text-slate-700\">\n              {(hints.length ? hints : [\"Try a smaller input first.\", \"Run the free tier preview before scaling up.\", \"Avoid rerunning unchanged inputs.\"]).slice(0, 4).map((t) => (\n                <li key={t}>{t}</li>\n              ))}\n            </ul>\n          </div>\n        </div>\n      ) : null}\n    </section>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}