;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="bb00e3d1-5408-2a86-08d3-60224ed92ddb")}catch(e){}}();
module.exports=[479328,a=>{"use strict";var b=a.i(508171),c=a.i(127669),d=a.i(507735),e=a.i(613483),f=a.i(745001),g=a.i(524911),h=a.i(324920),i=a.i(530548),j=a.i(887358),k=a.i(742093),l=a.i(739362),m=a.i(190896),n=a.i(698887),o=a.i(778529),p=a.i(742480);function q(a,b){let c=a.map(a=>b.map(b=>{let c=a[b];if("number"==typeof c)return c;if(null==c)return 0;let d=String(c).trim();if(""===d)return 0;let e=Number(d);return Number.isFinite(e)?e:0}));return f.tensor2d(c)}function r(){let[a,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)("classification"),[y,z]=(0,c.useState)(.7),[A,B]=(0,c.useState)(.15),[C,D]=(0,c.useState)({status:"idle"}),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)("accuracy"),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)({}),[Q,R]=(0,c.useState)(""),S=(0,c.useCallback)(a=>{let{safeFiles:b,errors:c}=(0,h.validateUpload)(a.target.files,{maxBytes:8388608,allowedExtensions:[".csv"]});c.length&&alert(c.join("\n"));let d=b[0];d&&(D({status:"preparing"}),F([]),J(""),L(null),N(null),P({}),R(""),g.default.parse(d,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:a=>{let b=a.data;if(!b||0===b.length)return void D({status:"error",message:"The CSV file appears to be empty or malformed."});let c=b.length?Object.keys(b[0]):[];c.length?(r({columns:c,rows:b}),t(c[c.length-1]),v(c.slice(0,-1)),D({status:"idle"})):D({status:"error",message:"Could not detect any columns in the CSV file."})},error:a=>{D({status:"error",message:`Failed to parse CSV: ${a.message}`})}}))},[]),T=(0,c.useMemo)(()=>a&&s&&u.length>0&&y>0&&A>=0&&y+A<1,[a,s,u,y,A]),U=(0,c.useCallback)(async()=>{if(a&&T)try{var b;let c,d,e,g;D({status:"training",epoch:0,totalEpochs:30}),F([]),J(""),R("");let{normRows:h}=(b=a.rows,d={},e={},g=b.map(a=>({...a})),u.forEach(a=>{let c=b.map(b=>b[a]).filter(a=>"number"==typeof a);if(!c.length){d[a]=0,e[a]=1;return}let f=c.reduce((a,b)=>a+b,0)/c.length,h=Math.sqrt(c.reduce((a,b)=>a+(b-f)*(b-f),0)/Math.max(1,c.length-1)||1);d[a]=f,e[a]=h,g.forEach(b=>{let c=b[a];"number"==typeof c&&(b[a]=(c-f)/h)})}),{normRows:g,means:d,stds:e}),i=h.map(a=>({...a})),j=q(i,u),k=null;if("classification"===w){let a,b,d,e,g=(a=i.map(a=>a[s]),b=Array.from(new Set(a.map(a=>null==a?"null":String(a)))),d=new Map,b.forEach((a,b)=>d.set(a,b)),e=a.map(a=>{let b=null==a?"null":String(a);return d.get(b)??0}),{labelsTensor:f.tensor1d(e,"int32"),classes:b});c=g.labelsTensor,k=g.classes,H("accuracy"),N(g.classes)}else{let a=i.map(a=>a[s]).map(a=>{if("number"==typeof a)return a;if(null==a)return 0;let b=Number(String(a).trim());return Number.isFinite(b)?b:0});c=f.tensor1d(a,"float32"),H("meanSquaredError"),N(null)}let l=[],m=j.arraySync(),n=c.arraySync();for(let a=0;a<m.length;a+=1)l.push({x:m[a],y:n[a]});let{train:o,val:p,test:r}=function(a,b,c){let d=[...a];for(let a=d.length-1;a>0;a-=1){let b=Math.floor(Math.random()*(a+1));[d[a],d[b]]=[d[b],d[a]]}let e=Math.floor(d.length*b),f=Math.floor(d.length*c),g=d.slice(0,e),h=d.slice(e,e+f);return{train:g,val:h,test:d.slice(e+f)}}(l,y,A);if(o.length<u.length+1){D({status:"error",message:"Training set is too small after splitting. Increase train ratio or provide more rows."}),j.dispose(),c.dispose();return}let t=a=>f.tensor2d(a.map(a=>a.x)),v=a=>f.tensor1d(a.map(a=>a.y),"classification"===w?"int32":"float32"),x=t(o),z=v(o),B=t(p),C=v(p),E=t(r),G=v(r),I=u.length,K=f.sequential();if(K.add(f.layers.dense({inputShape:[I],units:16,activation:"relu"})),K.add(f.layers.dense({units:8,activation:"relu"})),"classification"===w){let a=k?k.length:2;K.add(f.layers.dense({units:a,activation:"softmax"})),K.compile({optimizer:f.train.adam(.01),loss:"sparseCategoricalCrossentropy",metrics:["accuracy"]})}else K.add(f.layers.dense({units:1,activation:"linear"})),K.compile({optimizer:f.train.adam(.01),loss:"meanSquaredError",metrics:["meanSquaredError"]});let M=Math.max(8,Math.floor(o.length/10)),O=[];await K.fit(x,z,{epochs:30,batchSize:M,validationData:[B,C],callbacks:{onEpochEnd:async(a,b)=>{let c=b?.loss??0,d="classification"===w?b?.acc??b?.accuracy??0:b?.meanSquaredError??0;O.push({epoch:a+1,loss:c,metric:d}),F([...O]),D({status:"training",epoch:a+1,totalEpochs:30})}}});let P=K.evaluate(E,G),Q=0,S=0;Array.isArray(P)?(Q=P[0].arraySync()??0,S=P[1].arraySync()??0,P.forEach(a=>a.dispose())):(Q=P.arraySync()??0,P.dispose());let T=[];T.push(`Training rows: ${o.length}, validation rows: ${p.length}, test rows: ${r.length}.`),T.push(`Final test loss: ${Q.toFixed(4)}.`),"classification"===w?T.push(`Approximate test accuracy: ${S.toFixed(4)}.`):T.push(`Approximate test mean squared error: ${S.toFixed(4)}.`),J(T.join(" ")),x.dispose(),z.dispose(),B.dispose(),C.dispose(),E.dispose(),G.dispose(),j.dispose(),c.dispose(),L(K),D({status:"trained",problemType:w,summary:T.join(" ")})}catch(a){D({status:"error",message:"Something went wrong during training. Try a smaller dataset or adjust the splits."})}},[a,T,u,s,y,A,w]),V=(0,c.useMemo)(()=>E.map(a=>({epoch:a.epoch,loss:a.loss,metric:a.metric})),[E]),W=(0,c.useCallback)((a,b)=>{P(c=>({...c,[a]:b}))},[]),X=(0,c.useCallback)(async()=>{if(!K||!a)return void R("Train a model first and upload a dataset before trying predictions.");try{let a={};u.forEach(b=>{let c=O[b],d=Number(c);c?isNaN(d)?a[b]=0:a[b]=d:a[b]=0});let b=q([a],u),c=K.predict(b),d=await c.array();if("classification"===w&&M){let a=d[0],b=0,c=a[0]??0;for(let d=1;d<a.length;d+=1)a[d]>c&&(c=a[d],b=d);let e=M[b]??"(unknown)";R(`Predicted class: ${e} with probability ${c.toFixed(3)}.`)}else{let a=Array.isArray(d[0])?d[0][0]:d[0];R(`Predicted numeric value: ${Number(a).toFixed(4)}.`)}b.dispose(),c.dispose()}catch(a){R("Could not compute prediction for this input. Check your values and try again.")}},[K,a,O,u,w,M]),Y=(0,c.useMemo)(()=>"idle"===C.status?"Ready to train. Upload a CSV and choose target and features.":"preparing"===C.status?"Parsing CSV and preparing data.":"training"===C.status?`Training epoch ${C.epoch} of ${C.totalEpochs}.`:"trained"===C.status?"Training complete. Review metrics and try a prediction.":"error"===C.status?`Error: ${C.message}`:"",[C]),Z=a?.columns??[];return(0,b.jsxs)(o.AiToolCard,{id:"tabular-model-lab-title",title:"Tabular model builder and evaluator",icon:(0,b.jsx)(d.Brain,{className:"h-4 w-4","aria-hidden":"true"}),description:"Upload a CSV, pick a target column and features, train a small model in your browser and inspect its performance.",children:[(0,b.jsx)(p.SecurityBanner,{}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 lg:col-span-1",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"csv-upload",className:"block text-xs font-semibold text-slate-700",children:"Upload CSV file"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("label",{htmlFor:"csv-upload",className:"inline-flex cursor-pointer items-center gap-2 rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm hover:border-sky-300 hover:text-sky-700",children:[(0,b.jsx)(e.UploadCloud,{className:"h-4 w-4","aria-hidden":"true"}),(0,b.jsx)("span",{children:"Choose file"})]}),(0,b.jsx)("input",{id:"csv-upload",type:"file",accept:".csv,text/csv",className:"hidden",onChange:S}),(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"CSV only, max 8MB. Data stays in your browser."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Problem type"}),(0,b.jsxs)("div",{className:"inline-flex rounded-full bg-white p-0.5 ring-1 ring-slate-200 text-xs",children:[(0,b.jsx)("button",{type:"button",onClick:()=>x("classification"),className:`px-3 py-1.5 rounded-full ${"classification"===w?"bg-slate-900 text-white":"text-slate-600"}`,children:"Classification"}),(0,b.jsx)("button",{type:"button",onClick:()=>x("regression"),className:`px-3 py-1.5 rounded-full ${"regression"===w?"bg-slate-900 text-white":"text-slate-600"}`,children:"Regression"})]}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Classification predicts labels, regression predicts continuous numeric values. If you are unsure, classification usually applies to categories like Yes or No and regression to quantities like price."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"target-column",className:"block text-xs font-semibold text-slate-700",children:"Target column"}),(0,b.jsxs)("select",{id:"target-column",value:s,onChange:a=>t(a.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",children:[(0,b.jsx)("option",{value:"",children:"Select target"}),Z.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Feature columns"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5",children:Z.map(a=>{let c=a===s,d=u.includes(a);return(0,b.jsx)("button",{type:"button",disabled:c,onClick:()=>{v(b=>d?b.filter(b=>b!==a):[...b,a])},className:`rounded-full border px-2 py-0.5 text-sm ${c?"border-slate-200 bg-slate-100 text-slate-400 cursor-not-allowed":d?"border-sky-500 bg-sky-50 text-sky-800":"border-slate-200 bg-white text-slate-700"}`,children:a},a)})}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Click to toggle features. The target column is excluded automatically."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Data split ratios"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,b.jsx)("span",{children:"Train"}),(0,b.jsx)("input",{type:"number",min:.5,max:.9,step:.05,value:y,onChange:a=>z(Number(a.target.value)),className:"w-14 rounded-2xl border border-slate-200 bg-white px-1.5 py-0.5 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-200"}),(0,b.jsx)("span",{children:"Validation"}),(0,b.jsx)("input",{type:"number",min:.05,max:.4,step:.05,value:A,onChange:a=>B(Number(a.target.value)),className:"w-14 rounded-2xl border border-slate-200 bg-white px-1.5 py-0.5 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-200"}),(0,b.jsxs)("span",{children:["Test auto set to ",Math.max(0,1-y-A).toFixed(2)]})]})]}),(0,b.jsx)("button",{type:"button",onClick:U,disabled:!T||"training"===C.status,className:"inline-flex items-center justify-center rounded-2xl bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-300",children:"training"===C.status?"Training...":"Train model"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:Y})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 lg:col-span-1",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Training progress"}),(0,b.jsx)("div",{className:"h-48 rounded-2xl border border-slate-200 bg-white px-3 py-2",children:0===V.length?(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"The learning curve will appear here once training begins."}):(0,b.jsx)(n.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(i.LineChart,{data:V,children:[(0,b.jsx)(k.XAxis,{dataKey:"epoch",tick:{fontSize:10},label:{value:"Epoch",position:"insideBottom",offset:-4,fontSize:10}}),(0,b.jsx)(l.YAxis,{tick:{fontSize:10},label:{value:"accuracy"===G?"Loss and accuracy":"Loss and error",angle:-90,position:"insideLeft",fontSize:10}}),(0,b.jsx)(m.Tooltip,{contentStyle:{fontSize:10,borderRadius:12,padding:8}}),(0,b.jsx)(j.Line,{type:"monotone",dataKey:"loss",stroke:"#94a3b8",strokeWidth:1.6,dot:!1,name:"Loss"}),(0,b.jsx)(j.Line,{type:"monotone",dataKey:"metric",stroke:"#0f766e",strokeWidth:1.6,dot:!1,name:G})]})})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Evaluation summary"}),(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700 min-h-[64px]",children:I||"Metrics will appear here once the model is trained."})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-2xl border border-slate-100 bg-slate-50/60 p-4 lg:col-span-1",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Try a prediction"}),(0,b.jsx)("div",{className:"space-y-2",children:0===u.length?(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"After training, you can enter feature values here to see how your model responds."}):(0,b.jsxs)(b.Fragment,{children:[u.map(a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{htmlFor:`pred-${a}`,className:"block text-sm font-medium text-slate-700",children:a}),(0,b.jsx)("input",{id:`pred-${a}`,type:"text",value:O[a]??"",onChange:b=>W(a,b.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-2 py-1 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-200",placeholder:"Enter a numeric value"})]},a)),(0,b.jsx)("button",{type:"button",onClick:X,disabled:!K,className:"mt-1 inline-flex items-center justify-center rounded-2xl bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-500 disabled:bg-slate-300 disabled:cursor-not-allowed",children:"Predict"})]})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Prediction output"}),(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-700 min-h-[48px]",children:Q||"Your prediction result will appear here."}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"This is not a production grade model. It is an educational lab to help you see how data, model choices and metrics connect."})]})]})]})]})}a.s(["TabularModelLab",()=>r])},718872,a=>{a.n(a.i(479328))}];

//# debugId=bb00e3d1-5408-2a86-08d3-60224ed92ddb
//# sourceMappingURL=src_components_tools_ai_TabularModelLab_tsx_b8f84592._.js.map