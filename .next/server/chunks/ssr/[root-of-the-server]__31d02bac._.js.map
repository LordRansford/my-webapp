{
  "version": 3,
  "sources": [],
  "debugId": "ebea1504-023c-317e-c279-02cb9fb91d27",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/lib/certificates/store.core.js","../../../../src/lib/certificates/store.ts","../../../../src/pages/certificates/verify/%5BcertificateId%5D.tsx","../../../../node_modules/next/src/build/templates/pages.ts"],"sourcesContent":["import fs from \"node:fs\";\nimport path from \"node:path\";\nimport crypto from \"node:crypto\";\n\nconst STORE_PATH = process.env.CERTIFICATES_STORE_PATH || \"data/certificates.json\";\nconst empty = { certificates: [] };\n\nfunction ensureDir(filePath) {\n  const dir = path.dirname(filePath);\n  if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });\n}\n\nfunction readJsonFile(filePath, fallback) {\n  try {\n    const abs = path.isAbsolute(filePath) ? filePath : path.join(process.cwd(), filePath);\n    if (!fs.existsSync(abs)) return fallback;\n    return JSON.parse(fs.readFileSync(abs, \"utf8\"));\n  } catch {\n    return fallback;\n  }\n}\n\nfunction writeJsonFile(filePath, value) {\n  const abs = path.isAbsolute(filePath) ? filePath : path.join(process.cwd(), filePath);\n  ensureDir(abs);\n  const tmp = `${abs}.tmp`;\n  fs.writeFileSync(tmp, JSON.stringify(value, null, 2), \"utf8\");\n  fs.renameSync(tmp, abs);\n}\n\nexport function issueCertificate(params) {\n  const { userId, courseId, levelId, courseTitle, hoursEarned, completionDate, learnerName } = params;\n  const s = readJsonFile(STORE_PATH, empty);\n  const key = `${userId}:${courseId}:${levelId}`;\n  const existing = (s.certificates || []).find((c) => `${c.userId}:${c.courseId}:${c.levelId}` === key);\n  if (existing) return existing;\n\n  const certificateId = crypto.randomUUID();\n  const cert = {\n    certificateId,\n    userId,\n    courseId,\n    levelId,\n    courseTitle,\n    hoursEarned,\n    completionDate,\n    issuedAt: new Date().toISOString(),\n    version: 1,\n    learnerName: learnerName || \"\",\n    revokedAt: null,\n  };\n  s.certificates.push(cert);\n  writeJsonFile(STORE_PATH, s);\n  return cert;\n}\n\nexport function getCertificateById(certificateId) {\n  const s = readJsonFile(STORE_PATH, empty);\n  return (s.certificates || []).find((c) => c.certificateId === certificateId) || null;\n}\n\nexport function revokeCertificate(certificateId, reason = \"\") {\n  const s = readJsonFile(STORE_PATH, empty);\n  const idx = (s.certificates || []).findIndex((c) => c.certificateId === certificateId);\n  if (idx < 0) return null;\n  if (s.certificates[idx].revokedAt) return s.certificates[idx];\n  s.certificates[idx] = {\n    ...s.certificates[idx],\n    revokedAt: new Date().toISOString(),\n    revokedReason: reason || undefined,\n  };\n  writeJsonFile(STORE_PATH, s);\n  return s.certificates[idx];\n}\n\n\n","export type CertificateRecord = {\n  certificateId: string;\n  userId: string;\n  courseId: string;\n  levelId: string;\n  courseTitle: string;\n  hoursEarned: number;\n  completionDate: string;\n  issuedAt: string;\n  version: number;\n  learnerName: string;\n  revokedAt?: string | null;\n  revokedReason?: string;\n};\n\nconst core = require(\"./store.core.js\");\n\nexport const issueCertificate: (params: {\n  userId: string;\n  courseId: string;\n  levelId: string;\n  courseTitle: string;\n  hoursEarned: number;\n  completionDate: string;\n  learnerName?: string;\n}) => CertificateRecord = core.issueCertificate;\n\nexport const getCertificateById: (certificateId: string) => CertificateRecord | null = core.getCertificateById;\nexport const revokeCertificate: (certificateId: string, reason?: string) => CertificateRecord | null = core.revokeCertificate;\n\n\n","import type { GetServerSideProps } from \"next\";\nimport Layout from \"@/components/Layout\";\nimport { getCertificateById } from \"@/lib/certificates/store\";\n\ntype Props = {\n  found: boolean;\n  certificate?: {\n    certificateId: string;\n    courseTitle: string;\n    courseId: string;\n    levelId: string;\n    hoursEarned: number;\n    completionDate: string;\n    issuedAt: string;\n    version: number;\n    status: \"valid\" | \"revoked\";\n    revokedAt?: string | null;\n  };\n};\n\nexport default function CertificateVerifyPage({ found, certificate }: Props) {\n  return (\n    <Layout title=\"Certificate verification\" description=\"Verify a certificate by its ID.\">\n      <main className=\"page\">\n        <header className=\"page-header\">\n          <p className=\"eyebrow\">Verification</p>\n          <h1>Certificate verification</h1>\n          <p className=\"lead\">This page verifies a certificate ID and shows a safe summary.</p>\n          <p className=\"muted text-sm\">No personal data is shown here.</p>\n        </header>\n\n        <section className=\"section\">\n          {!found ? (\n            <p className=\"muted\">Certificate not found.</p>\n          ) : (\n            <div className=\"card\">\n              <p className=\"text-sm text-slate-700\">\n                <strong>Status</strong>: {certificate?.status === \"revoked\" ? \"Revoked\" : \"Valid\"}\n                {certificate?.status === \"revoked\" && certificate?.revokedAt ? ` (revoked ${new Date(certificate.revokedAt).toLocaleDateString()})` : \"\"}\n              </p>\n              <p className=\"text-sm text-slate-700\">\n                <strong>Certificate ID</strong>: {certificate?.certificateId}\n              </p>\n              <p className=\"text-sm text-slate-700\">\n                <strong>Course</strong>: {certificate?.courseTitle}\n              </p>\n              <p className=\"text-sm text-slate-700\">\n                <strong>Level</strong>: {certificate?.levelId}\n              </p>\n              <p className=\"text-sm text-slate-700\">\n                <strong>Hours</strong>: {certificate?.hoursEarned}\n              </p>\n              <p className=\"text-sm text-slate-700\">\n                <strong>Completion date</strong>: {new Date(certificate?.completionDate || \"\").toLocaleDateString()}\n              </p>\n              <p className=\"text-xs text-slate-600\">\n                This summary does not include personal identifiers. It confirms a record exists for this certificate ID.\n              </p>\n            </div>\n          )}\n        </section>\n      </main>\n    </Layout>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps<Props> = async (ctx) => {\n  const certificateId = String(ctx.params?.certificateId || \"\").trim();\n  if (!certificateId) return { props: { found: false } };\n\n  const cert = getCertificateById(certificateId);\n  if (!cert) return { props: { found: false } };\n\n  return {\n    props: {\n      found: true,\n      certificate: {\n        certificateId: cert.certificateId,\n        courseTitle: cert.courseTitle,\n        courseId: cert.courseId,\n        levelId: cert.levelId,\n        hoursEarned: cert.hoursEarned,\n        completionDate: cert.completionDate,\n        issuedAt: cert.issuedAt,\n        version: cert.version,\n        status: cert.revokedAt ? \"revoked\" : \"valid\",\n        revokedAt: cert.revokedAt || null,\n      },\n    },\n  };\n};\n\n\n","import { PagesRouteModule } from '../../server/route-modules/pages/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\n\nimport { hoist } from './helpers'\n\n// Import the app and document modules.\nimport * as document from 'VAR_MODULE_DOCUMENT'\nimport * as app from 'VAR_MODULE_APP'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getHandler } from '../../server/route-modules/pages/pages-handler'\n\n// Re-export the component (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export methods.\nexport const getStaticProps = hoist(userland, 'getStaticProps')\nexport const getStaticPaths = hoist(userland, 'getStaticPaths')\nexport const getServerSideProps = hoist(userland, 'getServerSideProps')\nexport const config = hoist(userland, 'config')\nexport const reportWebVitals = hoist(userland, 'reportWebVitals')\n\n// Re-export legacy methods.\nexport const unstable_getStaticProps = hoist(\n  userland,\n  'unstable_getStaticProps'\n)\nexport const unstable_getStaticPaths = hoist(\n  userland,\n  'unstable_getStaticPaths'\n)\nexport const unstable_getStaticParams = hoist(\n  userland,\n  'unstable_getStaticParams'\n)\nexport const unstable_getServerProps = hoist(\n  userland,\n  'unstable_getServerProps'\n)\nexport const unstable_getServerSideProps = hoist(\n  userland,\n  'unstable_getServerSideProps'\n)\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new PagesRouteModule({\n  definition: {\n    kind: RouteKind.PAGES,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  components: {\n    // default export might not exist when optimized for data only\n    App: app.default,\n    Document: document.default,\n  },\n  userland,\n})\n\nexport const handler = getHandler({\n  srcPage: 'VAR_DEFINITION_PAGE',\n  config,\n  userland,\n  routeModule,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n})\n"],"names":["PagesRouteModule","RouteKind","hoist","document","app","userland","getHandler","getStaticProps","getStaticPaths","getServerSideProps","config","reportWebVitals","unstable_getStaticProps","unstable_getStaticPaths","unstable_getStaticParams","unstable_getServerProps","unstable_getServerSideProps","routeModule","definition","kind","PAGES","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","components","App","default","Document","handler","srcPage"],"mappings":"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","ignoreList":[3]}}]
}