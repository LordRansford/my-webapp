;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="bc3e474c-4346-448b-b6cd-ce6634cce54d")}catch(e){}}();
module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},569264,a=>{a.n(a.i(354832))},881967,a=>{a.n(a.i(429735))},900827,a=>{a.n(a.i(995845))},918554,a=>{a.n(a.i(316801))},517537,a=>{a.n(a.i(903363))},13718,a=>{a.n(a.i(685523))},118198,a=>{a.n(a.i(545518))},444067,a=>{a.n(a.i(436102))},520809,a=>{"use strict";var b=a.i(929073);function c(a){try{return new Date(a).toISOString()}catch{return new Date(0).toISOString()}}async function d(a){let d=Math.max(1,Math.min(50,a.take)),e=(a.search||"").trim().toLowerCase(),f="created"===a.sortKey?{createdAt:a.sortDir}:"lastActive"===a.sortKey?{lastActiveAt:a.sortDir}:[{adminRole:a.sortDir},{createdAt:"desc"}],g=await b.prisma.userIdentity.findMany({where:e?{OR:[{email:{contains:e}}]}:{},take:d+1,...a.cursor?{cursor:{id:a.cursor},skip:1}:{},orderBy:f,select:{id:!0,email:!0,adminRole:!0,accountStatus:!0,createdAt:!0,lastActiveAt:!0}}),h=g.length>d?g[d]:null;return{items:g.slice(0,d).map(a=>({userId:String(a.id),email:String(a.email||""),role:a.adminRole||"NONE",accountStatus:a.accountStatus||"active",createdAt:c(a.createdAt),lastActiveAt:c(a.lastActiveAt)})),nextCursor:h?String(h.id):null}}async function e(a){let d=await b.prisma.userIdentity.findUnique({where:{id:a},select:{id:!0,email:!0,adminRole:!0,accountStatus:!0,createdAt:!0,lastActiveAt:!0}});return d?{userId:String(d.id),email:String(d.email||""),role:d.adminRole||"NONE",accountStatus:d.accountStatus||"active",createdAt:c(d.createdAt),lastActiveAt:c(d.lastActiveAt)}:null}a.s(["getUserAdminSafe",()=>e,"listUsersAdminSafe",()=>d])},245545,a=>{"use strict";var b=a.i(907997),c=a.i(395936),d=a.i(520809);function e(a){try{return new Date(a).toLocaleString()}catch{return a}}async function f({searchParams:a}){let f=await a,g=(f.search||"").trim(),h=f.cursor||null,i=f.sort||"created",j=f.dir||"desc",{items:k,nextCursor:l}=await (0,d.listUsersAdminSafe)({search:g,cursor:h,take:20,sortKey:"lastActive"===i||"role"===i?i:"created",sortDir:"asc"===j?"asc":"desc"});return(0,b.jsxs)("main",{className:"mx-auto max-w-6xl px-4 py-10 md:px-6 lg:px-8 space-y-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Users"}),(0,b.jsx)("p",{className:"text-slate-700",children:"Search, review, and open a user for safe role and status changes."}),(0,b.jsxs)("form",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm flex flex-wrap gap-3 items-end",action:"/admin/users",children:[(0,b.jsxs)("label",{className:"min-w-[240px] flex-1 space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Search"}),(0,b.jsx)("input",{name:"search",defaultValue:g,placeholder:"Search by email",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Sort"}),(0,b.jsxs)("select",{name:"sort",defaultValue:i,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2",children:[(0,b.jsx)("option",{value:"created",children:"Created"}),(0,b.jsx)("option",{value:"lastActive",children:"Last active"}),(0,b.jsx)("option",{value:"role",children:"Role"})]})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Direction"}),(0,b.jsxs)("select",{name:"dir",defaultValue:j,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2",children:[(0,b.jsx)("option",{value:"desc",children:"Descending"}),(0,b.jsx)("option",{value:"asc",children:"Ascending"})]})]}),(0,b.jsx)("button",{type:"submit",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800",children:"Apply"})]}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-slate-50 text-slate-700",children:(0,b.jsx)("tr",{children:["User ID","Email","Role","Status","Created","Last active"].map(a=>(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold",children:a},a))})}),(0,b.jsxs)("tbody",{children:[k.map(a=>(0,b.jsxs)("tr",{className:"border-t border-slate-100",children:[(0,b.jsx)("td",{className:"px-4 py-3 font-mono text-xs text-slate-700",children:a.userId}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:(0,b.jsx)(c.default,{href:`/admin/users/${encodeURIComponent(a.userId)}`,className:"font-semibold text-emerald-700 hover:underline",children:a.email})}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:a.role}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-900",children:a.accountStatus}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e(a.createdAt)}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-700",children:e(a.lastActiveAt)})]},a.userId)),0===k.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:6,className:"px-4 py-8 text-center text-slate-600",children:"No users found."})}):null]})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-xs text-slate-600",children:"Only safe fields are shown. Admin actions require a reason and are audited."}),l?(0,b.jsx)(c.default,{href:`/admin/users?search=${encodeURIComponent(g)}&sort=${encodeURIComponent(i)}&dir=${encodeURIComponent(j)}&cursor=${encodeURIComponent(l)}`,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400",children:"Next page"}):(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"End"})]})]})}a.s(["default",()=>f,"metadata",0,{title:"Admin: Users",robots:{index:!1,follow:!1}}])}];

//# debugId=bc3e474c-4346-448b-b6cd-ce6634cce54d
//# sourceMappingURL=%5Broot-of-the-server%5D__55d74596._.js.map