{
  "version": 3,
  "sources": [],
  "debugId": "1dbbb9e0-1cf2-2567-9a09-096a807ec91c",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/donations/DonationModal.tsx","../../../../src/data/donationIntents.ts","../../../../src/data/donations.ts"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { donationIntents } from \"@/data/donationIntents\";\nimport { currency, donationTiers } from \"@/data/donations\";\n\ntype DonationModalProps = {\n  open: boolean;\n  onClose: () => void;\n  successPath?: string;\n  cancelPath?: string;\n};\n\nconst currencySymbol = {\n  GBP: \"£\",\n  USD: \"$\",\n  EUR: \"€\",\n};\n\nfunction formatAmount(amount: number) {\n  const symbol = currencySymbol[currency as keyof typeof currencySymbol] || \"\";\n  return `${symbol}${amount.toFixed(2)}`;\n}\n\nexport default function DonationModal({\n  open,\n  onClose,\n  successPath = \"/donate/success\",\n  cancelPath = \"/donate/cancel\",\n}: DonationModalProps) {\n  const [selectedTier, setSelectedTier] = useState(donationTiers[1]);\n  const [selectedIntent, setSelectedIntent] = useState(donationIntents[0]);\n  const [customAmount, setCustomAmount] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const modalRef = useRef<HTMLDivElement | null>(null);\n  const closeButtonRef = useRef<HTMLButtonElement | null>(null);\n  const lastFocused = useRef<Element | null>(null);\n\n  useEffect(() => {\n    if (open) {\n      lastFocused.current = document.activeElement;\n      const timer = setTimeout(() => {\n        closeButtonRef.current?.focus();\n      }, 0);\n      return () => clearTimeout(timer);\n    }\n    return undefined;\n  }, [open]);\n\n  useEffect(() => {\n    function handleKeyDown(e: KeyboardEvent) {\n      if (e.key === \"Escape\") {\n        e.preventDefault();\n        onClose();\n      }\n      if (e.key === \"Tab\" && modalRef.current) {\n        const focusable = modalRef.current.querySelectorAll<HTMLElement>(\n          'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        if (!focusable.length) return;\n        const first = focusable[0];\n        const last = focusable[focusable.length - 1];\n        if (e.shiftKey) {\n          if (document.activeElement === first) {\n            e.preventDefault();\n            last.focus();\n          }\n        } else if (document.activeElement === last) {\n          e.preventDefault();\n          first.focus();\n        }\n      }\n    }\n\n    if (open) {\n      document.addEventListener(\"keydown\", handleKeyDown);\n      return () => document.removeEventListener(\"keydown\", handleKeyDown);\n    }\n    return undefined;\n  }, [open, onClose]);\n\n  useEffect(() => {\n    if (!open && lastFocused.current instanceof HTMLElement) {\n      lastFocused.current.focus();\n    }\n  }, [open]);\n\n  const amountToSend = useMemo(() => {\n    const parsed = parseFloat(customAmount || \"\");\n    if (!Number.isNaN(parsed) && parsed > 0) return parsed;\n    return selectedTier?.amount ?? donationTiers[0].amount;\n  }, [customAmount, selectedTier]);\n\n  const handleConfirm = async () => {\n    try {\n      setLoading(true);\n      setError(\"\");\n      // Stage 7: monetisation scaffolding only. No payments enabled.\n      throw new Error(\"Donations are not enabled in this build yet.\");\n    } catch (err: any) {\n      setError(err.message || \"Something went wrong.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!open) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 px-4\" role=\"dialog\" aria-modal=\"true\">\n      <div ref={modalRef} className=\"w-full max-w-2xl rounded-3xl bg-white p-6 shadow-2xl ring-1 ring-slate-200\">\n        <div className=\"flex items-start justify-between gap-3\">\n          <div>\n            <p className=\"text-xs font-semibold uppercase tracking-[0.18em] text-slate-500\">Donations</p>\n            <h2 className=\"mt-1 text-2xl font-semibold text-slate-900\">Support this work</h2>\n            <p className=\"mt-2 text-sm text-slate-700 leading-relaxed\">\n              This site takes a lot of time, coffee and testing. If you find it useful, you can support its maintenance and growth here.\n            </p>\n          </div>\n          <button\n            ref={closeButtonRef}\n            type=\"button\"\n            onClick={onClose}\n            className=\"rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n            aria-label=\"Close donation dialog\"\n          >\n            Close\n          </button>\n        </div>\n\n        <div className=\"mt-4 grid gap-4 md:grid-cols-3\">\n          {donationTiers.map((tier) => {\n            const selected = selectedTier?.id === tier.id;\n            return (\n              <button\n                key={tier.id}\n                type=\"button\"\n                onClick={() => setSelectedTier(tier)}\n                className={`h-full rounded-2xl border p-4 text-left transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 ${\n                  selected ? \"border-slate-900 bg-slate-900/5 shadow-sm\" : \"border-slate-200 bg-slate-50/60 hover:border-slate-300\"\n                }`}\n                aria-pressed={selected}\n              >\n                <div className=\"flex items-center justify-between gap-2\">\n                  <span className=\"text-sm font-semibold text-slate-900\">{tier.label}</span>\n                  <span className=\"rounded-full bg-white px-3 py-1 text-xs font-semibold text-slate-800 shadow-sm\">{formatAmount(tier.amount)}</span>\n                </div>\n                <p className=\"mt-1 text-sm text-slate-700\">{tier.description}</p>\n                <ul className=\"mt-2 space-y-1 text-xs text-slate-700\">\n                  {tier.impact.map((line) => (\n                    <li key={line} className=\"flex items-start gap-2\">\n                      <span aria-hidden=\"true\">•</span>\n                      <span>{line}</span>\n                    </li>\n                  ))}\n                </ul>\n              </button>\n            );\n          })}\n        </div>\n\n        <div className=\"mt-4 grid gap-3 md:grid-cols-[1.2fr_0.8fr]\">\n          <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n            <label className=\"block text-xs font-semibold uppercase tracking-wide text-slate-600\">Custom amount (optional)</label>\n            <div className=\"mt-2 flex items-center gap-2\">\n              <span className=\"rounded-md border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-800\">\n                {currencySymbol[currency as keyof typeof currencySymbol] || currency}\n              </span>\n              <input\n                type=\"number\"\n                min={1}\n                step=\"1\"\n                inputMode=\"decimal\"\n                value={customAmount}\n                onChange={(e) => setCustomAmount(e.target.value)}\n                className=\"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400\"\n                placeholder={selectedTier ? selectedTier.amount.toString() : \"10\"}\n              />\n            </div>\n            <p className=\"mt-2 text-xs text-slate-700\">\n              Suggested: {formatAmount(amountToSend)}. Custom amounts replace the selected tier.\n            </p>\n          </div>\n\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-4\">\n            <label className=\"block text-xs font-semibold uppercase tracking-wide text-slate-600\">Intent (optional)</label>\n            <select\n              value={selectedIntent?.id}\n              onChange={(e) => setSelectedIntent(donationIntents.find((i) => i.id === e.target.value) || donationIntents[0])}\n              className=\"mt-2 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400\"\n            >\n              {donationIntents.map((intent) => (\n                <option key={intent.id} value={intent.id}>\n                  {intent.label}\n                </option>\n              ))}\n            </select>\n            <p className=\"mt-2 text-xs text-slate-700\">{selectedIntent?.description}</p>\n          </div>\n        </div>\n\n        {error ? <p className=\"mt-3 text-sm font-semibold text-rose-700\">{error}</p> : null}\n\n        <div className=\"mt-5 flex flex-wrap items-center justify-between gap-3\">\n          <div className=\"text-sm text-slate-700\">\n            Total: <span className=\"font-semibold text-slate-900\">{formatAmount(amountToSend)}</span>\n          </div>\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2\"\n              disabled={loading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleConfirm}\n              className=\"rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:bg-slate-400\"\n              disabled={loading}\n            >\n              {loading ? \"Preparing...\" : \"Donations coming soon\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","export type DonationIntent = {\n  id: string;\n  label: string;\n  description: string;\n};\n\nexport const donationIntents: DonationIntent[] = [\n  {\n    id: \"maintain\",\n    label: \"Maintain the site\",\n    description: \"Keep hosting, monitoring, and backups running smoothly.\",\n  },\n  {\n    id: \"new-labs\",\n    label: \"Fund new labs\",\n    description: \"Support fresh walkthroughs, diagrams, and accessibility passes.\",\n  },\n  {\n    id: \"content-research\",\n    label: \"Deep research\",\n    description: \"Buy time for testing edge cases and writing clearer guidance.\",\n  },\n];\n","export type DonationTier = {\n  id: string;\n  label: string;\n  amount: number; // in major currency units\n  description: string;\n  impact: string[];\n};\n\nexport const donationTiers: DonationTier[] = [\n  {\n    id: \"keep-lights-on\",\n    label: \"Keep the lights on\",\n    amount: 5,\n    description: \"Covers hosting and monitoring for a week.\",\n    impact: [\"Keeps the labs online\", \"Funds small bug fixes\", \"Covers coffee for late-night testing\"],\n  },\n  {\n    id: \"ship-new-labs\",\n    label: \"Ship a new lab\",\n    amount: 15,\n    description: \"Moves a new walkthrough or checklist from draft to published.\",\n    impact: [\"Funds test data and fixtures\", \"Supports accessibility polish\", \"Pays for diagram clean-up\"],\n  },\n  {\n    id: \"sponsor-research\",\n    label: \"Sponsor research time\",\n    amount: 30,\n    description: \"Buys focused time to explore deeper topics and tighten guidance.\",\n    impact: [\"Funds security reviews of new content\", \"Supports more edge case coverage\", \"Offsets tool subscriptions\"],\n  },\n];\n\nexport const currency = \"GBP\";\n"],"names":[],"mappings":"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"}}]
}