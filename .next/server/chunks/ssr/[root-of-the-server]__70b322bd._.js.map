{
  "version": 3,
  "sources": [],
  "debugId": "7cf7df1a-df54-9236-f4b7-d5505b200ae0",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/server/tools-pages.server.ts"],"sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\nimport matter from \"gray-matter\";\nimport { serialize } from \"next-mdx-remote/serialize\";\nimport remarkGfm from \"remark-gfm\";\nimport rehypeSlug from \"rehype-slug\";\nimport rehypeAutolinkHeadings from \"rehype-autolink-headings\";\n\nconst toolsDir = path.join(process.cwd(), \"content\", \"tools\");\n\nconst mdxOptions = {\n  remarkPlugins: [remarkGfm],\n  rehypePlugins: [\n    rehypeSlug,\n    [\n      rehypeAutolinkHeadings,\n      {\n        behavior: \"wrap\",\n        properties: { className: [\"anchor\"] },\n      },\n    ],\n  ],\n};\n\nconst listToolFiles = () => {\n  try {\n    return fs.readdirSync(toolsDir).filter((file) => file.endsWith(\".mdx\"));\n  } catch {\n    return [];\n  }\n};\n\nconst toSlug = (fileName: string) => fileName.replace(/\\.mdx$/, \"\");\n\nconst extractMetaExport = (source: string, fallbackTitle: string) => {\n  const match = source.match(/export const meta\\s*=\\s*({[\\s\\S]*?});/);\n  if (!match) {\n    return {\n      title: fallbackTitle || \"Tools\",\n      description: \"\",\n      topic: \"\",\n    };\n  }\n\n  try {\n    const parsed = Function(`return (${match[1]});`)();\n    return {\n      title: parsed.title || fallbackTitle || \"Tools\",\n      description: parsed.description || \"\",\n      topic: parsed.topic || \"\",\n    };\n  } catch {\n    return {\n      title: fallbackTitle || \"Tools\",\n      description: \"\",\n      topic: \"\",\n    };\n  }\n};\n\nexport const getAllToolPages = () =>\n  listToolFiles().map((file) => {\n    const slug = toSlug(file);\n    const fullPath = path.join(toolsDir, file);\n    const source = fs.readFileSync(fullPath, \"utf8\");\n    const { data } = matter(source);\n    const metaExport = extractMetaExport(source, slug.replace(/-/g, \" \"));\n    const meta = {\n      title: data.title || metaExport.title,\n      description: data.description || metaExport.description,\n      topic: data.topic || metaExport.topic,\n    };\n\n    return { slug, meta };\n  });\n\nexport const getToolPage = async (slug: string) => {\n  // #region agent log\n  try {\n    const logPath = path.join(process.cwd(), '.cursor', 'debug.log');\n    const logDir = path.dirname(logPath);\n    if (!fs.existsSync(logDir)) {\n      fs.mkdirSync(logDir, { recursive: true });\n    }\n    const logEntry = JSON.stringify({\n      location: 'tools-pages.server.ts:getToolPage',\n      message: 'getToolPage entry',\n      data: { slug },\n      timestamp: Date.now(),\n      sessionId: 'debug-session',\n      runId: 'run4',\n      hypothesisId: 'H1',\n    }) + '\\n';\n    fs.appendFileSync(logPath, logEntry, 'utf8');\n  } catch (e) {}\n  // #endregion\n  const fullPath = path.join(toolsDir, `${slug}.mdx`);\n  if (!fs.existsSync(fullPath)) {\n    // #region agent log\n    try {\n      const logPath = path.join(process.cwd(), '.cursor', 'debug.log');\n      const logEntry = JSON.stringify({\n        location: 'tools-pages.server.ts:getToolPage',\n        message: 'File not found',\n        data: { slug, fullPath },\n        timestamp: Date.now(),\n        sessionId: 'debug-session',\n        runId: 'run4',\n        hypothesisId: 'H1',\n      }) + '\\n';\n      fs.appendFileSync(logPath, logEntry, 'utf8');\n    } catch (e) {}\n    // #endregion\n    return null;\n  }\n\n  const source = fs.readFileSync(fullPath, \"utf8\");\n  const { content, data } = matter(source);\n  const metaExport = extractMetaExport(source, slug.replace(/-/g, \" \"));\n  const meta = {\n    title: data.title || metaExport.title,\n    description: data.description || metaExport.description,\n    topic: data.topic || metaExport.topic,\n  };\n\n  // #region agent log\n  try {\n    const logPath = path.join(process.cwd(), '.cursor', 'debug.log');\n    const logEntry = JSON.stringify({\n      location: 'tools-pages.server.ts:getToolPage',\n      message: 'About to serialize MDX',\n      data: { slug, contentLength: content?.length || 0 },\n      timestamp: Date.now(),\n      sessionId: 'debug-session',\n      runId: 'run4',\n      hypothesisId: 'H1',\n    }) + '\\n';\n    fs.appendFileSync(logPath, logEntry, 'utf8');\n  } catch (e) {}\n  // #endregion\n\n  try {\n    const mdx = await serialize(content || source, {\n      scope: meta,\n      mdxOptions: mdxOptions as any,\n    });\n    // #region agent log\n    try {\n      const logPath = path.join(process.cwd(), '.cursor', 'debug.log');\n      const logEntry = JSON.stringify({\n        location: 'tools-pages.server.ts:getToolPage',\n        message: 'MDX serialized successfully',\n        data: { slug, hasMdx: !!mdx },\n        timestamp: Date.now(),\n        sessionId: 'debug-session',\n        runId: 'run4',\n        hypothesisId: 'H1',\n      }) + '\\n';\n      fs.appendFileSync(logPath, logEntry, 'utf8');\n    } catch (e) {}\n    // #endregion\n    return { slug, meta, mdx };\n  } catch (error) {\n    // #region agent log\n    try {\n      const logPath = path.join(process.cwd(), '.cursor', 'debug.log');\n      const logEntry = JSON.stringify({\n        location: 'tools-pages.server.ts:getToolPage',\n        message: 'MDX serialization error',\n        data: { \n          slug, \n          errorMessage: (error as Error)?.message, \n          errorName: (error as Error)?.name,\n          errorStack: (error as Error)?.stack?.substring(0, 1000)\n        },\n        timestamp: Date.now(),\n        sessionId: 'debug-session',\n        runId: 'run4',\n        hypothesisId: ['H1', 'H5'],\n      }) + '\\n';\n      fs.appendFileSync(logPath, logEntry, 'utf8');\n    } catch (e) {}\n    // #endregion\n    console.error('[getToolPage] Error serializing MDX:', error);\n    throw error;\n  }\n};\n\n"],"names":[],"mappings":"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"}}]
}