{
  "version": 3,
  "sources": [],
  "debugId": "caea1889-eac0-78dc-6bbe-8cfde7d9004a",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/dashboards/cybersecurity/intermediate/AuthSessionFlowLab.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nconst STEPS = [\n  {\n    id: 1,\n    title: \"User submits credentials\",\n    client: \"Sends username/password over HTTPS\",\n    server: \"Receives credentials, checks rate limits\",\n    failures: [\"Weak password policy\", \"No rate limiting\", \"Credentials sent over http\"],\n  },\n  {\n    id: 2,\n    title: \"Server validates credentials\",\n    client: \"Waits for response\",\n    server: \"Validates hash, checks MFA\",\n    failures: [\"Password stored in plaintext\", \"Missing MFA\", \"Verbose errors revealing account validity\"],\n  },\n  {\n    id: 3,\n    title: \"Session or token is issued\",\n    client: \"Stores token/session id (should be httpOnly cookie or secure storage)\",\n    server: \"Creates session state with expiry and scope\",\n    failures: [\"Session id in URL\", \"No expiry/rotation\", \"Over-broad scopes\"],\n  },\n  {\n    id: 4,\n    title: \"Authenticated request\",\n    client: \"Sends cookie or Authorization header with token\",\n    server: \"Authorises based on session and permissions\",\n    failures: [\"CSRF missing\", \"Broken access control\", \"Token leaked in logs\"],\n  },\n  {\n    id: 5,\n    title: \"Session renews or expires\",\n    client: \"Renews or re-authenticates when token expires\",\n    server: \"Rotates tokens and clears sessions on logout/privilege change\",\n    failures: [\"No rotation on privilege change\", \"Long-lived tokens\", \"No logout invalidation\"],\n  },\n];\n\nexport default function AuthSessionFlowLab() {\n  const [step, setStep] = useState(0);\n\n  const current = STEPS[step];\n\n  return (\n    <div className=\"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200\">\n      <div className=\"flex items-center justify-between text-sm text-slate-700\">\n        <span>\n          Step {step + 1} / {STEPS.length}\n        </span>\n      </div>\n      <div className=\"mt-3 grid gap-3 md:grid-cols-2\">\n        <div className=\"rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm\">\n          <h4 className=\"text-base font-semibold text-slate-900\">{current.title}</h4>\n          <div className=\"mt-2 text-sm text-slate-800\">\n            <span className=\"font-semibold\">Client sends:</span> {current.client}\n          </div>\n          <div className=\"mt-1 text-sm text-slate-800\">\n            <span className=\"font-semibold\">Server does:</span> {current.server}\n          </div>\n        </div>\n        <div className=\"rounded-xl border border-slate-200 bg-white p-4 shadow-sm\">\n          <h5 className=\"text-sm font-semibold text-slate-900\">Common failures</h5>\n          <ul className=\"mt-2 list-disc space-y-1 pl-5 text-sm text-slate-800\">\n            {current.failures.map((f) => (\n              <li key={f}>{f}</li>\n            ))}\n          </ul>\n        </div>\n      </div>\n\n      <div className=\"mt-3 flex gap-2\">\n        <button\n          onClick={() => setStep((s) => Math.max(0, s - 1))}\n          className=\"rounded-full border border-slate-300 px-4 py-2 text-sm font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300 disabled:opacity-50\"\n          disabled={step === 0}\n        >\n          Previous\n        </button>\n        <button\n          onClick={() => setStep((s) => Math.min(STEPS.length - 1, s + 1))}\n          className=\"rounded-full border border-slate-300 px-4 py-2 text-sm font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300 disabled:opacity-50\"\n          disabled={step === STEPS.length - 1}\n        >\n          Next\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QAEA,IAAM,EAAQ,CACZ,CACE,GAAI,EACJ,MAAO,2BACP,OAAQ,qCACR,OAAQ,2CACR,SAAU,CAAC,uBAAwB,mBAAoB,6BAA6B,AACtF,EACA,CACE,GAAI,EACJ,MAAO,+BACP,OAAQ,qBACR,OAAQ,6BACR,SAAU,CAAC,+BAAgC,cAAe,4CAA4C,AACxG,EACA,CACE,GAAI,EACJ,MAAO,6BACP,OAAQ,wEACR,OAAQ,8CACR,SAAU,CAAC,oBAAqB,qBAAsB,oBAAoB,AAC5E,EACA,CACE,GAAI,EACJ,MAAO,wBACP,OAAQ,kDACR,OAAQ,8CACR,SAAU,CAAC,eAAgB,wBAAyB,uBAAuB,AAC7E,EACA,CACE,GAAI,EACJ,MAAO,4BACP,OAAQ,gDACR,OAAQ,gEACR,SAAU,CAAC,kCAAmC,oBAAqB,yBAAyB,AAC9F,EACD,CAEc,SAAS,IACtB,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAE3B,EAAU,CAAK,CAAC,EAAK,CAE3B,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,QACE,EAAO,EAAE,MAAI,EAAM,MAAM,MAGnC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kDAA0C,EAAQ,KAAK,GACrE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,kBAAoB,IAAE,EAAQ,MAAM,IAEtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,iBAAmB,IAAE,EAAQ,MAAM,OAGvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gDAAuC,oBACrD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gEACX,EAAQ,QAAQ,CAAC,GAAG,CAAC,AAAC,GACrB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAY,GAAJ,YAMjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAG,EAAI,IAC9C,UAAU,0LACV,SAAmB,IAAT,WACX,aAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,AAAC,GAAM,KAAK,GAAG,CAAC,EAAM,MAAM,CAAG,EAAG,EAAI,IAC7D,UAAU,0LACV,SAAU,IAAS,EAAM,MAAM,CAAG,WACnC,cAMT"}}]
}