{
  "version": 3,
  "sources": [],
  "debugId": "a9551e74-86e9-d1c5-4499-6fd36a9494b3",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/components/notes/hooks/use_tool_state.jsx","../../../../src/components/notes/ToolStateActions.jsx","../../../../src/components/notes/tools/cybersecurity/foundations/MfaDeepDiveLab.jsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useMemo, useRef, useState } from 'react'\n\nfunction safe_json_parse(value, fallback) {\n  try {\n    return JSON.parse(value)\n  } catch {\n    return fallback\n  }\n}\n\nfunction encode_state(obj) {\n  const json = JSON.stringify(obj)\n  const bytes = new TextEncoder().encode(json)\n  let binary = ''\n  bytes.forEach((b) => {\n    binary += String.fromCharCode(b)\n  })\n  return btoa(binary)\n}\n\nfunction decode_state(b64) {\n  const binary = atob(b64)\n  const bytes = Uint8Array.from(binary, (c) => c.charCodeAt(0))\n  const json = new TextDecoder().decode(bytes)\n  return safe_json_parse(json, null)\n}\n\nexport function useToolState({ tool_id, initial_state }) {\n  const [state, set_state] = useState(initial_state)\n  const [is_ready, set_is_ready] = useState(false)\n  const initial_ref = useRef(initial_state)\n\n  const url_key = useMemo(() => {\n    if (typeof window === 'undefined') return null\n    const params = new URLSearchParams(window.location.search)\n    return params.get(`s_${tool_id}`)\n  }, [tool_id])\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return\n    const from_url = url_key ? decode_state(url_key) : null\n    if (from_url) {\n      set_state(from_url)\n      set_is_ready(true)\n      return\n    }\n    const saved = window.localStorage.getItem(`rn_tool_${tool_id}`)\n    if (saved) {\n      set_state(safe_json_parse(saved, initial_ref.current))\n      set_is_ready(true)\n      return\n    }\n    set_is_ready(true)\n  }, [tool_id, url_key])\n\n  useEffect(() => {\n    if (!is_ready) return\n    if (typeof window === 'undefined') return\n    window.localStorage.setItem(`rn_tool_${tool_id}`, JSON.stringify(state))\n  }, [state, tool_id, is_ready])\n\n  function reset() {\n    set_state(initial_ref.current)\n    if (typeof window !== 'undefined') {\n      window.localStorage.removeItem(`rn_tool_${tool_id}`)\n    }\n  }\n\n  function copy_share_link() {\n    if (typeof window === 'undefined') return\n    const params = new URLSearchParams(window.location.search)\n    params.set(`s_${tool_id}`, encode_state(state))\n    const url = `${window.location.pathname}?${params.toString()}`\n    navigator.clipboard.writeText(`${window.location.origin}${url}`)\n  }\n\n  function export_json() {\n    const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application_json' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = `${tool_id}_state.json`\n    a.click()\n    URL.revokeObjectURL(url)\n  }\n\n  async function import_json(file) {\n    const text = await file.text()\n    const parsed = safe_json_parse(text, null)\n    if (parsed) set_state(parsed)\n  }\n\n  return {\n    state,\n    set_state,\n    reset,\n    copy_share_link,\n    export_json,\n    import_json,\n    is_ready,\n  }\n}\n\n// Temporary alias to avoid breaking existing imports while keeping hook naming compliant.\nexport const use_tool_state = useToolState\n","'use client'\n\nexport function ToolStateActions({ onReset, onCopy, onExport, onImport }) {\n  return (\n    <div className=\"mt-3 flex flex-wrap gap-2 text-xs\">\n      {onReset ? (\n        <button\n          onClick={onReset}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Reset\n        </button>\n      ) : null}\n      {onCopy ? (\n        <button\n          onClick={onCopy}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Copy link\n        </button>\n      ) : null}\n      {onExport ? (\n        <button\n          onClick={onExport}\n          className=\"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200\"\n        >\n          Export\n        </button>\n      ) : null}\n      {onImport ? (\n        <label className=\"inline-flex cursor-pointer items-center gap-1 rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus-within:ring focus-within:ring-blue-200\">\n          <span>Import</span>\n          <input\n            type=\"file\"\n            accept=\"application/json\"\n            onChange={(e) => {\n              const file = e.target.files?.[0]\n              if (file) onImport(file)\n              e.target.value = ''\n            }}\n            className=\"hidden\"\n          />\n        </label>\n      ) : null}\n    </div>\n  )\n}\n\nexport default ToolStateActions\n","\"use client\";\n\nimport { use_tool_state } from \"@/components/notes/hooks/use_tool_state\";\nimport ToolStateActions from \"@/components/notes/ToolStateActions\";\n\nexport default function MfaDeepDiveLab() {\n  const { state, set_state, reset, copy_share_link, export_json, import_json, is_ready } = use_tool_state({\n    tool_id: \"mfa-deep-dive-lab\",\n    initial_state: { selectedMethod: \"sms\" },\n  });\n\n  if (!is_ready) return <p className=\"text-sm text-gray-600\">Loading...</p>;\n\n  const methods = {\n    sms: {\n      name: \"SMS (Text Message)\",\n      security: \"Low\",\n      pros: [\"Easy to set up\", \"Widely supported\", \"No app needed\"],\n      cons: [\"Vulnerable to SIM swap attacks\", \"Can be intercepted\", \"Requires cell signal\"],\n      recommendation: \"Use only if no other option available\",\n      color: \"red\"\n    },\n    app: {\n      name: \"Authenticator App (TOTP)\",\n      security: \"High\",\n      pros: [\"Works offline\", \"Not vulnerable to SIM swap\", \"Free apps available\"],\n      cons: [\"Requires smartphone\", \"Must backup codes\", \"Can lose access if phone lost\"],\n      recommendation: \"Recommended for most users\",\n      color: \"green\"\n    },\n    hardware: {\n      name: \"Hardware Token (YubiKey)\",\n      security: \"Very High\",\n      pros: [\"Phishing resistant\", \"No batteries needed\", \"Extremely secure\"],\n      cons: [\"Costs money ($25-50)\", \"Can be lost/damaged\", \"Not universally supported\"],\n      recommendation: \"Best for high-value accounts\",\n      color: \"blue\"\n    },\n    biometric: {\n      name: \"Biometrics (Fingerprint/Face)\",\n      security: \"Moderate\",\n      pros: [\"Very convenient\", \"Can't forget\", \"Fast authentication\"],\n      cons: [\"Can't change if compromised\", \"Privacy concerns\", \"False positives\"],\n      recommendation: \"Good for device unlock, combine with other methods\",\n      color: \"purple\"\n    }\n  };\n\n  const selected = methods[state.selectedMethod] || methods.sms;\n\n  return (\n    <div className=\"space-y-4 text-sm\">\n      <p className=\"text-gray-700\">\n        Compare different 2FA and MFA methods. Not all methods are equally strong.\n      </p>\n\n      <div className=\"grid grid-cols-2 gap-2\">\n        {Object.entries(methods).map(([key, method]) => (\n          <button\n            key={key}\n            onClick={() => set_state({ selectedMethod: key })}\n            className={`p-3 rounded-lg border-2 text-left transition ${\n              state.selectedMethod === key\n                ? `border-${method.color}-500 bg-${method.color}-50`\n                : \"border-slate-200 bg-white hover:border-slate-300\"\n            }`}\n          >\n            <div className=\"font-semibold text-sm\">{method.name}</div>\n            <div className={`text-xs mt-1 font-medium ${\n              method.security === \"Very High\" ? \"text-green-600\" :\n              method.security === \"High\" ? \"text-blue-600\" :\n              method.security === \"Moderate\" ? \"text-yellow-600\" : \"text-red-600\"\n            }`}>\n              {method.security} Security\n            </div>\n          </button>\n        ))}\n      </div>\n\n      <div className=\"p-4 bg-slate-50 rounded-lg border border-slate-200\">\n        <div className=\"font-semibold text-lg mb-3\">{selected.name}</div>\n        \n        <div className=\"grid md:grid-cols-2 gap-4 mb-3\">\n          <div>\n            <div className=\"font-semibold text-green-700 mb-1\">‚úì Advantages</div>\n            <ul className=\"text-xs space-y-1\">\n              {selected.pros.map((pro, i) => (\n                <li key={i} className=\"flex gap-2\">\n                  <span className=\"tabular-nums\">{i + 1}.</span>\n                  <span className=\"flex-1\">{pro}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n          \n          <div>\n            <div className=\"font-semibold text-red-700 mb-1\">‚úó Disadvantages</div>\n            <ul className=\"text-xs space-y-1\">\n              {selected.cons.map((con, i) => (\n                <li key={i} className=\"flex gap-2\">\n                  <span className=\"tabular-nums\">{i + 1}.</span>\n                  <span className=\"flex-1\">{con}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n\n        <div className=\"p-3 bg-blue-50 border border-blue-200 rounded\">\n          <div className=\"font-semibold text-blue-900 mb-1\">Recommendation</div>\n          <div className=\"text-xs text-blue-800\">{selected.recommendation}</div>\n        </div>\n      </div>\n\n      <div className=\"p-4 bg-yellow-50 border border-yellow-300 rounded-lg\">\n        <div className=\"font-semibold text-yellow-900 mb-2\">‚ö†Ô∏è Real attack. Uber 2022 MFA fatigue</div>\n        <p className=\"text-xs text-yellow-800 mb-2\">\n          An attacker sent repeated MFA push notifications to an Uber employee. After many denials, the tired employee approved one and gave the attacker access.\n        </p>\n        <p className=\"text-xs text-yellow-800\">\n          <strong>Defense</strong> Use number matching or TOTP apps instead of simple push notifications. Always verify unexpected MFA requests.\n        </p>\n      </div>\n\n      <div className=\"p-4 bg-purple-50 border border-purple-300 rounded-lg\">\n        <div className=\"font-semibold text-purple-900 mb-2\">üéØ Your Action Plan</div>\n        <div className=\"text-xs text-purple-800 space-y-2\">\n          <div>\n            <strong>Priority 1 (This week)</strong> Enable 2FA on email and banking using an authenticator app\n          </div>\n          <div>\n            <strong>Priority 2 (This month)</strong> Enable 2FA on work accounts, social media, and password manager\n          </div>\n          <div>\n            <strong>Priority 3 (Optional)</strong> Purchase a hardware token for highest value accounts\n          </div>\n        </div>\n      </div>\n\n      <ToolStateActions\n        onReset={reset}\n        onCopy={copy_share_link}\n        onExport={export_json}\n        onImport={import_json}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}