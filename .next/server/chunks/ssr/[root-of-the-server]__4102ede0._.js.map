{
  "version": 3,
  "sources": [],
  "debugId": "ac2960da-d426-91f6-f94c-554b0db8b1b4",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../src/app/admin/billing/credits/%5Bid%5D/page.tsx"],"sourcesContent":["import Link from \"next/link\";\nimport { prisma } from \"@/lib/db/prisma\";\n\nexport const dynamic = \"force-dynamic\";\n\nexport const metadata = {\n  title: \"Admin: Credit ledger entry\",\n  robots: { index: false, follow: false },\n};\n\nfunction toHuman(d: any) {\n  try {\n    return new Date(d).toLocaleString();\n  } catch {\n    return String(d);\n  }\n}\n\nfunction formatPence(pence: number) {\n  const pounds = (pence / 100).toFixed(2);\n  return `£${pounds}`;\n}\n\nexport default async function CreditLedgerDetailPage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = await params;\n  let e: any = null;\n  try {\n    e = await (prisma as any).creditLedgerEvent.findUnique({\n      where: { id },\n      select: { id: true, userId: true, type: true, amountPence: true, reason: true, toolId: true, runId: true, createdAt: true, createdBy: true },\n    });\n  } catch {\n    e = null;\n  }\n  if (!e) {\n    return (\n      <main className=\"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-3\">\n        <h1 className=\"text-2xl font-semibold text-slate-900\">Ledger entry not found</h1>\n        <p className=\"text-slate-700\">This entry does not exist.</p>\n      </main>\n    );\n  }\n\n  let run: any = null;\n  if (e.runId) {\n    try {\n      run = await (prisma as any).toolRun.findUnique({\n        where: { id: e.runId },\n        select: { id: true, toolId: true, computeMs: true, computeUnits: true, costPence: true, status: true, createdAt: true },\n      });\n    } catch {\n      run = null;\n    }\n  }\n\n  return (\n    <main className=\"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-6\">\n      <header className=\"space-y-2\">\n        <p className=\"text-xs font-semibold text-slate-600\">Billing</p>\n        <h1 className=\"text-2xl font-semibold text-slate-900\">Credit ledger entry</h1>\n        <p className=\"text-slate-700\">Read-only detail view.</p>\n      </header>\n\n      <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-3\">\n        <div className=\"grid gap-3 sm:grid-cols-2\">\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Created</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{toHuman(e.createdAt)}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">User</p>\n            <p className=\"mt-1 font-mono text-xs text-slate-700\">{e.userId}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Type</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{e.type}</p>\n          </div>\n          <div>\n            <p className=\"text-xs font-semibold text-slate-700\">Amount</p>\n            <p className=\"mt-1 text-sm font-semibold text-slate-900\">{formatPence(Number(e.amountPence || 0))}</p>\n          </div>\n        </div>\n        <div className=\"rounded-2xl border border-slate-200 bg-slate-50/70 p-4\">\n          <p className=\"text-xs font-semibold text-slate-700\">Reason</p>\n          <p className=\"mt-1 text-sm text-slate-900\">{e.reason}</p>\n          <p className=\"mt-2 text-xs text-slate-600\">Created by: {e.createdBy || \"system\"}</p>\n        </div>\n        <div className=\"grid gap-3 sm:grid-cols-2\">\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Tool</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{e.toolId || \"\"}</p>\n          </div>\n          <div className=\"rounded-2xl border border-slate-200 bg-white p-4\">\n            <p className=\"text-xs font-semibold text-slate-700\">Run</p>\n            <p className=\"mt-1 text-sm text-slate-900\">{e.runId || \"\"}</p>\n          </div>\n        </div>\n      </section>\n\n      {run ? (\n        <section className=\"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-2\">\n          <h2 className=\"text-lg font-semibold text-slate-900\">Related tool run</h2>\n          <p className=\"text-sm text-slate-700\">\n            <span className=\"font-semibold\">{run.toolId}</span> · {run.status} · {toHuman(run.createdAt)}\n          </p>\n          <p className=\"text-sm text-slate-700\">Compute: {run.computeMs} ms · Units: {run.computeUnits} · Cost: {formatPence(Number(run.costPence || 0))}</p>\n          <Link href={`/admin/billing/usage/${encodeURIComponent(run.id)}`} className=\"text-sm font-semibold text-emerald-700 hover:underline\">\n            Open run detail\n          </Link>\n        </section>\n      ) : null}\n\n      <Link href=\"/admin/billing/credits\" className=\"text-sm font-semibold text-emerald-700 hover:underline\">\n        Back to credits ledger\n      </Link>\n    </main>\n  );\n}\n\n\n"],"names":[],"mappings":"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"}}]
}