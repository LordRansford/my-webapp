;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ca61e00c-f6ca-492c-6d2e-bccb3cd1e4f8")}catch(e){}}();
module.exports=[556704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},868404,a=>{"use strict";var b=a.i(127669),c=a.i(483074);function d(){let{data:a}=(0,c.useSession)(),d=a?.user?.id||null,[e,f]=(0,b.useState)(!1),g=(0,b.useRef)([]),h=(0,b.useRef)(null);(0,b.useEffect)(()=>{if(!d){f(!1),g.current=[];return}fetch("/api/account/profile").then(a=>a.json()).then(a=>{f(!!a?.user?.consent?.cpdDataUseAcceptedAt)}).catch(()=>f(!1))},[d]);let i=async()=>{if(!d||!e){g.current=[];return}let a=g.current.splice(0,g.current.length);if(a.length)try{await fetch("/api/analytics/events",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({events:a})})}catch{}};return(0,b.useEffect)(()=>()=>{h.current&&clearTimeout(h.current)},[]),{consented:e,track:a=>{if(d&&e){if(g.current.push({...a,timestamp:new Date().toISOString()}),g.current.length>=20)return void i();h.current&&clearTimeout(h.current),h.current=setTimeout(()=>void i(),1200)}},flush:i}}a.s(["useAnalytics",()=>d])},987346,160055,a=>{"use strict";function b(a){return"number"==typeof a&&Number.isFinite(a)?a:null}function c(a){let c=b(a);return null==c?null:Math.max(0,Math.round(c))}function d(a){let b=c(a);if(null==b)return null;let d=Math.max(0,Math.round(b/1e3));if(d<60)return`${d}s`;let e=Math.floor(d/60);return`${e}m ${d%60}s`}function e(a){let c=b(a);return null==c?null:String(Math.max(0,Math.round(c)))}a.s(["formatCreditsSafe",()=>e,"formatMsSafe",()=>d,"msOrNull",()=>c,"numberOrNull",()=>b],160055),a.s([],987346)},843539,a=>{"use strict";var b=a.i(508171),c=a.i(127669);a.i(987346);var d=a.i(160055);function e({estimatedCredits:a,currentBalance:e,onAccept:f,onDecline:g,disabled:h=!1,safetyBuffer:i=1.25}){let[j,k]=(0,c.useState)(!1),l=Math.ceil(a*i),m=null!==e&&e>=l;return((0,c.useEffect)(()=>{k(!1)},[a]),a<=0)?null:null===e?(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:(0,b.jsx)("p",{className:"text-sm text-slate-700",children:"Loading credit balance..."})}):(0,b.jsx)("div",{className:"rounded-xl border border-amber-200 bg-amber-50/50 p-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Credit Cost Estimate"}),(0,b.jsx)("span",{className:"text-xs font-semibold text-amber-700 bg-amber-100 px-2 py-0.5 rounded",children:"ESTIMATE"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-3",children:[(0,b.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-slate-700",children:"Estimated credits:"}),(0,b.jsx)("span",{className:"text-lg font-bold text-slate-900",children:(0,d.formatCreditsSafe)(a)})]}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-slate-600",children:"Required (with safety buffer):"}),(0,b.jsx)("span",{className:"font-semibold text-slate-700",children:(0,d.formatCreditsSafe)(l)})]}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-slate-600",children:"Current balance:"}),(0,b.jsx)("span",{className:`font-semibold ${m?"text-slate-900":"text-rose-600"}`,children:(0,d.formatCreditsSafe)(e)})]})]}),(0,b.jsx)("div",{className:"rounded-lg border border-amber-300 bg-amber-100/50 p-3",children:(0,b.jsxs)("p",{className:"text-xs font-medium text-amber-900",children:["⚠️ ",(0,b.jsx)("strong",{children:"This is an ESTIMATE."})," Actual cost may be higher or lower depending on actual execution time, complexity, and system load."]})}),!m&&(0,b.jsxs)("div",{className:"rounded-lg border border-rose-300 bg-rose-50 p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-rose-900",children:"Insufficient Credits"}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-rose-800",children:["You need at least ",(0,d.formatCreditsSafe)(l)," credits to proceed. Current balance: ",(0,d.formatCreditsSafe)(e),"."]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"credit-consent",checked:j,onChange:a=>{a.target.checked&&m?(k(!0),f?.()):k(!1)},disabled:!m||h,className:"mt-0.5 h-4 w-4 rounded border-slate-300 text-amber-600 focus:ring-amber-500 disabled:opacity-50 disabled:cursor-not-allowed"}),(0,b.jsxs)("label",{htmlFor:"credit-consent",className:"text-xs text-slate-700",children:[(0,b.jsx)("span",{className:"font-medium",children:"I accept that this operation will consume credits."}),(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-slate-600",children:"I understand this is an estimate and actual cost may vary. I have sufficient credits to proceed."})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:j&&m?(0,b.jsx)("button",{type:"button",onClick:()=>{k(!1),g?.()},className:"text-xs text-slate-600 underline hover:text-slate-900",children:"Revoke acceptance"}):(0,b.jsx)("button",{type:"button",onClick:()=>{m&&(k(!0),f?.())},disabled:!m||h,className:"rounded-lg bg-amber-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Accept and Continue"})})]})})}function f(a,b,d=1.25){let[e,g]=(0,c.useState)(!1),h=Math.ceil(a*d),i=null!==b&&b>=h,j=!(a>0)||e&&i;return(0,c.useEffect)(()=>{a<=0&&g(!0)},[a]),{accepted:e,setAccepted:g,canProceed:j,hasEnoughCredits:i,requiredCredits:h,needsConsent:a>0}}a.s(["default",()=>e,"useCreditConsent",()=>f])},137522,a=>{"use strict";var b=a.i(508171),c=a.i(127669),d=a.i(645667),e=a.i(901257),f=a.i(483074);let g=["public","registered","supporter","professional"];function h({message:a,detail:c}){return(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-3 shadow-sm",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:a}),c?(0,b.jsx)("p",{className:"text-sm text-slate-700 mt-1",children:c}):null]})}var i=a.i(868404),j=a.i(448988);function k({requiredLevel:a,fallbackMessage:d,showUpgradeHint:k=!0,children:l}){let{data:m}=(0,f.useSession)(),[n,o]=(0,c.useState)("public"),p=(0,i.useAnalytics)(),q=(0,j.getTestingOverrideDecision)().allowed;(0,c.useEffect)(()=>{let a=!1;return async function(){try{if(q){a||o("professional");return}let b=await fetch("/api/billing/summary");if(!b.ok)throw Error("summary");let c=await b.json(),d=c?.plan==="supporter"?"supporter":c?.plan==="pro"||c?.plan==="professional"?"professional":m?.user?.id?"registered":"public";a||o(d)}catch{a||o(m?.user?.id?"registered":"public")}}(),()=>{a=!0}},[m?.user?.id,q]);let r=(0,c.useMemo)(()=>q||g.indexOf(n)>=g.indexOf(a),[a,n,q]);return((0,c.useEffect)(()=>{r||p.track({type:"access_gate_locked",requiredLevel:a,plan:n})},[r]),r)?(0,b.jsx)(b.Fragment,{children:l}):(0,b.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 shadow-sm",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"This feature is available to higher access levels."}),(0,b.jsxs)("p",{className:"text-sm text-slate-700",children:["Current: ",n,". Required: ",a,"."]}),d?(0,b.jsx)(h,{message:d}):null,k?(0,b.jsx)(h,{message:"Create an account or sign in to continue.",detail:"Accounts save your progress and enable certificates and downloads."}):null,(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(e.default,{href:"/signin",className:"button",children:"Sign in"}),(0,b.jsx)(e.default,{href:"/pricing",className:"link",children:"See access options"})]})]})})}let l={ai:50,cybersecurity:0,"software-architecture":50,data:50,digitalisation:50};var m=a.i(843539);function n(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null),[l,m]=(0,c.useState)(null),[n,p]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/learning/records");if(!a.ok){j("Sign in to view your learning records."),f([]);return}let b=await a.json();f(Array.isArray(b?.records)?b.records:[])}catch{j("Could not load learning records.")}finally{h(!1)}})()},[]),(0,c.useEffect)(()=>{fetch("/api/credits/status").then(a=>a.ok?a.json():null).then(a=>{p("number"==typeof a?.balance?a.balance:0)}).catch(()=>p(0))},[]);let q=(0,c.useMemo)(()=>Math.round(a.reduce((a,b)=>a+(Number(b.timeSpentMinutes)||0),0)/60*10)/10,[a]),r=async(a,b)=>{m(`${a}:${b}`);try{let c=`${a}:${b}`,d=await fetch("/api/certificates/issue",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({courseId:c})}),e=await d.json().catch(()=>({}));if(!d.ok)return void j(e?.message||"Unable to issue certificate.");let f="string"==typeof e?.pdfUrl?e.pdfUrl:null,g="string"==typeof e?.verifyUrl?e.verifyUrl:null;f?window.location.href=f:g&&(window.location.href=g)}catch{j("Unable to issue certificate.")}finally{m(null)}};return(0,b.jsx)(d.default,{title:"Learning records",description:"Server verified learning records and CPD evidence summary.",children:(0,b.jsxs)("main",{className:"page",children:[(0,b.jsxs)("header",{className:"page-header",children:[(0,b.jsx)("p",{className:"eyebrow",children:"My CPD"}),(0,b.jsx)("h1",{children:"Learning records"}),(0,b.jsx)("p",{className:"lead",children:"This page shows server-derived learning records. Hours are calculated conservatively."}),(0,b.jsx)("p",{className:"muted",children:"Calculation method: earned minutes are based on completed sections, quizzes, and tool usage, capped by the course estimated hours. Manual hours are not accepted for certificates."}),(0,b.jsx)("div",{className:"actions",children:(0,b.jsx)(e.default,{href:"/my-cpd/evidence",className:"button",children:"CPD evidence text"})})]}),(0,b.jsxs)("section",{className:"section",children:[g?(0,b.jsx)("p",{className:"muted",children:"Loading."}):null,i?(0,b.jsx)("p",{className:"muted",children:i}):null,g||i?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"muted",children:["Total earned hours (all records): ",q]}),0===a.length?(0,b.jsx)("p",{className:"muted",children:"No records yet. Complete sections and quizzes, then refresh a record from a course page."}):(0,b.jsx)("div",{className:"card-grid",children:a.map(a=>(0,b.jsxs)("div",{className:"card",children:[(0,b.jsxs)("h3",{children:[a.courseId," ",a.levelId]}),(0,b.jsxs)("p",{className:"muted",children:["Status: ",a.completionStatus]}),(0,b.jsxs)("p",{className:"muted",children:["Sections completed: ",a.sectionsCompleted," · Quizzes: ",a.quizzesCompleted," · Tools used: ",a.toolsUsed]}),(0,b.jsxs)("p",{className:"muted",children:["Earned hours: ",Math.round(a.timeSpentMinutes/60*10)/10]}),a.completionDate?(0,b.jsxs)("p",{className:"muted",children:["Completion date: ",new Date(a.completionDate).toLocaleDateString()]}):null,(0,b.jsx)("div",{className:"actions",children:(0,b.jsxs)(k,{requiredLevel:"supporter",fallbackMessage:"Sign in to get a CPD certificate for this course.",showUpgradeHint:!0,children:[(0,b.jsx)("p",{className:"muted",style:{marginTop:0},children:"Everything on RansfordsNotes is free to learn and use. We only charge for extra compute and for issuing CPD certificates."}),(0,b.jsx)("p",{className:"muted",style:{marginTop:0},children:"You are purchasing certificate issuance. This covers identity linked issuance, a downloadable PDF, and a public verification page."}),(0,b.jsx)(o,{courseId:a.courseId,levelId:a.levelId,completionStatus:a.completionStatus,issuing:l,balance:n,onIssue:r})]})})]},`${a.courseId}:${a.levelId}`))})]})]})]})})}function o({courseId:a,levelId:c,completionStatus:d,issuing:e,balance:f,onIssue:g}){let h,i=Math.max(0,Math.round("number"==typeof(h=l[a])?h:50)),{accepted:j,canProceed:k}=(0,m.useCreditConsent)(i,f),n=e===`${a}:${c}`;return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(m.default,{estimatedCredits:i,currentBalance:f,onAccept:()=>{}}),(0,b.jsx)("button",{type:"button",className:"button",disabled:"completed"!==d||n||!k,onClick:()=>g(a,c),children:n?"Issuing...":`Get CPD certificate (${i} credits)`})]})}a.s(["default",()=>n],137522)},224973,a=>a.a(async(b,c)=>{try{var d=a.i(579168),e=a.i(627068),f=a.i(332759),g=a.i(167684),h=a.i(276695),i=a.i(137522),j=a.i(509193),k=b([h]);[h]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/my-cpd/records",pathname:"/my-cpd/records",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/my-cpd/records",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1),705779,a=>{a.v(b=>Promise.all(["server/chunks/ssr/src_components_donations_DonationModal_tsx_266cc690._.js"].map(b=>a.l(b))).then(()=>b(438398)))}];

//# debugId=ca61e00c-f6ca-492c-6d2e-bccb3cd1e4f8
//# sourceMappingURL=%5Broot-of-the-server%5D__f8435ed8._.js.map