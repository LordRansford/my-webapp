;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="33b597b5-caba-38aa-8c0a-63f14cf30896")}catch(e){}}();
module.exports=[602467,a=>{"use strict";var b=a.i(218282),c=a.i(572131),d=a.i(469124),e=a.i(831866);function f(a,b,c,d){let f=new e.SeededRNG(a+1e3*b),g=function(a){switch(a){case 1:return 3+Math.floor(2*Math.random());case 2:return 5+Math.floor(2*Math.random());case 3:return 6+Math.floor(2*Math.random());case 4:return 8+Math.floor(2*Math.random())}}(c),h=[];for(let a=0;a<g;a++){let a=f.next()<d,e=function(a,b,c,d){let e=a.sample([{name:"Unusual Network Traffic",severity:"high"},{name:"Suspicious File Activity",severity:"medium"},{name:"Anomalous Process Behavior",severity:"high"},{name:"Failed Login Attempts",severity:"medium"},{name:"Data Exfiltration Pattern",severity:"critical"},{name:"Malware Signature Detected",severity:"critical"}],1)[0],f=d?.3*a.next():.7+.3*a.next(),g=function(a,b,c){let d=["network","file","process","user","system"],e=b<=2?2:3===b?3:4,f=[];for(let b=0;b<e;b++){let e=a.sample(d,1)[0],g=c?.3+.4*a.next():.7+.3*a.next();f.push({id:`evidence-${b}`,type:e,description:`${e} evidence ${b+1}`,confidence:g,revealed:!1})}return f}(a,c,d);return{id:`signal-${b}-${a.next()}`,name:e.name,description:`${e.name} detected from source ${a.next().toString(36).substring(2,8)}`,severity:e.severity,threatProbability:f,evidence:g,source:`source-${a.next()}`,timestamp:b,isFalsePositive:d}}(f,b,c,a);h.push(e)}return h}function g(a,b){let c=b/4;return a<=c?1:a<=2*c?2:a<=3*c?3:4}function h(){return{version:1,xp:0,currentTier:"novice",tierProgress:0,unlockedTooling:["basic-investigation","basic-containment"],unlockedPostures:["aggressive","balanced","defensive"],unlockedScenarios:["basic-training"],personalBests:{},currentStreak:0,longestStreak:0,lastPlayedDate:"",completedChallenges:[],stats:{gamesPlayed:0,gamesWon:0,totalSignalsProcessed:0,totalFalsePositives:0,averageResponseTime:0}}}a.i(260054);var i=a.i(389158);a.i(671016);var j=a.i(682313),k=a.i(485827);a.i(264057);var l=a.i(648309);a.i(126482);var m=a.i(196613);a.i(649317);var n=a.i(301944);a.i(930929);var o=a.i(103121),p=a.i(550165),q=a.i(132333),r=a.i(442299);a.i(896088);var s=a.i(129739),t=a.i(606346);let u={id:"signal-hunt",title:"Signal Hunt",description:"Triage security signals under time pressure",category:"strategy",modes:["solo","daily"],supportsMultiplayer:!1,minPlayers:1,maxPlayers:1,estimatedMinutes:15,tutorialAvailable:!0},v="signal-hunt";function w(){let[a,w]=(0,c.useState)("idle"),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(null);(0,c.useEffect)(()=>{"idle"!==a||x||N()},[a,x]);let N=(0,c.useCallback)(()=>{try{var a,b,c,d;let g,h,j,k=(0,i.getOrGenerateTodayChallenge)(v),l=(a=k.seed,b="intermediate",g=new e.SeededRNG(a),h=function(a){switch(a){case"foundations":return{totalTurns:8,falsePositiveRate:.2,initialActions:5,initialBudget:8};case"intermediate":return{totalTurns:10,falsePositiveRate:.35,initialActions:4,initialBudget:6};case"advanced":return{totalTurns:12,falsePositiveRate:.4,initialActions:3,initialBudget:5};case"expert":return{totalTurns:12,falsePositiveRate:.5,initialActions:2,initialBudget:3}}}(b),c={id:`scenario-${a}`,name:({foundations:"SOC Training Scenario",intermediate:"Incident Response Challenge",advanced:"Advanced Threat Triage",expert:"Elite Security Operations"})[b],description:({foundations:"Learn the basics of security signal triage in a controlled environment.",intermediate:"Manage security signals under moderate pressure with realistic false positive rates.",advanced:"Handle complex security incidents with multiple simultaneous threats.",expert:"Master elite-level security operations with adversarial threats and high noise."})[b],adversaryType:g.sample(["Script Kiddie","Organized Crime","Advanced Persistent Threat","Insider Threat","Nation State Actor"],1)[0],environmentNoise:h.falsePositiveRate,difficulty:b,totalTurns:h.totalTurns,initialBudget:{actions:h.initialActions,budget:h.initialBudget}},d=k.seed,j=f(d,1,1,c.environmentNoise),{currentTurn:0,totalTurns:c.totalTurns,currentPhase:1,riskScore:0,budget:{actions:c.initialBudget.actions,budget:c.initialBudget.budget},signalQueue:j,threats:new Map,investigationHistory:[],toolingActive:[],posture:"balanced",seed:d,status:"idle"});y(l),A([]),C(null),E(null),G([]),I(null),K(null)}catch(a){console.error("Error initializing challenge:",a)}},[]),O=(0,c.useCallback)(()=>{x?(y({...x,status:"playing",currentTurn:1}),w("playing"),M(Date.now())):N()},[x,N]),P=(0,c.useCallback)((b,c)=>{"playing"===a&&x&&A(a=>[...a.filter(a=>a.signalId!==b),{signalId:b,type:c,timestamp:x.currentTurn}])},[a,x]),Q=(0,c.useCallback)(()=>{if(!x||"playing"!==a||0===z.length)return;let b=function(a,b){if("playing"!==a.status)return a;let c={...a};for(let a of b)c=function(a,b){let c=a.signalQueue.find(a=>a.id===b.signalId);if(!c)return a;let d={...a};switch(b.type){case"investigate":c.evidence.forEach(a=>a.revealed=!0);let e=c.evidence.reduce((a,b)=>a+b.confidence,0)/c.evidence.length;c.threatProbability=c.isFalsePositive?Math.max(0,c.threatProbability-.3*e):Math.min(1,c.threatProbability+.3*e),d.budget.actions-=1,d.investigationHistory.push(b);break;case"contain":let f=d.threats.get(b.signalId);f&&(f.state="contained",f.escalationLevel=Math.max(0,f.escalationLevel-20)),d.budget.actions-=1,d.budget.budget-=1;break;case"patch":let g=d.threats.get(b.signalId);g&&(g.state="resolved",g.escalationLevel=0),d.budget.actions-=1,d.budget.budget-=2;break;case"monitor":break;case"ignore":d.signalQueue=d.signalQueue.filter(a=>a.id!==b.signalId)}return d}(c,a);if((c=function(a){let b={...a},c=new Map(b.threats);for(let[a,b]of c.entries())"contained"!==b.state&&"resolved"!==b.state&&(b.escalationLevel+=b.escalationRate,b.escalationLevel>=100?b.state="critical":b.escalationLevel>=50&&(b.state="escalating"));for(let b of a.signalQueue)!c.has(b.id)&&b.threatProbability>.6&&c.set(b.id,{signalId:b.id,state:"new",escalationLevel:0,escalationRate:function(a){switch(a){case 1:return 10;case 2:return 15;case 3:return 25;case 4:return 40}}(a.currentPhase)});return b.threats=c,b}(c)).currentTurn<c.totalTurns){let a=g(c.currentTurn+1,c.totalTurns),b=f(c.seed,c.currentTurn+1,a,c.signalQueue.length>0?.35:.2);c.signalQueue=[...c.signalQueue,...b]}return c.currentPhase=g(c.currentTurn,c.totalTurns),c.riskScore=function(a){let b=0;for(let c of a.threats.values())b+=.5*c.escalationLevel,"critical"===c.state&&(b+=30);for(let c of a.signalQueue)"critical"===c.severity?b+=10:"high"===c.severity&&(b+=5);return Math.min(100,b)}(c),c.currentTurn>=c.totalTurns||c.riskScore>=100?(c.status="finished",c.outcome=c.riskScore<50?"win":"loss"):c.currentTurn+=1,c}(x,z);y(b),A([]),"finished"===b.status&&(w("finished"),R(b))},[x,a,z]),R=(0,c.useCallback)(a=>{var b,c;let d,e,f,g,o,p,q,r,u;if(!a.outcome||!L)return;let w=Date.now()-L,x="win"===a.outcome,y=a.investigationHistory.length,z=a.signalQueue.filter(b=>b.isFalsePositive&&a.investigationHistory.some(a=>a.signalId===b.id)).length,A=y>0?1-z/y:1,B=x?Math.round((100-a.riskScore)*.6+100*A*.4):Math.round((100-a.riskScore)*.4),D=(0,j.generateTodayChallengeCode)(v,a.seed);(0,k.storeChallengeCode)(D),C(D);let F=(0,s.calculateBaseXP)({win:x,score:B,efficiency:100*A,time:w,difficulty:"aggressive"===a.posture?"advanced":"intermediate",tier:h().currentTier}),H=(0,l.getStreakDataForGame)(v),J=(0,s.createRewardContext)({gameId:v,seed:a.seed,baseXP:F,performance:{score:B,efficiency:100*A,time:w},streak:H.currentStreak,tier:h().currentTier}),M=(0,t.generateRewardResult)(J),N=(b=h(),d={...b},d.stats.gamesPlayed+=1,"win"===a.outcome&&(d.stats.gamesWon+=1),e=`scenario-${a.seed}`,(f=d.personalBests[e])&&!(B>f.bestScore)||(d.personalBests[e]={bestScore:B,bestTurns:a.currentTurn,bestAccuracy:A}),o=(g={novice:0,analyst:100,expert:300,master:600,legend:1e3})[d.currentTier],c=d.currentTier,q=g[p=(u=(r=["novice","analyst","expert","master","legend"]).indexOf(c))<r.length-1?r[u+1]:c],d.xp>=q?(d.currentTier=p,d.tierProgress=0):d.tierProgress=(d.xp-o)/(q-o),d);N.xp=M.totalXP;let O={score:B,time:w,scoreValue:B,timestamp:Date.now()};I(O),E((0,n.submitScore)(D.code,O)),(0,i.completeTodayChallenge)(v,{score:B,time:w,scoreValue:B}),(0,l.updateStreakForGame)(v,!0),G((0,m.checkAndUnlockAchievements)({gameId:v,currentStreak:H.currentStreak+1,gamesCompleted:N.stats.gamesPlayed,score:B,time:w}).newlyUnlocked),K(function(a){let b=[],c=[],d=[],e=0;for(let d of a.investigationHistory){let f=a.signalQueue.find(a=>a.id===d.signalId);f&&(f.isFalsePositive?(e++,c.push({turn:d.timestamp,description:`Investigated false positive: ${f.name}`,cost:"Wasted 1 action token",recommendation:"Use Deep Investigation tooling to reduce false positives"})):b.push({turn:d.timestamp,description:`Investigated true threat: ${f.name}`,impact:"positive",reasoning:"Investigation revealed threat, enabling optimal containment"}))}for(let b of a.threats.values())"critical"===b.state&&c.push({turn:a.currentTurn,description:`Threat escalated to critical: ${b.signalId}`,cost:"Increased risk score significantly",recommendation:"Contain threats earlier, before escalation"});let f=a.investigationHistory.length>0?e/a.investigationHistory.length:0;f>.3&&d.push({type:"tooling",description:"Use Deep Investigation tooling to reduce false positives",rationale:`Your false positive rate is ${Math.round(100*f)}%, which is inefficient`}),a.riskScore>70&&d.push({type:"strategy",description:"Focus on containment earlier in the game",rationale:"High risk score indicates threats were allowed to escalate"});let g="win"===a.outcome?`Successfully managed security signals with ${Math.round((1-f)*100)}% accuracy. Final risk score: ${Math.round(a.riskScore)}.`:`Failed to maintain security posture. Risk score exceeded threshold at ${a.currentTurn} turns. False positive rate: ${Math.round(100*f)}%.`;return{keyDecisions:b,mistakes:c.slice(0,3),recommendations:d,summary:g}}(a))},[L]),S=(0,c.useCallback)(()=>{w("idle"),y(null),A([]),C(null),E(null),G([]),I(null),K(null),M(null)},[]),T=x?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Turn"}),(0,b.jsxs)("div",{className:"text-lg font-bold",children:[x.currentTurn," / ",x.totalTurns]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Risk Score"}),(0,b.jsx)("div",{className:`text-lg font-bold ${x.riskScore<30?"text-green-600":x.riskScore<70?"text-yellow-600":"text-red-600"}`,children:Math.round(x.riskScore)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Budget"}),(0,b.jsxs)("div",{className:"text-sm",children:["Actions: ",x.budget.actions,(0,b.jsx)("br",{}),"Budget: ",x.budget.budget]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Threats"}),(0,b.jsxs)("div",{className:"text-sm",children:["Active: ",Array.from(x.threats.values()).filter(a=>"resolved"!==a.state).length]})]})]}):null;return(0,b.jsx)(d.default,{config:u,status:a,onStart:O,onReset:S,rightPanel:T,children:(0,b.jsx)("div",{className:"p-4",children:x?"idle"===a?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Signal Hunt"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Triage security signals under time pressure"}),(0,b.jsx)("button",{onClick:O,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Start Challenge"})]}):"playing"===a||"finished"===a?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:["Signal Queue (Turn ",x.currentTurn,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:x.signalQueue.slice(0,6).map(c=>{let d=z.find(a=>a.signalId===c.id),e=x.threats.get(c.id);return(0,b.jsxs)("div",{className:`p-3 border-2 rounded-lg ${"critical"===c.severity?"border-red-500 bg-red-50":"high"===c.severity?"border-orange-500 bg-orange-50":"medium"===c.severity?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold text-slate-900",children:c.name}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:c.description})]}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:["Threat: ",Math.round(100*c.threatProbability),"%"]})]}),"playing"===a&&(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>P(c.id,"investigate"),className:`px-3 py-1 text-sm rounded ${d?.type==="investigate"?"bg-blue-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Investigate"}),(0,b.jsx)("button",{onClick:()=>P(c.id,"contain"),className:`px-3 py-1 text-sm rounded ${d?.type==="contain"?"bg-green-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Contain"}),(0,b.jsx)("button",{onClick:()=>P(c.id,"patch"),className:`px-3 py-1 text-sm rounded ${d?.type==="patch"?"bg-purple-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Patch"}),(0,b.jsx)("button",{onClick:()=>P(c.id,"monitor"),className:`px-3 py-1 text-sm rounded ${d?.type==="monitor"?"bg-yellow-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Monitor"}),(0,b.jsx)("button",{onClick:()=>P(c.id,"ignore"),className:`px-3 py-1 text-sm rounded ${d?.type==="ignore"?"bg-gray-600 text-white":"bg-slate-200 text-slate-700"}`,children:"Ignore"})]}),e&&(0,b.jsxs)("div",{className:"mt-2 text-xs text-red-600",children:["Threat Level: ",Math.round(e.escalationLevel),"% (",e.state,")"]})]},c.id)})})]}),"playing"===a&&(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)("button",{onClick:Q,disabled:0===z.length,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Confirm Turn ",x.currentTurn," (",z.length," actions)"]})}),"finished"===a&&B&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`text-3xl font-bold mb-2 ${"win"===x.outcome?"text-green-600":"text-red-600"}`,children:"win"===x.outcome?"Success!":"Failed"}),(0,b.jsxs)("div",{className:"text-sm text-slate-600",children:["Risk Score: ",Math.round(x.riskScore)," | Turns: ",x.currentTurn]})]}),(0,b.jsx)(o.ChallengeCodeShare,{code:B,score:H?.score||0}),D&&(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(p.ScoreComparisonDisplay,{comparison:D})}),(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(r.LeaderboardView,{challengeCode:B.code,playerScore:H||void 0})}),F.length>0&&(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsx)(q.AchievementDisplay,{achievementIds:F,compact:!0})}),J&&(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Analysis"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-slate-900 mb-1",children:"Summary"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:J.summary})]}),J.recommendations.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-slate-900 mb-1",children:"Recommendations"}),(0,b.jsx)("ul",{className:"text-sm text-slate-600 list-disc list-inside space-y-1",children:J.recommendations.map((a,c)=>(0,b.jsx)("li",{children:a.description},c))})]})]})]}),(0,b.jsx)("button",{onClick:S,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"New Challenge"})]})]}):null:(0,b.jsx)("div",{className:"text-center text-slate-600",children:"Loading scenario..."})})})}a.s(["default",()=>w],602467)}];

//# debugId=33b597b5-caba-38aa-8c0a-63f14cf30896
//# sourceMappingURL=src_lib_games_games_signal-hunt_SignalHunt_tsx_2a2ec6e5._.js.map