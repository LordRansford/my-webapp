;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="2dd118d1-7374-1492-74da-f72034996dbc")}catch(e){}}();
module.exports=[814747,(e,t,n)=>{t.exports=e.x("path",()=>require("path"))},193695,(e,t,n)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,n)=>{t.exports=e.x("fs",()=>require("fs"))},657194,e=>{"use strict";var t=e.i(89171),n=e.i(254799);let r=new Map;function a(e,a){var o,i;let s,l,u,c=Date.now(),d=`${a.keyPrefix}:${(o=a.keySuffix,s=e.headers.get("x-forwarded-for")||"",l=s.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",u=e.headers.get("user-agent")||"unknown",i=`${l}|${u}|${o||""}`,n.default.createHash("sha256").update(i).digest("hex").slice(0,24))}`,p=r.get(d);if(!p||p.resetAt<=c)return r.set(d,{count:1,resetAt:c+a.windowMs}),null;if(p.count+=1,p.count>a.limit){let e=Math.max(1,Math.ceil((p.resetAt-c)/1e3));return t.NextResponse.json({error:a.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>a])},875301,e=>{"use strict";var t=e.i(747909),n=e.i(174017),r=e.i(996250),a=e.i(759756),o=e.i(561916),i=e.i(114444),s=e.i(837092),l=e.i(869741),u=e.i(316795),c=e.i(487718),d=e.i(995169),p=e.i(47587),h=e.i(666012),m=e.i(570101),g=e.i(626937),f=e.i(10372),y=e.i(193695);e.i(52474);var v=e.i(600220);function R(e,t){let n=100;return e.forEach(e=>{0===e.securityControls.length&&(n-=5),e.vulnerabilities.length>0&&(n-=3*e.vulnerabilities.length),"public"===e.trustZone&&e.securityControls.length<2&&(n-=5)}),t.forEach(e=>{e.encrypted||(n-=2)}),Math.max(0,Math.min(100,n))}let C=(0,e.i(1863).createToolExecutionHandler)({toolId:"cyber-studio-security-architecture",executeTool:async(e,t)=>{let n,r,a,o,i,s=Date.now(),l=t.architectureName||t.name||"Untitled Architecture",u=t.components||[],c=t.connections||[],d=(n=[],r=[],0===u.length&&n.push("Architecture must contain at least one component"),a=new Set,u.forEach((e,t)=>{e.name&&""!==e.name.trim()?a.has(e.id)?n.push(`Duplicate component ID: ${e.id}`):a.add(e.id):n.push(`Component ${t+1} must have a name`),"public"===e.trustZone&&0===e.securityControls.length&&r.push(`Public component "${e.name}" should have security controls`),e.vulnerabilities.length>0&&0===e.securityControls.length&&r.push(`Component "${e.name}" has vulnerabilities but no security controls`)}),c.forEach((e,t)=>{let a=u.find(t=>t.id===e.from),o=u.find(t=>t.id===e.to);a||n.push(`Connection ${t+1} references non-existent source component: ${e.from}`),o||n.push(`Connection ${t+1} references non-existent destination component: ${e.to}`),a&&o&&!e.encrypted&&("public"===a.trustZone||"public"===o.trustZone)&&r.push(`Unencrypted connection between "${a.name}" and "${o.name}" involving public zone`)}),{valid:0===n.length,errors:n,warnings:r});if(!d.valid)return{result:{success:!1,errors:d.errors,warnings:d.warnings,architecture:{name:l,components:u,connections:c}},actualUsage:{cpuMs:Date.now()-s,memMb:170,durationMs:Date.now()-s}};let p=R(u,c),h=(o=`SECURITY ARCHITECTURE REPORT
===========================

Architecture: ${l}
Generated: ${new Date().toISOString()}

`,i=R(u,c),o+=`EXECUTIVE SUMMARY
=================
Security Score: ${i}/100
Total Components: ${u.length}
Total Connections: ${c.length}
Components with Controls: ${u.filter(e=>e.securityControls.length>0).length}
Components with Vulnerabilities: ${u.filter(e=>e.vulnerabilities.length>0).length}

COMPONENTS BY TRUST ZONE
=======================

`,["public","dmz","internal","restricted"].forEach(e=>{let t=u.filter(t=>t.trustZone===e);t.length>0&&(o+=`${e.toUpperCase()} ZONE
${"-".repeat(e.length+5)}

`,t.forEach(e=>{o+=`${e.name}
  Type: ${e.type.replace(/_/g," ")}
  Description: ${e.description||"Not provided"}
  Security Controls: ${e.securityControls.length}
`,e.securityControls.length>0&&e.securityControls.forEach(e=>{o+=`    - ${e}
`}),o+=`  Vulnerabilities: ${e.vulnerabilities.length}
`,e.vulnerabilities.length>0&&e.vulnerabilities.forEach(e=>{o+=`    - ${e}
`}),o+=`
`}))}),o+=`
CONNECTIONS
===========

`,c.forEach((e,t)=>{let n=u.find(t=>t.id===e.from),r=u.find(t=>t.id===e.to);o+=`${t+1}. ${n?.name||e.from} → ${r?.name||e.to}
   Protocol: ${e.protocol}
   Encrypted: ${e.encrypted?"Yes":"No"}
`,e.encrypted||(o+=`   ⚠️  WARNING: Unencrypted connection
`),o+=`
`}),o+=`
--- END OF REPORT ---
`),m={totalComponents:u.length,totalConnections:c.length,byType:u.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{}),byTrustZone:u.reduce((e,t)=>(e[t.trustZone]=(e[t.trustZone]||0)+1,e),{}),encryptedConnections:c.filter(e=>e.encrypted).length,componentsWithControls:u.filter(e=>e.securityControls.length>0).length,componentsWithVulnerabilities:u.filter(e=>e.vulnerabilities.length>0).length};return await new Promise(e=>setTimeout(e,300)),{result:{success:!0,architecture:{name:l,components:u,connections:c,securityScore:p,report:h,summary:m,validation:{valid:!0,warnings:d.warnings},toolId:"cyber-studio-security-architecture",timestamp:new Date().toISOString()}},actualUsage:{cpuMs:Date.now()-s,memMb:170,durationMs:Date.now()-s}}}});e.s(["POST",0,C],958831);var E=e.i(958831);let w=new t.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/cyber-studio/security-architecture/run/route",pathname:"/api/cyber-studio/security-architecture/run",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/cyber-studio/security-architecture/run/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:b,workUnitAsyncStorage:x,serverHooks:$}=w;function T(){return(0,r.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:x})}async function A(e,t,r){w.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/cyber-studio/security-architecture/run/route";R=R.replace(/\/index$/,"")||"/";let C=await w.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!C)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:E,params:b,nextConfig:x,parsedUrl:$,isDraftMode:T,prerenderManifest:A,routerServerContext:N,isOnDemandRevalidate:S,revalidateOnlyGenerated:P,resolvedPathname:O,clientReferenceManifest:M,serverActionsManifest:U}=C,_=(0,l.normalizeAppPath)(R),D=!!(A.dynamicRoutes[_]||A.routes[O]),I=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,$,!1):t.end("This page could not be found"),null);if(D&&!T){let e=!!A.routes[O],t=A.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await I();throw new y.NoFallbackError}}let k=null;!D||w.isDev||T||(k="/index"===(k=O)?"/":k);let H=!0===w.isDev||!D,q=D&&!H;U&&M&&(0,i.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:M,serverActionsManifest:U,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:U})});let j=e.method||"GET",Z=(0,o.getTracer)(),F=Z.getActiveScopeSpan(),K={params:b,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r)=>w.onRequestError(e,t,r,N)},sharedContext:{buildId:E}},V=new u.NodeNextRequest(e),B=new u.NodeNextResponse(t),L=c.NextRequestAdapter.fromNodeNextRequest(V,(0,c.signalFromNodeResponse)(t));try{let i=async e=>w.handle(L,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=Z.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=n.get("next.route");if(r){let t=`${j} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${R}`)}),s=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var o,l;let u=async({previousCacheEntry:n})=>{try{if(!s&&S&&P&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await i(a);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=K.renderOpts.collectedTags;if(!D)return await (0,h.sendResponse)(V,B,o,K.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,r=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:r}}}}catch(t){throw(null==n?void 0:n.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:S})},N),t}},c=await w.handleResponse({req:e,nextConfig:x,cacheKey:k,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:P,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:s});if(!D)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",S?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&D||d.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(V,B,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};F?await l(F):await Z.withPropagatedContext(e.headers,()=>Z.trace(d.BaseServerSpan.handleRequest,{spanName:`${j} ${R}`,kind:o.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:S})}),D)throw t;return await (0,h.sendResponse)(V,B,new Response(null,{status:500})),null}}e.s(["handler",()=>A,"patchFetch",()=>T,"routeModule",()=>w,"serverHooks",()=>$,"workAsyncStorage",()=>b,"workUnitAsyncStorage",()=>x],875301)},549292,e=>{e.v(e=>Promise.resolve().then(()=>e(333248)))},118191,e=>{e.v(t=>Promise.all(["server/chunks/src_lib_credits_store_ts_40181bd8._.js"].map(t=>e.l(t))).then(()=>t(685750)))},119949,e=>{e.v(e=>Promise.resolve().then(()=>e(124594)))}];

//# debugId=2dd118d1-7374-1492-74da-f72034996dbc
//# sourceMappingURL=%5Broot-of-the-server%5D__ed88b602._.js.map