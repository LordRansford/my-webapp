;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="77610c1e-6f6e-b143-539f-b0c2b1361f6c")}catch(e){}}();
module.exports=[985049,e=>{"use strict";let t=new Set(["http://localhost:3000","https://localhost:3000",process.env.NEXT_PUBLIC_SITE_URL||""].filter(Boolean));function r(e){if(!e?.headers)return;let r=e.headers.origin||e.headers.referer||"";if(!r)return;let a=r.match(/^https?:\/\/[^/]+/i),s=a?a[0]:r;if(0!==t.size&&!t.has(s))throw Error("Dashboard API origin not allowed")}e.s(["assertAllowedRequest",()=>r])},108317,e=>{"use strict";var t=e.i(926747),r=e.i(190406),a=e.i(244898),s=e.i(262950),n=e.i(985049);async function i(e,t){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{(0,n.assertAllowedRequest)(e)}catch(e){return t.status(403).json({error:"Dashboard API origin not allowed"})}let{url:r}=e.body;if(!r||"string"!=typeof r)return t.status(400).json({error:"URL is required"});try{let e;try{e=new URL(r.trim())}catch{try{e=new URL(`https://${r.trim()}`)}catch{return t.status(400).json({error:"Invalid URL format"})}}let a=e.hostname,s=e.pathname,n=e.search,i=a;try{a.includes("xn--")&&(i=new URL(`https://${a}`).hostname)}catch{}let o=/^\d+\.\d+\.\d+\.\d+$/.test(a)||/^[0-9a-f:]+$/i.test(a),l=a.split("."),d=l.length>1?l[l.length-1]:"",u=(s+n).toLowerCase(),h=["login","signin","sign-in","verify","confirm","update","secure","account","password","reset"].filter(e=>u.includes(e)),p=[],c=a.toLowerCase();["google","microsoft","apple","amazon","facebook","paypal","bank","secure","verify"].forEach(e=>{c.includes(e)&&a.length>e.length+10&&p.push(`Brand-like word "${e}" appears on the left of a longer domain.`)}),!(h.length>0)||c.includes("login")||c.includes("signin")||p.push("Login related keyword appears on an unusual host."),o&&p.push("URL uses an IP address instead of a domain name."),["tk","ml","ga","cf","gq"].includes(d.toLowerCase())&&p.push("Domain uses a TLD commonly associated with free or suspicious domains.");let f="";return f=0===p.length?"No obvious phishing patterns detected from the URL text alone. Always verify through official channels.":p.length<=2?"This URL contains some suspicious patterns. Treat with caution and verify the sender through official channels.":"This URL contains multiple suspicious patterns. Do not enter credentials or personal information.",t.status(200).json({host:a,normalisedHost:i,usesIp:o,tld:d,path:s+n,keywords:h,flags:p,summary:f})}catch(e){return console.error("Phishing link analysis error:",e),t.status(500).json({error:"Failed to analyze URL. Please check the format and try again.",details:void 0})}}e.s(["default",()=>i],937812);var o=e.i(937812),l=e.i(7031),d=e.i(181927),u=e.i(846432);let h=(0,s.hoist)(o,"default"),p=(0,s.hoist)(o,"config"),c=new a.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/dashboards/phishing-link",pathname:"/api/dashboards/phishing-link",bundlePath:"",filename:""},userland:o,distDir:".next",relativeProjectDir:""});async function f(e,r,a){c.isDev&&(0,u.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let s="/api/dashboards/phishing-link";s=s.replace(/\/index$/,"")||"/";let n=await c.prepare(e,r,{srcPage:s});if(!n){r.statusCode=400,r.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:i,params:o,prerenderManifest:h,routerServerContext:p}=n;try{let t=e.method||"GET",a=(0,l.getTracer)(),n=a.getActiveScopeSpan(),u=c.instrumentationOnRequestError.bind(c),f=async n=>c.render(e,r,{query:{...i,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:h.preview,propagateError:!1,dev:c.isDev,page:"/api/dashboards/phishing-link",internalRevalidate:null==p?void 0:p.revalidate,onError:(...t)=>u(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=a.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=e.get("next.route");if(i){let e=`${t} ${i}`;n.setAttributes({"next.route":i,"http.route":i,"next.span_name":e}),n.updateName(e)}else n.updateName(`${t} ${s}`)});n?await f(n):await a.withPropagatedContext(e.headers,()=>a.trace(d.BaseServerSpan.handleRequest,{spanName:`${t} ${s}`,kind:l.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},f))}catch(e){if(c.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}e.s(["config",0,p,"default",0,h,"handler",()=>f],108317)}];

//# debugId=77610c1e-6f6e-b143-539f-b0c2b1361f6c
//# sourceMappingURL=_92dde0a5._.js.map