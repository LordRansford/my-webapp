;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="97304664-02cf-cf14-8a5a-73f7919e41cc")}catch(e){}}();
module.exports=[224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},679594,(e,t,r)=>{t.exports=e.x("dns",()=>require("dns"))},985049,e=>{"use strict";let t=new Set(["http://localhost:3000","https://localhost:3000",process.env.NEXT_PUBLIC_SITE_URL||""].filter(Boolean));function r(e){if(!e?.headers)return;let r=e.headers.origin||e.headers.referer||"";if(!r)return;let s=r.match(/^https?:\/\/[^/]+/i),a=s?s[0]:r;if(0!==t.size&&!t.has(a))throw Error("Dashboard API origin not allowed")}e.s(["assertAllowedRequest",()=>r])},701912,e=>{"use strict";var t=e.i(926747),r=e.i(190406),s=e.i(244898),a=e.i(262950),i=e.i(985049),o=e.i(679594),n=e.i(224361);let l=(0,n.promisify)(o.default.resolve4),d=(0,n.promisify)(o.default.resolve6),u=(0,n.promisify)(o.default.resolveMx),c=(0,n.promisify)(o.default.resolveTxt);async function p(e,t){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{(0,i.assertAllowedRequest)(e)}catch(e){return t.status(403).json({error:"Dashboard API origin not allowed"})}let{domain:r}=e.body;if(!r||"string"!=typeof r)return t.status(400).json({error:"Domain is required"});let s=r.trim().toLowerCase();if(!s||!s.includes(".")||s.length>253)return t.status(400).json({error:"Invalid domain format"});let a=s.replace(/^https?:\/\//,"").replace(/\/.*$/,"");try{let[e,r,s,i]=await Promise.allSettled([l(a).catch(()=>[]),d(a).catch(()=>[]),u(a).catch(()=>[]),c(a).catch(()=>[])]),o="fulfilled"===e.status?e.value:[],n="fulfilled"===r.status?r.value:[],p="fulfilled"===s.status?s.value.map(e=>`${e.priority} ${e.exchange}`):[],f="fulfilled"===i.status?i.value.flat():[],h=f.find(e=>e.startsWith("v=spf1")),m={record:null,assessment:"Not found"};h&&(m.record=h.substring(0,100),h.includes("~all")||h.includes("-all")?m.assessment="Present and configured":m.assessment="Present but may be too permissive");let v=f.find(e=>e.startsWith("v=DMARC1")),g={record:null,policy:"None"};if(v){g.record=v.substring(0,100);let e=v.match(/p=([^;]+)/i);e&&(g.policy=e[1].toUpperCase())}let y="";return y=m.record||g.record?m.record?g.record?"Both SPF and DMARC records are present. Email security configuration looks good.":"SPF is configured, but DMARC is missing. Consider adding DMARC for better protection.":"SPF record is missing. DMARC is present but may not be effective without SPF.":"No SPF or DMARC records found. This domain is vulnerable to email spoofing.",t.status(200).json({aRecords:o,aaaaRecords:n,mxRecords:p,spf:m,dmarc:g,summary:y})}catch(e){return console.error("DNS lookup error:",e),t.status(500).json({error:"Failed to retrieve DNS information. The domain may be invalid or unreachable.",details:void 0})}}e.s(["default",()=>p],172517);var f=e.i(172517),h=e.i(7031),m=e.i(181927),v=e.i(846432);let g=(0,a.hoist)(f,"default"),y=(0,a.hoist)(f,"config"),b=new s.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/dashboards/dns-email-security",pathname:"/api/dashboards/dns-email-security",bundlePath:"",filename:""},userland:f,distDir:".next",relativeProjectDir:""});async function w(e,r,s){b.isDev&&(0,v.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/dashboards/dns-email-security";a=a.replace(/\/index$/,"")||"/";let i=await b.prepare(e,r,{srcPage:a});if(!i){r.statusCode=400,r.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve());return}let{query:o,params:n,prerenderManifest:l,routerServerContext:d}=i;try{let t=e.method||"GET",s=(0,h.getTracer)(),i=s.getActiveScopeSpan(),u=b.instrumentationOnRequestError.bind(b),c=async i=>b.render(e,r,{query:{...o,...n},params:n,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:b.isDev,page:"/api/dashboards/dns-email-security",internalRevalidate:null==d?void 0:d.revalidate,onError:(...t)=>u(e,...t)}).finally(()=>{if(!i)return;i.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=s.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=e.get("next.route");if(o){let e=`${t} ${o}`;i.setAttributes({"next.route":o,"http.route":o,"next.span_name":e}),i.updateName(e)}else i.updateName(`${t} ${a}`)});i?await c(i):await s.withPropagatedContext(e.headers,()=>s.trace(m.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:h.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},c))}catch(e){if(b.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==s.waitUntil||s.waitUntil.call(s,Promise.resolve())}}e.s(["config",0,y,"default",0,g,"handler",()=>w],701912)}];

//# debugId=97304664-02cf-cf14-8a5a-73f7919e41cc
//# sourceMappingURL=%5Broot-of-the-server%5D__bc8aa017._.js.map