;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="bc26dbca-b16a-3f3d-e2ac-d873c176b69f")}catch(e){}}();
module.exports=[679594,(e,t,r)=>{t.exports=e.x("dns",()=>require("dns"))},504446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},985049,e=>{"use strict";let t=new Set(["http://localhost:3000","https://localhost:3000",process.env.NEXT_PUBLIC_SITE_URL||""].filter(Boolean));function r(e){if(!e?.headers)return;let r=e.headers.origin||e.headers.referer||"";if(!r)return;let o=r.match(/^https?:\/\/[^/]+/i),a=o?o[0]:r;if(0!==t.size&&!t.has(a))throw Error("Dashboard API origin not allowed")}e.s(["assertAllowedRequest",()=>r])},300794,(e,t,r)=>{t.exports=e.x("node:dns/promises",()=>require("node:dns/promises"))},166457,31373,e=>{"use strict";var t=e.i(300794);class r extends Error{code="SAFE_FETCH_BLOCKED";constructor(e){super(e)}}class o extends Error{code="SAFE_FETCH_TIMEOUT";constructor(e){super(e)}}let a=new Set(["169.254.169.254"]);function s(e){let t=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.exec(e);if(!t)return!1;let r=Number(t[1]),o=Number(t[2]);return 10===r||127===r||0===r||169===r&&254===o||192===r&&168===o||172===r&&o>=16&&o<=31||100===r&&o>=64&&o<=127||!1}async function n(e,o){let n;if("localhost"===(n=e.hostname.toLowerCase())||"127.0.0.1"===n||"::1"===n||n.endsWith(".localhost")||a.has(e.hostname))throw new r("Blocked host");if(s(e.hostname))throw new r("Blocked IP range");try{for(let o of(await t.default.lookup(e.hostname,{all:!0,verbatim:!0})))if("string"==typeof o?.address&&(a.has(o.address)||s(o.address)))throw new r("Blocked IP range")}catch{throw new r("Unable to resolve host")}}async function i(e,t){let o=e.body?.getReader?.();if(!o){let o=Buffer.from(await e.arrayBuffer());if(o.byteLength>t)throw new r("Response too large");return o}let a=[],s=0;for(;;){let{done:e,value:n}=await o.read();if(e)break;if(n){if((s+=n.byteLength)>t)throw new r("Response too large");a.push(n)}}return Buffer.concat(a.map(e=>Buffer.from(e)))}async function l(e,t){let a=new URL(e),s=!!t.allowHttp||!!t.allowHttpInDev&&!1;if("https:"!==a.protocol&&!(s&&"http:"===a.protocol))throw new r("Blocked protocol");await n(a,!!t.allowLocalhostInDev);let l=new AbortController,u=setTimeout(()=>l.abort(),Math.max(1,t.overallTimeoutMs));try{let e=await fetch(a.toString(),{...t,redirect:"manual",signal:l.signal}),r=await i(e,t.maxResponseBytes);return{res:e,body:r}}catch(e){if(e?.name==="AbortError")throw new o("Request timed out");throw e}finally{clearTimeout(u)}}e.s(["safeFetch",()=>l],31373),e.s([],166457)},426584,e=>{"use strict";var t=e.i(504446),r=e.i(679594);async function o(e){let o;try{o=new URL(e)}catch{throw Error("Invalid URL")}if(!["http:","https:"].includes(o.protocol))throw Error("Only HTTP and HTTPS URLs are allowed");let a=o.hostname;if(!a)throw Error("Invalid host");if("localhost"===a)throw Error("Localhost is not allowed");let s=await r.default.promises.lookup(a,{all:!0}).catch(()=>[]);if(!s.length)throw Error("Unable to resolve host");for(let e of s)if(function(e){if(0===t.default.isIP(e)||"127.0.0.1"===e||"::1"===e||e.startsWith("10.")||e.startsWith("192.168."))return!0;let r=e.split(".").map(e=>Number(e));return 4===r.length&&172===r[0]&&!!(r[1]>=16)&&!!(r[1]<=31)||4===r.length&&169===r[0]&&254===r[1]}(e.address))throw Error("Private network targets are not allowed");return o}e.s(["validateOutboundUrl",()=>o])},567108,e=>{"use strict";var t=e.i(926747),r=e.i(190406),o=e.i(244898),a=e.i(262950),s=e.i(985049),n=e.i(426584);e.i(166457);var i=e.i(31373);async function l(e,t){let r;if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{(0,s.assertAllowedRequest)(e)}catch(e){return t.status(403).json({error:"Dashboard API origin not allowed"})}let{url:o}=e.body;if(!o||"string"!=typeof o)return t.status(400).json({error:"URL is required"});try{r=await (0,n.validateOutboundUrl)(o)}catch(e){return t.status(400).json({error:e.message||"Invalid URL"})}try{let e,{res:o,body:a}=await (0,i.safeFetch)(r.href,{method:"GET",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Accept-Encoding":"gzip, deflate, br"},allowHttp:!0,overallTimeoutMs:15e3,maxResponseBytes:1e6});if(!o.ok){let e=o.statusText||"Unknown error";throw Error(`HTTP ${o.status}: ${e}`)}let s=a.toString("utf8");if(!s||0===s.length)throw Error("Received empty response from server");let n=new URL(o.url),l=`${n.protocol}//${n.host}`,u=/<script[^>]+src=["']([^"']+)["'][^>]*>/gi,d=/integrity=["']([^"']+)["']/i,h=[];for(;null!==(e=u.exec(s));){let t,r=e[1];try{t=new URL(r,l)}catch{continue}let o=`${t.protocol}//${t.host}`!==l,a=e[0],s=d.test(a);h.push({src:t.href,thirdParty:o,hasIntegrity:s})}let c=h.filter(e=>e.thirdParty).length,p=h.filter(e=>e.hasIntegrity).length,f=`Page loads ${h.length} script${1!==h.length?"s":""}`;return c>0&&(f+=`, ${c} from third party domain${1!==c?"s":""}`),0===p?f+=". None use Subresource Integrity.":f+=`. ${p} use Subresource Integrity.`,t.status(200).json({summary:f,scripts:h})}catch(r){if("AbortError"===r.name||"Request timeout"===r.message)return t.status(408).json({error:"Request timeout. The site may be slow or unreachable."});console.error("Third party scripts analysis error:",r);let e="Failed to analyze page scripts.";return e=r.message.includes("HTTP")?`The site returned an error: ${r.message}. The site may require authentication or may be blocking automated requests.`:r.message.includes("timeout")?"Request timed out. The site may be slow or unreachable.":r.message.includes("fetch")?"Could not connect to the site. Please check the URL and try again.":r.message||e,t.status(500).json({error:e,details:void 0})}}e.s(["default",()=>l],717048);var u=e.i(717048),d=e.i(7031),h=e.i(181927),c=e.i(846432);let p=(0,a.hoist)(u,"default"),f=(0,a.hoist)(u,"config"),w=new o.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/dashboards/thirdparty-scripts",pathname:"/api/dashboards/thirdparty-scripts",bundlePath:"",filename:""},userland:u,distDir:".next",relativeProjectDir:""});async function m(e,r,o){w.isDev&&(0,c.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/dashboards/thirdparty-scripts";a=a.replace(/\/index$/,"")||"/";let s=await w.prepare(e,r,{srcPage:a});if(!s){r.statusCode=400,r.end("Bad Request"),null==o.waitUntil||o.waitUntil.call(o,Promise.resolve());return}let{query:n,params:i,prerenderManifest:l,routerServerContext:u}=s;try{let t=e.method||"GET",o=(0,d.getTracer)(),s=o.getActiveScopeSpan(),c=w.instrumentationOnRequestError.bind(w),p=async s=>w.render(e,r,{query:{...n,...i},params:i,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:w.isDev,page:"/api/dashboards/thirdparty-scripts",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>c(e,...t)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=o.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==h.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=e.get("next.route");if(n){let e=`${t} ${n}`;s.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),s.updateName(e)}else s.updateName(`${t} ${a}`)});s?await p(s):await o.withPropagatedContext(e.headers,()=>o.trace(h.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:d.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},p))}catch(e){if(w.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==o.waitUntil||o.waitUntil.call(o,Promise.resolve())}}e.s(["config",0,f,"default",0,p,"handler",()=>m],567108)}];

//# debugId=bc26dbca-b16a-3f3d-e2ac-d873c176b69f
//# sourceMappingURL=%5Broot-of-the-server%5D__4dd72751._.js.map