;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="a6cf7d27-f2d9-ce29-efe7-6fe3fb61fa68")}catch(e){}}();
module.exports=[814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},657194,e=>{"use strict";var t=e.i(89171),r=e.i(254799);let s=new Map;function n(e,n){var o,i;let a,u,c,l=Date.now(),d=`${n.keyPrefix}:${(o=n.keySuffix,a=e.headers.get("x-forwarded-for")||"",u=a.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",c=e.headers.get("user-agent")||"unknown",i=`${u}|${c}|${o||""}`,r.default.createHash("sha256").update(i).digest("hex").slice(0,24))}`,f=s.get(d);if(!f||f.resetAt<=l)return s.set(d,{count:1,resetAt:l+n.windowMs}),null;if(f.count+=1,f.count>n.limit){let e=Math.max(1,Math.ceil((f.resetAt-l)/1e3));return t.NextResponse.json({error:n.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>n])},936426,e=>{"use strict";var t=e.i(89171);function r(e){let r=e.headers.get("origin"),s=e.headers.get("referer"),n=function(){try{return new URL(process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000").origin}catch{return"http://localhost:3000"}}(),o=null;try{o=new URL(e.url).origin}catch{o=null}let i=r||(s?(()=>{try{return new URL(s).origin}catch{return null}})():null);return i?i===n||o&&i===o?null:t.NextResponse.json({error:"Invalid origin"},{status:403}):t.NextResponse.json({error:"Missing origin"},{status:403})}e.s(["requireSameOrigin",()=>r])},895968,e=>{"use strict";var t=e.i(254799);function r(e){return e.headers.get("x-request-id")||t.default.randomUUID()}async function s(e,t,s){let n=r(e),o=Date.now();try{let e=await s({requestId:n}),r=Date.now()-o;return console.info("req",{requestId:n,route:t.route,status:"ok",durationMs:r}),e}catch(r){let e=Date.now()-o;throw console.error("req",{requestId:n,route:t.route,status:"error",durationMs:e,message:r?.message||"error"}),r}}e.s(["getRequestId",()=>r,"withRequestLogging",()=>s])},902157,(e,t,r)=>{t.exports=e.x("node:fs",()=>require("node:fs"))},750227,(e,t,r)=>{t.exports=e.x("node:path",()=>require("node:path"))},161857,e=>{"use strict";function t(e,t,r,s){let n={level:e,event:t,requestId:r.requestId,route:r.route,...s,ts:new Date().toISOString()};"error"===e?console.error(t,n):"warn"===e?console.warn(t,n):console.info(t,n)}e.s(["logger",0,{debug:(e,r,s)=>t("debug",e,r,s),info:(e,r,s)=>t("info",e,r,s),warn:(e,r,s)=>t("warn",e,r,s),error:(e,r,s)=>t("error",e,r,s)}])},563502,e=>{"use strict";var t=e.i(254799);function r(e){return Math.round((Number(e)||0)/60*10)/10}function s(e){return Math.max(0,Math.round(60*(Number(e)||0)))}function n(e){if(!e||"object"!=typeof e)return{ok:!1,error:"State must be an object"};if(!Array.isArray(e.sections)||!Array.isArray(e.activity))return{ok:!1,error:"State must contain sections and activity arrays"};for(let t of e.sections){if(!t.trackId||!t.levelId||!t.sectionId)return{ok:!1,error:"Section missing identifiers"};if(0>Number(t.minutes))return{ok:!1,error:"Section minutes must be non-negative"}}for(let t of e.activity){if(!t.id||!t.trackId||!t.levelId||!t.sectionId||!t.timestamp)return{ok:!1,error:"Activity missing fields"};if(!Number.isFinite(Number(t.minutesDelta)))return{ok:!1,error:"Activity minutesDelta must be numeric"}}return{ok:!0}}function o(e){let r={...e,rulesVersion:"v1"},s=JSON.stringify(r),n=t.default.createHash("sha256").update(s).digest("hex");return{...r,hash:n}}function i(e,t){let s=(e?.activity||[]).filter(e=>e.trackId===t),n=s.reduce((e,t)=>e+(Number(t.minutesDelta)||0),0);return{trackId:t,totalMinutesFromActivity:n,totalHoursFromActivity:r(n),recent:s.slice(0,50).map(e=>({id:e.id,timestamp:e.timestamp,minutesDelta:e.minutesDelta,note:e.note||"",levelId:e.levelId,sectionId:e.sectionId}))}}e.s(["CPD_RULES_VERSION",0,"v1","buildEvidenceRecord",()=>o,"explainCredits",()=>i,"hoursToMinutes",()=>s,"minutesToHours",()=>r,"validateCpdState",()=>n])},228905,e=>{"use strict";var t=e.i(563502);function r(e){let r=(0,t.validateCpdState)(e);if(!r.ok)throw Error(r.error)}e.s(["validateCpdStateOrThrow",()=>r])},996388,519193,e=>{"use strict";var t=e.i(89171),r=e.i(895968);class s extends Error{code;status;exposeMessage;cause;constructor(e){super(e.message),this.name="AppError",this.code=e.code,this.status=e.status,this.exposeMessage=e.exposeMessage??"Request failed.",this.cause=e.cause}}function n(e){return e instanceof s?e:new s({code:"INTERNAL_ERROR",status:500,message:e instanceof Error?e.message:String(e),exposeMessage:"Something went wrong.",cause:e})}e.s(["AppError",()=>s,"asAppError",()=>n],519193);var o=e.i(161857);function i(e,r){let s=r?.status??200,n=r?.requestId,o=n?{...e,requestId:n}:e,i=t.NextResponse.json(o,{status:s});return n&&i.headers.set("x-request-id",n),i}async function a(e,s,i){let a=(0,r.getRequestId)(e),u=Date.now();try{let e=await i({requestId:a}),t=Date.now()-u;return o.logger.info("api_request",{requestId:a,route:s.route},{status:e.status,durationMs:t}),e.headers.set("x-request-id",a),e}catch(f){var c;let e,r,i,l,d=Date.now()-u;return o.logger.error("api_request",{requestId:a,route:s.route},{status:"error",durationMs:d}),c={requestId:a,route:s.route},e=n(f),r=c.requestId,o.logger.error("api_error",{requestId:r,route:c.route},{code:e.code,status:e.status,message:e.message}),i={error:{code:e.code,message:e.exposeMessage,requestId:r}},l=t.NextResponse.json(i,{status:e.status}),r&&l.headers.set("x-request-id",r),l}}e.s(["handleAppRoute",()=>a,"jsonOk",()=>i],996388)},868154,e=>{"use strict";var t=e.i(902157),r=e.i(750227);let s=process.env.LEARNING_RECORDS_STORE_PATH||"data/learning-records.json",n={records:[]};function o(e,s){try{let n=r.default.isAbsolute(e)?e:r.default.join(process.cwd(),e);if(!t.default.existsSync(n))return s;return JSON.parse(t.default.readFileSync(n,"utf8"))}catch{return s}}function i(e){let{estimatedMinutes:t,sectionsCompleted:r,quizzesCompleted:s,toolsUsed:n}=e;return Math.min(10*Math.max(0,Number(r)||0)+5*Math.max(0,Number(s)||0)+5*Math.max(0,Number(n)||0),Math.max(0,Number(t)||0))}function a(e){let{userId:t,courseId:r,levelId:s,totalSections:n,completedSectionKeys:o,quizIdsCompleted:a,toolIdsUsed:u,estimatedMinutes:c}=e,l=o.size,d=a.size,f=u.size,g=i({estimatedMinutes:c,sectionsCompleted:l,quizzesCompleted:d,toolsUsed:f}),m=n>0&&l>=n&&d>=1?"completed":l>0||d>0||f>0?"in_progress":"not_started",p="completed"===m?new Date().toISOString():null;return{userId:t,courseId:r,levelId:s,sectionsCompleted:l,quizzesCompleted:d,toolsUsed:f,timeSpentMinutes:g,completionStatus:m,completionDate:p,updatedAt:new Date().toISOString()}}function u(e){let i,a,u,c=o(s,n),l=`${e.userId}:${e.courseId}:${e.levelId}`,d=c.records.findIndex(e=>`${e.userId}:${e.courseId}:${e.levelId}`===l),f=e;if(d>=0){let t=c.records[d],r="completed"===t.completionStatus&&t.completionDate?t.completionDate:e.completionDate;f={...e,completionDate:r},c.records[d]=f}else c.records.push(e);return i=r.default.isAbsolute(s)?s:r.default.join(process.cwd(),s),a=r.default.dirname(i),t.default.existsSync(a)||t.default.mkdirSync(a,{recursive:!0}),u=`${i}.tmp`,t.default.writeFileSync(u,JSON.stringify(c,null,2),"utf8"),t.default.renameSync(u,i),f}function c(e){return(o(s,n).records||[]).filter(t=>t.userId===e)}e.s(["calculateEarnedMinutes",()=>i,"deriveLearningRecord",()=>a,"listLearningRecordsForUser",()=>c,"upsertLearningRecord",()=>u])},946628,e=>{"use strict";let t=e.r(868154);t.calculateEarnedMinutes;let r=t.deriveLearningRecord,s=t.upsertLearningRecord,n=t.listLearningRecordsForUser;e.s(["deriveLearningRecord",0,r,"listLearningRecordsForUser",0,n,"upsertLearningRecord",0,s])},986225,e=>{"use strict";let t="2025.01",r={ai:t,cybersecurity:t,"software-architecture":t,data:t,digitalisation:t};function s(e){let s=r[e];return"string"==typeof s&&s.trim()?s.trim():t}e.s(["getActiveCourseVersion",()=>s])}];

//# debugId=a6cf7d27-f2d9-ce29-efe7-6fe3fb61fa68
//# sourceMappingURL=%5Broot-of-the-server%5D__3e743c8d._.js.map