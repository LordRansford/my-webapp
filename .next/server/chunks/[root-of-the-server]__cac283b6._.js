;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="42ebf596-c912-acb1-224d-5dd8dbd8bad2")}catch(e){}}();
module.exports=[193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},657194,e=>{"use strict";var t=e.i(89171),r=e.i(254799);let n=new Map;function a(e,a){var s,i;let o,l,u,d=Date.now(),c=`${a.keyPrefix}:${(s=a.keySuffix,o=e.headers.get("x-forwarded-for")||"",l=o.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",u=e.headers.get("user-agent")||"unknown",i=`${l}|${u}|${s||""}`,r.default.createHash("sha256").update(i).digest("hex").slice(0,24))}`,p=n.get(c);if(!p||p.resetAt<=d)return n.set(c,{count:1,resetAt:d+a.windowMs}),null;if(p.count+=1,p.count>a.limit){let e=Math.max(1,Math.ceil((p.resetAt-d)/1e3));return t.NextResponse.json({error:a.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>a])},936426,e=>{"use strict";var t=e.i(89171);function r(e){let r=e.headers.get("origin"),n=e.headers.get("referer"),a=function(){try{return new URL(process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000").origin}catch{return"http://localhost:3000"}}(),s=null;try{s=new URL(e.url).origin}catch{s=null}let i=r||(n?(()=>{try{return new URL(n).origin}catch{return null}})():null);return i?i===a||s&&i===s?null:t.NextResponse.json({error:"Invalid origin"},{status:403}):s?null:t.NextResponse.json({error:"Missing origin"},{status:403})}e.s(["requireSameOrigin",()=>r])},412656,e=>{"use strict";var t=e.i(89171);function r(e){if("true"!==process.env.ADMIN_ANALYTICS_ENABLED)return t.NextResponse.json({message:"Forbidden"},{status:403});let r=process.env.ADMIN_ANALYTICS_KEY||"";return r&&(e.headers.get("x-admin-analytics-key")||"")===r?null:t.NextResponse.json({message:"Forbidden"},{status:403})}e.s(["requireAdmin",()=>r])},671266,e=>{"use strict";var t=e.i(747909),r=e.i(174017),n=e.i(996250),a=e.i(759756),s=e.i(561916),i=e.i(114444),o=e.i(837092),l=e.i(869741),u=e.i(316795),d=e.i(487718),c=e.i(995169),p=e.i(47587),h=e.i(666012),f=e.i(570101),g=e.i(626937),x=e.i(10372),m=e.i(193695);e.i(52474);var R=e.i(600220),v=e.i(89171),w=e.i(412656),y=e.i(657194),E=e.i(936426);function C(e,t){return("string"==typeof e?e:"").replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F]/g,"").trim().slice(0,t)}async function A(e){var t;let r,n,a,s,i,o=(0,w.requireAdmin)(e);if(o)return o;let l=(0,E.requireSameOrigin)(e);if(l)return l;let u=(0,y.rateLimit)(e,{keyPrefix:"admin-support-draft",limit:30,windowMs:6e4});if(u)return u;let d=await e.json().catch(()=>null),c=C(d?.message,2400),p=C(d?.referenceCode,80),h=C(d?.courseId,60),f=C(d?.levelId,60),g=C(d?.pageUrl,200);if(!c)return v.NextResponse.json({message:"Invalid message"},{status:400});let x=(n=(r=(t={message:c,referenceCode:p,courseId:h,levelId:f,pageUrl:g}).message.toLowerCase()).includes("payment")||r.includes("stripe")||r.includes("checkout")?"billing":r.includes("sign in")||r.includes("signin")||r.includes("google")?"auth":r.includes("assessment")||r.includes("certificate")||r.includes("cpd")?"cpd":r.includes("tool")||r.includes("lab")||r.includes("error")?"tools":"general",a=t.referenceCode?`Reference ${t.referenceCode}.`:"",i=["Thanks for your message. I can help.",a,(s=[t.courseId,t.levelId,t.pageUrl].filter(Boolean).join(" "))?`Context ${s}.`:"","",..."cpd"===n?["Please try Professor Ransford first so you get an instant explanation and the right link.","If you still need help, reply with the exact question you are stuck on and the page link.","If this is during an assessment, submit first. Then we can review your feedback and revision plan."]:"auth"===n?["Please try signing out and back in.","If it still fails, open the status page and confirm Google sign in is configured.","Reply with the exact error message and the time it happened."]:"billing"===n?["Please confirm the payment status in your Stripe receipt email.","If the site did not unlock, reply with the reference and the email used to sign in.","I will check and fix it."]:"tools"===n?["Please tell me which tool you used and what you entered.","If it needs secure compute, confirm you are signed in and have credits.","I will reply with a specific fix and a safer workflow."]:["Please share the page link and what you expected.","If you can, include a screenshot.","I will reply with next steps."]].filter(Boolean).join("\n"),{category:n,draftReply:i});return v.NextResponse.json(x,{status:200})}e.s(["POST",()=>A],188407);var k=e.i(188407);let I=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/admin/support/draft/route",pathname:"/api/admin/support/draft",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/admin/support/draft/route.ts",nextConfigOutput:"",userland:k}),{workAsyncStorage:N,workUnitAsyncStorage:b,serverHooks:P}=I;function T(){return(0,n.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:b})}async function S(e,t,n){I.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/admin/support/draft/route";v=v.replace(/\/index$/,"")||"/";let w=await I.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:y,params:E,nextConfig:C,parsedUrl:A,isDraftMode:k,prerenderManifest:N,routerServerContext:b,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,resolvedPathname:S,clientReferenceManifest:j,serverActionsManifest:_}=w,q=(0,l.normalizeAppPath)(v),M=!!(N.dynamicRoutes[q]||N.routes[S]),O=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,A,!1):t.end("This page could not be found"),null);if(M&&!k){let e=!!N.routes[S],t=N.dynamicRoutes[q];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await O();throw new m.NoFallbackError}}let U=null;!M||I.isDev||k||(U="/index"===(U=S)?"/":U);let H=!0===I.isDev||!M,D=M&&!H;_&&j&&(0,i.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:j,serverActionsManifest:_,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:_})});let L=e.method||"GET",$=(0,s.getTracer)(),F=$.getActiveScopeSpan(),B={params:E,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>I.onRequestError(e,t,n,b)},sharedContext:{buildId:y}},K=new u.NodeNextRequest(e),G=new u.NodeNextResponse(t),X=d.NextRequestAdapter.fromNodeNextRequest(K,(0,d.signalFromNodeResponse)(t));try{let i=async e=>I.handle(X,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${L} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${v}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!o&&P&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!M)return await (0,h.sendResponse)(K,G,s,B.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[x.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,n=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:R.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await I.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:P})},b),t}},d=await I.handleResponse({req:e,nextConfig:C,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:o});if(!M)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==R.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",P?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),k&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,f.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&M||c.delete(x.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(K,G,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};F?await l(F):await $.withPropagatedContext(e.headers,()=>$.trace(c.BaseServerSpan.handleRequest,{spanName:`${L} ${v}`,kind:s.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await I.onRequestError(e,t,{routerKind:"App Router",routePath:q,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:P})}),M)throw t;return await (0,h.sendResponse)(K,G,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>T,"routeModule",()=>I,"serverHooks",()=>P,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>b],671266)}];

//# debugId=42ebf596-c912-acb1-224d-5dd8dbd8bad2
//# sourceMappingURL=%5Broot-of-the-server%5D__cac283b6._.js.map