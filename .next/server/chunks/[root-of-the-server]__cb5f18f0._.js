;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="230d52a4-b618-09f2-097d-7eae53b190e7")}catch(e){}}();
module.exports=[814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},464592,e=>{"use strict";let t=new Set(["authorization","cookie","set-cookie","stripe-signature","secret","token","password","apiKey","apikey","client_secret"]);function r(e,r,n){let a={level:e,event:String(r||"").slice(0,80),ts:new Date().toISOString(),...function e(r,n=0){if(n>4)return"[TRUNCATED]";if(null==r)return r;if(Array.isArray(r))return r.slice(0,20).map(t=>e(t,n+1));if("object"!=typeof r)return r;let a={};for(let[i,s]of Object.entries(r)){let r=String(i),o=r.toLowerCase();if(t.has(o)||o.includes("secret")||o.includes("token")||o.includes("password")){a[r]=null==s?s:("string"==typeof s&&s.length,"[REDACTED]");continue}a[r]=e(s,n+1)}return a}(n&&"object"==typeof n?n:{})};"error"===e?console.error(a):"warn"===e?console.warn(a):console.log(a)}function n(e,t){r("info",e,t)}function a(e,t){r("warn",e,t)}e.s(["logInfo",()=>n,"logWarn",()=>a])},407323,e=>{"use strict";var t=e.i(926747),r=e.i(190406),n=e.i(244898),a=e.i(262950),i=e.i(828414),s=e.i(489521),o=e.i(192489),l=e.i(974298);let u=new Map;async function d(e,t){var r;let n,a;if("POST"!==e.method)return t.status(405).json({message:"Method not allowed"});let d=await (0,i.getServerSession)(e,t,s.authOptions),c=d?.user?.id;if(!c)return t.status(401).json({message:"Authentication required"});let p=e.headers["x-forwarded-for"]||e.socket.remoteAddress||"anon";if(r=`delete:${p}:${c}`,n=Date.now(),a=u.get(r)||{count:0,start:n},n-a.start>6e4?(u.set(r,{count:1,start:n}),!1):a.count>=10||(a.count+=1,u.set(r,a),!1))return t.status(429).json({message:"Rate limit exceeded"});let f="string"==typeof e.body?JSON.parse(e.body):e.body,g=String(f?.confirmEmail||"").trim().toLowerCase(),m=(0,o.getUserById)(c);return m?g!==String(m.email||"").trim().toLowerCase()?t.status(400).json({message:"Confirmation email does not match"}):((0,l.deleteUserBillingData)(c),(0,o.deleteUser)(c),console.warn("account:deleted",{userId:c}),t.status(200).json({ok:!0})):t.status(404).json({message:"User not found"})}e.s(["default",()=>d],211844);var c=e.i(211844),p=e.i(7031),f=e.i(181927),g=e.i(846432);let m=(0,a.hoist)(c,"default"),h=(0,a.hoist)(c,"config"),w=new n.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/account/delete",pathname:"/api/account/delete",bundlePath:"",filename:""},userland:c,distDir:".next",relativeProjectDir:""});async function v(e,r,n){w.isDev&&(0,g.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/account/delete";a=a.replace(/\/index$/,"")||"/";let i=await w.prepare(e,r,{srcPage:a});if(!i){r.statusCode=400,r.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve());return}let{query:s,params:o,prerenderManifest:l,routerServerContext:u}=i;try{let t=e.method||"GET",n=(0,p.getTracer)(),i=n.getActiveScopeSpan(),d=w.instrumentationOnRequestError.bind(w),c=async i=>w.render(e,r,{query:{...s,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:w.isDev,page:"/api/account/delete",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>d(e,...t)}).finally(()=>{if(!i)return;i.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=n.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==f.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${t} ${s}`;i.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),i.updateName(e)}else i.updateName(`${t} ${a}`)});i?await c(i):await n.withPropagatedContext(e.headers,()=>n.trace(f.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:p.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},c))}catch(e){if(w.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==n.waitUntil||n.waitUntil.call(n,Promise.resolve())}}e.s(["config",0,h,"default",0,m,"handler",()=>v],407323)}];

//# debugId=230d52a4-b618-09f2-097d-7eae53b190e7
//# sourceMappingURL=%5Broot-of-the-server%5D__cb5f18f0._.js.map