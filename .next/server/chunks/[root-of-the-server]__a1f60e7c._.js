;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="dac24af6-f33f-4f2c-0a21-7dcc9154ab9e")}catch(e){}}();
module.exports=[814747,(e,t,a)=>{t.exports=e.x("path",()=>require("path"))},193695,(e,t,a)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,a)=>{t.exports=e.x("fs",()=>require("fs"))},406461,(e,t,a)=>{t.exports=e.x("zlib",()=>require("zlib"))},688947,(e,t,a)=>{t.exports=e.x("stream",()=>require("stream"))},657194,e=>{"use strict";var t=e.i(89171),a=e.i(254799);let n=new Map;function r(e,r){var i,s;let l,o,d,u=Date.now(),c=`${r.keyPrefix}:${(i=r.keySuffix,l=e.headers.get("x-forwarded-for")||"",o=l.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",d=e.headers.get("user-agent")||"unknown",s=`${o}|${d}|${i||""}`,a.default.createHash("sha256").update(s).digest("hex").slice(0,24))}`,p=n.get(c);if(!p||p.resetAt<=u)return n.set(c,{count:1,resetAt:u+r.windowMs}),null;if(p.count+=1,p.count>r.limit){let e=Math.max(1,Math.ceil((p.resetAt-u)/1e3));return t.NextResponse.json({error:r.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>r])},599641,e=>{"use strict";var t=e.i(747909),a=e.i(174017),n=e.i(996250),r=e.i(759756),i=e.i(561916),s=e.i(114444),l=e.i(837092),o=e.i(869741),d=e.i(316795),u=e.i(487718),c=e.i(995169),p=e.i(47587),h=e.i(666012),m=e.i(570101),f=e.i(626937),R=e.i(10372),v=e.i(193695);e.i(52474);var E=e.i(600220);let g=(0,e.i(1863).createToolExecutionHandler)({toolId:"dev-studio-schema-designer",executeTool:async(e,t)=>{let a=Date.now(),n=t.tables||[],r=t.relationships||[],i=function(e,t){let a=[];if(!e||0===e.length)return a.push("Schema must contain at least one table"),{valid:!1,errors:a};let n=new Set;for(let t of e){t.name&&""!==t.name.trim()?n.has(t.name)?a.push(`Duplicate table name: ${t.name}`):n.add(t.name):a.push("Table name cannot be empty"),t.fields&&0!==t.fields.length||a.push(`Table ${t.name} must have at least one field`);let e=new Set,r=0;for(let n of t.fields)n.name&&""!==n.name.trim()?e.has(n.name)?a.push(`Table ${t.name} has duplicate field name: ${n.name}`):e.add(n.name):a.push(`Table ${t.name} has a field with empty name`),n.primaryKey&&r++;0===r?a.push(`Table ${t.name} must have at least one primary key field`):r>1&&a.push(`Table ${t.name} has multiple primary keys (composite keys not yet supported)`)}if(t&&t.length>0)for(let n of t){let t=e.find(e=>e.id===n.fromTable),r=e.find(e=>e.id===n.toTable);t||a.push(`Relationship references non-existent table: ${n.fromTable}`),r||a.push(`Relationship references non-existent table: ${n.toTable}`),t&&!t.fields.find(e=>e.id===n.fromField)&&a.push(`Relationship references non-existent field in ${t.name}`),r&&!r.fields.find(e=>e.id===n.toField)&&a.push(`Relationship references non-existent field in ${r.name}`)}return{valid:0===a.length,errors:a}}(n,r);if(!i.valid)return{result:{success:!1,errors:i.errors,schema:{name:t.schemaName||"Untitled Schema",tables:n,relationships:r}},actualUsage:{cpuMs:Date.now()-a,memMb:80,durationMs:Date.now()-a}};let s=function(e,t){let a="-- Generated Database Schema\n";for(let t of(a+=`-- Generated at: ${new Date().toISOString()}

`,e)){a+=`CREATE TABLE ${t.name} (
`;let e=[];for(let a of t.fields){let t=`  ${a.name} ${{string:"VARCHAR(255)",number:"INTEGER",boolean:"BOOLEAN",date:"DATE",text:"TEXT",json:"JSON"}[a.type]||"VARCHAR(255)"}`;a.primaryKey&&(t+=" PRIMARY KEY","AUTO_INCREMENT"===a.defaultValue&&(t+=" AUTO_INCREMENT")),a.nullable||(t+=" NOT NULL"),a.unique&&!a.primaryKey&&(t+=" UNIQUE"),a.defaultValue&&"AUTO_INCREMENT"!==a.defaultValue&&(t+=` DEFAULT '${a.defaultValue}'`),e.push(t)}a+=e.join(",\n"),a+="\n);\n\n"}if(t&&t.length>0)for(let n of t){let t=e.find(e=>e.id===n.fromTable),r=e.find(e=>e.id===n.toTable),i=t?.fields.find(e=>e.id===n.fromField),s=r?.fields.find(e=>e.id===n.toField);t&&r&&i&&s&&(a+=`ALTER TABLE ${t.name}
`,a+=`  ADD CONSTRAINT fk_${t.name}_${r.name}
`,a+=`  FOREIGN KEY (${i.name}) REFERENCES ${r.name}(${s.name});

`)}return a}(n,r);return await new Promise(e=>setTimeout(e,200)),{result:{success:!0,schema:{name:t.schemaName||"Untitled Schema",tables:n,relationships:r},sqlScript:s,validation:{valid:!0,tableCount:n.length,fieldCount:n.reduce((e,t)=>e+t.fields.length,0),relationshipCount:r.length},toolId:"dev-studio-schema-designer",timestamp:new Date().toISOString()},actualUsage:{cpuMs:Date.now()-a,memMb:80,durationMs:Date.now()-a}}}});e.s(["POST",0,g],385293);var x=e.i(385293);let T=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/dev-studio/schema-designer/run/route",pathname:"/api/dev-studio/schema-designer/run",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/dev-studio/schema-designer/run/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:w,workUnitAsyncStorage:b,serverHooks:A}=T;function y(){return(0,n.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:b})}async function C(e,t,n){T.isDev&&(0,r.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let g="/api/dev-studio/schema-designer/run/route";g=g.replace(/\/index$/,"")||"/";let x=await T.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:w,params:b,nextConfig:A,parsedUrl:y,isDraftMode:C,prerenderManifest:N,routerServerContext:S,isOnDemandRevalidate:$,revalidateOnlyGenerated:O,resolvedPathname:P,clientReferenceManifest:_,serverActionsManifest:M}=x,D=(0,o.normalizeAppPath)(g),I=!!(N.dynamicRoutes[D]||N.routes[P]),U=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,y,!1):t.end("This page could not be found"),null);if(I&&!C){let e=!!N.routes[P],t=N.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await U();throw new v.NoFallbackError}}let k=null;!I||T.isDev||C||(k="/index"===(k=P)?"/":k);let q=!0===T.isDev||!I,H=I&&!q;M&&_&&(0,s.setReferenceManifestsSingleton)({page:g,clientReferenceManifest:_,serverActionsManifest:M,serverModuleMap:(0,l.createServerModuleMap)({serverActionsManifest:M})});let F=e.method||"GET",j=(0,i.getTracer)(),K=j.getActiveScopeSpan(),L={params:b,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,r.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,n)=>T.onRequestError(e,t,n,S)},sharedContext:{buildId:w}},V=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),G=u.NextRequestAdapter.fromNodeNextRequest(V,(0,u.signalFromNodeResponse)(t));try{let s=async e=>T.handle(G,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=j.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let t=`${F} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${F} ${g}`)}),l=!!(0,r.getRequestMeta)(e,"minimalMode"),o=async r=>{var i,o;let d=async({previousCacheEntry:a})=>{try{if(!l&&$&&O&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(r);e.fetchMetrics=L.renderOpts.fetchMetrics;let o=L.renderOpts.pendingWaitUntil;o&&n.waitUntil&&(n.waitUntil(o),o=void 0);let d=L.renderOpts.collectedTags;if(!I)return await (0,h.sendResponse)(V,B,i,L.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(i.headers);d&&(t[R.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=R.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,n=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=R.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:n}}}}catch(t){throw(null==a?void 0:a.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:$})},S),t}},u=await T.handleResponse({req:e,nextConfig:A,cacheKey:k,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:$,revalidateOnlyGenerated:O,responseGenerator:d,waitUntil:n.waitUntil,isMinimalMode:l});if(!I)return null;if((null==u||null==(i=u.value)?void 0:i.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(o=u.value)?void 0:o.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",$?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return l&&I||c.delete(R.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(V,B,new Response(u.value.body,{headers:c,status:u.value.status||200})),null};K?await o(K):await j.withPropagatedContext(e.headers,()=>j.trace(c.BaseServerSpan.handleRequest,{spanName:`${F} ${g}`,kind:i.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},o))}catch(t){if(t instanceof v.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:$})}),I)throw t;return await (0,h.sendResponse)(V,B,new Response(null,{status:500})),null}}e.s(["handler",()=>C,"patchFetch",()=>y,"routeModule",()=>T,"serverHooks",()=>A,"workAsyncStorage",()=>w,"workUnitAsyncStorage",()=>b],599641)},549292,e=>{e.v(e=>Promise.resolve().then(()=>e(333248)))},118191,e=>{e.v(t=>Promise.all(["server/chunks/src_lib_credits_store_ts_40181bd8._.js"].map(t=>e.l(t))).then(()=>t(685750)))},119949,e=>{e.v(e=>Promise.resolve().then(()=>e(124594)))}];

//# debugId=dac24af6-f33f-4f2c-0a21-7dcc9154ab9e
//# sourceMappingURL=%5Broot-of-the-server%5D__a1f60e7c._.js.map