;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="f91b1f39-d713-9b27-6acb-3579d4aa0548")}catch(e){}}();
module.exports=[679594,(e,t,r)=>{t.exports=e.x("dns",()=>require("dns"))},504446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},985049,e=>{"use strict";let t=new Set(["http://localhost:3000","https://localhost:3000",process.env.NEXT_PUBLIC_SITE_URL||""].filter(Boolean));function r(e){if(!e?.headers)return;let r=e.headers.origin||e.headers.referer||"";if(!r)return;let o=r.match(/^https?:\/\/[^/]+/i),a=o?o[0]:r;if(0!==t.size&&!t.has(a))throw Error("Dashboard API origin not allowed")}e.s(["assertAllowedRequest",()=>r])},300794,(e,t,r)=>{t.exports=e.x("node:dns/promises",()=>require("node:dns/promises"))},166457,31373,e=>{"use strict";var t=e.i(300794);class r extends Error{code="SAFE_FETCH_BLOCKED";constructor(e){super(e)}}class o extends Error{code="SAFE_FETCH_TIMEOUT";constructor(e){super(e)}}let a=new Set(["169.254.169.254"]);function s(e){let t=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.exec(e);if(!t)return!1;let r=Number(t[1]),o=Number(t[2]);return 10===r||127===r||0===r||169===r&&254===o||192===r&&168===o||172===r&&o>=16&&o<=31||100===r&&o>=64&&o<=127||!1}async function n(e,o){let n;if("localhost"===(n=e.hostname.toLowerCase())||"127.0.0.1"===n||"::1"===n||n.endsWith(".localhost")||a.has(e.hostname))throw new r("Blocked host");if(s(e.hostname))throw new r("Blocked IP range");try{for(let o of(await t.default.lookup(e.hostname,{all:!0,verbatim:!0})))if("string"==typeof o?.address&&(a.has(o.address)||s(o.address)))throw new r("Blocked IP range")}catch{throw new r("Unable to resolve host")}}async function i(e,t){let o=e.body?.getReader?.();if(!o){let o=Buffer.from(await e.arrayBuffer());if(o.byteLength>t)throw new r("Response too large");return o}let a=[],s=0;for(;;){let{done:e,value:n}=await o.read();if(e)break;if(n){if((s+=n.byteLength)>t)throw new r("Response too large");a.push(n)}}return Buffer.concat(a.map(e=>Buffer.from(e)))}async function l(e,t){let a=new URL(e),s=!!t.allowHttp||!!t.allowHttpInDev&&!1;if("https:"!==a.protocol&&!(s&&"http:"===a.protocol))throw new r("Blocked protocol");await n(a,!!t.allowLocalhostInDev);let l=new AbortController,d=setTimeout(()=>l.abort(),Math.max(1,t.overallTimeoutMs));try{let e=await fetch(a.toString(),{...t,redirect:"manual",signal:l.signal}),r=await i(e,t.maxResponseBytes);return{res:e,body:r}}catch(e){if(e?.name==="AbortError")throw new o("Request timed out");throw e}finally{clearTimeout(d)}}e.s(["safeFetch",()=>l],31373),e.s([],166457)},426584,e=>{"use strict";var t=e.i(504446),r=e.i(679594);async function o(e){let o;try{o=new URL(e)}catch{throw Error("Invalid URL")}if(!["http:","https:"].includes(o.protocol))throw Error("Only HTTP and HTTPS URLs are allowed");let a=o.hostname;if(!a)throw Error("Invalid host");if("localhost"===a)throw Error("Localhost is not allowed");let s=await r.default.promises.lookup(a,{all:!0}).catch(()=>[]);if(!s.length)throw Error("Unable to resolve host");for(let e of s)if(function(e){if(0===t.default.isIP(e)||"127.0.0.1"===e||"::1"===e||e.startsWith("10.")||e.startsWith("192.168."))return!0;let r=e.split(".").map(e=>Number(e));return 4===r.length&&172===r[0]&&!!(r[1]>=16)&&!!(r[1]<=31)||4===r.length&&169===r[0]&&254===r[1]}(e.address))throw Error("Private network targets are not allowed");return o}e.s(["validateOutboundUrl",()=>o])},239093,e=>{"use strict";var t=e.i(926747),r=e.i(190406),o=e.i(244898),a=e.i(262950),s=e.i(985049),n=e.i(426584);e.i(166457);var i=e.i(31373);async function l(e,t){let r;if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{(0,s.assertAllowedRequest)(e)}catch(e){return t.status(403).json({error:"Dashboard API origin not allowed"})}let{url:o}=e.body;if(!o||"string"!=typeof o)return t.status(400).json({error:"URL is required"});try{r=await (0,n.validateOutboundUrl)(o)}catch(e){return t.status(400).json({error:e.message||"Invalid URL"})}try{let{res:e}=await (0,i.safeFetch)(r.href,{method:"GET",headers:{"User-Agent":"Mozilla/5.0 (compatible; RansfordsNotes/1.0; Educational Tool)",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"},allowHttp:!0,overallTimeoutMs:1e4,maxResponseBytes:131072}),o={csp:e.headers.get("content-security-policy")||null,xFrameOptions:e.headers.get("x-frame-options")||null,referrerPolicy:e.headers.get("referrer-policy")||null,hsts:e.headers.get("strict-transport-security")||null},a=r.protocol.replace(":",""),s=[],n=r.href,l=e.url;l!==n&&s.push(n,l);let d=Object.values(o).filter(e=>null!==e).length,u="";return u=0===d?"No security headers detected. Consider adding Content Security Policy, HSTS, and X-Frame-Options.":d<3?`Only ${d} security header(s) detected. Consider adding more security headers for better protection.`:"Good security header coverage detected.","http"===a&&(u+=" Warning: Site uses HTTP instead of HTTPS. All traffic is unencrypted."),t.status(200).json({scheme:a,tlsVersion:"https"===a?"TLS (version not available via fetch)":null,redirects:s.length>0?s:[],certificate:{issuer:null,validFrom:null,validTo:null},headers:o,summary:u})}catch(e){if("SAFE_FETCH_TIMEOUT"===(e?.code||""))return t.status(408).json({error:"Request timeout. The site may be slow or unreachable."});if("ENOTFOUND"===e.code||"ECONNREFUSED"===e.code)return t.status(404).json({error:"Site not found or unreachable."});return console.error("Website security analysis error:",e),t.status(500).json({error:"Failed to analyze website. The site may be blocking requests or may be unreachable.",details:void 0})}}e.s(["default",()=>l],392665);var d=e.i(392665),u=e.i(7031),c=e.i(181927),h=e.i(846432);let p=(0,a.hoist)(d,"default"),f=(0,a.hoist)(d,"config"),w=new o.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/dashboards/website-security",pathname:"/api/dashboards/website-security",bundlePath:"",filename:""},userland:d,distDir:".next",relativeProjectDir:""});async function m(e,r,o){w.isDev&&(0,h.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/dashboards/website-security";a=a.replace(/\/index$/,"")||"/";let s=await w.prepare(e,r,{srcPage:a});if(!s){r.statusCode=400,r.end("Bad Request"),null==o.waitUntil||o.waitUntil.call(o,Promise.resolve());return}let{query:n,params:i,prerenderManifest:l,routerServerContext:d}=s;try{let t=e.method||"GET",o=(0,u.getTracer)(),s=o.getActiveScopeSpan(),h=w.instrumentationOnRequestError.bind(w),p=async s=>w.render(e,r,{query:{...n,...i},params:i,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:w.isDev,page:"/api/dashboards/website-security",internalRevalidate:null==d?void 0:d.revalidate,onError:(...t)=>h(e,...t)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=o.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=e.get("next.route");if(n){let e=`${t} ${n}`;s.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),s.updateName(e)}else s.updateName(`${t} ${a}`)});s?await p(s):await o.withPropagatedContext(e.headers,()=>o.trace(c.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:u.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},p))}catch(e){if(w.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==o.waitUntil||o.waitUntil.call(o,Promise.resolve())}}e.s(["config",0,f,"default",0,p,"handler",()=>m],239093)}];

//# debugId=f91b1f39-d713-9b27-6acb-3579d4aa0548
//# sourceMappingURL=%5Broot-of-the-server%5D__a51882a9._.js.map