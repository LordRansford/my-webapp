;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="e37f3a69-6f71-fb81-986b-bbbd805fa1ae")}catch(e){}}();
module.exports=[814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},657194,e=>{"use strict";var t=e.i(89171),r=e.i(254799);let n=new Map;function s(e,s){var i,a;let o,l,u,c=Date.now(),d=`${s.keyPrefix}:${(i=s.keySuffix,o=e.headers.get("x-forwarded-for")||"",l=o.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown",u=e.headers.get("user-agent")||"unknown",a=`${l}|${u}|${i||""}`,r.default.createHash("sha256").update(a).digest("hex").slice(0,24))}`,p=n.get(d);if(!p||p.resetAt<=c)return n.set(d,{count:1,resetAt:c+s.windowMs}),null;if(p.count+=1,p.count>s.limit){let e=Math.max(1,Math.ceil((p.resetAt-c)/1e3));return t.NextResponse.json({error:s.message||"Too many requests. Please try again shortly."},{status:429,headers:{"retry-after":String(e)}})}return null}e.s(["rateLimit",()=>s])},936426,e=>{"use strict";var t=e.i(89171);function r(e){let r=e.headers.get("origin"),n=e.headers.get("referer"),s=function(){try{return new URL(process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000").origin}catch{return"http://localhost:3000"}}(),i=null;try{i=new URL(e.url).origin}catch{i=null}let a=r||(n?(()=>{try{return new URL(n).origin}catch{return null}})():null);return a?a===s||i&&a===i?null:t.NextResponse.json({error:"Invalid origin"},{status:403}):t.NextResponse.json({error:"Missing origin"},{status:403})}e.s(["requireSameOrigin",()=>r])},895968,e=>{"use strict";var t=e.i(254799);function r(e){return e.headers.get("x-request-id")||t.default.randomUUID()}async function n(e,t,n){let s=r(e),i=Date.now();try{let e=await n({requestId:s}),r=Date.now()-i;return console.info("req",{requestId:s,route:t.route,status:"ok",durationMs:r}),e}catch(r){let e=Date.now()-i;throw console.error("req",{requestId:s,route:t.route,status:"error",durationMs:e,message:r?.message||"error"}),r}}e.s(["getRequestId",()=>r,"withRequestLogging",()=>n])},38675,e=>{"use strict";var t=e.i(747909),r=e.i(174017),n=e.i(996250),s=e.i(759756),i=e.i(561916),a=e.i(114444),o=e.i(837092),l=e.i(869741),u=e.i(316795),c=e.i(487718),d=e.i(995169),p=e.i(47587),h=e.i(666012),f=e.i(570101),g=e.i(626937),w=e.i(10372),m=e.i(193695);e.i(52474);var y=e.i(600220),R=e.i(89171),x=e.i(757660),v=e.i(568212),C=e.i(124594),b=e.i(895968),E=e.i(936426),S=e.i(657194),k=e.i(522734),q=e.i(814747);function P(e){try{if(!k.default.existsSync(e))return null;return JSON.parse(k.default.readFileSync(e,"utf8"))}catch{return null}}function A(e,t){let r=String(t||"").toLowerCase(),n=0;for(let t of e)r.includes(t)&&(n+=1);return n}let N=null,T=null;async function I(e){var t,r;let n,s,i,a,o,l,u=(n=String((r={question:e.question,pageUrl:e.pageUrl}).question||"").toLowerCase().replace(/[^a-z0-9\s/-]+/g," ").split(/\s+/).map(e=>e.trim()).filter(e=>e.length>=3).slice(0,50),s=function(){if(N)return N;let e=P(q.default.join(process.cwd(),"public","content-index.json"))||[];return N=e,e}(),i=function(){if(T)return T;let e=P(q.default.join(process.cwd(),"public","tools-index.json"))||[];return T=e,e}(),a=[...s.map(e=>({row:e,score:A(n,`${e.title||""} ${e.excerpt||""} ${e.slug||""}`)+(r.pageUrl&&e.slug===r.pageUrl?2:0)})).filter(e=>e.score>0).sort((e,t)=>t.score-e.score).slice(0,4).map(e=>({title:String(e.row.title||e.row.slug),href:String(e.row.slug),why:e.row.excerpt?String(e.row.excerpt).slice(0,90):"Relevant page on this site"})),...i.map(e=>({row:e,score:A(n,`${e.title} ${e.description||""} ${e.route} ${e.category||""}`)})).filter(e=>e.score>0).sort((e,t)=>t.score-e.score).slice(0,2).map(e=>({title:e.row.title,href:e.row.route,why:e.row.description?e.row.description.slice(0,90):"Relevant tool on this site"})),{title:"Pricing",href:"/pricing",why:"Donations, CPD assessment, and compute credits"}],o=new Set,a.filter(e=>!(!e.href||o.has(e.href))&&(o.add(e.href),!0)));return{answer:(l=String((t={question:e.question,citations:u}).question||"").trim().toLowerCase()).includes("pricing")||l.includes("price")||l.includes("pay")||l.includes("credits")?"This site has three payments.\n1. Donations support keeping learning free.\n2. CPD assessments and certificates are paid so you can prove competence professionally.\n3. Compute credits are for heavy server runs that go beyond your browser.\n\nIf you want CPD and certificates you should sign in before you start learning so your progress can be recorded.\nYou can find details on the pricing page.":l.includes("cpd")||l.includes("certificate")||l.includes("assessment")?"For CPD on this site.\n1. Sign in so progress and attempts attach to your account.\n2. Study the course path for your level.\n3. When ready take the timed assessment for that level.\n4. After submission you get explanations and revision links based on what you missed.\n\nIf you tell me which course and level you are on I can point you to the best next page and tools.":l.includes("tool")||l.includes("lab")||l.includes("not working")||l.includes("error")?"If a tool is not working, the fastest way to fix it is to narrow the problem.\n1. Check the input format and keep it short.\n2. Try one example input first.\n3. If the tool has a compute mode, confirm you have credits and are signed in when required.\n\nTell me the tool name and what you entered and I will point to the exact tool page and the most common fixes.":["I can help using this site content.","Here are the most relevant pages and tools to answer your question.",...t.citations.slice(0,3).map(e=>`- ${e.title} ${e.href}`),"","Ask one focused question at a time and I will point you to the exact sections to read next."].join("\n"),citations:u,lowConfidence:0===u.length}}function D(e,t){return("string"==typeof e?e:"").replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F]/g,"").trim().slice(0,t)}async function U(e){return(0,b.withRequestLogging)(e,{route:"POST /api/professor/ask"},async()=>{let t,r,n,s,i,a=(0,E.requireSameOrigin)(e);if(a)return a;let o=(0,S.rateLimit)(e,{keyPrefix:"professor-ask",limit:45,windowMs:6e4});if(o)return o;let l=await e.json().catch(()=>null),u=D(l?.question,800),c=D(l?.pageUrl,200),d=D(l?.pageTitle,120);if(!u||u.length<3)return R.NextResponse.json({message:"Invalid question"},{status:400});if(c.includes("/assessment")||(n=(r=(t=String(u||"")).split("\n").map(e=>e.trim()).filter(Boolean)).filter(e=>/^[A-D][).:\-]\s+/.test(e)).length>=3||t.includes("A)")||t.includes("B)")||t.includes("C)")||t.includes("D)"),s=t.length>700||r.length>10,i=/assessment|pass mark|75 minutes|80 percent|question bank/i.test(t),n||s||i))return R.NextResponse.json({answer:"I cannot help with timed assessments or pasted exam questions. After you submit, I can explain concepts, show where to revise on this site, and help you practise.",citations:[{title:"Pricing and CPD",href:"/pricing",why:"How assessment and CPD works on this site"},{title:"Cybersecurity overview",href:"/cybersecurity",why:"Where to find learning path and practice"}],lowConfidence:!1},{status:200});let p=await (0,x.getServerSession)(v.authOptions).catch(()=>null),h=p?.user?.id||null;if(h){let e=new Date,t=await C.prisma.assessmentSession.findFirst({where:{userId:h,expiresAt:{gt:e}},select:{id:!0}}).catch(()=>null);if(t?.id)return R.NextResponse.json({answer:"Professor Ransford is paused while you have an active timed assessment session. Submit or let it expire, then come back for feedback and revision help.",citations:[{title:"My account",href:"/account",why:"Credits, certificates, and CPD links"}],lowConfidence:!1},{status:200})}let f=await I({question:u,pageUrl:c,pageTitle:d}).catch(()=>null);return f?R.NextResponse.json(f,{status:200}):R.NextResponse.json({message:"Unable to answer"},{status:503})})}e.s(["POST",()=>U],748959);var O=e.i(748959);let j=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/professor/ask/route",pathname:"/api/professor/ask",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/professor/ask/route.ts",nextConfigOutput:"",userland:O}),{workAsyncStorage:M,workUnitAsyncStorage:$,serverHooks:_}=j;function H(){return(0,n.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:$})}async function L(e,t,n){j.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/professor/ask/route";R=R.replace(/\/index$/,"")||"/";let x=await j.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:v,params:C,nextConfig:b,parsedUrl:E,isDraftMode:S,prerenderManifest:k,routerServerContext:q,isOnDemandRevalidate:P,revalidateOnlyGenerated:A,resolvedPathname:N,clientReferenceManifest:T,serverActionsManifest:I}=x,D=(0,l.normalizeAppPath)(R),U=!!(k.dynamicRoutes[D]||k.routes[N]),O=async()=>((null==q?void 0:q.render404)?await q.render404(e,t,E,!1):t.end("This page could not be found"),null);if(U&&!S){let e=!!k.routes[N],t=k.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await O();throw new m.NoFallbackError}}let M=null;!U||j.isDev||S||(M="/index"===(M=N)?"/":M);let $=!0===j.isDev||!U,_=U&&!$;I&&T&&(0,a.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:T,serverActionsManifest:I,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:I})});let H=e.method||"GET",L=(0,i.getTracer)(),F=L.getActiveScopeSpan(),B={params:C,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>j.onRequestError(e,t,n,q)},sharedContext:{buildId:v}},K=new u.NodeNextRequest(e),W=new u.NodeNextResponse(t),X=c.NextRequestAdapter.fromNodeNextRequest(K,(0,c.signalFromNodeResponse)(t));try{let a=async e=>j.handle(X,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${H} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${R}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var i,l;let u=async({previousCacheEntry:r})=>{try{if(!o&&P&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await a(s);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=B.renderOpts.collectedTags;if(!U)return await (0,h.sendResponse)(K,W,i,B.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[w.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=w.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,n=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=w.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await j.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:P})},q),t}},c=await j.handleResponse({req:e,nextConfig:b,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:A,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:o});if(!U)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",P?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,f.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&U||d.delete(w.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(K,W,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};F?await l(F):await L.withPropagatedContext(e.headers,()=>L.trace(d.BaseServerSpan.handleRequest,{spanName:`${H} ${R}`,kind:i.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await j.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:P})}),U)throw t;return await (0,h.sendResponse)(K,W,new Response(null,{status:500})),null}}e.s(["handler",()=>L,"patchFetch",()=>H,"routeModule",()=>j,"serverHooks",()=>_,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>$],38675)}];

//# debugId=e37f3a69-6f71-fb81-986b-bbbd805fa1ae
//# sourceMappingURL=%5Broot-of-the-server%5D__104b8eb4._.js.map