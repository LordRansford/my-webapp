/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2Fworkspace%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspace&isDev=true&tsconfigPath=&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2Fworkspace%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspace&isDev=true&tsconfigPath=&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_server_app_render_encryption_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/app-render/encryption-utils */ \"(rsc)/./node_modules/next/dist/server/app-render/encryption-utils.js\");\n/* harmony import */ var next_dist_server_app_render_encryption_utils__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_app_render_encryption_utils__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_app_render_action_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/app-render/action-utils */ \"(rsc)/./node_modules/next/dist/server/app-render/action-utils.js\");\n/* harmony import */ var next_dist_server_app_render_action_utils__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_app_render_action_utils__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_16__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_17__);\n/* harmony import */ var _workspace_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./src/app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./src/app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    distDir: \".next/dev\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/workspace/src/app/api/auth/[...nextauth]/route.ts\",\n    nextConfigOutput,\n    userland: _workspace_src_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_18__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.addRequestMeta)(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/auth/[...nextauth]/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_7__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_16__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        (0,next_dist_server_app_render_encryption_utils__WEBPACK_IMPORTED_MODULE_5__.setReferenceManifestsSingleton)({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest,\n            serverModuleMap: (0,next_dist_server_app_render_action_utils__WEBPACK_IMPORTED_MODULE_6__.createServerModuleMap)({\n                serverActionsManifest\n            })\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_8__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_8__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_9__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_9__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_10__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean( false || (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_13__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_17__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_12__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_11__.getRevalidateReason)({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_17__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_13__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_15__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_12__.sendResponse)(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_10__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_16__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_11__.getRevalidateReason)({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_12__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZ3b3Jrc3BhY2UlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRndvcmtzcGFjZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD0mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ0U7QUFDUDtBQUNzQjtBQUNiO0FBQ0Y7QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ2E7QUFDL0U7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsYUFBYSxXQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9EO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGO0FBQ25GO0FBQ1A7QUFDQSxRQUFRLDZFQUFjO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUIsQ0FBQztBQUNOO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixLQUF3QztBQUN2RTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwrTUFBK007QUFDM04sOEJBQThCLDZGQUFnQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw2RkFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNEdBQThCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwrRkFBcUI7QUFDbEQ7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxtQkFBbUIsNEVBQVM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDhCQUE4Qiw2RUFBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRFQUFlO0FBQzNDLDRCQUE0Qiw2RUFBZ0I7QUFDNUMsb0JBQW9CLHlHQUFrQixrQ0FBa0MsaUhBQXNCO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsaUZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQSxzQ0FBc0MsTUFBd0IsSUFBSSw2RUFBYztBQUNoRjtBQUNBO0FBQ0EsK0NBQStDLG9CQUFvQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxzRkFBeUI7QUFDakU7QUFDQSxvQ0FBb0MsNEVBQXNCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0pBQXNKLG9FQUFjO0FBQ3BLLDBJQUEwSSxvRUFBYztBQUN4SjtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsNkVBQWU7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBLDhCQUE4Qiw2RUFBWTtBQUMxQztBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLDRGQUFtQjtBQUNqRTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtFQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxSUFBcUksNkVBQWU7QUFDcEo7QUFDQSwyR0FBMkcsaUhBQWlIO0FBQzVOO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdGQUEyQjtBQUN2RDtBQUNBLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGlGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ04sNkJBQTZCLDZGQUFlO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDRGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBhZGRSZXF1ZXN0TWV0YSwgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBzZXRSZWZlcmVuY2VNYW5pZmVzdHNTaW5nbGV0b24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9hcHAtcmVuZGVyL2VuY3J5cHRpb24tdXRpbHNcIjtcbmltcG9ydCB7IGNyZWF0ZVNlcnZlck1vZHVsZU1hcCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2FwcC1yZW5kZXIvYWN0aW9uLXV0aWxzXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL3dvcmtzcGFjZS9zcmMvYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlXCJcbiAgICB9LFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi93b3Jrc3BhY2Uvc3JjL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIGlmIChyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICBhZGRSZXF1ZXN0TWV0YShyZXEsICdkZXZSZXF1ZXN0VGltaW5nSW50ZXJuYWxzRW5kJywgcHJvY2Vzcy5ocnRpbWUuYmlnaW50KCkpO1xuICAgIH1cbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfSBlbHNlIGlmIChzcmNQYWdlID09PSAnL2luZGV4Jykge1xuICAgICAgICAvLyB3ZSBhbHdheXMgbm9ybWFsaXplIC9pbmRleCBzcGVjaWZpY2FsbHlcbiAgICAgICAgc3JjUGFnZSA9ICcvJztcbiAgICB9XG4gICAgY29uc3QgbXVsdGlab25lRHJhZnRNb2RlID0gcHJvY2Vzcy5lbnYuX19ORVhUX01VTFRJX1pPTkVfRFJBRlRfTU9ERTtcbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xuICAgICAgICBzcmNQYWdlLFxuICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGVcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgYnVpbGRJZCwgcGFyYW1zLCBuZXh0Q29uZmlnLCBwYXJzZWRVcmwsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lLCBjbGllbnRSZWZlcmVuY2VNYW5pZmVzdCwgc2VydmVyQWN0aW9uc01hbmlmZXN0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgY29uc3QgcmVuZGVyNDA0ID0gYXN5bmMgKCk9PntcbiAgICAgICAgLy8gVE9ETzogc2hvdWxkIHJvdXRlLW1vZHVsZSBpdHNlbGYgaGFuZGxlIHJlbmRlcmluZyB0aGUgNDA0XG4gICAgICAgIGlmIChyb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnJlbmRlcjQwNCkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVyU2VydmVyQ29udGV4dC5yZW5kZXI0MDQocmVxLCByZXMsIHBhcnNlZFVybCwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dENvbmZpZy5leHBlcmltZW50YWwuYWRhcHRlclBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJlbmRlcjQwNCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNTdGF0aWNHZW5lcmF0aW9uID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIC8vIEJlZm9yZSByZW5kZXJpbmcgKHdoaWNoIGluaXRpYWxpemVzIGNvbXBvbmVudCB0cmVlIG1vZHVsZXMpLCB3ZSBoYXZlIHRvXG4gICAgLy8gc2V0IHRoZSByZWZlcmVuY2UgbWFuaWZlc3RzIHRvIG91ciBnbG9iYWwgc3RvcmUgc28gU2VydmVyIEFjdGlvbidzXG4gICAgLy8gZW5jcnlwdGlvbiB1dGlsIGNhbiBhY2Nlc3MgdG8gdGhlbSBhdCB0aGUgdG9wIGxldmVsIG9mIHRoZSBwYWdlIG1vZHVsZS5cbiAgICBpZiAoc2VydmVyQWN0aW9uc01hbmlmZXN0ICYmIGNsaWVudFJlZmVyZW5jZU1hbmlmZXN0KSB7XG4gICAgICAgIHNldFJlZmVyZW5jZU1hbmlmZXN0c1NpbmdsZXRvbih7XG4gICAgICAgICAgICBwYWdlOiBzcmNQYWdlLFxuICAgICAgICAgICAgY2xpZW50UmVmZXJlbmNlTWFuaWZlc3QsXG4gICAgICAgICAgICBzZXJ2ZXJBY3Rpb25zTWFuaWZlc3QsXG4gICAgICAgICAgICBzZXJ2ZXJNb2R1bGVNYXA6IGNyZWF0ZVNlcnZlck1vZHVsZU1hcCh7XG4gICAgICAgICAgICAgICAgc2VydmVyQWN0aW9uc01hbmlmZXN0XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcbiAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgIHJlbmRlck9wdHM6IHtcbiAgICAgICAgICAgIGV4cGVyaW1lbnRhbDoge1xuICAgICAgICAgICAgICAgIGF1dGhJbnRlcnJ1cHRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmF1dGhJbnRlcnJ1cHRzKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhY2hlQ29tcG9uZW50czogQm9vbGVhbihuZXh0Q29uZmlnLmNhY2hlQ29tcG9uZW50cyksXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiBuZXh0Q29uZmlnLmNhY2hlTGlmZSxcbiAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbCxcbiAgICAgICAgICAgIG9uQ2xvc2U6IChjYik9PntcbiAgICAgICAgICAgICAgICByZXMub24oJ2Nsb3NlJywgY2IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQWZ0ZXJUYXNrRXJyb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG9uSW5zdHJ1bWVudGF0aW9uUmVxdWVzdEVycm9yOiAoZXJyb3IsIF9yZXF1ZXN0LCBlcnJvckNvbnRleHQpPT5yb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVycm9yLCBlcnJvckNvbnRleHQsIHJvdXRlclNlcnZlckNvbnRleHQpXG4gICAgICAgIH0sXG4gICAgICAgIHNoYXJlZENvbnRleHQ6IHtcbiAgICAgICAgICAgIGJ1aWxkSWRcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgbm9kZU5leHRSZXEgPSBuZXcgTm9kZU5leHRSZXF1ZXN0KHJlcSk7XG4gICAgY29uc3Qgbm9kZU5leHRSZXMgPSBuZXcgTm9kZU5leHRSZXNwb25zZShyZXMpO1xuICAgIGNvbnN0IG5leHRSZXEgPSBOZXh0UmVxdWVzdEFkYXB0ZXIuZnJvbU5vZGVOZXh0UmVxdWVzdChub2RlTmV4dFJlcSwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZShyZXMpKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHJvdXRlTW9kdWxlLmhhbmRsZShuZXh0UmVxLCBjb250ZXh0KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3NyY1BhZ2V9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGlzTWluaW1hbE1vZGUgPSBCb29sZWFuKHByb2Nlc3MuZW52Lk1JTklNQUxfTU9ERSB8fCBnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNNaW5pbWFsTW9kZSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3RhdGljR2VuZXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgICAgIGlzTWluaW1hbE1vZGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY3JlYXRlIGEgY2FjaGVFbnRyeSBmb3IgSVNSXG4gICAgICAgICAgICBpZiAoIWlzSXNyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGNhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZS5raW5kKSAhPT0gQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSkge1xuICAgICAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTE7XG4gICAgICAgICAgICAgICAgdGhyb3cgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ldyBFcnJvcihgSW52YXJpYW50OiBhcHAtcm91dGUgcmVjZWl2ZWQgaW52YWxpZCBjYWNoZSBlbnRyeSAke2NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZTEgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUxLmtpbmR9YCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFNzAxXCIsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNNaW5pbWFsTW9kZSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgaXNPbkRlbWFuZFJldmFsaWRhdGUgPyAnUkVWQUxJREFURUQnIDogY2FjaGVFbnRyeS5pc01pc3MgPyAnTUlTUycgOiBjYWNoZUVudHJ5LmlzU3RhbGUgPyAnU1RBTEUnIDogJ0hJVCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJhZnQgbW9kZSBzaG91bGQgbmV2ZXIgYmUgY2FjaGVkXG4gICAgICAgICAgICBpZiAoaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMoY2FjaGVFbnRyeS52YWx1ZS5oZWFkZXJzKTtcbiAgICAgICAgICAgIGlmICghKGlzTWluaW1hbE1vZGUgJiYgaXNJc3IpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5kZWxldGUoTkVYVF9DQUNIRV9UQUdTX0hFQURFUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXQgdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXplIGl0IHZpYSBuZXh0LmNvbmZpZ1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuY2FjaGVDb250cm9sICYmICFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykgJiYgIWhlYWRlcnMuZ2V0KCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNldCgnQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgLy8gQHRzLWV4cGVjdC1lcnJvciAtIEFyZ3VtZW50IG9mIHR5cGUgJ0J1ZmZlcjxBcnJheUJ1ZmZlckxpa2U+JyBpcyBub3QgYXNzaWduYWJsZSB0byBwYXJhbWV0ZXIgb2YgdHlwZSAnQm9keUluaXQgfCBudWxsIHwgdW5kZWZpbmVkJy5cbiAgICAgICAgICAgIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7c3JjUGFnZX1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzU3RhdGljR2VuZXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2Fworkspace%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspace&isDev=true&tsconfigPath=&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/[...nextauth]/route.ts":
/*!*************************************************!*\
  !*** ./src/app/api/auth/[...nextauth]/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   HEAD: () => (/* binding */ HEAD),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   PATCH: () => (/* binding */ PATCH),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_app_render_work_unit_async_storage_external_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/app-render/work-unit-async-storage.external.js */ \"./work-unit-async-storage.external\");\n/* harmony import */ var next_dist_server_app_render_work_unit_async_storage_external_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_app_render_work_unit_async_storage_external_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth_options__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth/options */ \"(rsc)/./src/lib/auth/options.ts\");\n/* harmony import */ var _lib_security_rateLimit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/security/rateLimit */ \"(rsc)/./src/lib/security/rateLimit.ts\");\n/* harmony import */ var _lib_auth_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/auth/env */ \"(rsc)/./src/lib/auth/env.ts\");\n/* harmony import */ var _sentry_nextjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sentry/nextjs */ \"@sentry/nextjs\");\n/* harmony import */ var _sentry_nextjs__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_sentry_nextjs__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n\n// next-auth@4 App Router handler (runtime-typed)\n(0,_lib_auth_env__WEBPACK_IMPORTED_MODULE_5__.ensureNextAuthUrl)();\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_1___default()(_lib_auth_options__WEBPACK_IMPORTED_MODULE_3__.authOptions);\nasync function GET$1(req, ctx) {\n    const env = (0,_lib_auth_env__WEBPACK_IMPORTED_MODULE_5__.getAuthEnvStatus)();\n    if (!env.ok && \"development\" === \"production\") {}\n    const limited = (0,_lib_security_rateLimit__WEBPACK_IMPORTED_MODULE_4__.rateLimit)(req, {\n        keyPrefix: \"auth\",\n        limit: 30,\n        windowMs: 60000\n    });\n    if (limited) return limited;\n    // Pass ctx through so NextAuth can read ctx.params.nextauth in the App Router.\n    return handler(req, ctx);\n}\nasync function POST$1(req, ctx) {\n    const env = (0,_lib_auth_env__WEBPACK_IMPORTED_MODULE_5__.getAuthEnvStatus)();\n    if (!env.ok && \"development\" === \"production\") {}\n    const limited = (0,_lib_security_rateLimit__WEBPACK_IMPORTED_MODULE_4__.rateLimit)(req, {\n        keyPrefix: \"auth\",\n        limit: 30,\n        windowMs: 60000\n    });\n    if (limited) return limited;\n    return handler(req, ctx);\n}\n\n// @ts-expect-error Because we cannot be sure if the RequestAsyncStorage module exists (it is not part of the Next.js public\n// API) we use a shim if it doesn't exist. The logic for this is in the wrapping loader.\n\nconst asyncStorageModule = { ...next_dist_server_app_render_work_unit_async_storage_external_js__WEBPACK_IMPORTED_MODULE_0__ } ;\n\nconst requestAsyncStorage =\n  'workUnitAsyncStorage' in asyncStorageModule\n    ? asyncStorageModule.workUnitAsyncStorage\n    : 'requestAsyncStorage' in asyncStorageModule\n      ? asyncStorageModule.requestAsyncStorage\n      : undefined;\n\nfunction wrapHandler(handler, method) {\n  // Running the instrumentation code during the build phase will mark any function as \"dynamic\" because we're accessing\n  // the Request object. We do not want to turn handlers dynamic so we skip instrumentation in the build phase.\n  if (process.env.NEXT_PHASE === 'phase-production-build') {\n    return handler;\n  }\n\n  if (typeof handler !== 'function') {\n    return handler;\n  }\n\n  return new Proxy(handler, {\n    apply: (originalFunction, thisArg, args) => {\n      let headers = undefined;\n\n      // We try-catch here just in case the API around `requestAsyncStorage` changes unexpectedly since it is not public API\n      try {\n        const requestAsyncStore = requestAsyncStorage?.getStore();\n        headers = requestAsyncStore?.headers;\n      } catch {\n        /** empty */\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return _sentry_nextjs__WEBPACK_IMPORTED_MODULE_6__.wrapRouteHandlerWithSentry(originalFunction , {\n        method,\n        parameterizedRoute: '/api/auth/[...nextauth]',\n        headers,\n      }).apply(thisArg, args);\n    },\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst GET = wrapHandler(GET$1 , 'GET');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst POST = wrapHandler(POST$1 , 'POST');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst PUT = wrapHandler(undefined , 'PUT');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst PATCH = wrapHandler(undefined , 'PATCH');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst DELETE = wrapHandler(undefined , 'DELETE');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst HEAD = wrapHandler(undefined , 'HEAD');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst OPTIONS = wrapHandler(undefined , 'OPTIONS');\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU1BO0FBQ0FBLGdFQUFBQSxFQUFBQTtBQUNBLE1BQU1DLFVBQWVDLGdEQUFBQSxDQUFTQywwREFBQUEsQ0FBQUE7QUFFdkIsZUFBZUMsS0FBQUEsQ0FBSUMsR0FBWSxFQUFFQyxHQUFRO0FBQzlDLFVBQU1DLEdBQUFBLEdBQU1DLCtEQUFBQSxFQUFBQTtBQUNaLFFBQUksQ0FBQ0QsR0FBQUEsQ0FBSUUsRUFBRSxJQVVXLGtCQVZrQixjQUFjO0lBUXRELE1BQU1DLE9BQUFBLEdBQVVDLGtFQUFTQSxDQUFDTixHQUFBQSxFQUFLO1FBQUVPLFNBQUFBLEVBQVc7UUFBUUMsS0FBQUEsRUFBTztRQUFJQyxRQUFBQSxFQUFVO0FBQU87QUFDaEYsUUFBSUosU0FBUyxPQUFPQSxPQUFBQTs7QUFFcEIsV0FBT1QsUUFBUUksR0FBQUEsRUFBS0MsR0FBQUEsQ0FBQUE7QUFDdEI7QUFFTyxlQUFlUyxNQUFBQSxDQUFLVixHQUFZLEVBQUVDLEdBQVE7QUFDL0MsVUFBTUMsR0FBQUEsR0FBTUMsK0RBQUFBLEVBQUFBO0FBQ1osUUFBSSxDQUFDRCxHQUFBQSxDQUFJRSxFQUFFLElBTlcsa0JBTWtCLGNBQWM7SUFPdEQsTUFBTUMsT0FBQUEsR0FBVUMsa0VBQVNBLENBQUNOLEdBQUFBLEVBQUs7UUFBRU8sU0FBQUEsRUFBVztRQUFRQyxLQUFBQSxFQUFPO1FBQUlDLFFBQUFBLEVBQVU7QUFBTztBQUNoRixRQUFJSixTQUFTLE9BQU9BLE9BQUFBO0FBQ3BCLFdBQU9ULFFBQVFJLEdBQUFBLEVBQUtDLEdBQUFBLENBQUFBO0FBQ3RCOztBQ2hDQTtBQUNBOztBQUVBLE1BQU0sa0JBQWtCLEdBQUcsRUFBRSxHQUFHLDRGQUFVLEVBQUU7O0FBRTVDLE1BQU0sbUJBQW1CO0FBQ3pCLEVBQUUsc0JBQXNCLElBQUk7QUFDNUIsTUFBTSxrQkFBa0IsQ0FBQztBQUN6QixNQUFNLHFCQUFxQixJQUFJO0FBQy9CLFFBQVEsa0JBQWtCLENBQUM7QUFDM0IsUUFBUSxTQUFTOztBQUVqQixTQUFTLFdBQVcsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQ3RDO0FBQ0E7QUFDQSxFQUFFLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEtBQUssd0JBQXdCLEVBQUU7QUFDM0QsSUFBSSxPQUFPLE9BQU87QUFDbEIsRUFBRTs7QUFFRixFQUFFLElBQUksT0FBTyxPQUFPLEtBQUssVUFBVSxFQUFFO0FBQ3JDLElBQUksT0FBTyxPQUFPO0FBQ2xCLEVBQUU7O0FBRUYsRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sRUFBRTtBQUM1QixJQUFJLEtBQUssRUFBRSxDQUFDLGdCQUFnQixFQUFFLE9BQU8sRUFBRSxJQUFJLEtBQUs7QUFDaEQsTUFBTSxJQUFJLE9BQU8sR0FBRyxTQUFTOztBQUU3QjtBQUNBLE1BQU0sSUFBSTtBQUNWLFFBQVEsTUFBTSxpQkFBaUIsR0FBRyxtQkFBbUIsRUFBRSxRQUFRLEVBQUU7QUFDakUsUUFBUSxPQUFPLEdBQUcsaUJBQWlCLEVBQUUsT0FBTztBQUM1QyxNQUFNLENBQUMsQ0FBQyxNQUFNO0FBQ2Q7QUFDQSxNQUFNOztBQUVOO0FBQ0EsTUFBTSxPQUFPLHNFQUFpQyxDQUFDLGdCQUFnQixHQUFHO0FBQ2xFLFFBQVEsTUFBTTtBQUNkLFFBQVEsa0JBQWtCLEVBQUUseUJBQXlCO0FBQ3JELFFBQVEsT0FBTztBQUNmLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDO0FBQzdCLElBQUksQ0FBQztBQUNMLEdBQUcsQ0FBQztBQUNKOztBQUVBO0FBQ0ssTUFBQyxHQUFHLEdBQUcsV0FBVyxDQUFDVSxLQUF5QixHQUFHLEtBQUs7QUFDekQ7QUFDSyxNQUFDLElBQUksR0FBRyxXQUFXLENBQUNDLE1BQTBCLEdBQUcsTUFBTTtBQUM1RDtBQUNLLE1BQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQ0MsU0FBeUIsR0FBRyxLQUFLO0FBQ3pEO0FBQ0ssTUFBQyxLQUFLLEdBQUcsV0FBVyxDQUFDQyxTQUEyQixHQUFHLE9BQU87QUFDL0Q7QUFDSyxNQUFDLE1BQU0sR0FBRyxXQUFXLENBQUNDLFNBQTRCLEdBQUcsUUFBUTtBQUNsRTtBQUNLLE1BQUMsSUFBSSxHQUFHLFdBQVcsQ0FBQ0MsU0FBMEIsR0FBRyxNQUFNO0FBQzVEO0FBQ0ssTUFBQyxPQUFPLEdBQUcsV0FBVyxDQUFDQyxTQUE2QixHQUFHLFNBQVMiLCJzb3VyY2VzIjpbInNyYy9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsInNlbnRyeS13cmFwcGVyLW1vZHVsZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGggZnJvbSBcIm5leHQtYXV0aFwiO1xuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBhdXRoT3B0aW9ucyB9IGZyb20gXCJAL2xpYi9hdXRoL29wdGlvbnNcIjtcbmltcG9ydCB7IHJhdGVMaW1pdCB9IGZyb20gXCJAL2xpYi9zZWN1cml0eS9yYXRlTGltaXRcIjtcbmltcG9ydCB7IGVuc3VyZU5leHRBdXRoVXJsLCBnZXRBdXRoRW52U3RhdHVzLCBsb2dBdXRoRW52SWZNaXNjb25maWd1cmVkIH0gZnJvbSBcIkAvbGliL2F1dGgvZW52XCI7XG5cbi8vIG5leHQtYXV0aEA0IEFwcCBSb3V0ZXIgaGFuZGxlciAocnVudGltZS10eXBlZClcbmVuc3VyZU5leHRBdXRoVXJsKCk7XG5jb25zdCBoYW5kbGVyOiBhbnkgPSBOZXh0QXV0aChhdXRoT3B0aW9ucyk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxOiBSZXF1ZXN0LCBjdHg6IGFueSkge1xuICBjb25zdCBlbnYgPSBnZXRBdXRoRW52U3RhdHVzKCk7XG4gIGlmICghZW52Lm9rICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGxvZ0F1dGhFbnZJZk1pc2NvbmZpZ3VyZWQoXCJHRVQgL2FwaS9hdXRoXCIpO1xuICAgIGNvbnN0IHBhdGggPSBuZXcgVVJMKHJlcS51cmwpLnBhdGhuYW1lO1xuICAgIC8vIEtlZXAgdXNlU2Vzc2lvbigpIHN0YWJsZSBldmVuIHdoZW4gbWlzY29uZmlndXJlZC5cbiAgICBpZiAocGF0aC5lbmRzV2l0aChcIi9zZXNzaW9uXCIpKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyB1c2VyOiBudWxsLCBleHBpcmVzOiBuZXcgRGF0ZSgwKS50b0lTT1N0cmluZygpIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gICAgLy8gUmV0dXJuIGEgZnJpZW5kbHkgSlNPTiByZXNwb25zZSBpbnN0ZWFkIG9mIHJlZGlyZWN0aW5nICh3aGljaCBjYXVzZXMgNTAwIGVycm9ycylcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJBdXRoZW50aWNhdGlvbiBpcyBub3QgY29uZmlndXJlZC4gU2lnbiBpbiBpcyBvcHRpb25hbCBhbmQgbm90IHJlcXVpcmVkIHRvIHVzZSB0aGUgc2l0ZS5cIiB9LCB7IHN0YXR1czogNTAzIH0pO1xuICB9XG4gIGNvbnN0IGxpbWl0ZWQgPSByYXRlTGltaXQocmVxLCB7IGtleVByZWZpeDogXCJhdXRoXCIsIGxpbWl0OiAzMCwgd2luZG93TXM6IDYwXzAwMCB9KTtcbiAgaWYgKGxpbWl0ZWQpIHJldHVybiBsaW1pdGVkO1xuICAvLyBQYXNzIGN0eCB0aHJvdWdoIHNvIE5leHRBdXRoIGNhbiByZWFkIGN0eC5wYXJhbXMubmV4dGF1dGggaW4gdGhlIEFwcCBSb3V0ZXIuXG4gIHJldHVybiBoYW5kbGVyKHJlcSwgY3R4KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0LCBjdHg6IGFueSkge1xuICBjb25zdCBlbnYgPSBnZXRBdXRoRW52U3RhdHVzKCk7XG4gIGlmICghZW52Lm9rICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGxvZ0F1dGhFbnZJZk1pc2NvbmZpZ3VyZWQoXCJQT1NUIC9hcGkvYXV0aFwiKTtcbiAgICBjb25zdCBwYXRoID0gbmV3IFVSTChyZXEudXJsKS5wYXRobmFtZTtcbiAgICBpZiAocGF0aC5lbmRzV2l0aChcIi9fbG9nXCIpKSByZXR1cm4gbmV3IE5leHRSZXNwb25zZShudWxsLCB7IHN0YXR1czogMjA0IH0pO1xuICAgIC8vIFJldHVybiBhIGZyaWVuZGx5IEpTT04gcmVzcG9uc2UgaW5zdGVhZCBvZiByZWRpcmVjdGluZyAod2hpY2ggY2F1c2VzIDUwMCBlcnJvcnMpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiQXV0aGVudGljYXRpb24gaXMgbm90IGNvbmZpZ3VyZWQuIFNpZ24gaW4gaXMgb3B0aW9uYWwgYW5kIG5vdCByZXF1aXJlZCB0byB1c2UgdGhlIHNpdGUuXCIgfSwgeyBzdGF0dXM6IDUwMyB9KTtcbiAgfVxuICBjb25zdCBsaW1pdGVkID0gcmF0ZUxpbWl0KHJlcSwgeyBrZXlQcmVmaXg6IFwiYXV0aFwiLCBsaW1pdDogMzAsIHdpbmRvd01zOiA2MF8wMDAgfSk7XG4gIGlmIChsaW1pdGVkKSByZXR1cm4gbGltaXRlZDtcbiAgcmV0dXJuIGhhbmRsZXIocmVxLCBjdHgpO1xufVxuXG5cbiIsImltcG9ydCAqIGFzIG9yaWdNb2R1bGUgZnJvbSAnbmV4dC9kaXN0L3NlcnZlci9hcHAtcmVuZGVyL3dvcmstdW5pdC1hc3luYy1zdG9yYWdlLmV4dGVybmFsLmpzJztcbmltcG9ydCAqIGFzIHNlcnZlckNvbXBvbmVudE1vZHVsZSBmcm9tICdfX1NFTlRSWV9XUkFQUElOR19UQVJHRVRfRklMRV9fLmNqcyc7XG5leHBvcnQgKiBmcm9tICdfX1NFTlRSWV9XUkFQUElOR19UQVJHRVRfRklMRV9fLmNqcyc7XG5leHBvcnQge30gZnJvbSAnX19TRU5UUllfV1JBUFBJTkdfVEFSR0VUX0ZJTEVfXy5janMnO1xuaW1wb3J0ICogYXMgU2VudHJ5IGZyb20gJ0BzZW50cnkvbmV4dGpzJztcblxuLy8gQHRzLWV4cGVjdC1lcnJvciBCZWNhdXNlIHdlIGNhbm5vdCBiZSBzdXJlIGlmIHRoZSBSZXF1ZXN0QXN5bmNTdG9yYWdlIG1vZHVsZSBleGlzdHMgKGl0IGlzIG5vdCBwYXJ0IG9mIHRoZSBOZXh0LmpzIHB1YmxpY1xuLy8gQVBJKSB3ZSB1c2UgYSBzaGltIGlmIGl0IGRvZXNuJ3QgZXhpc3QuIFRoZSBsb2dpYyBmb3IgdGhpcyBpcyBpbiB0aGUgd3JhcHBpbmcgbG9hZGVyLlxuXG5jb25zdCBhc3luY1N0b3JhZ2VNb2R1bGUgPSB7IC4uLm9yaWdNb2R1bGUgfSA7XG5cbmNvbnN0IHJlcXVlc3RBc3luY1N0b3JhZ2UgPVxuICAnd29ya1VuaXRBc3luY1N0b3JhZ2UnIGluIGFzeW5jU3RvcmFnZU1vZHVsZVxuICAgID8gYXN5bmNTdG9yYWdlTW9kdWxlLndvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgOiAncmVxdWVzdEFzeW5jU3RvcmFnZScgaW4gYXN5bmNTdG9yYWdlTW9kdWxlXG4gICAgICA/IGFzeW5jU3RvcmFnZU1vZHVsZS5yZXF1ZXN0QXN5bmNTdG9yYWdlXG4gICAgICA6IHVuZGVmaW5lZDtcblxuZnVuY3Rpb24gd3JhcEhhbmRsZXIoaGFuZGxlciwgbWV0aG9kKSB7XG4gIC8vIFJ1bm5pbmcgdGhlIGluc3RydW1lbnRhdGlvbiBjb2RlIGR1cmluZyB0aGUgYnVpbGQgcGhhc2Ugd2lsbCBtYXJrIGFueSBmdW5jdGlvbiBhcyBcImR5bmFtaWNcIiBiZWNhdXNlIHdlJ3JlIGFjY2Vzc2luZ1xuICAvLyB0aGUgUmVxdWVzdCBvYmplY3QuIFdlIGRvIG5vdCB3YW50IHRvIHR1cm4gaGFuZGxlcnMgZHluYW1pYyBzbyB3ZSBza2lwIGluc3RydW1lbnRhdGlvbiBpbiB0aGUgYnVpbGQgcGhhc2UuXG4gIGlmIChwcm9jZXNzLmVudi5ORVhUX1BIQVNFID09PSAncGhhc2UtcHJvZHVjdGlvbi1idWlsZCcpIHtcbiAgICByZXR1cm4gaGFuZGxlcjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgaGFuZGxlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBoYW5kbGVyO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBQcm94eShoYW5kbGVyLCB7XG4gICAgYXBwbHk6IChvcmlnaW5hbEZ1bmN0aW9uLCB0aGlzQXJnLCBhcmdzKSA9PiB7XG4gICAgICBsZXQgaGVhZGVycyA9IHVuZGVmaW5lZDtcblxuICAgICAgLy8gV2UgdHJ5LWNhdGNoIGhlcmUganVzdCBpbiBjYXNlIHRoZSBBUEkgYXJvdW5kIGByZXF1ZXN0QXN5bmNTdG9yYWdlYCBjaGFuZ2VzIHVuZXhwZWN0ZWRseSBzaW5jZSBpdCBpcyBub3QgcHVibGljIEFQSVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdEFzeW5jU3RvcmUgPSByZXF1ZXN0QXN5bmNTdG9yYWdlPy5nZXRTdG9yZSgpO1xuICAgICAgICBoZWFkZXJzID0gcmVxdWVzdEFzeW5jU3RvcmU/LmhlYWRlcnM7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgLyoqIGVtcHR5ICovXG4gICAgICB9XG5cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICByZXR1cm4gU2VudHJ5LndyYXBSb3V0ZUhhbmRsZXJXaXRoU2VudHJ5KG9yaWdpbmFsRnVuY3Rpb24gLCB7XG4gICAgICAgIG1ldGhvZCxcbiAgICAgICAgcGFyYW1ldGVyaXplZFJvdXRlOiAnL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0nLFxuICAgICAgICBoZWFkZXJzLFxuICAgICAgfSkuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gICAgfSxcbiAgfSk7XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbmNvbnN0IEdFVCA9IHdyYXBIYW5kbGVyKHNlcnZlckNvbXBvbmVudE1vZHVsZS5HRVQgLCAnR0VUJyk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG5jb25zdCBQT1NUID0gd3JhcEhhbmRsZXIoc2VydmVyQ29tcG9uZW50TW9kdWxlLlBPU1QgLCAnUE9TVCcpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuY29uc3QgUFVUID0gd3JhcEhhbmRsZXIoc2VydmVyQ29tcG9uZW50TW9kdWxlLlBVVCAsICdQVVQnKTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbmNvbnN0IFBBVENIID0gd3JhcEhhbmRsZXIoc2VydmVyQ29tcG9uZW50TW9kdWxlLlBBVENIICwgJ1BBVENIJyk7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG5jb25zdCBERUxFVEUgPSB3cmFwSGFuZGxlcihzZXJ2ZXJDb21wb25lbnRNb2R1bGUuREVMRVRFICwgJ0RFTEVURScpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuY29uc3QgSEVBRCA9IHdyYXBIYW5kbGVyKHNlcnZlckNvbXBvbmVudE1vZHVsZS5IRUFEICwgJ0hFQUQnKTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbmNvbnN0IE9QVElPTlMgPSB3cmFwSGFuZGxlcihzZXJ2ZXJDb21wb25lbnRNb2R1bGUuT1BUSU9OUyAsICdPUFRJT05TJyk7XG5cbmV4cG9ydCB7IERFTEVURSwgR0VULCBIRUFELCBPUFRJT05TLCBQQVRDSCwgUE9TVCwgUFVUIH07XG4iXSwibmFtZXMiOlsiZW5zdXJlTmV4dEF1dGhVcmwiLCJoYW5kbGVyIiwiTmV4dEF1dGgiLCJhdXRoT3B0aW9ucyIsIkdFVCIsInJlcSIsImN0eCIsImVudiIsImdldEF1dGhFbnZTdGF0dXMiLCJvayIsImxpbWl0ZWQiLCJyYXRlTGltaXQiLCJrZXlQcmVmaXgiLCJsaW1pdCIsIndpbmRvd01zIiwiUE9TVCIsInNlcnZlckNvbXBvbmVudE1vZHVsZS5HRVQiLCJzZXJ2ZXJDb21wb25lbnRNb2R1bGUuUE9TVCIsInNlcnZlckNvbXBvbmVudE1vZHVsZS5QVVQiLCJzZXJ2ZXJDb21wb25lbnRNb2R1bGUuUEFUQ0giLCJzZXJ2ZXJDb21wb25lbnRNb2R1bGUuREVMRVRFIiwic2VydmVyQ29tcG9uZW50TW9kdWxlLkhFQUQiLCJzZXJ2ZXJDb21wb25lbnRNb2R1bGUuT1BUSU9OUyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/admin/rbac.ts":
/*!*******************************!*\
  !*** ./src/lib/admin/rbac.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ADMIN_PERMISSIONS: () => (/* binding */ ADMIN_PERMISSIONS),\n/* harmony export */   ADMIN_ROLES: () => (/* binding */ ADMIN_ROLES),\n/* harmony export */   AdminPermissionError: () => (/* binding */ AdminPermissionError),\n/* harmony export */   ROLE_PERMISSIONS: () => (/* binding */ ROLE_PERMISSIONS),\n/* harmony export */   getAdminRole: () => (/* binding */ getAdminRole),\n/* harmony export */   hasPermission: () => (/* binding */ hasPermission),\n/* harmony export */   isAdminRole: () => (/* binding */ isAdminRole),\n/* harmony export */   requireAdminPermission: () => (/* binding */ requireAdminPermission)\n/* harmony export */ });\nconst ADMIN_ROLES = [\n    \"OWNER\",\n    \"ADMIN\",\n    \"SUPPORT\",\n    \"READ_ONLY\"\n];\nfunction isAdminRole(value) {\n    return typeof value === \"string\" && ADMIN_ROLES.includes(value);\n}\nconst ADMIN_PERMISSIONS = [\n    \"VIEW_USERS\",\n    \"MANAGE_USERS\",\n    \"VIEW_SUPPORT\",\n    \"MANAGE_SUPPORT\",\n    \"VIEW_ASSESSMENTS\",\n    \"MANAGE_ASSESSMENTS\",\n    \"VIEW_BILLING\",\n    \"MANAGE_BILLING\",\n    \"VIEW_SYSTEM\",\n    \"MANAGE_SYSTEM\"\n];\nconst ROLE_PERMISSIONS = {\n    OWNER: ADMIN_PERMISSIONS,\n    ADMIN: [\n        \"VIEW_USERS\",\n        \"MANAGE_USERS\",\n        \"VIEW_SUPPORT\",\n        \"MANAGE_SUPPORT\",\n        \"VIEW_ASSESSMENTS\",\n        \"MANAGE_ASSESSMENTS\",\n        \"VIEW_BILLING\",\n        \"VIEW_SYSTEM\",\n        \"MANAGE_SYSTEM\"\n    ],\n    SUPPORT: [\n        \"VIEW_USERS\",\n        \"VIEW_SUPPORT\",\n        \"MANAGE_SUPPORT\",\n        \"VIEW_ASSESSMENTS\",\n        \"VIEW_SYSTEM\"\n    ],\n    READ_ONLY: [\n        \"VIEW_USERS\",\n        \"VIEW_SUPPORT\",\n        \"VIEW_ASSESSMENTS\",\n        \"VIEW_BILLING\",\n        \"VIEW_SYSTEM\"\n    ]\n};\nfunction parseEmailList(raw) {\n    return (raw || \"\").split(\",\").map((s)=>s.trim().toLowerCase()).filter(Boolean);\n}\nfunction getAdminRole(user) {\n    const explicitRole = user?.adminRole;\n    if (isAdminRole(explicitRole)) return explicitRole;\n    const email = (user?.email || \"\").trim().toLowerCase();\n    if (!email) return null;\n    // Environment-based role mapping (extensible, no client exposure).\n    // Comma-separated lists:\n    // - ADMIN_OWNER_EMAILS\n    // - ADMIN_ADMIN_EMAILS\n    // - ADMIN_SUPPORT_EMAILS\n    // - ADMIN_READ_ONLY_EMAILS\n    const owners = parseEmailList(process.env.ADMIN_OWNER_EMAILS);\n    const admins = parseEmailList(process.env.ADMIN_ADMIN_EMAILS);\n    const support = parseEmailList(process.env.ADMIN_SUPPORT_EMAILS);\n    const readOnly = parseEmailList(process.env.ADMIN_READ_ONLY_EMAILS);\n    if (owners.includes(email)) return \"OWNER\";\n    if (admins.includes(email)) return \"ADMIN\";\n    if (support.includes(email)) return \"SUPPORT\";\n    if (readOnly.includes(email)) return \"READ_ONLY\";\n    // Backward-compatible escape hatch for early deployments.\n    const legacyOwner = (process.env.ADMIN_EMAIL || \"sageransity@icloud.com\").trim().toLowerCase();\n    if (email === legacyOwner) return \"OWNER\";\n    return null;\n}\nfunction hasPermission(role, permission) {\n    const perms = ROLE_PERMISSIONS[role] || [];\n    return perms.includes(permission);\n}\nclass AdminPermissionError extends Error {\n    constructor(message = \"Access denied\"){\n        super(message), this.status = 403, this.code = \"ADMIN_FORBIDDEN\";\n    }\n}\n/**\n * Server-side RBAC gate.\n * Fail closed: if role is missing or permission is not granted, throw.\n *\n * Step-up auth placeholder:\n * - In future, enforce recent authentication or additional verification here (MFA).\n * - For now, this is intentionally a stub to avoid refactors later.\n */ function requireAdminPermission(user, permission) {\n    const role = getAdminRole(user);\n    if (!role) throw new AdminPermissionError(\"Access denied\");\n    if (!hasPermission(role, permission)) throw new AdminPermissionError(\"Access denied\");\n    // Step-up auth placeholder:\n    // if (permission === \"MANAGE_BILLING\") { enforceStepUp(user) }\n    return {\n        role\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L3dvcmtzcGFjZS9zcmMvbGliL2FkbWluL3JiYWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IEFETUlOX1JPTEVTID0gW1wiT1dORVJcIiwgXCJBRE1JTlwiLCBcIlNVUFBPUlRcIiwgXCJSRUFEX09OTFlcIl0gYXMgY29uc3Q7XG5leHBvcnQgdHlwZSBBZG1pblJvbGUgPSAodHlwZW9mIEFETUlOX1JPTEVTKVtudW1iZXJdO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pblJvbGUodmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBBZG1pblJvbGUge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIChBRE1JTl9ST0xFUyBhcyByZWFkb25seSBzdHJpbmdbXSkuaW5jbHVkZXModmFsdWUpO1xufVxuXG5leHBvcnQgY29uc3QgQURNSU5fUEVSTUlTU0lPTlMgPSBbXG4gIFwiVklFV19VU0VSU1wiLFxuICBcIk1BTkFHRV9VU0VSU1wiLFxuICBcIlZJRVdfU1VQUE9SVFwiLFxuICBcIk1BTkFHRV9TVVBQT1JUXCIsXG4gIFwiVklFV19BU1NFU1NNRU5UU1wiLFxuICBcIk1BTkFHRV9BU1NFU1NNRU5UU1wiLFxuICBcIlZJRVdfQklMTElOR1wiLFxuICBcIk1BTkFHRV9CSUxMSU5HXCIsXG4gIFwiVklFV19TWVNURU1cIixcbiAgXCJNQU5BR0VfU1lTVEVNXCIsXG5dIGFzIGNvbnN0O1xuXG5leHBvcnQgdHlwZSBBZG1pblBlcm1pc3Npb24gPSAodHlwZW9mIEFETUlOX1BFUk1JU1NJT05TKVtudW1iZXJdO1xuXG50eXBlIFJvbGVQZXJtaXNzaW9ucyA9IFJlY29yZDxBZG1pblJvbGUsIHJlYWRvbmx5IEFkbWluUGVybWlzc2lvbltdPjtcblxuZXhwb3J0IGNvbnN0IFJPTEVfUEVSTUlTU0lPTlM6IFJvbGVQZXJtaXNzaW9ucyA9IHtcbiAgT1dORVI6IEFETUlOX1BFUk1JU1NJT05TLFxuICBBRE1JTjogW1xuICAgIFwiVklFV19VU0VSU1wiLFxuICAgIFwiTUFOQUdFX1VTRVJTXCIsXG4gICAgXCJWSUVXX1NVUFBPUlRcIixcbiAgICBcIk1BTkFHRV9TVVBQT1JUXCIsXG4gICAgXCJWSUVXX0FTU0VTU01FTlRTXCIsXG4gICAgXCJNQU5BR0VfQVNTRVNTTUVOVFNcIixcbiAgICBcIlZJRVdfQklMTElOR1wiLFxuICAgIFwiVklFV19TWVNURU1cIixcbiAgICBcIk1BTkFHRV9TWVNURU1cIixcbiAgXSxcbiAgU1VQUE9SVDogW1wiVklFV19VU0VSU1wiLCBcIlZJRVdfU1VQUE9SVFwiLCBcIk1BTkFHRV9TVVBQT1JUXCIsIFwiVklFV19BU1NFU1NNRU5UU1wiLCBcIlZJRVdfU1lTVEVNXCJdLFxuICBSRUFEX09OTFk6IFtcIlZJRVdfVVNFUlNcIiwgXCJWSUVXX1NVUFBPUlRcIiwgXCJWSUVXX0FTU0VTU01FTlRTXCIsIFwiVklFV19CSUxMSU5HXCIsIFwiVklFV19TWVNURU1cIl0sXG59IGFzIGNvbnN0O1xuXG5mdW5jdGlvbiBwYXJzZUVtYWlsTGlzdChyYXc6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICByZXR1cm4gKHJhdyB8fCBcIlwiKVxuICAgIC5zcGxpdChcIixcIilcbiAgICAubWFwKChzKSA9PiBzLnRyaW0oKS50b0xvd2VyQ2FzZSgpKVxuICAgIC5maWx0ZXIoQm9vbGVhbik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZG1pblJvbGUodXNlcj86IHsgZW1haWw/OiBzdHJpbmcgfCBudWxsIH0gfCBudWxsKTogQWRtaW5Sb2xlIHwgbnVsbCB7XG4gIGNvbnN0IGV4cGxpY2l0Um9sZSA9ICh1c2VyIGFzIGFueSk/LmFkbWluUm9sZTtcbiAgaWYgKGlzQWRtaW5Sb2xlKGV4cGxpY2l0Um9sZSkpIHJldHVybiBleHBsaWNpdFJvbGU7XG5cbiAgY29uc3QgZW1haWwgPSAodXNlcj8uZW1haWwgfHwgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIGlmICghZW1haWwpIHJldHVybiBudWxsO1xuXG4gIC8vIEVudmlyb25tZW50LWJhc2VkIHJvbGUgbWFwcGluZyAoZXh0ZW5zaWJsZSwgbm8gY2xpZW50IGV4cG9zdXJlKS5cbiAgLy8gQ29tbWEtc2VwYXJhdGVkIGxpc3RzOlxuICAvLyAtIEFETUlOX09XTkVSX0VNQUlMU1xuICAvLyAtIEFETUlOX0FETUlOX0VNQUlMU1xuICAvLyAtIEFETUlOX1NVUFBPUlRfRU1BSUxTXG4gIC8vIC0gQURNSU5fUkVBRF9PTkxZX0VNQUlMU1xuICBjb25zdCBvd25lcnMgPSBwYXJzZUVtYWlsTGlzdChwcm9jZXNzLmVudi5BRE1JTl9PV05FUl9FTUFJTFMpO1xuICBjb25zdCBhZG1pbnMgPSBwYXJzZUVtYWlsTGlzdChwcm9jZXNzLmVudi5BRE1JTl9BRE1JTl9FTUFJTFMpO1xuICBjb25zdCBzdXBwb3J0ID0gcGFyc2VFbWFpbExpc3QocHJvY2Vzcy5lbnYuQURNSU5fU1VQUE9SVF9FTUFJTFMpO1xuICBjb25zdCByZWFkT25seSA9IHBhcnNlRW1haWxMaXN0KHByb2Nlc3MuZW52LkFETUlOX1JFQURfT05MWV9FTUFJTFMpO1xuXG4gIGlmIChvd25lcnMuaW5jbHVkZXMoZW1haWwpKSByZXR1cm4gXCJPV05FUlwiO1xuICBpZiAoYWRtaW5zLmluY2x1ZGVzKGVtYWlsKSkgcmV0dXJuIFwiQURNSU5cIjtcbiAgaWYgKHN1cHBvcnQuaW5jbHVkZXMoZW1haWwpKSByZXR1cm4gXCJTVVBQT1JUXCI7XG4gIGlmIChyZWFkT25seS5pbmNsdWRlcyhlbWFpbCkpIHJldHVybiBcIlJFQURfT05MWVwiO1xuXG4gIC8vIEJhY2t3YXJkLWNvbXBhdGlibGUgZXNjYXBlIGhhdGNoIGZvciBlYXJseSBkZXBsb3ltZW50cy5cbiAgY29uc3QgbGVnYWN5T3duZXIgPSAocHJvY2Vzcy5lbnYuQURNSU5fRU1BSUwgfHwgXCJzYWdlcmFuc2l0eUBpY2xvdWQuY29tXCIpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICBpZiAoZW1haWwgPT09IGxlZ2FjeU93bmVyKSByZXR1cm4gXCJPV05FUlwiO1xuXG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzUGVybWlzc2lvbihyb2xlOiBBZG1pblJvbGUsIHBlcm1pc3Npb246IEFkbWluUGVybWlzc2lvbikge1xuICBjb25zdCBwZXJtcyA9IFJPTEVfUEVSTUlTU0lPTlNbcm9sZV0gfHwgW107XG4gIHJldHVybiBwZXJtcy5pbmNsdWRlcyhwZXJtaXNzaW9uKTtcbn1cblxuZXhwb3J0IGNsYXNzIEFkbWluUGVybWlzc2lvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBzdGF0dXMgPSA0MDMgYXMgY29uc3Q7XG4gIGNvZGUgPSBcIkFETUlOX0ZPUkJJRERFTlwiIGFzIGNvbnN0O1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gXCJBY2Nlc3MgZGVuaWVkXCIpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufVxuXG4vKipcbiAqIFNlcnZlci1zaWRlIFJCQUMgZ2F0ZS5cbiAqIEZhaWwgY2xvc2VkOiBpZiByb2xlIGlzIG1pc3Npbmcgb3IgcGVybWlzc2lvbiBpcyBub3QgZ3JhbnRlZCwgdGhyb3cuXG4gKlxuICogU3RlcC11cCBhdXRoIHBsYWNlaG9sZGVyOlxuICogLSBJbiBmdXR1cmUsIGVuZm9yY2UgcmVjZW50IGF1dGhlbnRpY2F0aW9uIG9yIGFkZGl0aW9uYWwgdmVyaWZpY2F0aW9uIGhlcmUgKE1GQSkuXG4gKiAtIEZvciBub3csIHRoaXMgaXMgaW50ZW50aW9uYWxseSBhIHN0dWIgdG8gYXZvaWQgcmVmYWN0b3JzIGxhdGVyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVxdWlyZUFkbWluUGVybWlzc2lvbihcbiAgdXNlcjogeyBpZD86IHN0cmluZyB8IG51bGw7IGVtYWlsPzogc3RyaW5nIHwgbnVsbCB9IHwgbnVsbCB8IHVuZGVmaW5lZCxcbiAgcGVybWlzc2lvbjogQWRtaW5QZXJtaXNzaW9uXG4pIHtcbiAgY29uc3Qgcm9sZSA9IGdldEFkbWluUm9sZSh1c2VyKTtcbiAgaWYgKCFyb2xlKSB0aHJvdyBuZXcgQWRtaW5QZXJtaXNzaW9uRXJyb3IoXCJBY2Nlc3MgZGVuaWVkXCIpO1xuICBpZiAoIWhhc1Blcm1pc3Npb24ocm9sZSwgcGVybWlzc2lvbikpIHRocm93IG5ldyBBZG1pblBlcm1pc3Npb25FcnJvcihcIkFjY2VzcyBkZW5pZWRcIik7XG5cbiAgLy8gU3RlcC11cCBhdXRoIHBsYWNlaG9sZGVyOlxuICAvLyBpZiAocGVybWlzc2lvbiA9PT0gXCJNQU5BR0VfQklMTElOR1wiKSB7IGVuZm9yY2VTdGVwVXAodXNlcikgfVxuXG4gIHJldHVybiB7IHJvbGUgfTtcbn1cblxuXG4iXSwibmFtZXMiOlsiQURNSU5fUk9MRVMiLCJpc0FkbWluUm9sZSIsInZhbHVlIiwiaW5jbHVkZXMiLCJBRE1JTl9QRVJNSVNTSU9OUyIsIlJPTEVfUEVSTUlTU0lPTlMiLCJPV05FUiIsIkFETUlOIiwiU1VQUE9SVCIsIlJFQURfT05MWSIsInBhcnNlRW1haWxMaXN0IiwicmF3Iiwic3BsaXQiLCJtYXAiLCJzIiwidHJpbSIsInRvTG93ZXJDYXNlIiwiZmlsdGVyIiwiQm9vbGVhbiIsImdldEFkbWluUm9sZSIsInVzZXIiLCJleHBsaWNpdFJvbGUiLCJhZG1pblJvbGUiLCJlbWFpbCIsIm93bmVycyIsInByb2Nlc3MiLCJlbnYiLCJBRE1JTl9PV05FUl9FTUFJTFMiLCJhZG1pbnMiLCJBRE1JTl9BRE1JTl9FTUFJTFMiLCJzdXBwb3J0IiwiQURNSU5fU1VQUE9SVF9FTUFJTFMiLCJyZWFkT25seSIsIkFETUlOX1JFQURfT05MWV9FTUFJTFMiLCJsZWdhY3lPd25lciIsIkFETUlOX0VNQUlMIiwiaGFzUGVybWlzc2lvbiIsInJvbGUiLCJwZXJtaXNzaW9uIiwicGVybXMiLCJBZG1pblBlcm1pc3Npb25FcnJvciIsIkVycm9yIiwibWVzc2FnZSIsInN0YXR1cyIsImNvZGUiLCJyZXF1aXJlQWRtaW5QZXJtaXNzaW9uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/admin/rbac.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth/adapter.ts":
/*!*********************************!*\
  !*** ./src/lib/auth/adapter.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BetterSqlite3Adapter: () => (/* binding */ BetterSqlite3Adapter)\n/* harmony export */ });\n/* harmony import */ var _lib_auth_store__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/auth/store */ \"(rsc)/./src/lib/auth/store.ts\");\n\n// Minimal NextAuth adapter using better-sqlite3 (no Prisma).\n// Keeps identity server-side and avoids passwords (magic link + OAuth only).\nfunction BetterSqlite3Adapter() {\n    const nowIso = ()=>new Date().toISOString();\n    return {\n        async createUser (user) {\n            const id = user.id || (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.createId)();\n            (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.upsertUser)({\n                id,\n                email: user.email,\n                emailVerified: user.emailVerified ? new Date(user.emailVerified).toISOString() : null,\n                name: user.name || null,\n                image: user.image || null,\n                provider: user.provider || null,\n                entitlements: [\n                    \"free\"\n                ],\n                entitlementSource: \"default\",\n                createdAt: nowIso(),\n                lastLoginAt: nowIso(),\n                tier: \"registered\",\n                consent: {\n                    termsAcceptedAt: null,\n                    privacyAcceptedAt: null,\n                    cpdDataUseAcceptedAt: null\n                }\n            });\n            return {\n                ...user,\n                id\n            };\n        },\n        async getUser (id) {\n            const row = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.getUserById)(id);\n            if (!row) return null;\n            return {\n                id: row.id,\n                email: row.email,\n                emailVerified: row.emailVerified ? new Date(row.emailVerified) : null,\n                name: row.name,\n                image: row.image\n            };\n        },\n        async getUserByEmail (email) {\n            const row = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.getUserByEmail)(email);\n            if (!row) return null;\n            return {\n                id: row.id,\n                email: row.email,\n                emailVerified: row.emailVerified ? new Date(row.emailVerified) : null,\n                name: row.name,\n                image: row.image\n            };\n        },\n        async getUserByAccount ({ provider, providerAccountId }) {\n            const row = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.getUserByAccount)(provider, providerAccountId);\n            if (!row) return null;\n            return {\n                id: row.id,\n                email: row.email,\n                emailVerified: row.emailVerified ? new Date(row.emailVerified) : null,\n                name: row.name,\n                image: row.image\n            };\n        },\n        async updateUser (user) {\n            const existing = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.getUserById)(user.id);\n            if (!existing) return user;\n            const updated = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.upsertUser)({\n                id: user.id,\n                email: user.email ?? existing.email,\n                emailVerified: user.emailVerified !== undefined ? user.emailVerified ? new Date(user.emailVerified).toISOString() : null : existing.emailVerified,\n                name: user.name !== undefined ? user.name : existing.name,\n                image: user.image !== undefined ? user.image : existing.image,\n                provider: existing.provider,\n                entitlements: Array.isArray(existing.entitlements) && existing.entitlements.length ? existing.entitlements : [\n                    \"free\"\n                ],\n                entitlementSource: existing.entitlementSource || \"default\",\n                createdAt: existing.createdAt,\n                lastLoginAt: existing.lastLoginAt ?? null,\n                tier: existing.tier || \"registered\",\n                consent: existing.consent || {\n                    termsAcceptedAt: null,\n                    privacyAcceptedAt: null,\n                    cpdDataUseAcceptedAt: null\n                }\n            });\n            return {\n                id: updated.id,\n                email: updated.email,\n                emailVerified: updated.emailVerified ? new Date(updated.emailVerified) : null,\n                name: updated.name,\n                image: updated.image\n            };\n        },\n        async deleteUser (userId) {\n            (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.deleteUser)(userId);\n        },\n        async linkAccount (account) {\n            const rec = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.linkAccount)({\n                userId: account.userId,\n                type: account.type,\n                provider: account.provider,\n                providerAccountId: account.providerAccountId,\n                refresh_token: account.refresh_token || null,\n                access_token: account.access_token || null,\n                expires_at: account.expires_at || null,\n                token_type: account.token_type || null,\n                scope: account.scope || null,\n                id_token: account.id_token || null,\n                session_state: account.session_state || null\n            });\n            return {\n                ...account,\n                id: rec.id\n            };\n        },\n        async unlinkAccount ({ provider, providerAccountId }) {\n            (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.unlinkAccount)(provider, providerAccountId);\n        },\n        async createSession (session) {\n            const rec = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.createSession)({\n                sessionToken: session.sessionToken,\n                userId: session.userId,\n                expires: session.expires.toISOString()\n            });\n            return {\n                sessionToken: rec.sessionToken,\n                userId: rec.userId,\n                expires: new Date(rec.expires)\n            };\n        },\n        async getSessionAndUser (sessionToken) {\n            const result = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.getSessionAndUser)(sessionToken);\n            if (!result) return null;\n            const { session, user } = result;\n            return {\n                session: {\n                    sessionToken: session.sessionToken,\n                    userId: session.userId,\n                    expires: new Date(session.expires)\n                },\n                user: {\n                    id: user.id,\n                    email: user.email,\n                    emailVerified: user.emailVerified ? new Date(user.emailVerified) : null,\n                    name: user.name,\n                    image: user.image\n                }\n            };\n        },\n        async updateSession (session) {\n            const updated = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.updateSession)(session.sessionToken, {\n                expires: session.expires ? session.expires.toISOString() : undefined\n            });\n            if (!updated) return null;\n            return {\n                sessionToken: updated.sessionToken,\n                userId: updated.userId,\n                expires: new Date(updated.expires)\n            };\n        },\n        async deleteSession (sessionToken) {\n            (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.deleteSession)(sessionToken);\n        },\n        async createVerificationToken (token) {\n            return (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.createVerificationToken)({\n                identifier: token.identifier,\n                token: token.token,\n                expires: token.expires.toISOString()\n            });\n        },\n        async useVerificationToken ({ identifier, token }) {\n            const row = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_0__.useVerificationToken)(identifier, token);\n            if (!row) return null;\n            return {\n                identifier: row.identifier,\n                token: row.token,\n                expires: new Date(row.expires)\n            };\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtHLEtBQUtHLGFBQWEsSUFBSTtvQkFDbkVDLE1BQU1KLEtBQUtJLElBQUk7b0JBQ2ZDLE9BQU9MLEtBQUtLLEtBQUs7Z0JBQ25CO1lBQ0Y7UUFDRjtRQUVBLE1BQU1oQixlQUFjZ0QsT0FBTztZQUN6QixNQUFNaEIsVUFBVS9CLDhEQUFrQkEsQ0FBQytDLFFBQVFDLFlBQVksRUFBRTtnQkFDdkRDLFNBQVNGLFFBQVFFLE9BQU8sR0FBR0YsUUFBUUUsT0FBTyxDQUFDekMsV0FBVyxLQUFLd0I7WUFDN0Q7WUFDQSxJQUFJLENBQUNELFNBQVMsT0FBTztZQUNyQixPQUFPO2dCQUFFaUIsY0FBY2pCLFFBQVFpQixZQUFZO2dCQUFFWixRQUFRTCxRQUFRSyxNQUFNO2dCQUFFYSxTQUFTLElBQUkxQyxLQUFLd0IsUUFBUWtCLE9BQU87WUFBRTtRQUMxRztRQUVBLE1BQU1sRSxlQUFjaUUsWUFBWTtZQUM5QmhFLDhEQUFrQkEsQ0FBQ2dFO1FBQ3JCO1FBRUEsTUFBTW5FLHlCQUF3QnNFLEtBQUs7WUFDakMsT0FBT3JFLHdFQUE0QkEsQ0FBQztnQkFDbENzRSxZQUFZRCxNQUFNQyxVQUFVO2dCQUM1QkQsT0FBT0EsTUFBTUEsS0FBSztnQkFDbEJGLFNBQVNFLE1BQU1GLE9BQU8sQ0FBQ3pDLFdBQVc7WUFDcEM7UUFDRjtRQUVBLE1BQU1MLHNCQUFxQixFQUFFaUQsVUFBVSxFQUFFRCxLQUFLLEVBQUU7WUFDOUMsTUFBTXhCLE1BQU12QixxRUFBeUJBLENBQUNnRCxZQUFZRDtZQUNsRCxJQUFJLENBQUN4QixLQUFLLE9BQU87WUFDakIsT0FBTztnQkFBRXlCLFlBQVl6QixJQUFJeUIsVUFBVTtnQkFBRUQsT0FBT3hCLElBQUl3QixLQUFLO2dCQUFFRixTQUFTLElBQUkxQyxLQUFLb0IsSUFBSXNCLE9BQU87WUFBRTtRQUN4RjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL2xpYi9hdXRoL2FkYXB0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBBZGFwdGVyIH0gZnJvbSBcIm5leHQtYXV0aC9hZGFwdGVyc1wiO1xuaW1wb3J0IHtcbiAgY3JlYXRlSWQsXG4gIGNyZWF0ZVNlc3Npb24gYXMgc3RvcmVDcmVhdGVTZXNzaW9uLFxuICBjcmVhdGVWZXJpZmljYXRpb25Ub2tlbiBhcyBzdG9yZUNyZWF0ZVZlcmlmaWNhdGlvblRva2VuLFxuICBkZWxldGVTZXNzaW9uIGFzIHN0b3JlRGVsZXRlU2Vzc2lvbixcbiAgZGVsZXRlVXNlciBhcyBzdG9yZURlbGV0ZVVzZXIsXG4gIGdldFNlc3Npb25BbmRVc2VyIGFzIHN0b3JlR2V0U2Vzc2lvbkFuZFVzZXIsXG4gIGdldFVzZXJCeUFjY291bnQgYXMgc3RvcmVHZXRVc2VyQnlBY2NvdW50LFxuICBnZXRVc2VyQnlFbWFpbCBhcyBzdG9yZUdldFVzZXJCeUVtYWlsLFxuICBnZXRVc2VyQnlJZCBhcyBzdG9yZUdldFVzZXJCeUlkLFxuICBsaW5rQWNjb3VudCBhcyBzdG9yZUxpbmtBY2NvdW50LFxuICB1bmxpbmtBY2NvdW50IGFzIHN0b3JlVW5saW5rQWNjb3VudCxcbiAgdXBkYXRlU2Vzc2lvbiBhcyBzdG9yZVVwZGF0ZVNlc3Npb24sXG4gIHVwc2VydFVzZXIgYXMgc3RvcmVVcHNlcnRVc2VyLFxuICB1c2VWZXJpZmljYXRpb25Ub2tlbiBhcyBzdG9yZVVzZVZlcmlmaWNhdGlvblRva2VuLFxufSBmcm9tIFwiQC9saWIvYXV0aC9zdG9yZVwiO1xuXG4vLyBNaW5pbWFsIE5leHRBdXRoIGFkYXB0ZXIgdXNpbmcgYmV0dGVyLXNxbGl0ZTMgKG5vIFByaXNtYSkuXG4vLyBLZWVwcyBpZGVudGl0eSBzZXJ2ZXItc2lkZSBhbmQgYXZvaWRzIHBhc3N3b3JkcyAobWFnaWMgbGluayArIE9BdXRoIG9ubHkpLlxuXG5leHBvcnQgZnVuY3Rpb24gQmV0dGVyU3FsaXRlM0FkYXB0ZXIoKTogQWRhcHRlciB7XG4gIGNvbnN0IG5vd0lzbyA9ICgpID0+IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcblxuICByZXR1cm4ge1xuICAgIGFzeW5jIGNyZWF0ZVVzZXIodXNlcikge1xuICAgICAgY29uc3QgaWQgPSB1c2VyLmlkIHx8IGNyZWF0ZUlkKCk7XG4gICAgICBzdG9yZVVwc2VydFVzZXIoe1xuICAgICAgICBpZCxcbiAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCA/IG5ldyBEYXRlKHVzZXIuZW1haWxWZXJpZmllZCkudG9JU09TdHJpbmcoKSA6IG51bGwsXG4gICAgICAgIG5hbWU6IHVzZXIubmFtZSB8fCBudWxsLFxuICAgICAgICBpbWFnZTogdXNlci5pbWFnZSB8fCBudWxsLFxuICAgICAgICBwcm92aWRlcjogKHVzZXIgYXMgYW55KS5wcm92aWRlciB8fCBudWxsLFxuICAgICAgICBlbnRpdGxlbWVudHM6IFtcImZyZWVcIl0sXG4gICAgICAgIGVudGl0bGVtZW50U291cmNlOiBcImRlZmF1bHRcIixcbiAgICAgICAgY3JlYXRlZEF0OiBub3dJc28oKSxcbiAgICAgICAgbGFzdExvZ2luQXQ6IG5vd0lzbygpLFxuICAgICAgICB0aWVyOiBcInJlZ2lzdGVyZWRcIixcbiAgICAgICAgY29uc2VudDogeyB0ZXJtc0FjY2VwdGVkQXQ6IG51bGwsIHByaXZhY3lBY2NlcHRlZEF0OiBudWxsLCBjcGREYXRhVXNlQWNjZXB0ZWRBdDogbnVsbCB9LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4geyAuLi51c2VyLCBpZCB9O1xuICAgIH0sXG5cbiAgICBhc3luYyBnZXRVc2VyKGlkKSB7XG4gICAgICBjb25zdCByb3cgPSBzdG9yZUdldFVzZXJCeUlkKGlkKTtcbiAgICAgIGlmICghcm93KSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiB7IGlkOiByb3cuaWQsIGVtYWlsOiByb3cuZW1haWwsIGVtYWlsVmVyaWZpZWQ6IHJvdy5lbWFpbFZlcmlmaWVkID8gbmV3IERhdGUocm93LmVtYWlsVmVyaWZpZWQpIDogbnVsbCwgbmFtZTogcm93Lm5hbWUsIGltYWdlOiByb3cuaW1hZ2UgfSBhcyBhbnk7XG4gICAgfSxcblxuICAgIGFzeW5jIGdldFVzZXJCeUVtYWlsKGVtYWlsKSB7XG4gICAgICBjb25zdCByb3cgPSBzdG9yZUdldFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICAgIGlmICghcm93KSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiB7IGlkOiByb3cuaWQsIGVtYWlsOiByb3cuZW1haWwsIGVtYWlsVmVyaWZpZWQ6IHJvdy5lbWFpbFZlcmlmaWVkID8gbmV3IERhdGUocm93LmVtYWlsVmVyaWZpZWQpIDogbnVsbCwgbmFtZTogcm93Lm5hbWUsIGltYWdlOiByb3cuaW1hZ2UgfSBhcyBhbnk7XG4gICAgfSxcblxuICAgIGFzeW5jIGdldFVzZXJCeUFjY291bnQoeyBwcm92aWRlciwgcHJvdmlkZXJBY2NvdW50SWQgfSkge1xuICAgICAgY29uc3Qgcm93ID0gc3RvcmVHZXRVc2VyQnlBY2NvdW50KHByb3ZpZGVyLCBwcm92aWRlckFjY291bnRJZCk7XG4gICAgICBpZiAoIXJvdykgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4geyBpZDogcm93LmlkLCBlbWFpbDogcm93LmVtYWlsLCBlbWFpbFZlcmlmaWVkOiByb3cuZW1haWxWZXJpZmllZCA/IG5ldyBEYXRlKHJvdy5lbWFpbFZlcmlmaWVkKSA6IG51bGwsIG5hbWU6IHJvdy5uYW1lLCBpbWFnZTogcm93LmltYWdlIH0gYXMgYW55O1xuICAgIH0sXG5cbiAgICBhc3luYyB1cGRhdGVVc2VyKHVzZXIpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gc3RvcmVHZXRVc2VyQnlJZCh1c2VyLmlkKTtcbiAgICAgIGlmICghZXhpc3RpbmcpIHJldHVybiB1c2VyIGFzIGFueTtcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBzdG9yZVVwc2VydFVzZXIoe1xuICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgZW1haWw6ICh1c2VyIGFzIGFueSkuZW1haWwgPz8gZXhpc3RpbmcuZW1haWwsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6XG4gICAgICAgICAgKHVzZXIgYXMgYW55KS5lbWFpbFZlcmlmaWVkICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgID8gKHVzZXIgYXMgYW55KS5lbWFpbFZlcmlmaWVkXG4gICAgICAgICAgICAgID8gbmV3IERhdGUoKHVzZXIgYXMgYW55KS5lbWFpbFZlcmlmaWVkKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgICAgOiBleGlzdGluZy5lbWFpbFZlcmlmaWVkLFxuICAgICAgICBuYW1lOiAodXNlciBhcyBhbnkpLm5hbWUgIT09IHVuZGVmaW5lZCA/ICh1c2VyIGFzIGFueSkubmFtZSA6IGV4aXN0aW5nLm5hbWUsXG4gICAgICAgIGltYWdlOiAodXNlciBhcyBhbnkpLmltYWdlICE9PSB1bmRlZmluZWQgPyAodXNlciBhcyBhbnkpLmltYWdlIDogZXhpc3RpbmcuaW1hZ2UsXG4gICAgICAgIHByb3ZpZGVyOiBleGlzdGluZy5wcm92aWRlcixcbiAgICAgICAgZW50aXRsZW1lbnRzOiBBcnJheS5pc0FycmF5KChleGlzdGluZyBhcyBhbnkpLmVudGl0bGVtZW50cykgJiYgKGV4aXN0aW5nIGFzIGFueSkuZW50aXRsZW1lbnRzLmxlbmd0aCA/IChleGlzdGluZyBhcyBhbnkpLmVudGl0bGVtZW50cyA6IFtcImZyZWVcIl0sXG4gICAgICAgIGVudGl0bGVtZW50U291cmNlOiAoZXhpc3RpbmcgYXMgYW55KS5lbnRpdGxlbWVudFNvdXJjZSB8fCBcImRlZmF1bHRcIixcbiAgICAgICAgY3JlYXRlZEF0OiBleGlzdGluZy5jcmVhdGVkQXQsXG4gICAgICAgIGxhc3RMb2dpbkF0OiAoZXhpc3RpbmcgYXMgYW55KS5sYXN0TG9naW5BdCA/PyBudWxsLFxuICAgICAgICB0aWVyOiAoZXhpc3RpbmcgYXMgYW55KS50aWVyIHx8IFwicmVnaXN0ZXJlZFwiLFxuICAgICAgICBjb25zZW50OiAoZXhpc3RpbmcgYXMgYW55KS5jb25zZW50IHx8IHsgdGVybXNBY2NlcHRlZEF0OiBudWxsLCBwcml2YWN5QWNjZXB0ZWRBdDogbnVsbCwgY3BkRGF0YVVzZUFjY2VwdGVkQXQ6IG51bGwgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHsgaWQ6IHVwZGF0ZWQuaWQsIGVtYWlsOiB1cGRhdGVkLmVtYWlsLCBlbWFpbFZlcmlmaWVkOiB1cGRhdGVkLmVtYWlsVmVyaWZpZWQgPyBuZXcgRGF0ZSh1cGRhdGVkLmVtYWlsVmVyaWZpZWQpIDogbnVsbCwgbmFtZTogdXBkYXRlZC5uYW1lLCBpbWFnZTogdXBkYXRlZC5pbWFnZSB9IGFzIGFueTtcbiAgICB9LFxuXG4gICAgYXN5bmMgZGVsZXRlVXNlcih1c2VySWQpIHtcbiAgICAgIHN0b3JlRGVsZXRlVXNlcih1c2VySWQpO1xuICAgIH0sXG5cbiAgICBhc3luYyBsaW5rQWNjb3VudChhY2NvdW50KSB7XG4gICAgICBjb25zdCByZWMgPSBzdG9yZUxpbmtBY2NvdW50KHtcbiAgICAgICAgdXNlcklkOiBhY2NvdW50LnVzZXJJZCxcbiAgICAgICAgdHlwZTogYWNjb3VudC50eXBlLFxuICAgICAgICBwcm92aWRlcjogYWNjb3VudC5wcm92aWRlcixcbiAgICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IGFjY291bnQucHJvdmlkZXJBY2NvdW50SWQsXG4gICAgICAgIHJlZnJlc2hfdG9rZW46IGFjY291bnQucmVmcmVzaF90b2tlbiB8fCBudWxsLFxuICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY291bnQuYWNjZXNzX3Rva2VuIHx8IG51bGwsXG4gICAgICAgIGV4cGlyZXNfYXQ6IGFjY291bnQuZXhwaXJlc19hdCB8fCBudWxsLFxuICAgICAgICB0b2tlbl90eXBlOiBhY2NvdW50LnRva2VuX3R5cGUgfHwgbnVsbCxcbiAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGUgfHwgbnVsbCxcbiAgICAgICAgaWRfdG9rZW46IGFjY291bnQuaWRfdG9rZW4gfHwgbnVsbCxcbiAgICAgICAgc2Vzc2lvbl9zdGF0ZTogYWNjb3VudC5zZXNzaW9uX3N0YXRlIHx8IG51bGwsXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7IC4uLmFjY291bnQsIGlkOiByZWMuaWQgfSBhcyBhbnk7XG4gICAgfSxcblxuICAgIGFzeW5jIHVubGlua0FjY291bnQoeyBwcm92aWRlciwgcHJvdmlkZXJBY2NvdW50SWQgfSkge1xuICAgICAgc3RvcmVVbmxpbmtBY2NvdW50KHByb3ZpZGVyLCBwcm92aWRlckFjY291bnRJZCk7XG4gICAgfSxcblxuICAgIGFzeW5jIGNyZWF0ZVNlc3Npb24oc2Vzc2lvbikge1xuICAgICAgY29uc3QgcmVjID0gc3RvcmVDcmVhdGVTZXNzaW9uKHtcbiAgICAgICAgc2Vzc2lvblRva2VuOiBzZXNzaW9uLnNlc3Npb25Ub2tlbixcbiAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgZXhwaXJlczogc2Vzc2lvbi5leHBpcmVzLnRvSVNPU3RyaW5nKCksXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7IHNlc3Npb25Ub2tlbjogcmVjLnNlc3Npb25Ub2tlbiwgdXNlcklkOiByZWMudXNlcklkLCBleHBpcmVzOiBuZXcgRGF0ZShyZWMuZXhwaXJlcykgfSBhcyBhbnk7XG4gICAgfSxcblxuICAgIGFzeW5jIGdldFNlc3Npb25BbmRVc2VyKHNlc3Npb25Ub2tlbikge1xuICAgICAgY29uc3QgcmVzdWx0ID0gc3RvcmVHZXRTZXNzaW9uQW5kVXNlcihzZXNzaW9uVG9rZW4pO1xuICAgICAgaWYgKCFyZXN1bHQpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgeyBzZXNzaW9uLCB1c2VyIH0gPSByZXN1bHQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZXNzaW9uOiB7IHNlc3Npb25Ub2tlbjogc2Vzc2lvbi5zZXNzaW9uVG9rZW4sIHVzZXJJZDogc2Vzc2lvbi51c2VySWQsIGV4cGlyZXM6IG5ldyBEYXRlKHNlc3Npb24uZXhwaXJlcykgfSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxWZXJpZmllZCA/IG5ldyBEYXRlKHVzZXIuZW1haWxWZXJpZmllZCkgOiBudWxsLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBpbWFnZTogdXNlci5pbWFnZSxcbiAgICAgICAgfSxcbiAgICAgIH0gYXMgYW55O1xuICAgIH0sXG5cbiAgICBhc3luYyB1cGRhdGVTZXNzaW9uKHNlc3Npb24pIHtcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBzdG9yZVVwZGF0ZVNlc3Npb24oc2Vzc2lvbi5zZXNzaW9uVG9rZW4sIHtcbiAgICAgICAgZXhwaXJlczogc2Vzc2lvbi5leHBpcmVzID8gc2Vzc2lvbi5leHBpcmVzLnRvSVNPU3RyaW5nKCkgOiB1bmRlZmluZWQsXG4gICAgICB9KTtcbiAgICAgIGlmICghdXBkYXRlZCkgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4geyBzZXNzaW9uVG9rZW46IHVwZGF0ZWQuc2Vzc2lvblRva2VuLCB1c2VySWQ6IHVwZGF0ZWQudXNlcklkLCBleHBpcmVzOiBuZXcgRGF0ZSh1cGRhdGVkLmV4cGlyZXMpIH0gYXMgYW55O1xuICAgIH0sXG5cbiAgICBhc3luYyBkZWxldGVTZXNzaW9uKHNlc3Npb25Ub2tlbikge1xuICAgICAgc3RvcmVEZWxldGVTZXNzaW9uKHNlc3Npb25Ub2tlbik7XG4gICAgfSxcblxuICAgIGFzeW5jIGNyZWF0ZVZlcmlmaWNhdGlvblRva2VuKHRva2VuKSB7XG4gICAgICByZXR1cm4gc3RvcmVDcmVhdGVWZXJpZmljYXRpb25Ub2tlbih7XG4gICAgICAgIGlkZW50aWZpZXI6IHRva2VuLmlkZW50aWZpZXIsXG4gICAgICAgIHRva2VuOiB0b2tlbi50b2tlbixcbiAgICAgICAgZXhwaXJlczogdG9rZW4uZXhwaXJlcy50b0lTT1N0cmluZygpLFxuICAgICAgfSkgYXMgYW55O1xuICAgIH0sXG5cbiAgICBhc3luYyB1c2VWZXJpZmljYXRpb25Ub2tlbih7IGlkZW50aWZpZXIsIHRva2VuIH0pIHtcbiAgICAgIGNvbnN0IHJvdyA9IHN0b3JlVXNlVmVyaWZpY2F0aW9uVG9rZW4oaWRlbnRpZmllciwgdG9rZW4pO1xuICAgICAgaWYgKCFyb3cpIHJldHVybiBudWxsO1xuICAgICAgcmV0dXJuIHsgaWRlbnRpZmllcjogcm93LmlkZW50aWZpZXIsIHRva2VuOiByb3cudG9rZW4sIGV4cGlyZXM6IG5ldyBEYXRlKHJvdy5leHBpcmVzKSB9IGFzIGFueTtcbiAgICB9LFxuICB9O1xufVxuXG5cbiJdLCJuYW1lcyI6WyJjcmVhdGVJZCIsImNyZWF0ZVNlc3Npb24iLCJzdG9yZUNyZWF0ZVNlc3Npb24iLCJjcmVhdGVWZXJpZmljYXRpb25Ub2tlbiIsInN0b3JlQ3JlYXRlVmVyaWZpY2F0aW9uVG9rZW4iLCJkZWxldGVTZXNzaW9uIiwic3RvcmVEZWxldGVTZXNzaW9uIiwiZGVsZXRlVXNlciIsInN0b3JlRGVsZXRlVXNlciIsImdldFNlc3Npb25BbmRVc2VyIiwic3RvcmVHZXRTZXNzaW9uQW5kVXNlciIsImdldFVzZXJCeUFjY291bnQiLCJzdG9yZUdldFVzZXJCeUFjY291bnQiLCJnZXRVc2VyQnlFbWFpbCIsInN0b3JlR2V0VXNlckJ5RW1haWwiLCJnZXRVc2VyQnlJZCIsInN0b3JlR2V0VXNlckJ5SWQiLCJsaW5rQWNjb3VudCIsInN0b3JlTGlua0FjY291bnQiLCJ1bmxpbmtBY2NvdW50Iiwic3RvcmVVbmxpbmtBY2NvdW50IiwidXBkYXRlU2Vzc2lvbiIsInN0b3JlVXBkYXRlU2Vzc2lvbiIsInVwc2VydFVzZXIiLCJzdG9yZVVwc2VydFVzZXIiLCJ1c2VWZXJpZmljYXRpb25Ub2tlbiIsInN0b3JlVXNlVmVyaWZpY2F0aW9uVG9rZW4iLCJCZXR0ZXJTcWxpdGUzQWRhcHRlciIsIm5vd0lzbyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImNyZWF0ZVVzZXIiLCJ1c2VyIiwiaWQiLCJlbWFpbCIsImVtYWlsVmVyaWZpZWQiLCJuYW1lIiwiaW1hZ2UiLCJwcm92aWRlciIsImVudGl0bGVtZW50cyIsImVudGl0bGVtZW50U291cmNlIiwiY3JlYXRlZEF0IiwibGFzdExvZ2luQXQiLCJ0aWVyIiwiY29uc2VudCIsInRlcm1zQWNjZXB0ZWRBdCIsInByaXZhY3lBY2NlcHRlZEF0IiwiY3BkRGF0YVVzZUFjY2VwdGVkQXQiLCJnZXRVc2VyIiwicm93IiwicHJvdmlkZXJBY2NvdW50SWQiLCJ1cGRhdGVVc2VyIiwiZXhpc3RpbmciLCJ1cGRhdGVkIiwidW5kZWZpbmVkIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwidXNlcklkIiwiYWNjb3VudCIsInJlYyIsInR5cGUiLCJyZWZyZXNoX3Rva2VuIiwiYWNjZXNzX3Rva2VuIiwiZXhwaXJlc19hdCIsInRva2VuX3R5cGUiLCJzY29wZSIsImlkX3Rva2VuIiwic2Vzc2lvbl9zdGF0ZSIsInNlc3Npb24iLCJzZXNzaW9uVG9rZW4iLCJleHBpcmVzIiwicmVzdWx0IiwidG9rZW4iLCJpZGVudGlmaWVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth/adapter.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth/env.ts":
/*!*****************************!*\
  !*** ./src/lib/auth/env.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ensureNextAuthUrl: () => (/* binding */ ensureNextAuthUrl),\n/* harmony export */   getAuthEnvStatus: () => (/* binding */ getAuthEnvStatus),\n/* harmony export */   logAuthEnvIfMisconfigured: () => (/* binding */ logAuthEnvIfMisconfigured)\n/* harmony export */ });\nfunction getBaseUrlFallback() {\n    const explicit = (process.env.NEXT_PUBLIC_SITE_URL || \"\").trim();\n    if (explicit) return explicit;\n    const vercel = (process.env.VERCEL_URL || \"\").trim();\n    if (vercel) return vercel.startsWith(\"http\") ? vercel : `https://${vercel}`;\n    return \"\";\n}\n/**\n * Best-effort compatibility:\n * - Prefer NEXTAUTH_URL (canonical).\n * - If absent, use NEXT_PUBLIC_SITE_URL or VERCEL_URL so OAuth callbacks can still work.\n */ function ensureNextAuthUrl() {\n    if (process.env.NEXTAUTH_URL) return;\n    const fallback = getBaseUrlFallback();\n    if (fallback) process.env.NEXTAUTH_URL = fallback;\n}\nfunction getAuthEnvStatus() {\n    const missing = [];\n    // NextAuth v4 canonical env names.\n    // Allow a fallback so production doesn't \"look broken\" when only NEXT_PUBLIC_SITE_URL/VERCEL_URL is set.\n    // Still recommend setting NEXTAUTH_URL explicitly.\n    if (!process.env.NEXTAUTH_URL && !getBaseUrlFallback()) missing.push(\"NEXTAUTH_URL\");\n    if (!process.env.NEXTAUTH_SECRET) missing.push(\"NEXTAUTH_SECRET\");\n    // Provider env vars (only required when you want sign-in enabled).\n    const hasGoogle = Boolean(process.env.GOOGLE_CLIENT_ID || process.env.GOOGLE_CLIENT_SECRET);\n    if (hasGoogle) {\n        if (!process.env.GOOGLE_CLIENT_ID) missing.push(\"GOOGLE_CLIENT_ID\");\n        if (!process.env.GOOGLE_CLIENT_SECRET) missing.push(\"GOOGLE_CLIENT_SECRET\");\n    }\n    // Email magic link provider (optional). Enable only when fully configured.\n    const hasEmail = Boolean(process.env.EMAIL_SERVER || process.env.EMAIL_FROM);\n    if (hasEmail) {\n        if (!process.env.EMAIL_SERVER) missing.push(\"EMAIL_SERVER\");\n        if (!process.env.EMAIL_FROM) missing.push(\"EMAIL_FROM\");\n    }\n    return {\n        ok: missing.length === 0,\n        missing\n    };\n}\nfunction logAuthEnvIfMisconfigured(context) {\n    const status = getAuthEnvStatus();\n    if (status.ok) return;\n    // Server logs only. Do not print values.\n    console.error(`auth:misconfigured ${context} missing=${status.missing.join(\",\")}`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgvZW52LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUtBLFNBQVNBO0lBQ1AsTUFBTUMsV0FBVyxDQUFDQyxRQUFRQyxHQUFHLENBQUNDLG9CQUFvQixJQUFJLEVBQUMsRUFBR0MsSUFBSTtJQUM5RCxJQUFJSixVQUFVLE9BQU9BO0lBQ3JCLE1BQU1LLFNBQVMsQ0FBQ0osUUFBUUMsR0FBRyxDQUFDSSxVQUFVLElBQUksRUFBQyxFQUFHRixJQUFJO0lBQ2xELElBQUlDLFFBQVEsT0FBT0EsT0FBT0UsVUFBVSxDQUFDLFVBQVVGLFNBQVMsQ0FBQyxRQUFRLEVBQUVBLFFBQVE7SUFDM0UsT0FBTztBQUNUO0FBRUE7Ozs7Q0FJQyxHQUNNLFNBQVNHO0lBQ2QsSUFBSVAsUUFBUUMsR0FBRyxDQUFDTyxZQUFZLEVBQUU7SUFDOUIsTUFBTUMsV0FBV1g7SUFDakIsSUFBSVcsVUFBVVQsUUFBUUMsR0FBRyxDQUFDTyxZQUFZLEdBQUdDO0FBQzNDO0FBRU8sU0FBU0M7SUFDZCxNQUFNQyxVQUFvQixFQUFFO0lBRTVCLG1DQUFtQztJQUNuQyx5R0FBeUc7SUFDekcsbURBQW1EO0lBQ25ELElBQUksQ0FBQ1gsUUFBUUMsR0FBRyxDQUFDTyxZQUFZLElBQUksQ0FBQ1Ysc0JBQXNCYSxRQUFRQyxJQUFJLENBQUM7SUFDckUsSUFBSSxDQUFDWixRQUFRQyxHQUFHLENBQUNZLGVBQWUsRUFBRUYsUUFBUUMsSUFBSSxDQUFDO0lBRS9DLG1FQUFtRTtJQUNuRSxNQUFNRSxZQUFZQyxRQUFRZixRQUFRQyxHQUFHLENBQUNlLGdCQUFnQixJQUFJaEIsUUFBUUMsR0FBRyxDQUFDZ0Isb0JBQW9CO0lBQzFGLElBQUlILFdBQVc7UUFDYixJQUFJLENBQUNkLFFBQVFDLEdBQUcsQ0FBQ2UsZ0JBQWdCLEVBQUVMLFFBQVFDLElBQUksQ0FBQztRQUNoRCxJQUFJLENBQUNaLFFBQVFDLEdBQUcsQ0FBQ2dCLG9CQUFvQixFQUFFTixRQUFRQyxJQUFJLENBQUM7SUFDdEQ7SUFFQSwyRUFBMkU7SUFDM0UsTUFBTU0sV0FBV0gsUUFBUWYsUUFBUUMsR0FBRyxDQUFDa0IsWUFBWSxJQUFJbkIsUUFBUUMsR0FBRyxDQUFDbUIsVUFBVTtJQUMzRSxJQUFJRixVQUFVO1FBQ1osSUFBSSxDQUFDbEIsUUFBUUMsR0FBRyxDQUFDa0IsWUFBWSxFQUFFUixRQUFRQyxJQUFJLENBQUM7UUFDNUMsSUFBSSxDQUFDWixRQUFRQyxHQUFHLENBQUNtQixVQUFVLEVBQUVULFFBQVFDLElBQUksQ0FBQztJQUM1QztJQUVBLE9BQU87UUFBRVMsSUFBSVYsUUFBUVcsTUFBTSxLQUFLO1FBQUdYO0lBQVE7QUFDN0M7QUFFTyxTQUFTWSwwQkFBMEJDLE9BQWU7SUFDdkQsTUFBTUMsU0FBU2Y7SUFDZixJQUFJZSxPQUFPSixFQUFFLEVBQUU7SUFDZix5Q0FBeUM7SUFDekNLLFFBQVFDLEtBQUssQ0FBQyxDQUFDLG1CQUFtQixFQUFFSCxRQUFRLFNBQVMsRUFBRUMsT0FBT2QsT0FBTyxDQUFDaUIsSUFBSSxDQUFDLE1BQU07QUFDbkYiLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL2xpYi9hdXRoL2Vudi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBBdXRoRW52U3RhdHVzID0ge1xuICBvazogYm9vbGVhbjtcbiAgbWlzc2luZzogc3RyaW5nW107XG59O1xuXG5mdW5jdGlvbiBnZXRCYXNlVXJsRmFsbGJhY2soKSB7XG4gIGNvbnN0IGV4cGxpY2l0ID0gKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NJVEVfVVJMIHx8IFwiXCIpLnRyaW0oKTtcbiAgaWYgKGV4cGxpY2l0KSByZXR1cm4gZXhwbGljaXQ7XG4gIGNvbnN0IHZlcmNlbCA9IChwcm9jZXNzLmVudi5WRVJDRUxfVVJMIHx8IFwiXCIpLnRyaW0oKTtcbiAgaWYgKHZlcmNlbCkgcmV0dXJuIHZlcmNlbC5zdGFydHNXaXRoKFwiaHR0cFwiKSA/IHZlcmNlbCA6IGBodHRwczovLyR7dmVyY2VsfWA7XG4gIHJldHVybiBcIlwiO1xufVxuXG4vKipcbiAqIEJlc3QtZWZmb3J0IGNvbXBhdGliaWxpdHk6XG4gKiAtIFByZWZlciBORVhUQVVUSF9VUkwgKGNhbm9uaWNhbCkuXG4gKiAtIElmIGFic2VudCwgdXNlIE5FWFRfUFVCTElDX1NJVEVfVVJMIG9yIFZFUkNFTF9VUkwgc28gT0F1dGggY2FsbGJhY2tzIGNhbiBzdGlsbCB3b3JrLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlTmV4dEF1dGhVcmwoKSB7XG4gIGlmIChwcm9jZXNzLmVudi5ORVhUQVVUSF9VUkwpIHJldHVybjtcbiAgY29uc3QgZmFsbGJhY2sgPSBnZXRCYXNlVXJsRmFsbGJhY2soKTtcbiAgaWYgKGZhbGxiYWNrKSBwcm9jZXNzLmVudi5ORVhUQVVUSF9VUkwgPSBmYWxsYmFjaztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEF1dGhFbnZTdGF0dXMoKTogQXV0aEVudlN0YXR1cyB7XG4gIGNvbnN0IG1pc3Npbmc6IHN0cmluZ1tdID0gW107XG5cbiAgLy8gTmV4dEF1dGggdjQgY2Fub25pY2FsIGVudiBuYW1lcy5cbiAgLy8gQWxsb3cgYSBmYWxsYmFjayBzbyBwcm9kdWN0aW9uIGRvZXNuJ3QgXCJsb29rIGJyb2tlblwiIHdoZW4gb25seSBORVhUX1BVQkxJQ19TSVRFX1VSTC9WRVJDRUxfVVJMIGlzIHNldC5cbiAgLy8gU3RpbGwgcmVjb21tZW5kIHNldHRpbmcgTkVYVEFVVEhfVVJMIGV4cGxpY2l0bHkuXG4gIGlmICghcHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMICYmICFnZXRCYXNlVXJsRmFsbGJhY2soKSkgbWlzc2luZy5wdXNoKFwiTkVYVEFVVEhfVVJMXCIpO1xuICBpZiAoIXByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCkgbWlzc2luZy5wdXNoKFwiTkVYVEFVVEhfU0VDUkVUXCIpO1xuXG4gIC8vIFByb3ZpZGVyIGVudiB2YXJzIChvbmx5IHJlcXVpcmVkIHdoZW4geW91IHdhbnQgc2lnbi1pbiBlbmFibGVkKS5cbiAgY29uc3QgaGFzR29vZ2xlID0gQm9vbGVhbihwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lEIHx8IHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfU0VDUkVUKTtcbiAgaWYgKGhhc0dvb2dsZSkge1xuICAgIGlmICghcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCkgbWlzc2luZy5wdXNoKFwiR09PR0xFX0NMSUVOVF9JRFwiKTtcbiAgICBpZiAoIXByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfU0VDUkVUKSBtaXNzaW5nLnB1c2goXCJHT09HTEVfQ0xJRU5UX1NFQ1JFVFwiKTtcbiAgfVxuXG4gIC8vIEVtYWlsIG1hZ2ljIGxpbmsgcHJvdmlkZXIgKG9wdGlvbmFsKS4gRW5hYmxlIG9ubHkgd2hlbiBmdWxseSBjb25maWd1cmVkLlxuICBjb25zdCBoYXNFbWFpbCA9IEJvb2xlYW4ocHJvY2Vzcy5lbnYuRU1BSUxfU0VSVkVSIHx8IHByb2Nlc3MuZW52LkVNQUlMX0ZST00pO1xuICBpZiAoaGFzRW1haWwpIHtcbiAgICBpZiAoIXByb2Nlc3MuZW52LkVNQUlMX1NFUlZFUikgbWlzc2luZy5wdXNoKFwiRU1BSUxfU0VSVkVSXCIpO1xuICAgIGlmICghcHJvY2Vzcy5lbnYuRU1BSUxfRlJPTSkgbWlzc2luZy5wdXNoKFwiRU1BSUxfRlJPTVwiKTtcbiAgfVxuXG4gIHJldHVybiB7IG9rOiBtaXNzaW5nLmxlbmd0aCA9PT0gMCwgbWlzc2luZyB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nQXV0aEVudklmTWlzY29uZmlndXJlZChjb250ZXh0OiBzdHJpbmcpIHtcbiAgY29uc3Qgc3RhdHVzID0gZ2V0QXV0aEVudlN0YXR1cygpO1xuICBpZiAoc3RhdHVzLm9rKSByZXR1cm47XG4gIC8vIFNlcnZlciBsb2dzIG9ubHkuIERvIG5vdCBwcmludCB2YWx1ZXMuXG4gIGNvbnNvbGUuZXJyb3IoYGF1dGg6bWlzY29uZmlndXJlZCAke2NvbnRleHR9IG1pc3Npbmc9JHtzdGF0dXMubWlzc2luZy5qb2luKFwiLFwiKX1gKTtcbn1cblxuXG4iXSwibmFtZXMiOlsiZ2V0QmFzZVVybEZhbGxiYWNrIiwiZXhwbGljaXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU0lURV9VUkwiLCJ0cmltIiwidmVyY2VsIiwiVkVSQ0VMX1VSTCIsInN0YXJ0c1dpdGgiLCJlbnN1cmVOZXh0QXV0aFVybCIsIk5FWFRBVVRIX1VSTCIsImZhbGxiYWNrIiwiZ2V0QXV0aEVudlN0YXR1cyIsIm1pc3NpbmciLCJwdXNoIiwiTkVYVEFVVEhfU0VDUkVUIiwiaGFzR29vZ2xlIiwiQm9vbGVhbiIsIkdPT0dMRV9DTElFTlRfSUQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsImhhc0VtYWlsIiwiRU1BSUxfU0VSVkVSIiwiRU1BSUxfRlJPTSIsIm9rIiwibGVuZ3RoIiwibG9nQXV0aEVudklmTWlzY29uZmlndXJlZCIsImNvbnRleHQiLCJzdGF0dXMiLCJjb25zb2xlIiwiZXJyb3IiLCJqb2luIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth/env.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth/options.ts":
/*!*********************************!*\
  !*** ./src/lib/auth/options.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var next_auth_providers_email__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/email */ \"(rsc)/./node_modules/next-auth/providers/email.js\");\n/* harmony import */ var _lib_auth_adapter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth/adapter */ \"(rsc)/./src/lib/auth/adapter.ts\");\n/* harmony import */ var _lib_auth_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth/store */ \"(rsc)/./src/lib/auth/store.ts\");\n/* harmony import */ var _lib_billing_access__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/billing/access */ \"(rsc)/./src/lib/billing/access.ts\");\n/* harmony import */ var _services_progressService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/services/progressService */ \"(rsc)/./src/services/progressService.ts\");\n/* harmony import */ var _lib_db_prisma__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/db/prisma */ \"(rsc)/./src/lib/db/prisma.ts\");\n/* harmony import */ var _lib_admin_rbac__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/admin/rbac */ \"(rsc)/./src/lib/admin/rbac.ts\");\n/* harmony import */ var _lib_telemetry_log__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/lib/telemetry/log */ \"(rsc)/./src/lib/telemetry/log.ts\");\n\n\n\n\n\n\n\n\n\nconst authOptions = {\n    adapter: (0,_lib_auth_adapter__WEBPACK_IMPORTED_MODULE_2__.BetterSqlite3Adapter)(),\n    // Phase 5: stateless JWT sessions (no server session table required).\n    // Tokens remain in httpOnly cookies; client JS never reads raw tokens.\n    session: {\n        strategy: \"jwt\",\n        maxAge: 60 * 60 * 24 * 14\n    },\n    // Security: set NEXTAUTH_SECRET in env for consistent token/cookie encryption.\n    // Keep secrets server-side only. NextAuth cookies are httpOnly by default and CSRF protection is enabled by default.\n    secret: process.env.NEXTAUTH_SECRET,\n    providers: (()=>{\n        const providers = [];\n        // Keep login optional: the site remains usable without auth, but users can sign in to persist progress across devices.\n        const googleId = process.env.GOOGLE_CLIENT_ID || \"\";\n        const googleSecret = process.env.GOOGLE_CLIENT_SECRET || \"\";\n        if (googleId && googleSecret) {\n            providers.push((0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n                clientId: googleId,\n                clientSecret: googleSecret\n            }));\n        } else if ( true && (googleId || googleSecret)) {\n            (0,_lib_telemetry_log__WEBPACK_IMPORTED_MODULE_8__.logWarn)(\"auth.provider_misconfigured\", {\n                provider: \"google\"\n            });\n        }\n        // Email magic link (passwordless). Only enable when fully configured.\n        const emailServer = process.env.EMAIL_SERVER || \"\";\n        const emailFrom = process.env.EMAIL_FROM || \"\";\n        if (emailServer && emailFrom) {\n            providers.push((0,next_auth_providers_email__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n                server: emailServer,\n                from: emailFrom,\n                // Magic link expiry <= 15 minutes.\n                maxAge: 15 * 60\n            }));\n        } else if ( true && (emailServer || emailFrom)) {\n            (0,_lib_telemetry_log__WEBPACK_IMPORTED_MODULE_8__.logWarn)(\"auth.provider_misconfigured\", {\n                provider: \"email\"\n            });\n        }\n        return providers;\n    })(),\n    pages: {\n        signIn: \"/signin\",\n        verifyRequest: \"/signin?check=1\",\n        error: \"/signin?error=auth\"\n    },\n    events: {\n        async signIn ({ user, account }) {\n            // Identity model (passwordless by design):\n            // - User = email + provider id (providerAccountId)\n            // - Email is the primary identifier for humans; internal id is stable UUID\n            //\n            // Store minimal identity metadata. Never store magic link tokens.\n            try {\n                const existing = user?.id ? (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_3__.getUserById)(user.id) : null;\n                const plan = user?.id ? await (0,_lib_billing_access__WEBPACK_IMPORTED_MODULE_4__.getUserPlan)(user.id) : \"free\";\n                if (existing && user?.id) {\n                    (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_3__.upsertUser)({\n                        ...existing,\n                        // Tier is derived from server-side plan records/entitlements.\n                        tier: plan === \"pro\" ? \"professional\" : plan === \"supporter\" ? \"supporter\" : \"registered\",\n                        lastLoginAt: new Date().toISOString()\n                    });\n                }\n                // Mirror identity into the Prisma-backed progress store so progress persistence can scale.\n                if (user?.id && user?.email && account?.provider && account?.providerAccountId) {\n                    await (0,_services_progressService__WEBPACK_IMPORTED_MODULE_5__.upsertUserIdentity)({\n                        userId: user.id,\n                        email: user.email,\n                        provider: account.provider,\n                        providerAccountId: String(account.providerAccountId)\n                    });\n                }\n            } catch  {\n            // Avoid blocking sign-in on metadata write.\n            }\n        }\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            // Embed admin role in JWT so middleware can enforce /admin without DB access.\n            // Fail closed: unknown values are ignored.\n            try {\n                const userId = user?.id || token?.sub;\n                if (userId) {\n                    const rec = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_6__.prisma.userIdentity.findUnique({\n                        where: {\n                            id: String(userId)\n                        },\n                        select: {\n                            adminRole: true\n                        }\n                    });\n                    const role = rec?.adminRole;\n                    token.adminRole = (0,_lib_admin_rbac__WEBPACK_IMPORTED_MODULE_7__.isAdminRole)(role) ? role : null;\n                }\n            } catch  {\n                token.adminRole = null;\n            }\n            return token;\n        },\n        async session ({ session, token, user }) {\n            if (session.user) {\n                session.user.id = user?.id || String(token?.sub || \"\");\n                // Surface admin role to server components; do not rely on this on the client for security.\n                session.user.adminRole = token?.adminRole || null;\n            }\n            return session;\n        }\n    },\n    // Privacy: do not log personal data beyond email. Keep logs minimal.\n    logger: {\n        error (code) {\n            console.error(\"auth:error\", code);\n        },\n        warn (code) {\n            console.warn(\"auth:warn\", code);\n        },\n        debug () {\n        // intentionally no-op (avoid verbose logs containing auth payloads)\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQzlFLDJDQUEyQztZQUMzQyxJQUFJO2dCQUNGLE1BQU1XLFNBQVMsTUFBZVIsTUFBT1ksT0FBZUM7Z0JBQ3BELElBQUlMLFFBQVE7b0JBQ1YsTUFBTU0sTUFBTSxNQUFNLG1EQUFnQkMsWUFBWSxDQUFDQyxVQUFVLENBQUM7d0JBQUVDLE9BQU87NEJBQUVqQixJQUFJUyxPQUFPRDt3QkFBUTt3QkFBR1UsUUFBUTs0QkFBRUMsV0FBVzt3QkFBSztvQkFBRTtvQkFDdkgsTUFBTUMsT0FBT04sS0FBS0s7b0JBQ2pCUCxNQUFjTyxTQUFTLEdBQUdyRCw0REFBV0EsQ0FBQ3NELFFBQVFBLE9BQU87Z0JBQ3hEO1lBQ0YsRUFBRSxPQUFNO2dCQUNMUixNQUFjTyxTQUFTLEdBQUc7WUFDN0I7WUFDQSxPQUFPUDtRQUNUO1FBQ0EsTUFBTTFDLFNBQVEsRUFBRUEsT0FBTyxFQUFFMEMsS0FBSyxFQUFFZixJQUFJLEVBQUU7WUFDcEMsSUFBSTNCLFFBQVEyQixJQUFJLEVBQUU7Z0JBQ2hCM0IsUUFBUTJCLElBQUksQ0FBQ0csRUFBRSxHQUFHLE1BQWVBLE1BQU1TLE9BQU8sT0FBZ0JJLE9BQU87Z0JBQ3JFLDJGQUEyRjtnQkFDMUYzQyxRQUFRMkIsSUFBSSxDQUFTc0IsU0FBUyxHQUFHLE9BQWdCQSxhQUFhO1lBQ2pFO1lBQ0EsT0FBT2pEO1FBQ1Q7SUFDRjtJQUNBLHFFQUFxRTtJQUNyRW1ELFFBQVE7UUFDTjFCLE9BQU0yQixJQUFJO1lBQ1JDLFFBQVE1QixLQUFLLENBQUMsY0FBYzJCO1FBQzlCO1FBQ0FFLE1BQUtGLElBQUk7WUFDUEMsUUFBUUMsSUFBSSxDQUFDLGFBQWFGO1FBQzVCO1FBQ0FHO1FBQ0Usb0VBQW9FO1FBQ3RFO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyIvd29ya3NwYWNlL3NyYy9saWIvYXV0aC9vcHRpb25zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBHb29nbGVQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9nb29nbGVcIjtcbmltcG9ydCBFbWFpbFByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2VtYWlsXCI7XG5pbXBvcnQgdHlwZSB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gXCJuZXh0LWF1dGhcIjtcbmltcG9ydCB7IEJldHRlclNxbGl0ZTNBZGFwdGVyIH0gZnJvbSBcIkAvbGliL2F1dGgvYWRhcHRlclwiO1xuaW1wb3J0IHsgdXBzZXJ0VXNlciwgZ2V0VXNlckJ5SWQgfSBmcm9tIFwiQC9saWIvYXV0aC9zdG9yZVwiO1xuaW1wb3J0IHsgZ2V0VXNlclBsYW4gfSBmcm9tIFwiQC9saWIvYmlsbGluZy9hY2Nlc3NcIjtcbmltcG9ydCB7IHVwc2VydFVzZXJJZGVudGl0eSB9IGZyb20gXCJAL3NlcnZpY2VzL3Byb2dyZXNzU2VydmljZVwiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL2RiL3ByaXNtYVwiO1xuaW1wb3J0IHsgaXNBZG1pblJvbGUgfSBmcm9tIFwiQC9saWIvYWRtaW4vcmJhY1wiO1xuaW1wb3J0IHsgbG9nV2FybiB9IGZyb20gXCJAL2xpYi90ZWxlbWV0cnkvbG9nXCI7XG5cbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xuICBhZGFwdGVyOiBCZXR0ZXJTcWxpdGUzQWRhcHRlcigpLFxuICAvLyBQaGFzZSA1OiBzdGF0ZWxlc3MgSldUIHNlc3Npb25zIChubyBzZXJ2ZXIgc2Vzc2lvbiB0YWJsZSByZXF1aXJlZCkuXG4gIC8vIFRva2VucyByZW1haW4gaW4gaHR0cE9ubHkgY29va2llczsgY2xpZW50IEpTIG5ldmVyIHJlYWRzIHJhdyB0b2tlbnMuXG4gIHNlc3Npb246IHsgc3RyYXRlZ3k6IFwiand0XCIsIG1heEFnZTogNjAgKiA2MCAqIDI0ICogMTQgfSxcbiAgLy8gU2VjdXJpdHk6IHNldCBORVhUQVVUSF9TRUNSRVQgaW4gZW52IGZvciBjb25zaXN0ZW50IHRva2VuL2Nvb2tpZSBlbmNyeXB0aW9uLlxuICAvLyBLZWVwIHNlY3JldHMgc2VydmVyLXNpZGUgb25seS4gTmV4dEF1dGggY29va2llcyBhcmUgaHR0cE9ubHkgYnkgZGVmYXVsdCBhbmQgQ1NSRiBwcm90ZWN0aW9uIGlzIGVuYWJsZWQgYnkgZGVmYXVsdC5cbiAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG4gIHByb3ZpZGVyczogKCgpID0+IHtcbiAgICBjb25zdCBwcm92aWRlcnM6IGFueVtdID0gW107XG5cbiAgICAvLyBLZWVwIGxvZ2luIG9wdGlvbmFsOiB0aGUgc2l0ZSByZW1haW5zIHVzYWJsZSB3aXRob3V0IGF1dGgsIGJ1dCB1c2VycyBjYW4gc2lnbiBpbiB0byBwZXJzaXN0IHByb2dyZXNzIGFjcm9zcyBkZXZpY2VzLlxuICAgIGNvbnN0IGdvb2dsZUlkID0gcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCB8fCBcIlwiO1xuICAgIGNvbnN0IGdvb2dsZVNlY3JldCA9IHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfU0VDUkVUIHx8IFwiXCI7XG4gICAgaWYgKGdvb2dsZUlkICYmIGdvb2dsZVNlY3JldCkge1xuICAgICAgcHJvdmlkZXJzLnB1c2goXG4gICAgICAgIEdvb2dsZVByb3ZpZGVyKHtcbiAgICAgICAgICBjbGllbnRJZDogZ29vZ2xlSWQsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBnb29nbGVTZWNyZXQsXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiICYmIChnb29nbGVJZCB8fCBnb29nbGVTZWNyZXQpKSB7XG4gICAgICBsb2dXYXJuKFwiYXV0aC5wcm92aWRlcl9taXNjb25maWd1cmVkXCIsIHsgcHJvdmlkZXI6IFwiZ29vZ2xlXCIgfSk7XG4gICAgfVxuXG4gICAgLy8gRW1haWwgbWFnaWMgbGluayAocGFzc3dvcmRsZXNzKS4gT25seSBlbmFibGUgd2hlbiBmdWxseSBjb25maWd1cmVkLlxuICAgIGNvbnN0IGVtYWlsU2VydmVyID0gcHJvY2Vzcy5lbnYuRU1BSUxfU0VSVkVSIHx8IFwiXCI7XG4gICAgY29uc3QgZW1haWxGcm9tID0gcHJvY2Vzcy5lbnYuRU1BSUxfRlJPTSB8fCBcIlwiO1xuICAgIGlmIChlbWFpbFNlcnZlciAmJiBlbWFpbEZyb20pIHtcbiAgICAgIHByb3ZpZGVycy5wdXNoKFxuICAgICAgICBFbWFpbFByb3ZpZGVyKHtcbiAgICAgICAgICBzZXJ2ZXI6IGVtYWlsU2VydmVyLFxuICAgICAgICAgIGZyb206IGVtYWlsRnJvbSxcbiAgICAgICAgICAvLyBNYWdpYyBsaW5rIGV4cGlyeSA8PSAxNSBtaW51dGVzLlxuICAgICAgICAgIG1heEFnZTogMTUgKiA2MCxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgJiYgKGVtYWlsU2VydmVyIHx8IGVtYWlsRnJvbSkpIHtcbiAgICAgIGxvZ1dhcm4oXCJhdXRoLnByb3ZpZGVyX21pc2NvbmZpZ3VyZWRcIiwgeyBwcm92aWRlcjogXCJlbWFpbFwiIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcm92aWRlcnM7XG4gIH0pKCksXG4gIHBhZ2VzOiB7XG4gICAgc2lnbkluOiBcIi9zaWduaW5cIixcbiAgICB2ZXJpZnlSZXF1ZXN0OiBcIi9zaWduaW4/Y2hlY2s9MVwiLFxuICAgIGVycm9yOiBcIi9zaWduaW4/ZXJyb3I9YXV0aFwiLFxuICB9LFxuICBldmVudHM6IHtcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50IH0pIHtcbiAgICAgIC8vIElkZW50aXR5IG1vZGVsIChwYXNzd29yZGxlc3MgYnkgZGVzaWduKTpcbiAgICAgIC8vIC0gVXNlciA9IGVtYWlsICsgcHJvdmlkZXIgaWQgKHByb3ZpZGVyQWNjb3VudElkKVxuICAgICAgLy8gLSBFbWFpbCBpcyB0aGUgcHJpbWFyeSBpZGVudGlmaWVyIGZvciBodW1hbnM7IGludGVybmFsIGlkIGlzIHN0YWJsZSBVVUlEXG4gICAgICAvL1xuICAgICAgLy8gU3RvcmUgbWluaW1hbCBpZGVudGl0eSBtZXRhZGF0YS4gTmV2ZXIgc3RvcmUgbWFnaWMgbGluayB0b2tlbnMuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBleGlzdGluZyA9IHVzZXI/LmlkID8gZ2V0VXNlckJ5SWQodXNlci5pZCkgOiBudWxsO1xuICAgICAgICBjb25zdCBwbGFuID0gdXNlcj8uaWQgPyBhd2FpdCBnZXRVc2VyUGxhbih1c2VyLmlkKSA6IFwiZnJlZVwiO1xuICAgICAgICBpZiAoZXhpc3RpbmcgJiYgdXNlcj8uaWQpIHtcbiAgICAgICAgICB1cHNlcnRVc2VyKHtcbiAgICAgICAgICAgIC4uLmV4aXN0aW5nLFxuICAgICAgICAgICAgLy8gVGllciBpcyBkZXJpdmVkIGZyb20gc2VydmVyLXNpZGUgcGxhbiByZWNvcmRzL2VudGl0bGVtZW50cy5cbiAgICAgICAgICAgIHRpZXI6IHBsYW4gPT09IFwicHJvXCIgPyBcInByb2Zlc3Npb25hbFwiIDogcGxhbiA9PT0gXCJzdXBwb3J0ZXJcIiA/IFwic3VwcG9ydGVyXCIgOiBcInJlZ2lzdGVyZWRcIixcbiAgICAgICAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTWlycm9yIGlkZW50aXR5IGludG8gdGhlIFByaXNtYS1iYWNrZWQgcHJvZ3Jlc3Mgc3RvcmUgc28gcHJvZ3Jlc3MgcGVyc2lzdGVuY2UgY2FuIHNjYWxlLlxuICAgICAgICBpZiAodXNlcj8uaWQgJiYgdXNlcj8uZW1haWwgJiYgYWNjb3VudD8ucHJvdmlkZXIgJiYgYWNjb3VudD8ucHJvdmlkZXJBY2NvdW50SWQpIHtcbiAgICAgICAgICBhd2FpdCB1cHNlcnRVc2VySWRlbnRpdHkoe1xuICAgICAgICAgICAgdXNlcklkOiB1c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBwcm92aWRlcjogYWNjb3VudC5wcm92aWRlcixcbiAgICAgICAgICAgIHByb3ZpZGVyQWNjb3VudElkOiBTdHJpbmcoYWNjb3VudC5wcm92aWRlckFjY291bnRJZCksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICAvLyBBdm9pZCBibG9ja2luZyBzaWduLWluIG9uIG1ldGFkYXRhIHdyaXRlLlxuICAgICAgfVxuICAgIH0sXG4gIH0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyIH0pIHtcbiAgICAgIC8vIEVtYmVkIGFkbWluIHJvbGUgaW4gSldUIHNvIG1pZGRsZXdhcmUgY2FuIGVuZm9yY2UgL2FkbWluIHdpdGhvdXQgREIgYWNjZXNzLlxuICAgICAgLy8gRmFpbCBjbG9zZWQ6IHVua25vd24gdmFsdWVzIGFyZSBpZ25vcmVkLlxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXNlcklkID0gKHVzZXIgYXMgYW55KT8uaWQgfHwgKHRva2VuIGFzIGFueSk/LnN1YjtcbiAgICAgICAgaWYgKHVzZXJJZCkge1xuICAgICAgICAgIGNvbnN0IHJlYyA9IGF3YWl0IChwcmlzbWEgYXMgYW55KS51c2VySWRlbnRpdHkuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBTdHJpbmcodXNlcklkKSB9LCBzZWxlY3Q6IHsgYWRtaW5Sb2xlOiB0cnVlIH0gfSk7XG4gICAgICAgICAgY29uc3Qgcm9sZSA9IHJlYz8uYWRtaW5Sb2xlO1xuICAgICAgICAgICh0b2tlbiBhcyBhbnkpLmFkbWluUm9sZSA9IGlzQWRtaW5Sb2xlKHJvbGUpID8gcm9sZSA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICAodG9rZW4gYXMgYW55KS5hZG1pblJvbGUgPSBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0sXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuLCB1c2VyIH0pIHtcbiAgICAgIGlmIChzZXNzaW9uLnVzZXIpIHtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkID0gKHVzZXIgYXMgYW55KT8uaWQgfHwgU3RyaW5nKCh0b2tlbiBhcyBhbnkpPy5zdWIgfHwgXCJcIik7XG4gICAgICAgIC8vIFN1cmZhY2UgYWRtaW4gcm9sZSB0byBzZXJ2ZXIgY29tcG9uZW50czsgZG8gbm90IHJlbHkgb24gdGhpcyBvbiB0aGUgY2xpZW50IGZvciBzZWN1cml0eS5cbiAgICAgICAgKHNlc3Npb24udXNlciBhcyBhbnkpLmFkbWluUm9sZSA9ICh0b2tlbiBhcyBhbnkpPy5hZG1pblJvbGUgfHwgbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG4gIH0sXG4gIC8vIFByaXZhY3k6IGRvIG5vdCBsb2cgcGVyc29uYWwgZGF0YSBiZXlvbmQgZW1haWwuIEtlZXAgbG9ncyBtaW5pbWFsLlxuICBsb2dnZXI6IHtcbiAgICBlcnJvcihjb2RlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiYXV0aDplcnJvclwiLCBjb2RlKTtcbiAgICB9LFxuICAgIHdhcm4oY29kZSkge1xuICAgICAgY29uc29sZS53YXJuKFwiYXV0aDp3YXJuXCIsIGNvZGUpO1xuICAgIH0sXG4gICAgZGVidWcoKSB7XG4gICAgICAvLyBpbnRlbnRpb25hbGx5IG5vLW9wIChhdm9pZCB2ZXJib3NlIGxvZ3MgY29udGFpbmluZyBhdXRoIHBheWxvYWRzKVxuICAgIH0sXG4gIH0sXG59O1xuXG5cbiJdLCJuYW1lcyI6WyJHb29nbGVQcm92aWRlciIsIkVtYWlsUHJvdmlkZXIiLCJCZXR0ZXJTcWxpdGUzQWRhcHRlciIsInVwc2VydFVzZXIiLCJnZXRVc2VyQnlJZCIsImdldFVzZXJQbGFuIiwidXBzZXJ0VXNlcklkZW50aXR5IiwicHJpc21hIiwiaXNBZG1pblJvbGUiLCJsb2dXYXJuIiwiYXV0aE9wdGlvbnMiLCJhZGFwdGVyIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIk5FWFRBVVRIX1NFQ1JFVCIsInByb3ZpZGVycyIsImdvb2dsZUlkIiwiR09PR0xFX0NMSUVOVF9JRCIsImdvb2dsZVNlY3JldCIsIkdPT0dMRV9DTElFTlRfU0VDUkVUIiwicHVzaCIsImNsaWVudElkIiwiY2xpZW50U2VjcmV0IiwicHJvdmlkZXIiLCJlbWFpbFNlcnZlciIsIkVNQUlMX1NFUlZFUiIsImVtYWlsRnJvbSIsIkVNQUlMX0ZST00iLCJzZXJ2ZXIiLCJmcm9tIiwicGFnZXMiLCJzaWduSW4iLCJ2ZXJpZnlSZXF1ZXN0IiwiZXJyb3IiLCJldmVudHMiLCJ1c2VyIiwiYWNjb3VudCIsImV4aXN0aW5nIiwiaWQiLCJwbGFuIiwidGllciIsImxhc3RMb2dpbkF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZW1haWwiLCJwcm92aWRlckFjY291bnRJZCIsInVzZXJJZCIsIlN0cmluZyIsImNhbGxiYWNrcyIsImp3dCIsInRva2VuIiwic3ViIiwicmVjIiwidXNlcklkZW50aXR5IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwic2VsZWN0IiwiYWRtaW5Sb2xlIiwicm9sZSIsImxvZ2dlciIsImNvZGUiLCJjb25zb2xlIiwid2FybiIsImRlYnVnIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth/options.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth/store.ts":
/*!*******************************!*\
  !*** ./src/lib/auth/store.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addUserEntitlement: () => (/* binding */ addUserEntitlement),\n/* harmony export */   createId: () => (/* binding */ createId),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   createVerificationToken: () => (/* binding */ createVerificationToken),\n/* harmony export */   deleteSession: () => (/* binding */ deleteSession),\n/* harmony export */   deleteUser: () => (/* binding */ deleteUser),\n/* harmony export */   getCpdState: () => (/* binding */ getCpdState),\n/* harmony export */   getSessionAndUser: () => (/* binding */ getSessionAndUser),\n/* harmony export */   getUserByAccount: () => (/* binding */ getUserByAccount),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   linkAccount: () => (/* binding */ linkAccount),\n/* harmony export */   setCpdState: () => (/* binding */ setCpdState),\n/* harmony export */   unlinkAccount: () => (/* binding */ unlinkAccount),\n/* harmony export */   updateSession: () => (/* binding */ updateSession),\n/* harmony export */   updateUserConsent: () => (/* binding */ updateUserConsent),\n/* harmony export */   upsertUser: () => (/* binding */ upsertUser),\n/* harmony export */   useVerificationToken: () => (/* binding */ useVerificationToken)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/storage/jsonFile */ \"(rsc)/./src/lib/storage/jsonFile.ts\");\n\n\nconst AUTH_STORE_PATH = process.env.AUTH_STORE_PATH || \"data/auth.json\";\nfunction addUserEntitlement(params) {\n    const s = load();\n    const idx = s.users.findIndex((u)=>u.id === params.userId);\n    if (idx === -1) return null;\n    const user = s.users[idx];\n    const entitlements = Array.isArray(user.entitlements) ? user.entitlements : [\n        \"free\"\n    ];\n    const next = Array.from(new Set([\n        ...entitlements.filter((e)=>e !== \"free\"),\n        params.entitlement\n    ]));\n    s.users[idx] = {\n        ...user,\n        entitlements: next.length ? next : [\n            \"free\"\n        ],\n        entitlementSource: params.source\n    };\n    save(s);\n    return s.users[idx];\n}\nconst empty = {\n    users: [],\n    accounts: [],\n    sessions: [],\n    verificationTokens: [],\n    cpdState: {}\n};\nfunction load() {\n    return (0,_lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_1__.readJsonFile)(AUTH_STORE_PATH, empty);\n}\nfunction save(store) {\n    (0,_lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_1__.writeJsonFile)(AUTH_STORE_PATH, store);\n}\nfunction createId() {\n    return (0,crypto__WEBPACK_IMPORTED_MODULE_0__.randomUUID)();\n}\nfunction getUserById(id) {\n    const s = load();\n    return s.users.find((u)=>u.id === id) || null;\n}\nfunction getUserByEmail(email) {\n    const s = load();\n    return s.users.find((u)=>u.email.toLowerCase() === email.toLowerCase()) || null;\n}\nfunction upsertUser(user) {\n    const s = load();\n    const existingIdx = s.users.findIndex((u)=>u.id === user.id);\n    const existing = existingIdx >= 0 ? s.users[existingIdx] : null;\n    const record = {\n        ...user,\n        entitlements: Array.isArray(user.entitlements) && user.entitlements.length ? user.entitlements : [\n            \"free\"\n        ],\n        entitlementSource: user.entitlementSource || \"default\",\n        createdAt: user.createdAt || new Date().toISOString(),\n        lastLoginAt: user.lastLoginAt !== undefined ? user.lastLoginAt : existing?.lastLoginAt ?? null,\n        tier: user.tier || existing?.tier || \"registered\",\n        consent: {\n            termsAcceptedAt: user.consent?.termsAcceptedAt !== undefined ? user.consent?.termsAcceptedAt : existing?.consent?.termsAcceptedAt ?? null,\n            privacyAcceptedAt: user.consent?.privacyAcceptedAt !== undefined ? user.consent?.privacyAcceptedAt : existing?.consent?.privacyAcceptedAt ?? null,\n            cpdDataUseAcceptedAt: user.consent?.cpdDataUseAcceptedAt !== undefined ? user.consent?.cpdDataUseAcceptedAt : existing?.consent?.cpdDataUseAcceptedAt ?? null\n        }\n    };\n    if (existingIdx >= 0) s.users[existingIdx] = record;\n    else s.users.push(record);\n    save(s);\n    return record;\n}\nfunction updateUserConsent(params) {\n    const s = load();\n    const idx = s.users.findIndex((u)=>u.id === params.userId);\n    if (idx < 0) return null;\n    const now = new Date().toISOString();\n    const existing = s.users[idx];\n    const consent = existing.consent || {};\n    s.users[idx] = {\n        ...existing,\n        consent: {\n            termsAcceptedAt: params.termsAccepted ? consent.termsAcceptedAt || now : null,\n            privacyAcceptedAt: params.privacyAccepted ? consent.privacyAcceptedAt || now : null,\n            cpdDataUseAcceptedAt: params.cpdDataUseAccepted ? consent.cpdDataUseAcceptedAt || now : null\n        }\n    };\n    save(s);\n    return s.users[idx];\n}\nfunction deleteUser(id) {\n    const s = load();\n    s.users = s.users.filter((u)=>u.id !== id);\n    s.accounts = s.accounts.filter((a)=>a.userId !== id);\n    s.sessions = s.sessions.filter((sess)=>sess.userId !== id);\n    delete s.cpdState[id];\n    save(s);\n}\nfunction linkAccount(account) {\n    const s = load();\n    const record = {\n        id: createId(),\n        ...account\n    };\n    // Ensure uniqueness by provider/providerAccountId\n    s.accounts = s.accounts.filter((a)=>!(a.provider === record.provider && a.providerAccountId === record.providerAccountId));\n    s.accounts.push(record);\n    save(s);\n    return record;\n}\nfunction unlinkAccount(provider, providerAccountId) {\n    const s = load();\n    s.accounts = s.accounts.filter((a)=>!(a.provider === provider && a.providerAccountId === providerAccountId));\n    save(s);\n}\nfunction getUserByAccount(provider, providerAccountId) {\n    const s = load();\n    const acct = s.accounts.find((a)=>a.provider === provider && a.providerAccountId === providerAccountId);\n    if (!acct) return null;\n    return s.users.find((u)=>u.id === acct.userId) || null;\n}\nfunction createSession(session) {\n    const s = load();\n    const record = {\n        id: createId(),\n        ...session\n    };\n    s.sessions.push(record);\n    save(s);\n    return record;\n}\nfunction getSessionAndUser(sessionToken) {\n    const s = load();\n    const sess = s.sessions.find((x)=>x.sessionToken === sessionToken);\n    if (!sess) return null;\n    const user = s.users.find((u)=>u.id === sess.userId);\n    if (!user) return null;\n    return {\n        session: sess,\n        user\n    };\n}\nfunction updateSession(sessionToken, patch) {\n    const s = load();\n    const idx = s.sessions.findIndex((x)=>x.sessionToken === sessionToken);\n    if (idx < 0) return null;\n    s.sessions[idx] = {\n        ...s.sessions[idx],\n        ...patch\n    };\n    save(s);\n    return s.sessions[idx];\n}\nfunction deleteSession(sessionToken) {\n    const s = load();\n    s.sessions = s.sessions.filter((x)=>x.sessionToken !== sessionToken);\n    save(s);\n}\nfunction createVerificationToken(token) {\n    const s = load();\n    s.verificationTokens.push(token);\n    save(s);\n    return token;\n}\nfunction useVerificationToken(identifier, token) {\n    const s = load();\n    const idx = s.verificationTokens.findIndex((t)=>t.identifier === identifier && t.token === token);\n    if (idx < 0) return null;\n    const record = s.verificationTokens[idx];\n    s.verificationTokens.splice(idx, 1);\n    save(s);\n    return record;\n}\nfunction getCpdState(userId) {\n    const s = load();\n    return s.cpdState[userId] || null;\n}\nfunction setCpdState(userId, stateJson) {\n    const s = load();\n    s.cpdState[userId] = {\n        stateJson,\n        updatedAt: new Date().toISOString()\n    };\n    save(s);\n    return s.cpdState[userId];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUNWRCxFQUFFMEIsUUFBUSxDQUFDbkIsT0FBTyxHQUFHO1FBQUV5RTtRQUFXQyxXQUFXLElBQUkxQyxPQUFPQyxXQUFXO0lBQUc7SUFDdEVuQixLQUFLckI7SUFDTCxPQUFPQSxFQUFFMEIsUUFBUSxDQUFDbkIsT0FBTztBQUMzQiIsInNvdXJjZXMiOlsiL3dvcmtzcGFjZS9zcmMvbGliL2F1dGgvc3RvcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmFuZG9tVVVJRCB9IGZyb20gXCJjcnlwdG9cIjtcbmltcG9ydCB7IHJlYWRKc29uRmlsZSwgd3JpdGVKc29uRmlsZSB9IGZyb20gXCJAL2xpYi9zdG9yYWdlL2pzb25GaWxlXCI7XG5cbmNvbnN0IEFVVEhfU1RPUkVfUEFUSCA9IHByb2Nlc3MuZW52LkFVVEhfU1RPUkVfUEFUSCB8fCBcImRhdGEvYXV0aC5qc29uXCI7XG5cbmV4cG9ydCB0eXBlIFN0b3JlZFVzZXIgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGVtYWlsVmVyaWZpZWQ6IHN0cmluZyB8IG51bGw7XG4gIG5hbWU6IHN0cmluZyB8IG51bGw7XG4gIGltYWdlOiBzdHJpbmcgfCBudWxsO1xuICBwcm92aWRlcjogc3RyaW5nIHwgbnVsbDtcbiAgZW50aXRsZW1lbnRzOiBzdHJpbmdbXTtcbiAgZW50aXRsZW1lbnRTb3VyY2U6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIGxhc3RMb2dpbkF0Pzogc3RyaW5nIHwgbnVsbDtcbiAgdGllcj86IFwidmlzaXRvclwiIHwgXCJyZWdpc3RlcmVkXCIgfCBcInN1cHBvcnRlclwiIHwgXCJwcm9mZXNzaW9uYWxcIjtcbiAgY29uc2VudD86IHtcbiAgICB0ZXJtc0FjY2VwdGVkQXQ/OiBzdHJpbmcgfCBudWxsO1xuICAgIHByaXZhY3lBY2NlcHRlZEF0Pzogc3RyaW5nIHwgbnVsbDtcbiAgICBjcGREYXRhVXNlQWNjZXB0ZWRBdD86IHN0cmluZyB8IG51bGw7XG4gIH07XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gYWRkVXNlckVudGl0bGVtZW50KHBhcmFtczogeyB1c2VySWQ6IHN0cmluZzsgZW50aXRsZW1lbnQ6IHN0cmluZzsgc291cmNlOiBzdHJpbmcgfSkge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICBjb25zdCBpZHggPSBzLnVzZXJzLmZpbmRJbmRleCgodSkgPT4gdS5pZCA9PT0gcGFyYW1zLnVzZXJJZCk7XG4gIGlmIChpZHggPT09IC0xKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgdXNlciA9IHMudXNlcnNbaWR4XTtcbiAgY29uc3QgZW50aXRsZW1lbnRzID0gQXJyYXkuaXNBcnJheSh1c2VyLmVudGl0bGVtZW50cykgPyB1c2VyLmVudGl0bGVtZW50cyA6IFtcImZyZWVcIl07XG4gIGNvbnN0IG5leHQgPSBBcnJheS5mcm9tKG5ldyBTZXQoWy4uLmVudGl0bGVtZW50cy5maWx0ZXIoKGUpID0+IGUgIT09IFwiZnJlZVwiKSwgcGFyYW1zLmVudGl0bGVtZW50XSkpO1xuICBzLnVzZXJzW2lkeF0gPSB7XG4gICAgLi4udXNlcixcbiAgICBlbnRpdGxlbWVudHM6IG5leHQubGVuZ3RoID8gbmV4dCA6IFtcImZyZWVcIl0sXG4gICAgZW50aXRsZW1lbnRTb3VyY2U6IHBhcmFtcy5zb3VyY2UsXG4gIH07XG4gIHNhdmUocyk7XG4gIHJldHVybiBzLnVzZXJzW2lkeF07XG59XG5cbnR5cGUgU3RvcmVkQWNjb3VudCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbiAgcHJvdmlkZXI6IHN0cmluZztcbiAgcHJvdmlkZXJBY2NvdW50SWQ6IHN0cmluZztcbiAgcmVmcmVzaF90b2tlbj86IHN0cmluZyB8IG51bGw7XG4gIGFjY2Vzc190b2tlbj86IHN0cmluZyB8IG51bGw7XG4gIGV4cGlyZXNfYXQ/OiBudW1iZXIgfCBudWxsO1xuICB0b2tlbl90eXBlPzogc3RyaW5nIHwgbnVsbDtcbiAgc2NvcGU/OiBzdHJpbmcgfCBudWxsO1xuICBpZF90b2tlbj86IHN0cmluZyB8IG51bGw7XG4gIHNlc3Npb25fc3RhdGU/OiBzdHJpbmcgfCBudWxsO1xufTtcblxudHlwZSBTdG9yZWRTZXNzaW9uID0ge1xuICBpZDogc3RyaW5nO1xuICBzZXNzaW9uVG9rZW46IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIGV4cGlyZXM6IHN0cmluZztcbn07XG5cbnR5cGUgU3RvcmVkVmVyaWZpY2F0aW9uVG9rZW4gPSB7XG4gIGlkZW50aWZpZXI6IHN0cmluZztcbiAgdG9rZW46IHN0cmluZztcbiAgZXhwaXJlczogc3RyaW5nO1xufTtcblxudHlwZSBBdXRoU3RvcmUgPSB7XG4gIHVzZXJzOiBTdG9yZWRVc2VyW107XG4gIGFjY291bnRzOiBTdG9yZWRBY2NvdW50W107XG4gIHNlc3Npb25zOiBTdG9yZWRTZXNzaW9uW107XG4gIHZlcmlmaWNhdGlvblRva2VuczogU3RvcmVkVmVyaWZpY2F0aW9uVG9rZW5bXTtcbiAgY3BkU3RhdGU6IFJlY29yZDxzdHJpbmcsIHsgc3RhdGVKc29uOiBzdHJpbmc7IHVwZGF0ZWRBdDogc3RyaW5nIH0+O1xufTtcblxuY29uc3QgZW1wdHk6IEF1dGhTdG9yZSA9IHtcbiAgdXNlcnM6IFtdLFxuICBhY2NvdW50czogW10sXG4gIHNlc3Npb25zOiBbXSxcbiAgdmVyaWZpY2F0aW9uVG9rZW5zOiBbXSxcbiAgY3BkU3RhdGU6IHt9LFxufTtcblxuZnVuY3Rpb24gbG9hZCgpOiBBdXRoU3RvcmUge1xuICByZXR1cm4gcmVhZEpzb25GaWxlPEF1dGhTdG9yZT4oQVVUSF9TVE9SRV9QQVRILCBlbXB0eSk7XG59XG5cbmZ1bmN0aW9uIHNhdmUoc3RvcmU6IEF1dGhTdG9yZSkge1xuICB3cml0ZUpzb25GaWxlKEFVVEhfU1RPUkVfUEFUSCwgc3RvcmUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSWQoKSB7XG4gIHJldHVybiByYW5kb21VVUlEKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQnlJZChpZDogc3RyaW5nKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHJldHVybiBzLnVzZXJzLmZpbmQoKHUpID0+IHUuaWQgPT09IGlkKSB8fCBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZykge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICByZXR1cm4gcy51c2Vycy5maW5kKCh1KSA9PiB1LmVtYWlsLnRvTG93ZXJDYXNlKCkgPT09IGVtYWlsLnRvTG93ZXJDYXNlKCkpIHx8IG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cHNlcnRVc2VyKHVzZXI6IE9taXQ8U3RvcmVkVXNlciwgXCJjcmVhdGVkQXRcIj4gJiB7IGNyZWF0ZWRBdD86IHN0cmluZyB9KSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIGNvbnN0IGV4aXN0aW5nSWR4ID0gcy51c2Vycy5maW5kSW5kZXgoKHUpID0+IHUuaWQgPT09IHVzZXIuaWQpO1xuICBjb25zdCBleGlzdGluZyA9IGV4aXN0aW5nSWR4ID49IDAgPyBzLnVzZXJzW2V4aXN0aW5nSWR4XSA6IG51bGw7XG4gIGNvbnN0IHJlY29yZDogU3RvcmVkVXNlciA9IHtcbiAgICAuLi51c2VyLFxuICAgIGVudGl0bGVtZW50czogQXJyYXkuaXNBcnJheSh1c2VyLmVudGl0bGVtZW50cykgJiYgdXNlci5lbnRpdGxlbWVudHMubGVuZ3RoID8gdXNlci5lbnRpdGxlbWVudHMgOiBbXCJmcmVlXCJdLFxuICAgIGVudGl0bGVtZW50U291cmNlOiB1c2VyLmVudGl0bGVtZW50U291cmNlIHx8IFwiZGVmYXVsdFwiLFxuICAgIGNyZWF0ZWRBdDogdXNlci5jcmVhdGVkQXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIGxhc3RMb2dpbkF0OiB1c2VyLmxhc3RMb2dpbkF0ICE9PSB1bmRlZmluZWQgPyB1c2VyLmxhc3RMb2dpbkF0IDogZXhpc3Rpbmc/Lmxhc3RMb2dpbkF0ID8/IG51bGwsXG4gICAgdGllcjogdXNlci50aWVyIHx8IGV4aXN0aW5nPy50aWVyIHx8IFwicmVnaXN0ZXJlZFwiLFxuICAgIGNvbnNlbnQ6IHtcbiAgICAgIHRlcm1zQWNjZXB0ZWRBdDpcbiAgICAgICAgdXNlci5jb25zZW50Py50ZXJtc0FjY2VwdGVkQXQgIT09IHVuZGVmaW5lZCA/IHVzZXIuY29uc2VudD8udGVybXNBY2NlcHRlZEF0IDogZXhpc3Rpbmc/LmNvbnNlbnQ/LnRlcm1zQWNjZXB0ZWRBdCA/PyBudWxsLFxuICAgICAgcHJpdmFjeUFjY2VwdGVkQXQ6XG4gICAgICAgIHVzZXIuY29uc2VudD8ucHJpdmFjeUFjY2VwdGVkQXQgIT09IHVuZGVmaW5lZCA/IHVzZXIuY29uc2VudD8ucHJpdmFjeUFjY2VwdGVkQXQgOiBleGlzdGluZz8uY29uc2VudD8ucHJpdmFjeUFjY2VwdGVkQXQgPz8gbnVsbCxcbiAgICAgIGNwZERhdGFVc2VBY2NlcHRlZEF0OlxuICAgICAgICB1c2VyLmNvbnNlbnQ/LmNwZERhdGFVc2VBY2NlcHRlZEF0ICE9PSB1bmRlZmluZWQgPyB1c2VyLmNvbnNlbnQ/LmNwZERhdGFVc2VBY2NlcHRlZEF0IDogZXhpc3Rpbmc/LmNvbnNlbnQ/LmNwZERhdGFVc2VBY2NlcHRlZEF0ID8/IG51bGwsXG4gICAgfSxcbiAgfTtcbiAgaWYgKGV4aXN0aW5nSWR4ID49IDApIHMudXNlcnNbZXhpc3RpbmdJZHhdID0gcmVjb3JkO1xuICBlbHNlIHMudXNlcnMucHVzaChyZWNvcmQpO1xuICBzYXZlKHMpO1xuICByZXR1cm4gcmVjb3JkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVXNlckNvbnNlbnQocGFyYW1zOiB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICB0ZXJtc0FjY2VwdGVkOiBib29sZWFuO1xuICBwcml2YWN5QWNjZXB0ZWQ6IGJvb2xlYW47XG4gIGNwZERhdGFVc2VBY2NlcHRlZDogYm9vbGVhbjtcbn0pIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgY29uc3QgaWR4ID0gcy51c2Vycy5maW5kSW5kZXgoKHUpID0+IHUuaWQgPT09IHBhcmFtcy51c2VySWQpO1xuICBpZiAoaWR4IDwgMCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgY29uc3QgZXhpc3RpbmcgPSBzLnVzZXJzW2lkeF07XG4gIGNvbnN0IGNvbnNlbnQgPSBleGlzdGluZy5jb25zZW50IHx8IHt9O1xuICBzLnVzZXJzW2lkeF0gPSB7XG4gICAgLi4uZXhpc3RpbmcsXG4gICAgY29uc2VudDoge1xuICAgICAgdGVybXNBY2NlcHRlZEF0OiBwYXJhbXMudGVybXNBY2NlcHRlZCA/IGNvbnNlbnQudGVybXNBY2NlcHRlZEF0IHx8IG5vdyA6IG51bGwsXG4gICAgICBwcml2YWN5QWNjZXB0ZWRBdDogcGFyYW1zLnByaXZhY3lBY2NlcHRlZCA/IGNvbnNlbnQucHJpdmFjeUFjY2VwdGVkQXQgfHwgbm93IDogbnVsbCxcbiAgICAgIGNwZERhdGFVc2VBY2NlcHRlZEF0OiBwYXJhbXMuY3BkRGF0YVVzZUFjY2VwdGVkID8gY29uc2VudC5jcGREYXRhVXNlQWNjZXB0ZWRBdCB8fCBub3cgOiBudWxsLFxuICAgIH0sXG4gIH07XG4gIHNhdmUocyk7XG4gIHJldHVybiBzLnVzZXJzW2lkeF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVVc2VyKGlkOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgcy51c2VycyA9IHMudXNlcnMuZmlsdGVyKCh1KSA9PiB1LmlkICE9PSBpZCk7XG4gIHMuYWNjb3VudHMgPSBzLmFjY291bnRzLmZpbHRlcigoYSkgPT4gYS51c2VySWQgIT09IGlkKTtcbiAgcy5zZXNzaW9ucyA9IHMuc2Vzc2lvbnMuZmlsdGVyKChzZXNzKSA9PiBzZXNzLnVzZXJJZCAhPT0gaWQpO1xuICBkZWxldGUgcy5jcGRTdGF0ZVtpZF07XG4gIHNhdmUocyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaW5rQWNjb3VudChhY2NvdW50OiBPbWl0PFN0b3JlZEFjY291bnQsIFwiaWRcIj4pIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgY29uc3QgcmVjb3JkOiBTdG9yZWRBY2NvdW50ID0geyBpZDogY3JlYXRlSWQoKSwgLi4uYWNjb3VudCB9O1xuICAvLyBFbnN1cmUgdW5pcXVlbmVzcyBieSBwcm92aWRlci9wcm92aWRlckFjY291bnRJZFxuICBzLmFjY291bnRzID0gcy5hY2NvdW50cy5maWx0ZXIoXG4gICAgKGEpID0+ICEoYS5wcm92aWRlciA9PT0gcmVjb3JkLnByb3ZpZGVyICYmIGEucHJvdmlkZXJBY2NvdW50SWQgPT09IHJlY29yZC5wcm92aWRlckFjY291bnRJZClcbiAgKTtcbiAgcy5hY2NvdW50cy5wdXNoKHJlY29yZCk7XG4gIHNhdmUocyk7XG4gIHJldHVybiByZWNvcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmxpbmtBY2NvdW50KHByb3ZpZGVyOiBzdHJpbmcsIHByb3ZpZGVyQWNjb3VudElkOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgcy5hY2NvdW50cyA9IHMuYWNjb3VudHMuZmlsdGVyKChhKSA9PiAhKGEucHJvdmlkZXIgPT09IHByb3ZpZGVyICYmIGEucHJvdmlkZXJBY2NvdW50SWQgPT09IHByb3ZpZGVyQWNjb3VudElkKSk7XG4gIHNhdmUocyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQnlBY2NvdW50KHByb3ZpZGVyOiBzdHJpbmcsIHByb3ZpZGVyQWNjb3VudElkOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgY29uc3QgYWNjdCA9IHMuYWNjb3VudHMuZmluZCgoYSkgPT4gYS5wcm92aWRlciA9PT0gcHJvdmlkZXIgJiYgYS5wcm92aWRlckFjY291bnRJZCA9PT0gcHJvdmlkZXJBY2NvdW50SWQpO1xuICBpZiAoIWFjY3QpIHJldHVybiBudWxsO1xuICByZXR1cm4gcy51c2Vycy5maW5kKCh1KSA9PiB1LmlkID09PSBhY2N0LnVzZXJJZCkgfHwgbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlc3Npb24oc2Vzc2lvbjogT21pdDxTdG9yZWRTZXNzaW9uLCBcImlkXCI+KSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIGNvbnN0IHJlY29yZDogU3RvcmVkU2Vzc2lvbiA9IHsgaWQ6IGNyZWF0ZUlkKCksIC4uLnNlc3Npb24gfTtcbiAgcy5zZXNzaW9ucy5wdXNoKHJlY29yZCk7XG4gIHNhdmUocyk7XG4gIHJldHVybiByZWNvcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXNzaW9uQW5kVXNlcihzZXNzaW9uVG9rZW46IHN0cmluZykge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICBjb25zdCBzZXNzID0gcy5zZXNzaW9ucy5maW5kKCh4KSA9PiB4LnNlc3Npb25Ub2tlbiA9PT0gc2Vzc2lvblRva2VuKTtcbiAgaWYgKCFzZXNzKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgdXNlciA9IHMudXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gc2Vzcy51c2VySWQpO1xuICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICByZXR1cm4geyBzZXNzaW9uOiBzZXNzLCB1c2VyIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVTZXNzaW9uKHNlc3Npb25Ub2tlbjogc3RyaW5nLCBwYXRjaDogUGFydGlhbDxQaWNrPFN0b3JlZFNlc3Npb24sIFwiZXhwaXJlc1wiPj4pIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgY29uc3QgaWR4ID0gcy5zZXNzaW9ucy5maW5kSW5kZXgoKHgpID0+IHguc2Vzc2lvblRva2VuID09PSBzZXNzaW9uVG9rZW4pO1xuICBpZiAoaWR4IDwgMCkgcmV0dXJuIG51bGw7XG4gIHMuc2Vzc2lvbnNbaWR4XSA9IHsgLi4ucy5zZXNzaW9uc1tpZHhdLCAuLi5wYXRjaCB9O1xuICBzYXZlKHMpO1xuICByZXR1cm4gcy5zZXNzaW9uc1tpZHhdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlU2Vzc2lvbihzZXNzaW9uVG9rZW46IHN0cmluZykge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICBzLnNlc3Npb25zID0gcy5zZXNzaW9ucy5maWx0ZXIoKHgpID0+IHguc2Vzc2lvblRva2VuICE9PSBzZXNzaW9uVG9rZW4pO1xuICBzYXZlKHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVmVyaWZpY2F0aW9uVG9rZW4odG9rZW46IFN0b3JlZFZlcmlmaWNhdGlvblRva2VuKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHMudmVyaWZpY2F0aW9uVG9rZW5zLnB1c2godG9rZW4pO1xuICBzYXZlKHMpO1xuICByZXR1cm4gdG9rZW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VWZXJpZmljYXRpb25Ub2tlbihpZGVudGlmaWVyOiBzdHJpbmcsIHRva2VuOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgY29uc3QgaWR4ID0gcy52ZXJpZmljYXRpb25Ub2tlbnMuZmluZEluZGV4KCh0KSA9PiB0LmlkZW50aWZpZXIgPT09IGlkZW50aWZpZXIgJiYgdC50b2tlbiA9PT0gdG9rZW4pO1xuICBpZiAoaWR4IDwgMCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHJlY29yZCA9IHMudmVyaWZpY2F0aW9uVG9rZW5zW2lkeF07XG4gIHMudmVyaWZpY2F0aW9uVG9rZW5zLnNwbGljZShpZHgsIDEpO1xuICBzYXZlKHMpO1xuICByZXR1cm4gcmVjb3JkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3BkU3RhdGUodXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgcmV0dXJuIHMuY3BkU3RhdGVbdXNlcklkXSB8fCBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3BkU3RhdGUodXNlcklkOiBzdHJpbmcsIHN0YXRlSnNvbjogc3RyaW5nKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHMuY3BkU3RhdGVbdXNlcklkXSA9IHsgc3RhdGVKc29uLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9O1xuICBzYXZlKHMpO1xuICByZXR1cm4gcy5jcGRTdGF0ZVt1c2VySWRdO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJyYW5kb21VVUlEIiwicmVhZEpzb25GaWxlIiwid3JpdGVKc29uRmlsZSIsIkFVVEhfU1RPUkVfUEFUSCIsInByb2Nlc3MiLCJlbnYiLCJhZGRVc2VyRW50aXRsZW1lbnQiLCJwYXJhbXMiLCJzIiwibG9hZCIsImlkeCIsInVzZXJzIiwiZmluZEluZGV4IiwidSIsImlkIiwidXNlcklkIiwidXNlciIsImVudGl0bGVtZW50cyIsIkFycmF5IiwiaXNBcnJheSIsIm5leHQiLCJmcm9tIiwiU2V0IiwiZmlsdGVyIiwiZSIsImVudGl0bGVtZW50IiwibGVuZ3RoIiwiZW50aXRsZW1lbnRTb3VyY2UiLCJzb3VyY2UiLCJzYXZlIiwiZW1wdHkiLCJhY2NvdW50cyIsInNlc3Npb25zIiwidmVyaWZpY2F0aW9uVG9rZW5zIiwiY3BkU3RhdGUiLCJzdG9yZSIsImNyZWF0ZUlkIiwiZ2V0VXNlckJ5SWQiLCJmaW5kIiwiZ2V0VXNlckJ5RW1haWwiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwidXBzZXJ0VXNlciIsImV4aXN0aW5nSWR4IiwiZXhpc3RpbmciLCJyZWNvcmQiLCJjcmVhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJsYXN0TG9naW5BdCIsInVuZGVmaW5lZCIsInRpZXIiLCJjb25zZW50IiwidGVybXNBY2NlcHRlZEF0IiwicHJpdmFjeUFjY2VwdGVkQXQiLCJjcGREYXRhVXNlQWNjZXB0ZWRBdCIsInB1c2giLCJ1cGRhdGVVc2VyQ29uc2VudCIsIm5vdyIsInRlcm1zQWNjZXB0ZWQiLCJwcml2YWN5QWNjZXB0ZWQiLCJjcGREYXRhVXNlQWNjZXB0ZWQiLCJkZWxldGVVc2VyIiwiYSIsInNlc3MiLCJsaW5rQWNjb3VudCIsImFjY291bnQiLCJwcm92aWRlciIsInByb3ZpZGVyQWNjb3VudElkIiwidW5saW5rQWNjb3VudCIsImdldFVzZXJCeUFjY291bnQiLCJhY2N0IiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb24iLCJnZXRTZXNzaW9uQW5kVXNlciIsInNlc3Npb25Ub2tlbiIsIngiLCJ1cGRhdGVTZXNzaW9uIiwicGF0Y2giLCJkZWxldGVTZXNzaW9uIiwiY3JlYXRlVmVyaWZpY2F0aW9uVG9rZW4iLCJ0b2tlbiIsInVzZVZlcmlmaWNhdGlvblRva2VuIiwiaWRlbnRpZmllciIsInQiLCJzcGxpY2UiLCJnZXRDcGRTdGF0ZSIsInNldENwZFN0YXRlIiwic3RhdGVKc29uIiwidXBkYXRlZEF0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth/store.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/billing/access.ts":
/*!***********************************!*\
  !*** ./src/lib/billing/access.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertFeatureOrThrow: () => (/* binding */ assertFeatureOrThrow),\n/* harmony export */   getRateLimitConfig: () => (/* binding */ getRateLimitConfig),\n/* harmony export */   getSafePlanSummaryForRequest: () => (/* binding */ getSafePlanSummaryForRequest),\n/* harmony export */   getUserPlan: () => (/* binding */ getUserPlan),\n/* harmony export */   hasFeature: () => (/* binding */ hasFeature)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth_options__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth/options */ \"(rsc)/./src/lib/auth/options.ts\");\n/* harmony import */ var _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/billing/plans */ \"(rsc)/./src/lib/billing/plans.ts\");\n/* harmony import */ var _lib_auth_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth/store */ \"(rsc)/./src/lib/auth/store.ts\");\n/* harmony import */ var _lib_billing_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/billing/store */ \"(rsc)/./src/lib/billing/store.ts\");\n/* harmony import */ var _lib_testingMode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/testingMode */ \"(rsc)/./src/lib/testingMode.ts\");\n\n\n\n\n\n\nasync function getUserPlan(userId) {\n    // Temporary QA override: treat all users as pro so everything is reachable for testing.\n    if ((0,_lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.getTestingOverrideDecision)().allowed || _lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.TESTING_MODE_ENABLED) return \"pro\";\n    const explicit = (0,_lib_billing_store__WEBPACK_IMPORTED_MODULE_4__.getUserPlanRecord)(userId);\n    if (explicit?.plan) return explicit.plan;\n    const user = (0,_lib_auth_store__WEBPACK_IMPORTED_MODULE_3__.getUserById)(userId);\n    const entitlements = Array.isArray(user?.entitlements) ? user.entitlements : [\n        \"free\"\n    ];\n    if (entitlements.includes(\"commercial\")) return \"pro\";\n    if (entitlements.includes(\"supporter\")) return \"supporter\";\n    return \"free\";\n}\nfunction hasFeature(plan, feature) {\n    if ((0,_lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.getTestingOverrideDecision)().allowed || _lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.TESTING_MODE_ENABLED) return true;\n    return _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS[plan].features.includes(feature);\n}\nasync function getSafePlanSummaryForRequest() {\n    if ((0,_lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.getTestingOverrideDecision)().allowed || _lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.TESTING_MODE_ENABLED) {\n        return {\n            plan: \"pro\",\n            features: _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS.pro.features,\n            limits: _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS.pro.limits\n        };\n    }\n    const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(_lib_auth_options__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n    if (!session?.user?.id) return {\n        plan: \"free\",\n        features: [],\n        limits: _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS.free.limits\n    };\n    const plan = await getUserPlan(session.user.id);\n    return {\n        plan,\n        features: _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS[plan].features,\n        limits: _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS[plan].limits\n    };\n}\nasync function assertFeatureOrThrow(feature) {\n    if ((0,_lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.getTestingOverrideDecision)().allowed || _lib_testingMode__WEBPACK_IMPORTED_MODULE_5__.TESTING_MODE_ENABLED) {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(_lib_auth_options__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n        return {\n            userId: session?.user?.id || \"testing\",\n            plan: \"pro\"\n        };\n    }\n    const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_0__.getServerSession)(_lib_auth_options__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n    if (!session?.user?.id) {\n        const err = new Error(\"Authentication required\");\n        err.status = 401;\n        throw err;\n    }\n    const plan = await getUserPlan(session.user.id);\n    if (!hasFeature(plan, feature)) {\n        const err = new Error(\"Upgrade required\");\n        err.status = 403;\n        err.plan = plan;\n        err.feature = feature;\n        throw err;\n    }\n    return {\n        userId: session.user.id,\n        plan\n    };\n}\nfunction getRateLimitConfig(plan) {\n    const limits = _lib_billing_plans__WEBPACK_IMPORTED_MODULE_2__.PLANS[plan].limits;\n    return {\n        monthlyCredits: limits.monthlyCredits,\n        dailyCreditCap: limits.dailyCreditCap,\n        maxUploadBytes: limits.maxUploadBytes,\n        maxExportsPerDay: limits.maxExportsPerDay\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDakMsT0FBTztRQUNMUyxnQkFBZ0JULE9BQU9TLGNBQWM7UUFDckNDLGdCQUFnQlYsT0FBT1UsY0FBYztRQUNyQ0MsZ0JBQWdCWCxPQUFPVyxjQUFjO1FBQ3JDQyxrQkFBa0JaLE9BQU9ZLGdCQUFnQjtJQUMzQztBQUNGIiwic291cmNlcyI6WyIvd29ya3NwYWNlL3NyYy9saWIvYmlsbGluZy9hY2Nlc3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gXCJuZXh0LWF1dGhcIjtcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSBcIkAvbGliL2F1dGgvb3B0aW9uc1wiO1xuaW1wb3J0IHsgUExBTlMsIHR5cGUgRmVhdHVyZUtleSwgdHlwZSBQbGFuS2V5IH0gZnJvbSBcIkAvbGliL2JpbGxpbmcvcGxhbnNcIjtcbmltcG9ydCB7IGdldFVzZXJCeUlkIH0gZnJvbSBcIkAvbGliL2F1dGgvc3RvcmVcIjtcbmltcG9ydCB7IGdldFVzZXJQbGFuUmVjb3JkIH0gZnJvbSBcIkAvbGliL2JpbGxpbmcvc3RvcmVcIjtcbmltcG9ydCB7IGdldFRlc3RpbmdPdmVycmlkZURlY2lzaW9uLCBURVNUSU5HX01PREVfRU5BQkxFRCB9IGZyb20gXCJAL2xpYi90ZXN0aW5nTW9kZVwiO1xuXG5leHBvcnQgdHlwZSBTYWZlUGxhblN1bW1hcnkgPSB7XG4gIHBsYW46IFBsYW5LZXk7XG4gIGZlYXR1cmVzOiBGZWF0dXJlS2V5W107XG4gIGxpbWl0czogKHR5cGVvZiBQTEFOUylbUGxhbktleV1bXCJsaW1pdHNcIl07XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclBsYW4odXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFBsYW5LZXk+IHtcbiAgLy8gVGVtcG9yYXJ5IFFBIG92ZXJyaWRlOiB0cmVhdCBhbGwgdXNlcnMgYXMgcHJvIHNvIGV2ZXJ5dGhpbmcgaXMgcmVhY2hhYmxlIGZvciB0ZXN0aW5nLlxuICBpZiAoZ2V0VGVzdGluZ092ZXJyaWRlRGVjaXNpb24oKS5hbGxvd2VkIHx8IFRFU1RJTkdfTU9ERV9FTkFCTEVEKSByZXR1cm4gXCJwcm9cIjtcblxuICBjb25zdCBleHBsaWNpdCA9IGdldFVzZXJQbGFuUmVjb3JkKHVzZXJJZCk7XG4gIGlmIChleHBsaWNpdD8ucGxhbikgcmV0dXJuIGV4cGxpY2l0LnBsYW47XG5cbiAgY29uc3QgdXNlciA9IGdldFVzZXJCeUlkKHVzZXJJZCk7XG4gIGNvbnN0IGVudGl0bGVtZW50cyA9IEFycmF5LmlzQXJyYXkoKHVzZXIgYXMgYW55KT8uZW50aXRsZW1lbnRzKSA/ICgodXNlciBhcyBhbnkpLmVudGl0bGVtZW50cyBhcyBzdHJpbmdbXSkgOiBbXCJmcmVlXCJdO1xuICBpZiAoZW50aXRsZW1lbnRzLmluY2x1ZGVzKFwiY29tbWVyY2lhbFwiKSkgcmV0dXJuIFwicHJvXCI7XG4gIGlmIChlbnRpdGxlbWVudHMuaW5jbHVkZXMoXCJzdXBwb3J0ZXJcIikpIHJldHVybiBcInN1cHBvcnRlclwiO1xuICByZXR1cm4gXCJmcmVlXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNGZWF0dXJlKHBsYW46IFBsYW5LZXksIGZlYXR1cmU6IEZlYXR1cmVLZXkpIHtcbiAgaWYgKGdldFRlc3RpbmdPdmVycmlkZURlY2lzaW9uKCkuYWxsb3dlZCB8fCBURVNUSU5HX01PREVfRU5BQkxFRCkgcmV0dXJuIHRydWU7XG4gIHJldHVybiBQTEFOU1twbGFuXS5mZWF0dXJlcy5pbmNsdWRlcyhmZWF0dXJlKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhZmVQbGFuU3VtbWFyeUZvclJlcXVlc3QoKSB7XG4gIGlmIChnZXRUZXN0aW5nT3ZlcnJpZGVEZWNpc2lvbigpLmFsbG93ZWQgfHwgVEVTVElOR19NT0RFX0VOQUJMRUQpIHtcbiAgICByZXR1cm4geyBwbGFuOiBcInByb1wiLCBmZWF0dXJlczogUExBTlMucHJvLmZlYXR1cmVzLCBsaW1pdHM6IFBMQU5TLnByby5saW1pdHMgfSBzYXRpc2ZpZXMgU2FmZVBsYW5TdW1tYXJ5O1xuICB9XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKTtcbiAgaWYgKCFzZXNzaW9uPy51c2VyPy5pZCkgcmV0dXJuIHsgcGxhbjogXCJmcmVlXCIsIGZlYXR1cmVzOiBbXSwgbGltaXRzOiBQTEFOUy5mcmVlLmxpbWl0cyB9IHNhdGlzZmllcyBTYWZlUGxhblN1bW1hcnk7XG4gIGNvbnN0IHBsYW4gPSBhd2FpdCBnZXRVc2VyUGxhbihzZXNzaW9uLnVzZXIuaWQpO1xuICByZXR1cm4geyBwbGFuLCBmZWF0dXJlczogUExBTlNbcGxhbl0uZmVhdHVyZXMsIGxpbWl0czogUExBTlNbcGxhbl0ubGltaXRzIH0gc2F0aXNmaWVzIFNhZmVQbGFuU3VtbWFyeTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFzc2VydEZlYXR1cmVPclRocm93KGZlYXR1cmU6IEZlYXR1cmVLZXkpIHtcbiAgaWYgKGdldFRlc3RpbmdPdmVycmlkZURlY2lzaW9uKCkuYWxsb3dlZCB8fCBURVNUSU5HX01PREVfRU5BQkxFRCkge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKTtcbiAgICByZXR1cm4geyB1c2VySWQ6IHNlc3Npb24/LnVzZXI/LmlkIHx8IFwidGVzdGluZ1wiLCBwbGFuOiBcInByb1wiIGFzIGNvbnN0IH07XG4gIH1cbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpO1xuICBpZiAoIXNlc3Npb24/LnVzZXI/LmlkKSB7XG4gICAgY29uc3QgZXJyID0gbmV3IEVycm9yKFwiQXV0aGVudGljYXRpb24gcmVxdWlyZWRcIik7XG4gICAgKGVyciBhcyBhbnkpLnN0YXR1cyA9IDQwMTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbiAgY29uc3QgcGxhbiA9IGF3YWl0IGdldFVzZXJQbGFuKHNlc3Npb24udXNlci5pZCk7XG4gIGlmICghaGFzRmVhdHVyZShwbGFuLCBmZWF0dXJlKSkge1xuICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcihcIlVwZ3JhZGUgcmVxdWlyZWRcIik7XG4gICAgKGVyciBhcyBhbnkpLnN0YXR1cyA9IDQwMztcbiAgICAoZXJyIGFzIGFueSkucGxhbiA9IHBsYW47XG4gICAgKGVyciBhcyBhbnkpLmZlYXR1cmUgPSBmZWF0dXJlO1xuICAgIHRocm93IGVycjtcbiAgfVxuICByZXR1cm4geyB1c2VySWQ6IHNlc3Npb24udXNlci5pZCwgcGxhbiB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmF0ZUxpbWl0Q29uZmlnKHBsYW46IFBsYW5LZXkpIHtcbiAgY29uc3QgbGltaXRzID0gUExBTlNbcGxhbl0ubGltaXRzO1xuICByZXR1cm4ge1xuICAgIG1vbnRobHlDcmVkaXRzOiBsaW1pdHMubW9udGhseUNyZWRpdHMsXG4gICAgZGFpbHlDcmVkaXRDYXA6IGxpbWl0cy5kYWlseUNyZWRpdENhcCxcbiAgICBtYXhVcGxvYWRCeXRlczogbGltaXRzLm1heFVwbG9hZEJ5dGVzLFxuICAgIG1heEV4cG9ydHNQZXJEYXk6IGxpbWl0cy5tYXhFeHBvcnRzUGVyRGF5LFxuICB9O1xufVxuXG5cbiJdLCJuYW1lcyI6WyJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJQTEFOUyIsImdldFVzZXJCeUlkIiwiZ2V0VXNlclBsYW5SZWNvcmQiLCJnZXRUZXN0aW5nT3ZlcnJpZGVEZWNpc2lvbiIsIlRFU1RJTkdfTU9ERV9FTkFCTEVEIiwiZ2V0VXNlclBsYW4iLCJ1c2VySWQiLCJhbGxvd2VkIiwiZXhwbGljaXQiLCJwbGFuIiwidXNlciIsImVudGl0bGVtZW50cyIsIkFycmF5IiwiaXNBcnJheSIsImluY2x1ZGVzIiwiaGFzRmVhdHVyZSIsImZlYXR1cmUiLCJmZWF0dXJlcyIsImdldFNhZmVQbGFuU3VtbWFyeUZvclJlcXVlc3QiLCJwcm8iLCJsaW1pdHMiLCJzZXNzaW9uIiwiaWQiLCJmcmVlIiwiYXNzZXJ0RmVhdHVyZU9yVGhyb3ciLCJlcnIiLCJFcnJvciIsInN0YXR1cyIsImdldFJhdGVMaW1pdENvbmZpZyIsIm1vbnRobHlDcmVkaXRzIiwiZGFpbHlDcmVkaXRDYXAiLCJtYXhVcGxvYWRCeXRlcyIsIm1heEV4cG9ydHNQZXJEYXkiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/billing/access.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/billing/plans.ts":
/*!**********************************!*\
  !*** ./src/lib/billing/plans.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CREDIT_PACKS: () => (/* binding */ CREDIT_PACKS),\n/* harmony export */   CREDIT_PRICE: () => (/* binding */ CREDIT_PRICE),\n/* harmony export */   PLANS: () => (/* binding */ PLANS),\n/* harmony export */   planRank: () => (/* binding */ planRank)\n/* harmony export */ });\n// Single source of truth for product ladder.\n// Keep limits as constants so they can be tuned later without chasing usage logic across the codebase.\nconst PLANS = {\n    free: {\n        key: \"free\",\n        label: \"Free\",\n        description: \"Small monthly bundle, hard daily cap, no rollovers. Enough to taste, not enough to farm.\",\n        features: [],\n        limits: {\n            maxUploadBytes: 1000000,\n            maxExportsPerDay: 3,\n            monthlyCredits: 300,\n            dailyCreditCap: 30\n        }\n    },\n    supporter: {\n        key: \"supporter\",\n        label: \"Supporter\",\n        description: \"Aimed at learners and hobbyists. Higher limits and basic cloud save.\",\n        features: [\n            \"advanced_dashboards\",\n            \"larger_limits\"\n        ],\n        limits: {\n            maxUploadBytes: 20000000,\n            maxExportsPerDay: 25,\n            monthlyCredits: 3000,\n            dailyCreditCap: 300\n        }\n    },\n    pro: {\n        key: \"pro\",\n        label: \"Professional\",\n        description: \"Aimed at serious builders. API access, webhooks, and higher concurrency.\",\n        features: [\n            \"templates_download\",\n            \"history_export\",\n            \"reports_export\",\n            \"cpd_evidence_export\",\n            \"early_access\",\n            \"advanced_dashboards\",\n            \"larger_limits\",\n            \"api_access\",\n            \"webhooks\"\n        ],\n        limits: {\n            maxUploadBytes: 100000000,\n            maxExportsPerDay: 100,\n            monthlyCredits: 12000,\n            dailyCreditCap: 2000\n        }\n    }\n};\n// Credit top-up packs\nconst CREDIT_PACKS = [\n    {\n        id: \"starter\",\n        label: \"Starter\",\n        price: 10,\n        credits: 500,\n        pricePerCredit: 0.02\n    },\n    {\n        id: \"standard\",\n        label: \"Standard\",\n        price: 25,\n        credits: 1400,\n        pricePerCredit: 0.0179\n    },\n    {\n        id: \"professional\",\n        label: \"Professional\",\n        price: 50,\n        credits: 3000,\n        pricePerCredit: 0.0167\n    }\n];\n// Public credit price (per credit)\nconst CREDIT_PRICE = 0.02; // 0.02 per credit\nfunction planRank(plan) {\n    if (plan === \"pro\") return 3;\n    if (plan === \"supporter\") return 2;\n    return 1;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2JpbGxpbmcvcGxhbnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQTZCQSw2Q0FBNkM7QUFDN0MsdUdBQXVHO0FBQ2hHLE1BQU1BLFFBQStCO0lBQzFDQyxNQUFNO1FBQ0pDLEtBQUs7UUFDTEMsT0FBTztRQUNQQyxhQUFhO1FBQ2JDLFVBQVUsRUFBRTtRQUNaQyxRQUFRO1lBQ05DLGdCQUFnQjtZQUNoQkMsa0JBQWtCO1lBQ2xCQyxnQkFBZ0I7WUFDaEJDLGdCQUFnQjtRQUNsQjtJQUNGO0lBQ0FDLFdBQVc7UUFDVFQsS0FBSztRQUNMQyxPQUFPO1FBQ1BDLGFBQWE7UUFDYkMsVUFBVTtZQUFDO1lBQXVCO1NBQWdCO1FBQ2xEQyxRQUFRO1lBQ05DLGdCQUFnQjtZQUNoQkMsa0JBQWtCO1lBQ2xCQyxnQkFBZ0I7WUFDaEJDLGdCQUFnQjtRQUNsQjtJQUNGO0lBQ0FFLEtBQUs7UUFDSFYsS0FBSztRQUNMQyxPQUFPO1FBQ1BDLGFBQWE7UUFDYkMsVUFBVTtZQUNSO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO1FBQ0RDLFFBQVE7WUFDTkMsZ0JBQWdCO1lBQ2hCQyxrQkFBa0I7WUFDbEJDLGdCQUFnQjtZQUNoQkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFDRixFQUFFO0FBRUYsc0JBQXNCO0FBQ2YsTUFBTUcsZUFBZTtJQUMxQjtRQUFFQyxJQUFJO1FBQVdYLE9BQU87UUFBV1ksT0FBTztRQUFJQyxTQUFTO1FBQUtDLGdCQUFnQjtJQUFLO0lBQ2pGO1FBQUVILElBQUk7UUFBWVgsT0FBTztRQUFZWSxPQUFPO1FBQUlDLFNBQVM7UUFBT0MsZ0JBQWdCO0lBQU87SUFDdkY7UUFBRUgsSUFBSTtRQUFnQlgsT0FBTztRQUFnQlksT0FBTztRQUFJQyxTQUFTO1FBQU9DLGdCQUFnQjtJQUFPO0NBQ2hHLENBQVU7QUFFWCxtQ0FBbUM7QUFDNUIsTUFBTUMsZUFBZSxLQUFLLENBQUMsbUJBQW1CO0FBRTlDLFNBQVNDLFNBQVNDLElBQWE7SUFDcEMsSUFBSUEsU0FBUyxPQUFPLE9BQU87SUFDM0IsSUFBSUEsU0FBUyxhQUFhLE9BQU87SUFDakMsT0FBTztBQUNUIiwic291cmNlcyI6WyIvd29ya3NwYWNlL3NyYy9saWIvYmlsbGluZy9wbGFucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBQbGFuS2V5ID0gXCJmcmVlXCIgfCBcInN1cHBvcnRlclwiIHwgXCJwcm9cIjtcblxuZXhwb3J0IHR5cGUgRmVhdHVyZUtleSA9XG4gIHwgXCJ0ZW1wbGF0ZXNfZG93bmxvYWRcIlxuICB8IFwiaGlzdG9yeV9leHBvcnRcIlxuICB8IFwiYWR2YW5jZWRfZGFzaGJvYXJkc1wiXG4gIHwgXCJsYXJnZXJfbGltaXRzXCJcbiAgfCBcInJlcG9ydHNfZXhwb3J0XCJcbiAgfCBcImNwZF9ldmlkZW5jZV9leHBvcnRcIlxuICB8IFwiZWFybHlfYWNjZXNzXCJcbiAgfCBcImFwaV9hY2Nlc3NcIlxuICB8IFwid2ViaG9va3NcIjtcblxuZXhwb3J0IHR5cGUgVXNhZ2VMaW1pdHMgPSB7XG4gIG1heFVwbG9hZEJ5dGVzOiBudW1iZXI7XG4gIG1heEV4cG9ydHNQZXJEYXk6IG51bWJlcjtcbiAgLy8gQ3JlZGl0LWJhc2VkIGxpbWl0cyAocmVwbGFjZXMgbWF4VG9vbFJ1bnNQZXJEYXkpXG4gIG1vbnRobHlDcmVkaXRzOiBudW1iZXI7XG4gIGRhaWx5Q3JlZGl0Q2FwOiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBQbGFuID0ge1xuICBrZXk6IFBsYW5LZXk7XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGZlYXR1cmVzOiBGZWF0dXJlS2V5W107XG4gIGxpbWl0czogVXNhZ2VMaW1pdHM7XG59O1xuXG4vLyBTaW5nbGUgc291cmNlIG9mIHRydXRoIGZvciBwcm9kdWN0IGxhZGRlci5cbi8vIEtlZXAgbGltaXRzIGFzIGNvbnN0YW50cyBzbyB0aGV5IGNhbiBiZSB0dW5lZCBsYXRlciB3aXRob3V0IGNoYXNpbmcgdXNhZ2UgbG9naWMgYWNyb3NzIHRoZSBjb2RlYmFzZS5cbmV4cG9ydCBjb25zdCBQTEFOUzogUmVjb3JkPFBsYW5LZXksIFBsYW4+ID0ge1xuICBmcmVlOiB7XG4gICAga2V5OiBcImZyZWVcIixcbiAgICBsYWJlbDogXCJGcmVlXCIsXG4gICAgZGVzY3JpcHRpb246IFwiU21hbGwgbW9udGhseSBidW5kbGUsIGhhcmQgZGFpbHkgY2FwLCBubyByb2xsb3ZlcnMuIEVub3VnaCB0byB0YXN0ZSwgbm90IGVub3VnaCB0byBmYXJtLlwiLFxuICAgIGZlYXR1cmVzOiBbXSxcbiAgICBsaW1pdHM6IHtcbiAgICAgIG1heFVwbG9hZEJ5dGVzOiAxXzAwMF8wMDAsIC8vIDEgTUJcbiAgICAgIG1heEV4cG9ydHNQZXJEYXk6IDMsXG4gICAgICBtb250aGx5Q3JlZGl0czogMzAwLCAvLyAzMDAgY3JlZGl0cy9tb250aFxuICAgICAgZGFpbHlDcmVkaXRDYXA6IDMwLCAvLyBNYXggMzAgY3JlZGl0cy9kYXlcbiAgICB9LFxuICB9LFxuICBzdXBwb3J0ZXI6IHtcbiAgICBrZXk6IFwic3VwcG9ydGVyXCIsXG4gICAgbGFiZWw6IFwiU3VwcG9ydGVyXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQWltZWQgYXQgbGVhcm5lcnMgYW5kIGhvYmJ5aXN0cy4gSGlnaGVyIGxpbWl0cyBhbmQgYmFzaWMgY2xvdWQgc2F2ZS5cIixcbiAgICBmZWF0dXJlczogW1wiYWR2YW5jZWRfZGFzaGJvYXJkc1wiLCBcImxhcmdlcl9saW1pdHNcIl0sXG4gICAgbGltaXRzOiB7XG4gICAgICBtYXhVcGxvYWRCeXRlczogMjBfMDAwXzAwMCwgLy8gMjAgTUJcbiAgICAgIG1heEV4cG9ydHNQZXJEYXk6IDI1LFxuICAgICAgbW9udGhseUNyZWRpdHM6IDNfMDAwLCAvLyAzLDAwMCBjcmVkaXRzL21vbnRoXG4gICAgICBkYWlseUNyZWRpdENhcDogMzAwLCAvLyBNYXggMzAwIGNyZWRpdHMvZGF5XG4gICAgfSxcbiAgfSxcbiAgcHJvOiB7XG4gICAga2V5OiBcInByb1wiLFxuICAgIGxhYmVsOiBcIlByb2Zlc3Npb25hbFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFpbWVkIGF0IHNlcmlvdXMgYnVpbGRlcnMuIEFQSSBhY2Nlc3MsIHdlYmhvb2tzLCBhbmQgaGlnaGVyIGNvbmN1cnJlbmN5LlwiLFxuICAgIGZlYXR1cmVzOiBbXG4gICAgICBcInRlbXBsYXRlc19kb3dubG9hZFwiLFxuICAgICAgXCJoaXN0b3J5X2V4cG9ydFwiLFxuICAgICAgXCJyZXBvcnRzX2V4cG9ydFwiLFxuICAgICAgXCJjcGRfZXZpZGVuY2VfZXhwb3J0XCIsXG4gICAgICBcImVhcmx5X2FjY2Vzc1wiLFxuICAgICAgXCJhZHZhbmNlZF9kYXNoYm9hcmRzXCIsXG4gICAgICBcImxhcmdlcl9saW1pdHNcIixcbiAgICAgIFwiYXBpX2FjY2Vzc1wiLFxuICAgICAgXCJ3ZWJob29rc1wiLFxuICAgIF0sXG4gICAgbGltaXRzOiB7XG4gICAgICBtYXhVcGxvYWRCeXRlczogMTAwXzAwMF8wMDAsIC8vIDEwMCBNQlxuICAgICAgbWF4RXhwb3J0c1BlckRheTogMTAwLFxuICAgICAgbW9udGhseUNyZWRpdHM6IDEyXzAwMCwgLy8gMTIsMDAwIGNyZWRpdHMvbW9udGhcbiAgICAgIGRhaWx5Q3JlZGl0Q2FwOiAyXzAwMCwgLy8gTWF4IDIsMDAwIGNyZWRpdHMvZGF5XG4gICAgfSxcbiAgfSxcbn07XG5cbi8vIENyZWRpdCB0b3AtdXAgcGFja3NcbmV4cG9ydCBjb25zdCBDUkVESVRfUEFDS1MgPSBbXG4gIHsgaWQ6IFwic3RhcnRlclwiLCBsYWJlbDogXCJTdGFydGVyXCIsIHByaWNlOiAxMCwgY3JlZGl0czogNTAwLCBwcmljZVBlckNyZWRpdDogMC4wMiB9LFxuICB7IGlkOiBcInN0YW5kYXJkXCIsIGxhYmVsOiBcIlN0YW5kYXJkXCIsIHByaWNlOiAyNSwgY3JlZGl0czogMV80MDAsIHByaWNlUGVyQ3JlZGl0OiAwLjAxNzkgfSwgLy8gMTAlIGJ1bGsgZGlzY291bnRcbiAgeyBpZDogXCJwcm9mZXNzaW9uYWxcIiwgbGFiZWw6IFwiUHJvZmVzc2lvbmFsXCIsIHByaWNlOiA1MCwgY3JlZGl0czogM18wMDAsIHByaWNlUGVyQ3JlZGl0OiAwLjAxNjcgfSwgLy8gMTclIGJ1bGsgZGlzY291bnRcbl0gYXMgY29uc3Q7XG5cbi8vIFB1YmxpYyBjcmVkaXQgcHJpY2UgKHBlciBjcmVkaXQpXG5leHBvcnQgY29uc3QgQ1JFRElUX1BSSUNFID0gMC4wMjsgLy8gwqMwLjAyIHBlciBjcmVkaXRcblxuZXhwb3J0IGZ1bmN0aW9uIHBsYW5SYW5rKHBsYW46IFBsYW5LZXkpIHtcbiAgaWYgKHBsYW4gPT09IFwicHJvXCIpIHJldHVybiAzO1xuICBpZiAocGxhbiA9PT0gXCJzdXBwb3J0ZXJcIikgcmV0dXJuIDI7XG4gIHJldHVybiAxO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJQTEFOUyIsImZyZWUiLCJrZXkiLCJsYWJlbCIsImRlc2NyaXB0aW9uIiwiZmVhdHVyZXMiLCJsaW1pdHMiLCJtYXhVcGxvYWRCeXRlcyIsIm1heEV4cG9ydHNQZXJEYXkiLCJtb250aGx5Q3JlZGl0cyIsImRhaWx5Q3JlZGl0Q2FwIiwic3VwcG9ydGVyIiwicHJvIiwiQ1JFRElUX1BBQ0tTIiwiaWQiLCJwcmljZSIsImNyZWRpdHMiLCJwcmljZVBlckNyZWRpdCIsIkNSRURJVF9QUklDRSIsInBsYW5SYW5rIiwicGxhbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/billing/plans.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/billing/store.ts":
/*!**********************************!*\
  !*** ./src/lib/billing/store.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addDonation: () => (/* binding */ addDonation),\n/* harmony export */   addTemplateDownload: () => (/* binding */ addTemplateDownload),\n/* harmony export */   addToolRun: () => (/* binding */ addToolRun),\n/* harmony export */   countToolRunsSince: () => (/* binding */ countToolRunsSince),\n/* harmony export */   deleteUserBillingData: () => (/* binding */ deleteUserBillingData),\n/* harmony export */   getUserPlanRecord: () => (/* binding */ getUserPlanRecord),\n/* harmony export */   listTemplateDownloads: () => (/* binding */ listTemplateDownloads),\n/* harmony export */   listToolRuns: () => (/* binding */ listToolRuns),\n/* harmony export */   upsertUserPlan: () => (/* binding */ upsertUserPlan)\n/* harmony export */ });\n/* harmony import */ var _lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/storage/jsonFile */ \"(rsc)/./src/lib/storage/jsonFile.ts\");\n\nconst STORE_PATH = process.env.BILLING_STORE_PATH || \"data/billing-store.json\";\nconst empty = {\n    userPlans: [],\n    toolRuns: [],\n    templateDownloads: [],\n    donations: []\n};\nfunction load() {\n    return (0,_lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_0__.readJsonFile)(STORE_PATH, empty);\n}\nfunction save(store) {\n    (0,_lib_storage_jsonFile__WEBPACK_IMPORTED_MODULE_0__.writeJsonFile)(STORE_PATH, store);\n}\nfunction upsertUserPlan(record) {\n    const s = load();\n    s.userPlans = s.userPlans.filter((p)=>p.userId !== record.userId);\n    s.userPlans.push(record);\n    save(s);\n    return record;\n}\nfunction getUserPlanRecord(userId) {\n    const s = load();\n    return s.userPlans.find((p)=>p.userId === userId) || null;\n}\nfunction addToolRun(record) {\n    const s = load();\n    s.toolRuns.push({\n        ...record,\n        userId: record.userId || null,\n        anonymousUserId: record.anonymousUserId || null\n    });\n    save(s);\n    return record;\n}\nfunction listToolRuns(filters = {}, limit = 50) {\n    const s = load();\n    return [\n        ...s.toolRuns\n    ].filter((r)=>filters.userId ? r.userId === filters.userId : true).filter((r)=>filters.anonymousUserId ? r.anonymousUserId === filters.anonymousUserId : true).sort((a, b)=>(b.timestamp || \"\").localeCompare(a.timestamp || \"\")).slice(0, limit);\n}\nfunction countToolRunsSince(filters, sinceIso) {\n    const s = load();\n    return s.toolRuns.filter((r)=>filters.userId ? r.userId === filters.userId : true).filter((r)=>filters.anonymousUserId ? r.anonymousUserId === filters.anonymousUserId : true).filter((r)=>(r.timestamp || \"\") >= sinceIso).length;\n}\nfunction addTemplateDownload(record) {\n    const s = load();\n    s.templateDownloads.push({\n        ...record,\n        userId: record.userId || null,\n        anonymousUserId: record.anonymousUserId || null\n    });\n    save(s);\n    return record;\n}\nfunction listTemplateDownloads(filters = {}, limit = 50) {\n    const s = load();\n    return [\n        ...s.templateDownloads\n    ].filter((r)=>filters.userId ? r.userId === filters.userId : true).filter((r)=>filters.anonymousUserId ? r.anonymousUserId === filters.anonymousUserId : true).sort((a, b)=>(b.timestamp || \"\").localeCompare(a.timestamp || \"\")).slice(0, limit);\n}\nfunction addDonation(record) {\n    const s = load();\n    const exists = s.donations.some((d)=>d.stripeEventId === record.stripeEventId);\n    if (!exists) {\n        s.donations.push({\n            ...record,\n            userId: record.userId || null,\n            stripeSessionId: record.stripeSessionId || null,\n            stripePaymentIntentId: record.stripePaymentIntentId || null\n        });\n        save(s);\n    }\n    return record;\n}\nfunction deleteUserBillingData(userId) {\n    const s = load();\n    s.userPlans = s.userPlans.filter((p)=>p.userId !== userId);\n    s.toolRuns = s.toolRuns.filter((r)=>r.userId !== userId);\n    s.templateDownloads = s.templateDownloads.filter((r)=>r.userId !== userId);\n    s.donations = s.donations.filter((d)=>d.userId !== userId);\n    save(s);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFVCxNQUFNLEtBQUtBO0lBQ3JFSCxFQUFFTixTQUFTLEdBQUdNLEVBQUVOLFNBQVMsQ0FBQ08sTUFBTSxDQUFDLENBQUMwQixJQUFNQSxFQUFFeEIsTUFBTSxLQUFLQTtJQUNyRFAsS0FBS0k7QUFDUCIsInNvdXJjZXMiOlsiL3dvcmtzcGFjZS9zcmMvbGliL2JpbGxpbmcvc3RvcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVhZEpzb25GaWxlLCB3cml0ZUpzb25GaWxlIH0gZnJvbSBcIkAvbGliL3N0b3JhZ2UvanNvbkZpbGVcIjtcblxuZXhwb3J0IHR5cGUgVXNlclBsYW5SZWNvcmQgPSB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBwbGFuOiBcImZyZWVcIiB8IFwic3VwcG9ydGVyXCIgfCBcInByb1wiO1xuICBzb3VyY2U6IFwiZGVmYXVsdFwiIHwgXCJkb25hdGlvblwiIHwgXCJtYW51YWxcIiB8IFwiZnV0dXJlXCI7XG4gIHVwZGF0ZWRBdDogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgVG9vbFJ1blJlY29yZCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkPzogc3RyaW5nIHwgbnVsbDtcbiAgYW5vbnltb3VzVXNlcklkPzogc3RyaW5nIHwgbnVsbDtcbiAgdG9vbElkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufTtcblxuZXhwb3J0IHR5cGUgVGVtcGxhdGVEb3dubG9hZFJlY29yZCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkPzogc3RyaW5nIHwgbnVsbDtcbiAgYW5vbnltb3VzVXNlcklkPzogc3RyaW5nIHwgbnVsbDtcbiAgdGVtcGxhdGVJZDogc3RyaW5nO1xuICBsaWNlbnNlQ2hvaWNlOiBcImludGVybmFsX3VzZVwiIHwgXCJjb21tZXJjaWFsX3VzZVwiO1xuICBzaWduYXR1cmVQb2xpY3lBcHBsaWVkOiBcImtlcHRcIiB8IFwicmVtb3ZlZFwiO1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbn07XG5cbnR5cGUgQmlsbGluZ1N0b3JlID0ge1xuICB1c2VyUGxhbnM6IFVzZXJQbGFuUmVjb3JkW107XG4gIHRvb2xSdW5zOiBUb29sUnVuUmVjb3JkW107XG4gIHRlbXBsYXRlRG93bmxvYWRzOiBUZW1wbGF0ZURvd25sb2FkUmVjb3JkW107XG4gIGRvbmF0aW9uczogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgc3RyaXBlRXZlbnRJZDogc3RyaW5nO1xuICAgIHN0cmlwZVNlc3Npb25JZD86IHN0cmluZyB8IG51bGw7XG4gICAgc3RyaXBlUGF5bWVudEludGVudElkPzogc3RyaW5nIHwgbnVsbDtcbiAgICBhbW91bnQ6IG51bWJlcjtcbiAgICBjdXJyZW5jeTogc3RyaW5nO1xuICAgIHN0YXR1czogXCJwYWlkXCIgfCBcImZhaWxlZFwiO1xuICAgIHVzZXJJZD86IHN0cmluZyB8IG51bGw7XG4gICAgY3JlYXRlZEF0OiBzdHJpbmc7XG4gIH0+O1xufTtcblxuY29uc3QgU1RPUkVfUEFUSCA9IHByb2Nlc3MuZW52LkJJTExJTkdfU1RPUkVfUEFUSCB8fCBcImRhdGEvYmlsbGluZy1zdG9yZS5qc29uXCI7XG5jb25zdCBlbXB0eTogQmlsbGluZ1N0b3JlID0geyB1c2VyUGxhbnM6IFtdLCB0b29sUnVuczogW10sIHRlbXBsYXRlRG93bmxvYWRzOiBbXSwgZG9uYXRpb25zOiBbXSB9O1xuXG5mdW5jdGlvbiBsb2FkKCkge1xuICByZXR1cm4gcmVhZEpzb25GaWxlPEJpbGxpbmdTdG9yZT4oU1RPUkVfUEFUSCwgZW1wdHkpO1xufVxuXG5mdW5jdGlvbiBzYXZlKHN0b3JlOiBCaWxsaW5nU3RvcmUpIHtcbiAgd3JpdGVKc29uRmlsZShTVE9SRV9QQVRILCBzdG9yZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cHNlcnRVc2VyUGxhbihyZWNvcmQ6IFVzZXJQbGFuUmVjb3JkKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHMudXNlclBsYW5zID0gcy51c2VyUGxhbnMuZmlsdGVyKChwKSA9PiBwLnVzZXJJZCAhPT0gcmVjb3JkLnVzZXJJZCk7XG4gIHMudXNlclBsYW5zLnB1c2gocmVjb3JkKTtcbiAgc2F2ZShzKTtcbiAgcmV0dXJuIHJlY29yZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZXJQbGFuUmVjb3JkKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHJldHVybiBzLnVzZXJQbGFucy5maW5kKChwKSA9PiBwLnVzZXJJZCA9PT0gdXNlcklkKSB8fCBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkVG9vbFJ1bihyZWNvcmQ6IFRvb2xSdW5SZWNvcmQpIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgcy50b29sUnVucy5wdXNoKHtcbiAgICAuLi5yZWNvcmQsXG4gICAgdXNlcklkOiByZWNvcmQudXNlcklkIHx8IG51bGwsXG4gICAgYW5vbnltb3VzVXNlcklkOiByZWNvcmQuYW5vbnltb3VzVXNlcklkIHx8IG51bGwsXG4gIH0pO1xuICBzYXZlKHMpO1xuICByZXR1cm4gcmVjb3JkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdFRvb2xSdW5zKGZpbHRlcnM6IHsgdXNlcklkPzogc3RyaW5nIHwgbnVsbDsgYW5vbnltb3VzVXNlcklkPzogc3RyaW5nIHwgbnVsbCB9ID0ge30sIGxpbWl0ID0gNTApIHtcbiAgY29uc3QgcyA9IGxvYWQoKTtcbiAgcmV0dXJuIFsuLi5zLnRvb2xSdW5zXVxuICAgIC5maWx0ZXIoKHIpID0+IChmaWx0ZXJzLnVzZXJJZCA/IHIudXNlcklkID09PSBmaWx0ZXJzLnVzZXJJZCA6IHRydWUpKVxuICAgIC5maWx0ZXIoKHIpID0+IChmaWx0ZXJzLmFub255bW91c1VzZXJJZCA/IHIuYW5vbnltb3VzVXNlcklkID09PSBmaWx0ZXJzLmFub255bW91c1VzZXJJZCA6IHRydWUpKVxuICAgIC5zb3J0KChhLCBiKSA9PiAoYi50aW1lc3RhbXAgfHwgXCJcIikubG9jYWxlQ29tcGFyZShhLnRpbWVzdGFtcCB8fCBcIlwiKSlcbiAgICAuc2xpY2UoMCwgbGltaXQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY291bnRUb29sUnVuc1NpbmNlKGZpbHRlcnM6IHsgdXNlcklkPzogc3RyaW5nIHwgbnVsbDsgYW5vbnltb3VzVXNlcklkPzogc3RyaW5nIHwgbnVsbCB9LCBzaW5jZUlzbzogc3RyaW5nKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIHJldHVybiBzLnRvb2xSdW5zLmZpbHRlcigocikgPT4gKGZpbHRlcnMudXNlcklkID8gci51c2VySWQgPT09IGZpbHRlcnMudXNlcklkIDogdHJ1ZSkpXG4gICAgLmZpbHRlcigocikgPT4gKGZpbHRlcnMuYW5vbnltb3VzVXNlcklkID8gci5hbm9ueW1vdXNVc2VySWQgPT09IGZpbHRlcnMuYW5vbnltb3VzVXNlcklkIDogdHJ1ZSkpXG4gICAgLmZpbHRlcigocikgPT4gKHIudGltZXN0YW1wIHx8IFwiXCIpID49IHNpbmNlSXNvKS5sZW5ndGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRUZW1wbGF0ZURvd25sb2FkKHJlY29yZDogVGVtcGxhdGVEb3dubG9hZFJlY29yZCkge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICBzLnRlbXBsYXRlRG93bmxvYWRzLnB1c2goe1xuICAgIC4uLnJlY29yZCxcbiAgICB1c2VySWQ6IHJlY29yZC51c2VySWQgfHwgbnVsbCxcbiAgICBhbm9ueW1vdXNVc2VySWQ6IHJlY29yZC5hbm9ueW1vdXNVc2VySWQgfHwgbnVsbCxcbiAgfSk7XG4gIHNhdmUocyk7XG4gIHJldHVybiByZWNvcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXN0VGVtcGxhdGVEb3dubG9hZHMoZmlsdGVyczogeyB1c2VySWQ/OiBzdHJpbmcgfCBudWxsOyBhbm9ueW1vdXNVc2VySWQ/OiBzdHJpbmcgfCBudWxsIH0gPSB7fSwgbGltaXQgPSA1MCkge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICByZXR1cm4gWy4uLnMudGVtcGxhdGVEb3dubG9hZHNdXG4gICAgLmZpbHRlcigocikgPT4gKGZpbHRlcnMudXNlcklkID8gci51c2VySWQgPT09IGZpbHRlcnMudXNlcklkIDogdHJ1ZSkpXG4gICAgLmZpbHRlcigocikgPT4gKGZpbHRlcnMuYW5vbnltb3VzVXNlcklkID8gci5hbm9ueW1vdXNVc2VySWQgPT09IGZpbHRlcnMuYW5vbnltb3VzVXNlcklkIDogdHJ1ZSkpXG4gICAgLnNvcnQoKGEsIGIpID0+IChiLnRpbWVzdGFtcCB8fCBcIlwiKS5sb2NhbGVDb21wYXJlKGEudGltZXN0YW1wIHx8IFwiXCIpKVxuICAgIC5zbGljZSgwLCBsaW1pdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGREb25hdGlvbihyZWNvcmQ6IEJpbGxpbmdTdG9yZVtcImRvbmF0aW9uc1wiXVtudW1iZXJdKSB7XG4gIGNvbnN0IHMgPSBsb2FkKCk7XG4gIGNvbnN0IGV4aXN0cyA9IHMuZG9uYXRpb25zLnNvbWUoKGQpID0+IGQuc3RyaXBlRXZlbnRJZCA9PT0gcmVjb3JkLnN0cmlwZUV2ZW50SWQpO1xuICBpZiAoIWV4aXN0cykge1xuICAgIHMuZG9uYXRpb25zLnB1c2goe1xuICAgICAgLi4ucmVjb3JkLFxuICAgICAgdXNlcklkOiByZWNvcmQudXNlcklkIHx8IG51bGwsXG4gICAgICBzdHJpcGVTZXNzaW9uSWQ6IHJlY29yZC5zdHJpcGVTZXNzaW9uSWQgfHwgbnVsbCxcbiAgICAgIHN0cmlwZVBheW1lbnRJbnRlbnRJZDogcmVjb3JkLnN0cmlwZVBheW1lbnRJbnRlbnRJZCB8fCBudWxsLFxuICAgIH0pO1xuICAgIHNhdmUocyk7XG4gIH1cbiAgcmV0dXJuIHJlY29yZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVVzZXJCaWxsaW5nRGF0YSh1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBzID0gbG9hZCgpO1xuICBzLnVzZXJQbGFucyA9IHMudXNlclBsYW5zLmZpbHRlcigocCkgPT4gcC51c2VySWQgIT09IHVzZXJJZCk7XG4gIHMudG9vbFJ1bnMgPSBzLnRvb2xSdW5zLmZpbHRlcigocikgPT4gci51c2VySWQgIT09IHVzZXJJZCk7XG4gIHMudGVtcGxhdGVEb3dubG9hZHMgPSBzLnRlbXBsYXRlRG93bmxvYWRzLmZpbHRlcigocikgPT4gci51c2VySWQgIT09IHVzZXJJZCk7XG4gIHMuZG9uYXRpb25zID0gcy5kb25hdGlvbnMuZmlsdGVyKChkKSA9PiBkLnVzZXJJZCAhPT0gdXNlcklkKTtcbiAgc2F2ZShzKTtcbn1cblxuXG4iXSwibmFtZXMiOlsicmVhZEpzb25GaWxlIiwid3JpdGVKc29uRmlsZSIsIlNUT1JFX1BBVEgiLCJwcm9jZXNzIiwiZW52IiwiQklMTElOR19TVE9SRV9QQVRIIiwiZW1wdHkiLCJ1c2VyUGxhbnMiLCJ0b29sUnVucyIsInRlbXBsYXRlRG93bmxvYWRzIiwiZG9uYXRpb25zIiwibG9hZCIsInNhdmUiLCJzdG9yZSIsInVwc2VydFVzZXJQbGFuIiwicmVjb3JkIiwicyIsImZpbHRlciIsInAiLCJ1c2VySWQiLCJwdXNoIiwiZ2V0VXNlclBsYW5SZWNvcmQiLCJmaW5kIiwiYWRkVG9vbFJ1biIsImFub255bW91c1VzZXJJZCIsImxpc3RUb29sUnVucyIsImZpbHRlcnMiLCJsaW1pdCIsInIiLCJzb3J0IiwiYSIsImIiLCJ0aW1lc3RhbXAiLCJsb2NhbGVDb21wYXJlIiwic2xpY2UiLCJjb3VudFRvb2xSdW5zU2luY2UiLCJzaW5jZUlzbyIsImxlbmd0aCIsImFkZFRlbXBsYXRlRG93bmxvYWQiLCJsaXN0VGVtcGxhdGVEb3dubG9hZHMiLCJhZGREb25hdGlvbiIsImV4aXN0cyIsInNvbWUiLCJkIiwic3RyaXBlRXZlbnRJZCIsInN0cmlwZVNlc3Npb25JZCIsInN0cmlwZVBheW1lbnRJbnRlbnRJZCIsImRlbGV0ZVVzZXJCaWxsaW5nRGF0YSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/billing/store.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db/prisma.ts":
/*!******************************!*\
  !*** ./src/lib/db/prisma.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// Default DB for local dev when env is missing.\n// This keeps local dev lightweight and avoids \"silent\" runtime failures.\nif (!process.env.DATABASE_URL) {\n    process.env.DATABASE_URL = \"file:./data/dev.db\";\n}\nconst prisma = global.__prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"error\"\n    ]\n});\nif (true) {\n    global.__prisma = prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFFOUMsZ0RBQWdEO0FBQ2hELHlFQUF5RTtBQUN6RSxJQUFJLENBQUNDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWSxFQUFFO0lBQzdCRixRQUFRQyxHQUFHLENBQUNDLFlBQVksR0FBRztBQUM3QjtBQU1PLE1BQU1DLFNBQ1hDLE9BQU9DLFFBQVEsSUFDZixJQUFJTix3REFBWUEsQ0FBQztJQUNmTyxLQUFLO1FBQUM7S0FBUTtBQUNoQixHQUFHO0FBRUwsSUFBSU4sSUFBcUMsRUFBRTtJQUN6Q0ksT0FBT0MsUUFBUSxHQUFHRjtBQUNwQiIsInNvdXJjZXMiOlsiL3dvcmtzcGFjZS9zcmMvbGliL2RiL3ByaXNtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcblxuLy8gRGVmYXVsdCBEQiBmb3IgbG9jYWwgZGV2IHdoZW4gZW52IGlzIG1pc3NpbmcuXG4vLyBUaGlzIGtlZXBzIGxvY2FsIGRldiBsaWdodHdlaWdodCBhbmQgYXZvaWRzIFwic2lsZW50XCIgcnVudGltZSBmYWlsdXJlcy5cbmlmICghcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB7XG4gIHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCA9IFwiZmlsZTouL2RhdGEvZGV2LmRiXCI7XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWE6IFByaXNtYUNsaWVudCA9XG4gIGdsb2JhbC5fX3ByaXNtYSB8fFxuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IFtcImVycm9yXCJdLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICBnbG9iYWwuX19wcmlzbWEgPSBwcmlzbWE7XG59XG5cblxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJwcmlzbWEiLCJnbG9iYWwiLCJfX3ByaXNtYSIsImxvZyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/security/rateLimit.ts":
/*!***************************************!*\
  !*** ./src/lib/security/rateLimit.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   rateLimit: () => (/* binding */ rateLimit)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst buckets = new Map();\nfunction hash(value) {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"sha256\").update(value).digest(\"hex\").slice(0, 24);\n}\nfunction getClientKey(req, keySuffix) {\n    // Privacy: we do not persist IPs; we only keep a short-lived hash in memory.\n    const forwarded = req.headers.get(\"x-forwarded-for\") || \"\";\n    const ip = forwarded.split(\",\")[0]?.trim() || req.headers.get(\"x-real-ip\") || \"unknown\";\n    const ua = req.headers.get(\"user-agent\") || \"unknown\";\n    return hash(`${ip}|${ua}|${keySuffix || \"\"}`);\n}\nfunction rateLimit(req, opts) {\n    const now = Date.now();\n    const key = `${opts.keyPrefix}:${getClientKey(req, opts.keySuffix)}`;\n    const existing = buckets.get(key);\n    if (!existing || existing.resetAt <= now) {\n        buckets.set(key, {\n            count: 1,\n            resetAt: now + opts.windowMs\n        });\n        return null;\n    }\n    existing.count += 1;\n    if (existing.count > opts.limit) {\n        const retryAfter = Math.max(1, Math.ceil((existing.resetAt - now) / 1000));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: opts.message || \"Too many requests. Please try again shortly.\"\n        }, {\n            status: 429,\n            headers: {\n                \"retry-after\": String(retryAfter)\n            }\n        });\n    }\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlY3VyaXR5L3JhdGVMaW1pdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ2Y7QUFZNUIsTUFBTUUsVUFBVSxJQUFJQztBQUVwQixTQUFTQyxLQUFLQyxLQUFhO0lBQ3pCLE9BQU9KLHdEQUFpQixDQUFDLFVBQVVNLE1BQU0sQ0FBQ0YsT0FBT0csTUFBTSxDQUFDLE9BQU9DLEtBQUssQ0FBQyxHQUFHO0FBQzFFO0FBRUEsU0FBU0MsYUFBYUMsR0FBWSxFQUFFQyxTQUFrQjtJQUNwRCw2RUFBNkU7SUFDN0UsTUFBTUMsWUFBWUYsSUFBSUcsT0FBTyxDQUFDQyxHQUFHLENBQUMsc0JBQXNCO0lBQ3hELE1BQU1DLEtBQUtILFVBQVVJLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFQyxVQUFVUCxJQUFJRyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxnQkFBZ0I7SUFDOUUsTUFBTUksS0FBS1IsSUFBSUcsT0FBTyxDQUFDQyxHQUFHLENBQUMsaUJBQWlCO0lBQzVDLE9BQU9YLEtBQUssR0FBR1ksR0FBRyxDQUFDLEVBQUVHLEdBQUcsQ0FBQyxFQUFFUCxhQUFhLElBQUk7QUFDOUM7QUFFTyxTQUFTUSxVQUFVVCxHQUFZLEVBQUVVLElBQWE7SUFDbkQsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUNwQixNQUFNRSxNQUFNLEdBQUdILEtBQUtJLFNBQVMsQ0FBQyxDQUFDLEVBQUVmLGFBQWFDLEtBQUtVLEtBQUtULFNBQVMsR0FBRztJQUNwRSxNQUFNYyxXQUFXeEIsUUFBUWEsR0FBRyxDQUFDUztJQUM3QixJQUFJLENBQUNFLFlBQVlBLFNBQVNDLE9BQU8sSUFBSUwsS0FBSztRQUN4Q3BCLFFBQVEwQixHQUFHLENBQUNKLEtBQUs7WUFBRUssT0FBTztZQUFHRixTQUFTTCxNQUFNRCxLQUFLUyxRQUFRO1FBQUM7UUFDMUQsT0FBTztJQUNUO0lBQ0FKLFNBQVNHLEtBQUssSUFBSTtJQUNsQixJQUFJSCxTQUFTRyxLQUFLLEdBQUdSLEtBQUtVLEtBQUssRUFBRTtRQUMvQixNQUFNQyxhQUFhQyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsSUFBSSxDQUFDLENBQUNULFNBQVNDLE9BQU8sR0FBR0wsR0FBRSxJQUFLO1FBQ3BFLE9BQU90QixxREFBWUEsQ0FBQ29DLElBQUksQ0FDdEI7WUFBRUMsT0FBT2hCLEtBQUtpQixPQUFPLElBQUk7UUFBK0MsR0FDeEU7WUFBRUMsUUFBUTtZQUFLekIsU0FBUztnQkFBRSxlQUFlMEIsT0FBT1I7WUFBWTtRQUFFO0lBRWxFO0lBQ0EsT0FBTztBQUNUIiwic291cmNlcyI6WyIvd29ya3NwYWNlL3NyYy9saWIvc2VjdXJpdHkvcmF0ZUxpbWl0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XG5cbnR5cGUgT3B0aW9ucyA9IHtcbiAga2V5UHJlZml4OiBzdHJpbmc7XG4gIGxpbWl0OiBudW1iZXI7XG4gIHdpbmRvd01zOiBudW1iZXI7XG4gIGtleVN1ZmZpeD86IHN0cmluZztcbiAgbWVzc2FnZT86IHN0cmluZztcbn07XG5cbnR5cGUgRW50cnkgPSB7IGNvdW50OiBudW1iZXI7IHJlc2V0QXQ6IG51bWJlciB9O1xuXG5jb25zdCBidWNrZXRzID0gbmV3IE1hcDxzdHJpbmcsIEVudHJ5PigpO1xuXG5mdW5jdGlvbiBoYXNoKHZhbHVlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGNyeXB0by5jcmVhdGVIYXNoKFwic2hhMjU2XCIpLnVwZGF0ZSh2YWx1ZSkuZGlnZXN0KFwiaGV4XCIpLnNsaWNlKDAsIDI0KTtcbn1cblxuZnVuY3Rpb24gZ2V0Q2xpZW50S2V5KHJlcTogUmVxdWVzdCwga2V5U3VmZml4Pzogc3RyaW5nKSB7XG4gIC8vIFByaXZhY3k6IHdlIGRvIG5vdCBwZXJzaXN0IElQczsgd2Ugb25seSBrZWVwIGEgc2hvcnQtbGl2ZWQgaGFzaCBpbiBtZW1vcnkuXG4gIGNvbnN0IGZvcndhcmRlZCA9IHJlcS5oZWFkZXJzLmdldChcIngtZm9yd2FyZGVkLWZvclwiKSB8fCBcIlwiO1xuICBjb25zdCBpcCA9IGZvcndhcmRlZC5zcGxpdChcIixcIilbMF0/LnRyaW0oKSB8fCByZXEuaGVhZGVycy5nZXQoXCJ4LXJlYWwtaXBcIikgfHwgXCJ1bmtub3duXCI7XG4gIGNvbnN0IHVhID0gcmVxLmhlYWRlcnMuZ2V0KFwidXNlci1hZ2VudFwiKSB8fCBcInVua25vd25cIjtcbiAgcmV0dXJuIGhhc2goYCR7aXB9fCR7dWF9fCR7a2V5U3VmZml4IHx8IFwiXCJ9YCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByYXRlTGltaXQocmVxOiBSZXF1ZXN0LCBvcHRzOiBPcHRpb25zKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGtleSA9IGAke29wdHMua2V5UHJlZml4fToke2dldENsaWVudEtleShyZXEsIG9wdHMua2V5U3VmZml4KX1gO1xuICBjb25zdCBleGlzdGluZyA9IGJ1Y2tldHMuZ2V0KGtleSk7XG4gIGlmICghZXhpc3RpbmcgfHwgZXhpc3RpbmcucmVzZXRBdCA8PSBub3cpIHtcbiAgICBidWNrZXRzLnNldChrZXksIHsgY291bnQ6IDEsIHJlc2V0QXQ6IG5vdyArIG9wdHMud2luZG93TXMgfSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgZXhpc3RpbmcuY291bnQgKz0gMTtcbiAgaWYgKGV4aXN0aW5nLmNvdW50ID4gb3B0cy5saW1pdCkge1xuICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwoKGV4aXN0aW5nLnJlc2V0QXQgLSBub3cpIC8gMTAwMCkpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IG9wdHMubWVzc2FnZSB8fCBcIlRvbyBtYW55IHJlcXVlc3RzLiBQbGVhc2UgdHJ5IGFnYWluIHNob3J0bHkuXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA0MjksIGhlYWRlcnM6IHsgXCJyZXRyeS1hZnRlclwiOiBTdHJpbmcocmV0cnlBZnRlcikgfSB9XG4gICAgKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3J5cHRvIiwiYnVja2V0cyIsIk1hcCIsImhhc2giLCJ2YWx1ZSIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJzbGljZSIsImdldENsaWVudEtleSIsInJlcSIsImtleVN1ZmZpeCIsImZvcndhcmRlZCIsImhlYWRlcnMiLCJnZXQiLCJpcCIsInNwbGl0IiwidHJpbSIsInVhIiwicmF0ZUxpbWl0Iiwib3B0cyIsIm5vdyIsIkRhdGUiLCJrZXkiLCJrZXlQcmVmaXgiLCJleGlzdGluZyIsInJlc2V0QXQiLCJzZXQiLCJjb3VudCIsIndpbmRvd01zIiwibGltaXQiLCJyZXRyeUFmdGVyIiwiTWF0aCIsIm1heCIsImNlaWwiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwic3RhdHVzIiwiU3RyaW5nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/security/rateLimit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/storage/jsonFile.ts":
/*!*************************************!*\
  !*** ./src/lib/storage/jsonFile.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   readJsonFile: () => (/* binding */ readJsonFile),\n/* harmony export */   writeJsonFile: () => (/* binding */ writeJsonFile)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction ensureDir(filePath) {\n    const dir = path__WEBPACK_IMPORTED_MODULE_1___default().dirname(filePath);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dir)) fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(dir, {\n        recursive: true\n    });\n}\nfunction readJsonFile(filePath, fallback) {\n    try {\n        const abs = path__WEBPACK_IMPORTED_MODULE_1___default().isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), filePath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(abs)) return fallback;\n        const raw = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(abs, \"utf8\");\n        return JSON.parse(raw);\n    } catch  {\n        return fallback;\n    }\n}\nfunction writeJsonFile(filePath, value) {\n    const abs = path__WEBPACK_IMPORTED_MODULE_1___default().isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), filePath);\n    ensureDir(abs);\n    const tmp = `${abs}.tmp`;\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(tmp, JSON.stringify(value, null, 2), \"utf8\");\n    fs__WEBPACK_IMPORTED_MODULE_0___default().renameSync(tmp, abs);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N0b3JhZ2UvanNvbkZpbGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQW9CO0FBQ0k7QUFFeEIsU0FBU0UsVUFBVUMsUUFBZ0I7SUFDakMsTUFBTUMsTUFBTUgsbURBQVksQ0FBQ0U7SUFDekIsSUFBSSxDQUFDSCxvREFBYSxDQUFDSSxNQUFNSixtREFBWSxDQUFDSSxLQUFLO1FBQUVJLFdBQVc7SUFBSztBQUMvRDtBQUVPLFNBQVNDLGFBQWdCTixRQUFnQixFQUFFTyxRQUFXO0lBQzNELElBQUk7UUFDRixNQUFNQyxNQUFNVixzREFBZSxDQUFDRSxZQUFZQSxXQUFXRixnREFBUyxDQUFDYSxRQUFRQyxHQUFHLElBQUlaO1FBQzVFLElBQUksQ0FBQ0gsb0RBQWEsQ0FBQ1csTUFBTSxPQUFPRDtRQUNoQyxNQUFNTSxNQUFNaEIsc0RBQWUsQ0FBQ1csS0FBSztRQUNqQyxPQUFPTyxLQUFLQyxLQUFLLENBQUNIO0lBQ3BCLEVBQUUsT0FBTTtRQUNOLE9BQU9OO0lBQ1Q7QUFDRjtBQUVPLFNBQVNVLGNBQWlCakIsUUFBZ0IsRUFBRWtCLEtBQVE7SUFDekQsTUFBTVYsTUFBTVYsc0RBQWUsQ0FBQ0UsWUFBWUEsV0FBV0YsZ0RBQVMsQ0FBQ2EsUUFBUUMsR0FBRyxJQUFJWjtJQUM1RUQsVUFBVVM7SUFDVixNQUFNVyxNQUFNLEdBQUdYLElBQUksSUFBSSxDQUFDO0lBQ3hCWCx1REFBZ0IsQ0FBQ3NCLEtBQUtKLEtBQUtNLFNBQVMsQ0FBQ0gsT0FBTyxNQUFNLElBQUk7SUFDdERyQixvREFBYSxDQUFDc0IsS0FBS1g7QUFDckIiLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL2xpYi9zdG9yYWdlL2pzb25GaWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmZ1bmN0aW9uIGVuc3VyZURpcihmaWxlUGF0aDogc3RyaW5nKSB7XG4gIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZShmaWxlUGF0aCk7XG4gIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRKc29uRmlsZTxUPihmaWxlUGF0aDogc3RyaW5nLCBmYWxsYmFjazogVCk6IFQge1xuICB0cnkge1xuICAgIGNvbnN0IGFicyA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBmaWxlUGF0aCk7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGFicykpIHJldHVybiBmYWxsYmFjaztcbiAgICBjb25zdCByYXcgPSBmcy5yZWFkRmlsZVN5bmMoYWJzLCBcInV0ZjhcIik7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UocmF3KSBhcyBUO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsbGJhY2s7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlSnNvbkZpbGU8VD4oZmlsZVBhdGg6IHN0cmluZywgdmFsdWU6IFQpIHtcbiAgY29uc3QgYWJzID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIGZpbGVQYXRoKTtcbiAgZW5zdXJlRGlyKGFicyk7XG4gIGNvbnN0IHRtcCA9IGAke2Fic30udG1wYDtcbiAgZnMud3JpdGVGaWxlU3luYyh0bXAsIEpTT04uc3RyaW5naWZ5KHZhbHVlLCBudWxsLCAyKSwgXCJ1dGY4XCIpO1xuICBmcy5yZW5hbWVTeW5jKHRtcCwgYWJzKTtcbn1cblxuXG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiZW5zdXJlRGlyIiwiZmlsZVBhdGgiLCJkaXIiLCJkaXJuYW1lIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInJlYWRKc29uRmlsZSIsImZhbGxiYWNrIiwiYWJzIiwiaXNBYnNvbHV0ZSIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwicmF3IiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwid3JpdGVKc29uRmlsZSIsInZhbHVlIiwidG1wIiwid3JpdGVGaWxlU3luYyIsInN0cmluZ2lmeSIsInJlbmFtZVN5bmMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/storage/jsonFile.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/telemetry/log.ts":
/*!**********************************!*\
  !*** ./src/lib/telemetry/log.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logInfo: () => (/* binding */ logInfo),\n/* harmony export */   logWarn: () => (/* binding */ logWarn)\n/* harmony export */ });\nconst REDACT_KEYS = new Set([\n    \"authorization\",\n    \"cookie\",\n    \"set-cookie\",\n    \"stripe-signature\",\n    \"secret\",\n    \"token\",\n    \"password\",\n    \"apiKey\",\n    \"apikey\",\n    \"client_secret\"\n]);\nfunction isProd() {\n    return \"development\" === \"production\";\n}\nfunction redactValue(value) {\n    if (value == null) return value;\n    if (typeof value === \"string\") {\n        if (value.length <= 6) return \"[REDACTED]\";\n        return \"[REDACTED]\";\n    }\n    return \"[REDACTED]\";\n}\nfunction redactAny(input, depth = 0) {\n    if (depth > 4) return \"[TRUNCATED]\";\n    if (input == null) return input;\n    if (Array.isArray(input)) return input.slice(0, 20).map((v)=>redactAny(v, depth + 1));\n    if (typeof input !== \"object\") return input;\n    const out = {};\n    for (const [k, v] of Object.entries(input)){\n        const key = String(k);\n        const lower = key.toLowerCase();\n        if (REDACT_KEYS.has(lower) || lower.includes(\"secret\") || lower.includes(\"token\") || lower.includes(\"password\")) {\n            out[key] = redactValue(v);\n            continue;\n        }\n        out[key] = redactAny(v, depth + 1);\n    }\n    return out;\n}\nfunction safeFields(fields) {\n    const base = fields && typeof fields === \"object\" ? fields : {};\n    // In production: always redact aggressively.\n    return isProd() ? redactAny(base) : redactAny(base);\n}\nfunction write(level, eventName, fields) {\n    const payload = {\n        level,\n        event: String(eventName || \"\").slice(0, 80),\n        ts: new Date().toISOString(),\n        ...safeFields(fields)\n    };\n    if (level === \"error\") console.error(payload);\n    else if (level === \"warn\") console.warn(payload);\n    else console.log(payload);\n}\nfunction logInfo(eventName, fields) {\n    write(\"info\", eventName, fields);\n}\nfunction logWarn(eventName, fields) {\n    write(\"warn\", eventName, fields);\n}\nfunction logError(eventName, fields) {\n    write(\"error\", eventName, fields);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3RlbGVtZXRyeS9sb2cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRUEsTUFBTUEsY0FBYyxJQUFJQyxJQUFJO0lBQzFCO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0Q7QUFFRCxTQUFTQztJQUNQLE9BQU9DLGtCQUF5QjtBQUNsQztBQUVBLFNBQVNDLFlBQVlDLEtBQWM7SUFDakMsSUFBSUEsU0FBUyxNQUFNLE9BQU9BO0lBQzFCLElBQUksT0FBT0EsVUFBVSxVQUFVO1FBQzdCLElBQUlBLE1BQU1DLE1BQU0sSUFBSSxHQUFHLE9BQU87UUFDOUIsT0FBTztJQUNUO0lBQ0EsT0FBTztBQUNUO0FBRUEsU0FBU0MsVUFBVUMsS0FBVSxFQUFFQyxRQUFRLENBQUM7SUFDdEMsSUFBSUEsUUFBUSxHQUFHLE9BQU87SUFDdEIsSUFBSUQsU0FBUyxNQUFNLE9BQU9BO0lBQzFCLElBQUlFLE1BQU1DLE9BQU8sQ0FBQ0gsUUFBUSxPQUFPQSxNQUFNSSxLQUFLLENBQUMsR0FBRyxJQUFJQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTVAsVUFBVU8sR0FBR0wsUUFBUTtJQUNwRixJQUFJLE9BQU9ELFVBQVUsVUFBVSxPQUFPQTtJQUV0QyxNQUFNTyxNQUFXLENBQUM7SUFDbEIsS0FBSyxNQUFNLENBQUNDLEdBQUdGLEVBQUUsSUFBSUcsT0FBT0MsT0FBTyxDQUFDVixPQUFRO1FBQzFDLE1BQU1XLE1BQU1DLE9BQU9KO1FBQ25CLE1BQU1LLFFBQVFGLElBQUlHLFdBQVc7UUFDN0IsSUFBSXRCLFlBQVl1QixHQUFHLENBQUNGLFVBQVVBLE1BQU1HLFFBQVEsQ0FBQyxhQUFhSCxNQUFNRyxRQUFRLENBQUMsWUFBWUgsTUFBTUcsUUFBUSxDQUFDLGFBQWE7WUFDL0dULEdBQUcsQ0FBQ0ksSUFBSSxHQUFHZixZQUFZVTtZQUN2QjtRQUNGO1FBQ0FDLEdBQUcsQ0FBQ0ksSUFBSSxHQUFHWixVQUFVTyxHQUFHTCxRQUFRO0lBQ2xDO0lBQ0EsT0FBT007QUFDVDtBQUVBLFNBQVNVLFdBQVdDLE1BQTJDO0lBQzdELE1BQU1DLE9BQU9ELFVBQVUsT0FBT0EsV0FBVyxXQUFXQSxTQUFTLENBQUM7SUFDOUQsNkNBQTZDO0lBQzdDLE9BQU94QixXQUFXSyxVQUFVb0IsUUFBUXBCLFVBQVVvQjtBQUNoRDtBQUVBLFNBQVNDLE1BQU1DLEtBQVksRUFBRUMsU0FBaUIsRUFBRUosTUFBZ0M7SUFDOUUsTUFBTUssVUFBVTtRQUNkRjtRQUNBRyxPQUFPWixPQUFPVSxhQUFhLElBQUlsQixLQUFLLENBQUMsR0FBRztRQUN4Q3FCLElBQUksSUFBSUMsT0FBT0MsV0FBVztRQUMxQixHQUFHVixXQUFXQyxPQUFPO0lBQ3ZCO0lBQ0EsSUFBSUcsVUFBVSxTQUFTTyxRQUFRQyxLQUFLLENBQUNOO1NBQ2hDLElBQUlGLFVBQVUsUUFBUU8sUUFBUUUsSUFBSSxDQUFDUDtTQUNuQ0ssUUFBUUcsR0FBRyxDQUFDUjtBQUNuQjtBQUVPLFNBQVNTLFFBQVFWLFNBQWlCLEVBQUVKLE1BQWdDO0lBQ3pFRSxNQUFNLFFBQVFFLFdBQVdKO0FBQzNCO0FBRU8sU0FBU2UsUUFBUVgsU0FBaUIsRUFBRUosTUFBZ0M7SUFDekVFLE1BQU0sUUFBUUUsV0FBV0o7QUFDM0I7QUFFTyxTQUFTZ0IsU0FBU1osU0FBaUIsRUFBRUosTUFBZ0M7SUFDMUVFLE1BQU0sU0FBU0UsV0FBV0o7QUFDNUIiLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL2xpYi90ZWxlbWV0cnkvbG9nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGUgTGV2ZWwgPSBcImluZm9cIiB8IFwid2FyblwiIHwgXCJlcnJvclwiO1xuXG5jb25zdCBSRURBQ1RfS0VZUyA9IG5ldyBTZXQoW1xuICBcImF1dGhvcml6YXRpb25cIixcbiAgXCJjb29raWVcIixcbiAgXCJzZXQtY29va2llXCIsXG4gIFwic3RyaXBlLXNpZ25hdHVyZVwiLFxuICBcInNlY3JldFwiLFxuICBcInRva2VuXCIsXG4gIFwicGFzc3dvcmRcIixcbiAgXCJhcGlLZXlcIixcbiAgXCJhcGlrZXlcIixcbiAgXCJjbGllbnRfc2VjcmV0XCIsXG5dKTtcblxuZnVuY3Rpb24gaXNQcm9kKCkge1xuICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiO1xufVxuXG5mdW5jdGlvbiByZWRhY3RWYWx1ZSh2YWx1ZTogdW5rbm93bikge1xuICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIHZhbHVlO1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgaWYgKHZhbHVlLmxlbmd0aCA8PSA2KSByZXR1cm4gXCJbUkVEQUNURURdXCI7XG4gICAgcmV0dXJuIFwiW1JFREFDVEVEXVwiO1xuICB9XG4gIHJldHVybiBcIltSRURBQ1RFRF1cIjtcbn1cblxuZnVuY3Rpb24gcmVkYWN0QW55KGlucHV0OiBhbnksIGRlcHRoID0gMCk6IGFueSB7XG4gIGlmIChkZXB0aCA+IDQpIHJldHVybiBcIltUUlVOQ0FURURdXCI7XG4gIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gaW5wdXQ7XG4gIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSkgcmV0dXJuIGlucHV0LnNsaWNlKDAsIDIwKS5tYXAoKHYpID0+IHJlZGFjdEFueSh2LCBkZXB0aCArIDEpKTtcbiAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gXCJvYmplY3RcIikgcmV0dXJuIGlucHV0O1xuXG4gIGNvbnN0IG91dDogYW55ID0ge307XG4gIGZvciAoY29uc3QgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKGlucHV0KSkge1xuICAgIGNvbnN0IGtleSA9IFN0cmluZyhrKTtcbiAgICBjb25zdCBsb3dlciA9IGtleS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChSRURBQ1RfS0VZUy5oYXMobG93ZXIpIHx8IGxvd2VyLmluY2x1ZGVzKFwic2VjcmV0XCIpIHx8IGxvd2VyLmluY2x1ZGVzKFwidG9rZW5cIikgfHwgbG93ZXIuaW5jbHVkZXMoXCJwYXNzd29yZFwiKSkge1xuICAgICAgb3V0W2tleV0gPSByZWRhY3RWYWx1ZSh2KTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBvdXRba2V5XSA9IHJlZGFjdEFueSh2LCBkZXB0aCArIDEpO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG5cbmZ1bmN0aW9uIHNhZmVGaWVsZHMoZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IHVuZGVmaW5lZCkge1xuICBjb25zdCBiYXNlID0gZmllbGRzICYmIHR5cGVvZiBmaWVsZHMgPT09IFwib2JqZWN0XCIgPyBmaWVsZHMgOiB7fTtcbiAgLy8gSW4gcHJvZHVjdGlvbjogYWx3YXlzIHJlZGFjdCBhZ2dyZXNzaXZlbHkuXG4gIHJldHVybiBpc1Byb2QoKSA/IHJlZGFjdEFueShiYXNlKSA6IHJlZGFjdEFueShiYXNlKTtcbn1cblxuZnVuY3Rpb24gd3JpdGUobGV2ZWw6IExldmVsLCBldmVudE5hbWU6IHN0cmluZywgZmllbGRzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICBsZXZlbCxcbiAgICBldmVudDogU3RyaW5nKGV2ZW50TmFtZSB8fCBcIlwiKS5zbGljZSgwLCA4MCksXG4gICAgdHM6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAuLi5zYWZlRmllbGRzKGZpZWxkcyksXG4gIH07XG4gIGlmIChsZXZlbCA9PT0gXCJlcnJvclwiKSBjb25zb2xlLmVycm9yKHBheWxvYWQpO1xuICBlbHNlIGlmIChsZXZlbCA9PT0gXCJ3YXJuXCIpIGNvbnNvbGUud2FybihwYXlsb2FkKTtcbiAgZWxzZSBjb25zb2xlLmxvZyhwYXlsb2FkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ0luZm8oZXZlbnROYW1lOiBzdHJpbmcsIGZpZWxkcz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gIHdyaXRlKFwiaW5mb1wiLCBldmVudE5hbWUsIGZpZWxkcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dXYXJuKGV2ZW50TmFtZTogc3RyaW5nLCBmaWVsZHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICB3cml0ZShcIndhcm5cIiwgZXZlbnROYW1lLCBmaWVsZHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9nRXJyb3IoZXZlbnROYW1lOiBzdHJpbmcsIGZpZWxkcz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gIHdyaXRlKFwiZXJyb3JcIiwgZXZlbnROYW1lLCBmaWVsZHMpO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJSRURBQ1RfS0VZUyIsIlNldCIsImlzUHJvZCIsInByb2Nlc3MiLCJyZWRhY3RWYWx1ZSIsInZhbHVlIiwibGVuZ3RoIiwicmVkYWN0QW55IiwiaW5wdXQiLCJkZXB0aCIsIkFycmF5IiwiaXNBcnJheSIsInNsaWNlIiwibWFwIiwidiIsIm91dCIsImsiLCJPYmplY3QiLCJlbnRyaWVzIiwia2V5IiwiU3RyaW5nIiwibG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImhhcyIsImluY2x1ZGVzIiwic2FmZUZpZWxkcyIsImZpZWxkcyIsImJhc2UiLCJ3cml0ZSIsImxldmVsIiwiZXZlbnROYW1lIiwicGF5bG9hZCIsImV2ZW50IiwidHMiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwiZXJyb3IiLCJ3YXJuIiwibG9nIiwibG9nSW5mbyIsImxvZ1dhcm4iLCJsb2dFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/telemetry/log.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/testingMode.ts":
/*!********************************!*\
  !*** ./src/lib/testingMode.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TESTING_MODE_ENABLED: () => (/* binding */ TESTING_MODE_ENABLED),\n/* harmony export */   getTestingOverrideDecision: () => (/* binding */ getTestingOverrideDecision)\n/* harmony export */ });\n/**\n * Temporary testing override.\n *\n * When enabled, access checks should treat everything as \"allowed\" so the site can be QA tested\n * on preview/prod environments without deleting or weakening the underlying access model.\n *\n * Turn off by removing the env var or setting it to \"false\".\n */ const TESTING_MODE_ENABLED = process.env.NEXT_PUBLIC_TESTING_MODE === \"true\";\n/**\n * Single source of truth for the temporary QA/testing override.\n * Do not fake roles or delete access logic  just return early when enabled.\n */ function getTestingOverrideDecision() {\n    if (process.env.NEXT_PUBLIC_TESTING_MODE === \"true\") {\n        return {\n            allowed: true,\n            reason: \"testing-mode\"\n        };\n    }\n    return {\n        allowed: false,\n        reason: \"disabled\"\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Rlc3RpbmdNb2RlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Q0FPQyxHQUNNLE1BQU1BLHVCQUNYQyxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QixLQUFLLE9BQU87QUFNbEQ7OztDQUdDLEdBQ00sU0FBU0M7SUFDZCxJQUFJSCxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QixLQUFLLFFBQVE7UUFDbkQsT0FBTztZQUFFRSxTQUFTO1lBQU1DLFFBQVE7UUFBZTtJQUNqRDtJQUNBLE9BQU87UUFBRUQsU0FBUztRQUFPQyxRQUFRO0lBQVc7QUFDOUMiLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2Uvc3JjL2xpYi90ZXN0aW5nTW9kZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlbXBvcmFyeSB0ZXN0aW5nIG92ZXJyaWRlLlxuICpcbiAqIFdoZW4gZW5hYmxlZCwgYWNjZXNzIGNoZWNrcyBzaG91bGQgdHJlYXQgZXZlcnl0aGluZyBhcyBcImFsbG93ZWRcIiBzbyB0aGUgc2l0ZSBjYW4gYmUgUUEgdGVzdGVkXG4gKiBvbiBwcmV2aWV3L3Byb2QgZW52aXJvbm1lbnRzIHdpdGhvdXQgZGVsZXRpbmcgb3Igd2Vha2VuaW5nIHRoZSB1bmRlcmx5aW5nIGFjY2VzcyBtb2RlbC5cbiAqXG4gKiBUdXJuIG9mZiBieSByZW1vdmluZyB0aGUgZW52IHZhciBvciBzZXR0aW5nIGl0IHRvIFwiZmFsc2VcIi5cbiAqL1xuZXhwb3J0IGNvbnN0IFRFU1RJTkdfTU9ERV9FTkFCTEVEID1cbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfVEVTVElOR19NT0RFID09PSBcInRydWVcIjtcblxuZXhwb3J0IHR5cGUgVGVzdGluZ092ZXJyaWRlRGVjaXNpb24gPVxuICB8IHsgYWxsb3dlZDogdHJ1ZTsgcmVhc29uOiBcInRlc3RpbmctbW9kZVwiIH1cbiAgfCB7IGFsbG93ZWQ6IGZhbHNlOyByZWFzb246IFwiZGlzYWJsZWRcIiB9O1xuXG4vKipcbiAqIFNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIHRoZSB0ZW1wb3JhcnkgUUEvdGVzdGluZyBvdmVycmlkZS5cbiAqIERvIG5vdCBmYWtlIHJvbGVzIG9yIGRlbGV0ZSBhY2Nlc3MgbG9naWMg4oCUIGp1c3QgcmV0dXJuIGVhcmx5IHdoZW4gZW5hYmxlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRlc3RpbmdPdmVycmlkZURlY2lzaW9uKCk6IFRlc3RpbmdPdmVycmlkZURlY2lzaW9uIHtcbiAgaWYgKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1RFU1RJTkdfTU9ERSA9PT0gXCJ0cnVlXCIpIHtcbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlLCByZWFzb246IFwidGVzdGluZy1tb2RlXCIgfTtcbiAgfVxuICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiBcImRpc2FibGVkXCIgfTtcbn1cblxuXG5cbiJdLCJuYW1lcyI6WyJURVNUSU5HX01PREVfRU5BQkxFRCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19URVNUSU5HX01PREUiLCJnZXRUZXN0aW5nT3ZlcnJpZGVEZWNpc2lvbiIsImFsbG93ZWQiLCJyZWFzb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/testingMode.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/progressService.ts":
/*!*****************************************!*\
  !*** ./src/services/progressService.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAdminProgressStats: () => (/* binding */ getAdminProgressStats),\n/* harmony export */   getCpdStateForUser: () => (/* binding */ getCpdStateForUser),\n/* harmony export */   setCpdStateForUser: () => (/* binding */ setCpdStateForUser),\n/* harmony export */   upsertUserIdentity: () => (/* binding */ upsertUserIdentity)\n/* harmony export */ });\n/* harmony import */ var _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db/prisma */ \"(rsc)/./src/lib/db/prisma.ts\");\n\n// Progress persistence rules:\n// - Anonymous users: local-only (handled in client hook; server endpoints require auth)\n// - Signed-in users: server is source of truth for cross-device persistence\nasync function upsertUserIdentity(params) {\n    const email = params.email.trim().toLowerCase();\n    if (!email) return null;\n    return _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.userIdentity.upsert({\n        where: {\n            id: params.userId\n        },\n        create: {\n            id: params.userId,\n            email,\n            provider: params.provider,\n            providerAccountId: params.providerAccountId,\n            lastLoginAt: new Date()\n        },\n        update: {\n            provider: params.provider,\n            providerAccountId: params.providerAccountId,\n            lastLoginAt: new Date()\n        }\n    });\n}\nasync function getCpdStateForUser(userId) {\n    const row = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.cpdState.findUnique({\n        where: {\n            userId\n        }\n    });\n    return row ? {\n        stateJson: row.stateJson,\n        updatedAt: row.updatedAt.toISOString()\n    } : null;\n}\nasync function setCpdStateForUser(params) {\n    const saved = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.cpdState.upsert({\n        where: {\n            userId: params.userId\n        },\n        create: {\n            userId: params.userId,\n            stateJson: params.stateJson\n        },\n        update: {\n            stateJson: params.stateJson\n        }\n    });\n    // Maintain per-section progress rows as a foundation for future CPD evidence/export.\n    // This is derived data: the canonical state is the CPD JSON.\n    try {\n        const state = JSON.parse(params.stateJson);\n        const sections = Array.isArray(state?.sections) ? state.sections : [];\n        const writes = sections.filter((s)=>s && typeof s === \"object\").filter((s)=>s.sectionId && s.sectionId !== \"overall\").map((s)=>({\n                courseId: String(s.trackId || \"\").trim(),\n                levelId: String(s.levelId || \"\").trim(),\n                sectionId: String(s.sectionId || \"\").trim(),\n                completed: Boolean(s.completed),\n                minutes: Math.max(0, Number(s.minutes) || 0)\n            })).filter((s)=>s.courseId && s.levelId && s.sectionId);\n        // Upsert each progress row (idempotent per unique key).\n        await Promise.all(writes.map((w)=>_lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.progress.upsert({\n                where: {\n                    userId_courseId_levelId_sectionId: {\n                        userId: params.userId,\n                        courseId: w.courseId,\n                        levelId: w.levelId,\n                        sectionId: w.sectionId\n                    }\n                },\n                create: {\n                    userId: params.userId,\n                    ...w\n                },\n                update: {\n                    completed: w.completed,\n                    minutes: w.minutes\n                }\n            })));\n    } catch  {\n    // Do not fail persistence if derived progress rows cannot be updated.\n    }\n    return {\n        updatedAt: saved.updatedAt.toISOString()\n    };\n}\nasync function getAdminProgressStats() {\n    const totalUsers = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.userIdentity.count();\n    const totalProgressRecords = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.progress.count();\n    const since = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n    const activeUsers = await _lib_db_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.userIdentity.count({\n        where: {\n            lastLoginAt: {\n                gte: since\n            }\n        }\n    });\n    return {\n        totalUsers,\n        activeUsersLast7Days: activeUsers,\n        totalProgressRecords\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFDbEJMLFdBQVdjLEVBQUVkLFNBQVM7b0JBQ3hCO2dCQUNGO2dCQUNBeEIsUUFBUTtvQkFBRUQsUUFBUVIsT0FBT1EsTUFBTTtvQkFBRSxHQUFHdUMsQ0FBQztnQkFBQztnQkFDdENqQyxRQUFRO29CQUFFeUIsV0FBV1EsRUFBRVIsU0FBUztvQkFBRUUsU0FBU00sRUFBRU4sT0FBTztnQkFBQztZQUN2RDtJQUdOLEVBQUUsT0FBTTtJQUNOLHNFQUFzRTtJQUN4RTtJQUVBLE9BQU87UUFBRXJCLFdBQVdHLE1BQU1ILFNBQVMsQ0FBQ0MsV0FBVztJQUFHO0FBQ3BEO0FBRU8sZUFBZTZCO0lBQ3BCLE1BQU1DLGFBQWEsTUFBTXJELGtEQUFNQSxDQUFDTSxZQUFZLENBQUNnRCxLQUFLO0lBQ2xELE1BQU1DLHVCQUF1QixNQUFNdkQsa0RBQU1BLENBQUNrRCxRQUFRLENBQUNJLEtBQUs7SUFDeEQsTUFBTUUsUUFBUSxJQUFJekMsS0FBS0EsS0FBSzBDLEdBQUcsS0FBSyxJQUFJLEtBQUssS0FBSyxLQUFLO0lBQ3ZELE1BQU1DLGNBQWMsTUFBTTFELGtEQUFNQSxDQUFDTSxZQUFZLENBQUNnRCxLQUFLLENBQUM7UUFBRTlDLE9BQU87WUFBRU0sYUFBYTtnQkFBRTZDLEtBQUtIO1lBQU07UUFBRTtJQUFFO0lBQzdGLE9BQU87UUFBRUg7UUFBWU8sc0JBQXNCRjtRQUFhSDtJQUFxQjtBQUMvRSIsInNvdXJjZXMiOlsiL3dvcmtzcGFjZS9zcmMvc2VydmljZXMvcHJvZ3Jlc3NTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9kYi9wcmlzbWFcIjtcblxuLy8gUHJvZ3Jlc3MgcGVyc2lzdGVuY2UgcnVsZXM6XG4vLyAtIEFub255bW91cyB1c2VyczogbG9jYWwtb25seSAoaGFuZGxlZCBpbiBjbGllbnQgaG9vazsgc2VydmVyIGVuZHBvaW50cyByZXF1aXJlIGF1dGgpXG4vLyAtIFNpZ25lZC1pbiB1c2Vyczogc2VydmVyIGlzIHNvdXJjZSBvZiB0cnV0aCBmb3IgY3Jvc3MtZGV2aWNlIHBlcnNpc3RlbmNlXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRVc2VySWRlbnRpdHkocGFyYW1zOiB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBlbWFpbDogc3RyaW5nO1xuICBwcm92aWRlcjogc3RyaW5nO1xuICBwcm92aWRlckFjY291bnRJZDogc3RyaW5nO1xufSkge1xuICBjb25zdCBlbWFpbCA9IHBhcmFtcy5lbWFpbC50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgaWYgKCFlbWFpbCkgcmV0dXJuIG51bGw7XG4gIHJldHVybiBwcmlzbWEudXNlcklkZW50aXR5LnVwc2VydCh7XG4gICAgd2hlcmU6IHsgaWQ6IHBhcmFtcy51c2VySWQgfSxcbiAgICBjcmVhdGU6IHtcbiAgICAgIGlkOiBwYXJhbXMudXNlcklkLFxuICAgICAgZW1haWwsXG4gICAgICBwcm92aWRlcjogcGFyYW1zLnByb3ZpZGVyLFxuICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IHBhcmFtcy5wcm92aWRlckFjY291bnRJZCxcbiAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLFxuICAgIH0sXG4gICAgdXBkYXRlOiB7XG4gICAgICBwcm92aWRlcjogcGFyYW1zLnByb3ZpZGVyLFxuICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IHBhcmFtcy5wcm92aWRlckFjY291bnRJZCxcbiAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3BkU3RhdGVGb3JVc2VyKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHJvdyA9IGF3YWl0IHByaXNtYS5jcGRTdGF0ZS5maW5kVW5pcXVlKHsgd2hlcmU6IHsgdXNlcklkIH0gfSk7XG4gIHJldHVybiByb3cgPyB7IHN0YXRlSnNvbjogcm93LnN0YXRlSnNvbiwgdXBkYXRlZEF0OiByb3cudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCkgfSA6IG51bGw7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDcGRTdGF0ZUZvclVzZXIocGFyYW1zOiB7IHVzZXJJZDogc3RyaW5nOyBzdGF0ZUpzb246IHN0cmluZyB9KSB7XG4gIGNvbnN0IHNhdmVkID0gYXdhaXQgcHJpc21hLmNwZFN0YXRlLnVwc2VydCh7XG4gICAgd2hlcmU6IHsgdXNlcklkOiBwYXJhbXMudXNlcklkIH0sXG4gICAgY3JlYXRlOiB7IHVzZXJJZDogcGFyYW1zLnVzZXJJZCwgc3RhdGVKc29uOiBwYXJhbXMuc3RhdGVKc29uIH0sXG4gICAgdXBkYXRlOiB7IHN0YXRlSnNvbjogcGFyYW1zLnN0YXRlSnNvbiB9LFxuICB9KTtcblxuICAvLyBNYWludGFpbiBwZXItc2VjdGlvbiBwcm9ncmVzcyByb3dzIGFzIGEgZm91bmRhdGlvbiBmb3IgZnV0dXJlIENQRCBldmlkZW5jZS9leHBvcnQuXG4gIC8vIFRoaXMgaXMgZGVyaXZlZCBkYXRhOiB0aGUgY2Fub25pY2FsIHN0YXRlIGlzIHRoZSBDUEQgSlNPTi5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdGF0ZSA9IEpTT04ucGFyc2UocGFyYW1zLnN0YXRlSnNvbik7XG4gICAgY29uc3Qgc2VjdGlvbnMgPSBBcnJheS5pc0FycmF5KHN0YXRlPy5zZWN0aW9ucykgPyBzdGF0ZS5zZWN0aW9ucyA6IFtdO1xuXG4gICAgY29uc3Qgd3JpdGVzID0gc2VjdGlvbnNcbiAgICAgIC5maWx0ZXIoKHM6IGFueSkgPT4gcyAmJiB0eXBlb2YgcyA9PT0gXCJvYmplY3RcIilcbiAgICAgIC5maWx0ZXIoKHM6IGFueSkgPT4gcy5zZWN0aW9uSWQgJiYgcy5zZWN0aW9uSWQgIT09IFwib3ZlcmFsbFwiKVxuICAgICAgLm1hcCgoczogYW55KSA9PiAoe1xuICAgICAgICBjb3Vyc2VJZDogU3RyaW5nKHMudHJhY2tJZCB8fCBcIlwiKS50cmltKCksXG4gICAgICAgIGxldmVsSWQ6IFN0cmluZyhzLmxldmVsSWQgfHwgXCJcIikudHJpbSgpLFxuICAgICAgICBzZWN0aW9uSWQ6IFN0cmluZyhzLnNlY3Rpb25JZCB8fCBcIlwiKS50cmltKCksXG4gICAgICAgIGNvbXBsZXRlZDogQm9vbGVhbihzLmNvbXBsZXRlZCksXG4gICAgICAgIG1pbnV0ZXM6IE1hdGgubWF4KDAsIE51bWJlcihzLm1pbnV0ZXMpIHx8IDApLFxuICAgICAgfSkpXG4gICAgICAuZmlsdGVyKChzOiBhbnkpID0+IHMuY291cnNlSWQgJiYgcy5sZXZlbElkICYmIHMuc2VjdGlvbklkKTtcblxuICAgIC8vIFVwc2VydCBlYWNoIHByb2dyZXNzIHJvdyAoaWRlbXBvdGVudCBwZXIgdW5pcXVlIGtleSkuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICB3cml0ZXMubWFwKCh3OiBhbnkpID0+XG4gICAgICAgIHByaXNtYS5wcm9ncmVzcy51cHNlcnQoe1xuICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICB1c2VySWRfY291cnNlSWRfbGV2ZWxJZF9zZWN0aW9uSWQ6IHtcbiAgICAgICAgICAgICAgdXNlcklkOiBwYXJhbXMudXNlcklkLFxuICAgICAgICAgICAgICBjb3Vyc2VJZDogdy5jb3Vyc2VJZCxcbiAgICAgICAgICAgICAgbGV2ZWxJZDogdy5sZXZlbElkLFxuICAgICAgICAgICAgICBzZWN0aW9uSWQ6IHcuc2VjdGlvbklkLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyZWF0ZTogeyB1c2VySWQ6IHBhcmFtcy51c2VySWQsIC4uLncgfSxcbiAgICAgICAgICB1cGRhdGU6IHsgY29tcGxldGVkOiB3LmNvbXBsZXRlZCwgbWludXRlczogdy5taW51dGVzIH0sXG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApO1xuICB9IGNhdGNoIHtcbiAgICAvLyBEbyBub3QgZmFpbCBwZXJzaXN0ZW5jZSBpZiBkZXJpdmVkIHByb2dyZXNzIHJvd3MgY2Fubm90IGJlIHVwZGF0ZWQuXG4gIH1cblxuICByZXR1cm4geyB1cGRhdGVkQXQ6IHNhdmVkLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBZG1pblByb2dyZXNzU3RhdHMoKSB7XG4gIGNvbnN0IHRvdGFsVXNlcnMgPSBhd2FpdCBwcmlzbWEudXNlcklkZW50aXR5LmNvdW50KCk7XG4gIGNvbnN0IHRvdGFsUHJvZ3Jlc3NSZWNvcmRzID0gYXdhaXQgcHJpc21hLnByb2dyZXNzLmNvdW50KCk7XG4gIGNvbnN0IHNpbmNlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgY29uc3QgYWN0aXZlVXNlcnMgPSBhd2FpdCBwcmlzbWEudXNlcklkZW50aXR5LmNvdW50KHsgd2hlcmU6IHsgbGFzdExvZ2luQXQ6IHsgZ3RlOiBzaW5jZSB9IH0gfSk7XG4gIHJldHVybiB7IHRvdGFsVXNlcnMsIGFjdGl2ZVVzZXJzTGFzdDdEYXlzOiBhY3RpdmVVc2VycywgdG90YWxQcm9ncmVzc1JlY29yZHMgfTtcbn1cblxuXG4iXSwibmFtZXMiOlsicHJpc21hIiwidXBzZXJ0VXNlcklkZW50aXR5IiwicGFyYW1zIiwiZW1haWwiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJ1c2VySWRlbnRpdHkiLCJ1cHNlcnQiLCJ3aGVyZSIsImlkIiwidXNlcklkIiwiY3JlYXRlIiwicHJvdmlkZXIiLCJwcm92aWRlckFjY291bnRJZCIsImxhc3RMb2dpbkF0IiwiRGF0ZSIsInVwZGF0ZSIsImdldENwZFN0YXRlRm9yVXNlciIsInJvdyIsImNwZFN0YXRlIiwiZmluZFVuaXF1ZSIsInN0YXRlSnNvbiIsInVwZGF0ZWRBdCIsInRvSVNPU3RyaW5nIiwic2V0Q3BkU3RhdGVGb3JVc2VyIiwic2F2ZWQiLCJzdGF0ZSIsIkpTT04iLCJwYXJzZSIsInNlY3Rpb25zIiwiQXJyYXkiLCJpc0FycmF5Iiwid3JpdGVzIiwiZmlsdGVyIiwicyIsInNlY3Rpb25JZCIsIm1hcCIsImNvdXJzZUlkIiwiU3RyaW5nIiwidHJhY2tJZCIsImxldmVsSWQiLCJjb21wbGV0ZWQiLCJCb29sZWFuIiwibWludXRlcyIsIk1hdGgiLCJtYXgiLCJOdW1iZXIiLCJQcm9taXNlIiwiYWxsIiwidyIsInByb2dyZXNzIiwidXNlcklkX2NvdXJzZUlkX2xldmVsSWRfc2VjdGlvbklkIiwiZ2V0QWRtaW5Qcm9ncmVzc1N0YXRzIiwidG90YWxVc2VycyIsImNvdW50IiwidG90YWxQcm9ncmVzc1JlY29yZHMiLCJzaW5jZSIsIm5vdyIsImFjdGl2ZVVzZXJzIiwiZ3RlIiwiYWN0aXZlVXNlcnNMYXN0N0RheXMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/services/progressService.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "@sentry/nextjs":
/*!*********************************!*\
  !*** external "@sentry/nextjs" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@sentry/nextjs");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose","vendor-chunks/@opentelemetry","vendor-chunks/next-auth","vendor-chunks/nodemailer","vendor-chunks/openid-client","vendor-chunks/@babel","vendor-chunks/uuid","vendor-chunks/oauth","vendor-chunks/@panva","vendor-chunks/preact-render-to-string","vendor-chunks/preact","vendor-chunks/oidc-token-hash","vendor-chunks/object-hash","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2Fworkspace%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fworkspace&isDev=true&tsconfigPath=&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();