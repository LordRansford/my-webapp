;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="c51c42bb-2200-6f11-46a1-a83e5e24a2e2")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87391,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(522016);function l(e){try{return new Date(e).toLocaleString()}catch{return e}}async function d(e,s){let t=await fetch(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(s)}),a=await t.json().catch(()=>({}));if(!t.ok)throw Error(a?.error||a?.message||"Request failed");return a}function r({ticket:e}){let[r,n]=(0,t.useState)(null),[o,i]=(0,t.useState)(e.status),[c,x]=(0,t.useState)(""),[m,p]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[b,N]=(0,t.useState)(null),[j,g]=(0,t.useState)(null),f=(0,t.useMemo)(()=>["open","in_progress","resolved"],[]),y=async()=>{N(null),g(null);let s=c.trim();if(!s)return N("Reason is required.");if(confirm("Confirm status change")){n("status");try{await d(`/api/admin/support/${encodeURIComponent(e.id)}/status`,{status:o,reason:s}),g("Status updated. Refresh the page to see updated timestamps."),x("")}catch(e){N(e.message||"Failed to update status.")}finally{n(null)}}},w=async()=>{N(null),g(null);let s=h.trim(),t=m.trim();if(!t)return N("Note is required.");if(!s)return N("Reason is required.");if(confirm("Confirm add note")){n("note");try{await d(`/api/admin/support/${encodeURIComponent(e.id)}/note`,{note:t,reason:s}),g("Note added. Refresh the page to see it."),p(""),u("")}catch(e){N(e.message||"Failed to add note.")}finally{n(null)}}};return(0,s.jsxs)("main",{className:"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"Support"}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:e.category}),(0,s.jsxs)("p",{className:"text-xs text-slate-600 font-mono",children:["Ticket ID: ",e.id]})]}),(0,s.jsx)(a.default,{href:"/admin/support",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400",children:"Back to support"})]}),b?(0,s.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900",children:b}):null,j?(0,s.jsx)("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-900",children:j}):null,(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Ticket"}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"From"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:e.email||"Unknown"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:e.name||"No name provided"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-600",children:["User ID: ",e.userId||"Anonymous"]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Timeline"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-600",children:["Created: ",l(e.createdAt)]}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-slate-600",children:["Updated: ",l(e.updatedAt)]}),(0,s.jsxs)("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:["Status: ",e.status]})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Message"}),(0,s.jsx)("p",{className:"mt-2 whitespace-pre-wrap text-sm text-slate-800",children:e.message})]})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Attachments"}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Attachments are treated as untrusted content. This UI does not render them inline. Use download only."}),(0,s.jsx)("div",{className:"space-y-2",children:e.attachments.length?e.attachments.map(t=>(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:t.fileName}),(0,s.jsxs)("p",{className:"text-xs text-slate-600",children:[t.mimeType," · ",Math.round(t.sizeBytes/1024)," KB · ",l(t.createdAt)]})]}),(0,s.jsx)("a",{href:`/api/admin/support/${encodeURIComponent(e.id)}/attachments/${encodeURIComponent(t.id)}`,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400",children:"Download"})]},t.id)):(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No attachments."})})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Status"}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"New status"}),(0,s.jsx)("select",{value:o,onChange:e=>i(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",children:f.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("label",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Reason"}),(0,s.jsx)("input",{value:c,onChange:e=>x(e.target.value),placeholder:"Required",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]})]}),(0,s.jsx)("button",{type:"button",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:null!==r,onClick:y,children:"status"===r?"Updating...":"Change status"})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Admin notes"}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Notes are internal only. Adding a note requires a reason and is audited."}),(0,s.jsx)("div",{className:"space-y-2",children:e.notes.length?e.notes.map(e=>(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsxs)("p",{className:"text-xs font-semibold text-slate-700",children:["Admin user: ",e.adminUserId]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-800 whitespace-pre-wrap",children:e.note}),(0,s.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:l(e.createdAt)})]},e.id)):(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No notes."})}),(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Note"}),(0,s.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white p-3 text-sm text-slate-900"})]}),(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Reason"}),(0,s.jsx)("input",{value:h,onChange:e=>u(e.target.value),placeholder:"Required",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"})]})]}),(0,s.jsx)("button",{type:"button",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:null!==r,onClick:w,children:"note"===r?"Saving...":"Add note"})]})]})}e.s(["default",()=>r])}]);

//# debugId=c51c42bb-2200-6f11-46a1-a83e5e24a2e2
//# sourceMappingURL=9a3a0e1648f69595.js.map