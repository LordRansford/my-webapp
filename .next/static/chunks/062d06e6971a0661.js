;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="dbafc8cc-cfd3-353e-1039-0d72618bf573")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38242,e=>{"use strict";var s=e.i(843476),t=e.i(271645);function a(){let[e,a]=(0,t.useState)([]),[l,n]=(0,t.useState)(!1),[r,o]=(0,t.useState)({userId:"",templateId:"",expiresAt:"",notes:""}),[d,i]=(0,t.useState)(null),[c,x]=(0,t.useState)(null),m=async()=>{n(!0),i(null),x(null);try{let e=await fetch("/api/admin/permission-tokens"),s=await e.json();if(!e.ok){if(401===e.status||403===e.status)return void x(s?.message||"Admin access requires a valid admin_token cookie.");if(500===e.status&&s?.message)return void x(s.message);throw Error(s?.message||"Forbidden")}a(s.tokens||[])}catch(e){i(e.message||"Could not load tokens")}finally{n(!1)}};(0,t.useEffect)(()=>{m()},[]);let p=async()=>{if(c)return void i(c);n(!0),i(null);try{let e=await fetch("/api/admin/permission-tokens",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.userId||null,templateId:r.templateId||null,expiresAt:r.expiresAt||null,notes:r.notes||null})}),s=await e.json();if(!e.ok)throw Error(s?.message||"Could not create token");await m(),o({userId:"",templateId:"",expiresAt:"",notes:""})}catch(e){i(e.message||"Could not create token")}finally{n(!1)}},u=async e=>{n(!0),i(null);try{let s=await fetch(`/api/admin/permission-tokens?tokenId=${encodeURIComponent(e)}`,{method:"DELETE"}),t=await s.json();if(!s.ok)throw Error(t?.message||"Could not revoke token");await m()}catch(e){i(e.message||"Could not revoke token")}finally{n(!1)}};return c?(0,s.jsxs)("main",{className:"mx-auto max-w-4xl p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Admin access unavailable"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:c}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Set ADMIN_DASHBOARD_TOKEN server side and present the admin_token cookie. All validation stays on the server."})]}):(0,s.jsxs)("main",{className:"mx-auto max-w-5xl p-6 space-y-4",children:[(0,s.jsxs)("header",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-semibold uppercase tracking-wide text-slate-600",children:"Admin"}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Template permissions"}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Issue and revoke permission tokens."})]}),(0,s.jsxs)("section",{className:"grid gap-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("label",{className:"space-y-1 text-sm text-slate-800",children:["User ID (optional)",(0,s.jsx)("input",{className:"w-full rounded-lg border border-slate-200 p-2",value:r.userId,onChange:e=>o(s=>({...s,userId:e.target.value})),placeholder:"user-123 or leave blank"})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm text-slate-800",children:["Template ID (optional)",(0,s.jsx)("input",{className:"w-full rounded-lg border border-slate-200 p-2",value:r.templateId,onChange:e=>o(s=>({...s,templateId:e.target.value})),placeholder:"template slug or leave blank"})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm text-slate-800",children:["Expires at (ISO, optional)",(0,s.jsx)("input",{className:"w-full rounded-lg border border-slate-200 p-2",value:r.expiresAt,onChange:e=>o(s=>({...s,expiresAt:e.target.value})),placeholder:"2026-01-01T00:00:00Z"})]}),(0,s.jsxs)("label",{className:"space-y-1 text-sm text-slate-800",children:["Notes",(0,s.jsx)("input",{className:"w-full rounded-lg border border-slate-200 p-2",value:r.notes,onChange:e=>o(s=>({...s,notes:e.target.value})),placeholder:"Who approved this"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:p,className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800",disabled:l,children:l?"Working...":"Create token"}),(0,s.jsx)("button",{type:"button",onClick:m,className:"rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 hover:bg-slate-50",disabled:l,children:"Refresh"})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Scope is fixed to commercial_remove_signature. Issuer is Ransford."})]}),(0,s.jsx)("section",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm",children:(0,s.jsxs)("table",{className:"min-w-full text-left text-sm text-slate-800",children:[(0,s.jsx)("thead",{className:"bg-slate-50 text-sm font-semibold uppercase tracking-wide text-slate-600",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2",children:"Token"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"User / anon"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Template"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Issued"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Expires"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Notes"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[e.map(e=>(0,s.jsxs)("tr",{className:"border-t border-slate-100",children:[(0,s.jsx)("td",{className:"px-4 py-2 font-mono text-sm text-slate-800 break-all",children:e.tokenId}),(0,s.jsxs)("td",{className:"px-4 py-2 text-sm text-slate-800",children:[e.userId||"-"," / ",e.anonymousUserId||"-"]}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.templateId||"Any"}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-slate-800",children:new Date(e.issuedAt).toLocaleString()}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-slate-800",children:e.expiresAt?new Date(e.expiresAt).toLocaleString():"No expiry"}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-slate-800",children:e.notes||""}),(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("button",{type:"button",onClick:()=>u(e.tokenId),className:"text-sm font-semibold text-rose-700 hover:underline",disabled:l,children:"Revoke"})})]},e.tokenId)),!e.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-slate-600",colSpan:7,children:"No tokens issued yet."})})]})]})}),d?(0,s.jsx)("p",{className:"text-sm font-semibold text-rose-700",children:d}):null]})}e.s(["default",()=>a])}]);

//# debugId=dbafc8cc-cfd3-353e-1039-0d72618bf573
//# sourceMappingURL=ac3284f5e826959b.js.map