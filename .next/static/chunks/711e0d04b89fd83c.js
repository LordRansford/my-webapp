;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4083143e-3dc0-d5e9-ea4c-0b5857135732")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,987633,t=>{"use strict";let e="template-permission-token";function s(t){let s=window;s&&t&&s.localStorage.setItem(e,t.trim())}function a(){let t=window;if(!t)return null;let s=t.localStorage.getItem(e);return s?s.trim():null}function i(){let t;return!!(t=window)&&!!t.localStorage.getItem("template-donation-token")}function n(){return!!a()}function r(){return i()||n()}t.s(["getPermissionToken",()=>a,"hasDonationSupport",()=>i,"hasPermissionToken",()=>n,"setPermissionToken",()=>s,"unlockCommercialNoAttribution",()=>r])},623978,t=>{"use strict";var e=t.i(271645);let s=t=>JSON.parse(JSON.stringify("function"==typeof t?t():t));function a(t,a){let[i,n]=(0,e.useState)(()=>s(a)),[r,o]=(0,e.useState)(null),[l,d]=(0,e.useState)(!1);(0,e.useEffect)(()=>{let e=window.localStorage.getItem(t);if(e)try{let t=JSON.parse(e);void 0!==t.data&&n(t.data),t.lastUpdated&&o(t.lastUpdated)}catch(t){console.warn("Could not parse stored template state",t)}d(!0)},[t]);let u=(0,e.useCallback)((e,s)=>{window.localStorage.setItem(t,JSON.stringify({data:e,lastUpdated:s}))},[t]),c=(0,e.useCallback)(t=>{n(e=>{let s="function"==typeof t?t(e):t,a=new Date().toISOString();return o(a),u(s,a),s})},[u]);return{state:i,updateState:c,resetState:(0,e.useCallback)(()=>{let t=s(a),e=new Date().toISOString();n(t),o(e),u(t,e)},[a,u]),...(0,e.useMemo)(()=>({hydrated:l,lastUpdated:r}),[l,r])}}t.s(["useTemplateState",()=>a])},41227,t=>{"use strict";var e=t.i(843476),s=t.i(271645),a=t.i(310935),i=t.i(181780),n=t.i(623978);let r="1.0.0",o="Created by Ransford for Ransfords Notes. Internal use allowed. Commercial use requires visible attribution. Downloads will be gated in the next stage.",l={assets:"Customer data lake\nAuthentication service\nAdmin console\nCI/CD pipeline",threatActors:"External attacker\nDisgruntled insider\nThird-party integrator\nScript kiddie",entryPoints:"Public web app login\nAPI gateway\nAdmin VPN\nCI/CD webhook",trustBoundaries:"Internet to edge/WAF\nEdge to app services\nApp services to data stores\nCI/CD to runtime",mitigations:"MFA on admin paths\nWAF with managed rules\nLeast privilege for service accounts\nSigned releases"},d=t=>(t||"").split("\n").map(t=>t.trim()).filter(Boolean);function u({id:t,label:s,hint:a,value:i,onChange:n}){return(0,e.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm",children:[(0,e.jsx)("label",{htmlFor:t,className:"text-sm font-semibold text-slate-900",children:s}),(0,e.jsx)("textarea",{id:t,name:t,value:i,onChange:n,rows:4,className:"w-full rounded-lg border border-slate-200 bg-white p-3 text-sm text-slate-800 focus:border-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-200"}),(0,e.jsx)("p",{className:"text-xs text-slate-600",children:a})]})}function c(){let{state:t,updateState:c,resetState:m,lastUpdated:h}=(0,n.useTemplateState)("template-cyber-threat-model-v1",l),p=t=>e=>{c(s=>({...s,[t]:e.target.value}))},g=(0,s.useMemo)(()=>({assets:d(t.assets),threatActors:d(t.threatActors),entryPoints:d(t.entryPoints),trustBoundaries:d(t.trustBoundaries),mitigations:d(t.mitigations)}),[t.assets,t.entryPoints,t.mitigations,t.threatActors,t.trustBoundaries]),y=(0,s.useMemo)(()=>{let t=g.assets[0]||"key asset",e=g.threatActors[0]||"threat actor",s=g.entryPoints[0]||"entry point",a=g.trustBoundaries[0]||"trust boundary",i=g.mitigations[0]||"mitigation";return[`Protect ${t} against ${e}.`,`Watch the entry point: ${s}.`,`Validate controls at the ${a} boundary.`,`Primary mitigation in place: ${i}.`]},[g.assets,g.entryPoints,g.mitigations,g.threatActors,g.trustBoundaries]);return(0,e.jsxs)(a.default,{title:"Threat Modelling Canvas",description:"Map assets, actors, entry points, and trust boundaries with a concise summary to brief stakeholders.",audience:"Security architects, product/security partners, platform engineers.",useCases:["Run lightweight threat modelling on new features.","Document boundaries and assumptions before a pen test.","Align teams on mitigations and ownership."],instructions:["List assets and their value.","Capture threat actors and likely entry points.","Describe key trust boundaries and the controls in place.","Record mitigations and owners; review the auto-summary."],outputTitle:"Canvas summary",outputSummary:y.join(" "),outputInterpretation:"Use this summary to brief teams and log assumptions. Expand to a full STRIDE or attack tree if risk is high.",outputNextSteps:["Validate mitigations against the riskiest entry point.","Assign owners and due dates for control gaps.","Schedule a review after major architectural changes."],attributionText:o,version:r,children:[(0,e.jsx)(i.default,{templateId:"cyber-threat-model",title:"Threat Modelling Canvas",category:"Cybersecurity",version:r,attributionText:o,prepareSections:()=>[{heading:"Assets and value",body:t.assets},{heading:"Threat actors",body:t.threatActors},{heading:"Entry points",body:t.entryPoints},{heading:"Trust boundaries",body:t.trustBoundaries},{heading:"Mitigations and owners",body:t.mitigations},{heading:"Auto-summary",body:y.join(" ")}]}),(0,e.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,e.jsxs)("p",{className:"text-sm font-medium text-slate-700",children:["Autosaves locally. Last updated: ",(t=>{if(!t)return"Not saved yet";try{return new Date(t).toLocaleString()}catch(e){return t}})(h)]}),(0,e.jsx)("button",{type:"button",onClick:m,className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:-translate-y-0.5 hover:border-slate-300 hover:shadow focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900",children:"Reset template"})]}),(0,e.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,e.jsx)(u,{id:"assets",label:"Assets and value",hint:"List the assets and why they matter (data sensitivity, availability needs). One per line.",value:t.assets,onChange:p("assets")}),(0,e.jsx)(u,{id:"threatActors",label:"Threat actors",hint:"Name specific adversaries or profiles (insider, partner, commodity attacker).",value:t.threatActors,onChange:p("threatActors")})]}),(0,e.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,e.jsx)(u,{id:"entryPoints",label:"Entry points",hint:"Where can the actor start? Web, API, physical, CI/CD, credentials, supply chain. One per line.",value:t.entryPoints,onChange:p("entryPoints")}),(0,e.jsx)(u,{id:"trustBoundaries",label:"Trust boundaries",hint:"Boundary crossings and expected controls (authn/z, rate limiting, validation, isolation).",value:t.trustBoundaries,onChange:p("trustBoundaries")})]}),(0,e.jsx)(u,{id:"mitigations",label:"Mitigations and owners",hint:"Current or planned mitigations with owners. Note coverage and any gaps that need review.",value:t.mitigations,onChange:p("mitigations")}),(0,e.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/90 p-5 shadow-sm","aria-live":"polite",role:"status",children:[(0,e.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-700",children:"Auto-generated summary"}),(0,e.jsx)("ul",{className:"mt-3 list-disc space-y-2 pl-5 text-sm text-slate-800",children:y.map((t,s)=>(0,e.jsx)("li",{children:t},s))})]})]})}t.s(["default",()=>c])}]);

//# debugId=4083143e-3dc0-d5e9-ea4c-0b5857135732
//# sourceMappingURL=291e1ac6f8fdfd5b.js.map