;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="86a3475f-61bd-4029-f315-cf7461442295")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,288504,333611,e=>{"use strict";var t=e.i(191788);function r(e,t){try{return JSON.parse(e)}catch{return t}}e.s(["use_tool_state",0,function({tool_id:e,initial_state:s}){let[n,i]=(0,t.useState)(s),[l,a]=(0,t.useState)(!1),o=(0,t.useRef)(s),c=(0,t.useMemo)(()=>new URLSearchParams(window.location.search).get(`s_${e}`),[e]);async function d(e){let t=r(await e.text(),null);t&&i(t)}return(0,t.useEffect)(()=>{let t,s,n=c?(t=atob(c),s=Uint8Array.from(t,e=>e.charCodeAt(0)),r(new TextDecoder().decode(s),null)):null;if(n){i(n),a(!0);return}let l=window.localStorage.getItem(`rn_tool_${e}`);if(l){i(r(l,o.current)),a(!0);return}a(!0)},[e,c]),(0,t.useEffect)(()=>{l&&window.localStorage.setItem(`rn_tool_${e}`,JSON.stringify(n))},[n,e,l]),{state:n,set_state:i,reset:function(){i(o.current),window.localStorage.removeItem(`rn_tool_${e}`)},copy_share_link:function(){let t,r,s,i=new URLSearchParams(window.location.search);i.set(`s_${e}`,(t=JSON.stringify(n),r=new TextEncoder().encode(t),s="",r.forEach(e=>{s+=String.fromCharCode(e)}),btoa(s)));let l=`${window.location.pathname}?${i.toString()}`;navigator.clipboard.writeText(`${window.location.origin}${l}`)},export_json:function(){let t=new Blob([JSON.stringify(n,null,2)],{type:"application_json"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=`${e}_state.json`,s.click(),URL.revokeObjectURL(r)},import_json:d,is_ready:l}}],288504);var s=e.i(391398);e.s(["default",0,function({onReset:e,onCopy:t,onExport:r,onImport:n}){return(0,s.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:[e?(0,s.jsx)("button",{onClick:e,className:"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200",children:"Reset"}):null,t?(0,s.jsx)("button",{onClick:t,className:"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200",children:"Copy link"}):null,r?(0,s.jsx)("button",{onClick:r,className:"rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring focus:ring-blue-200",children:"Export"}):null,n?(0,s.jsxs)("label",{className:"inline-flex cursor-pointer items-center gap-1 rounded-full border px-3 py-1 text-gray-700 hover:bg-gray-100 focus-within:ring focus-within:ring-blue-200",children:[(0,s.jsx)("span",{children:"Import"}),(0,s.jsx)("input",{type:"file",accept:"application/json",onChange:e=>{let t=e.target.files?.[0];t&&n(t),e.target.value=""},className:"hidden"})]}):null]})}],333611)},988564,e=>{"use strict";var t=e.i(391398),r=e.i(191788),s=e.i(288504),n=e.i(333611);function i({id:e,label:r,value:s,onChange:n,placeholder:i}){return(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-4 py-3",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-900",htmlFor:e,children:r}),(0,t.jsx)("input",{id:e,value:String(s||""),onChange:e=>n(e.target.value),className:"mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",placeholder:i})]})}function l({id:e,label:r,value:s,onChange:n,rows:i=5,placeholder:l}){return(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-4 py-3",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-900",htmlFor:e,children:r}),(0,t.jsx)("textarea",{id:e,value:String(s||""),onChange:e=>n(e.target.value),className:"mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",rows:i,placeholder:l})]})}function a(){let{state:e,set_state:a,reset:o,copy_share_link:c,export_json:d,import_json:u,is_ready:p}=(0,s.use_tool_state)({tool_id:"feature-security-review-pack",initial_state:{featureName:"",userJourney:"",trustBoundaries:"",topRisks:["","",""],controls:["","",""],verification:["","",""],evidence:["","",""],notes:""}}),[f,m]=(0,r.useState)(!1),x=(0,r.useMemo)(()=>{let t=[!!String(e.featureName||"").trim(),!!String(e.userJourney||"").trim(),!!String(e.trustBoundaries||"").trim(),e.topRisks.filter(e=>String(e||"").trim()).length>=2,e.controls.filter(e=>String(e||"").trim()).length>=2,e.verification.filter(e=>String(e||"").trim()).length>=2];return{doneCount:t.filter(Boolean).length,total:t.length}},[e]),g=(t,r,s)=>{let n=Array.isArray(e[t])?[...e[t]]:[];n[r]=s,a({...e,[t]:n})},h=async()=>{try{let t=["Feature Security Review Pack","",`Feature  ${String(e.featureName||"").trim()||"(not set)"}`,"","User journey",String(e.userJourney||"").trim()||"(none)","","Trust boundaries",String(e.trustBoundaries||"").trim()||"(none)","","Top risks",...e.topRisks.map((e,t)=>`${t+1}. ${String(e||"").trim()||"(blank)"}`),"","Controls",...e.controls.map((e,t)=>`${t+1}. ${String(e||"").trim()||"(blank)"}`),"","Verification",...e.verification.map((e,t)=>`${t+1}. ${String(e||"").trim()||"(blank)"}`),"","Evidence",...e.evidence.map((e,t)=>`${t+1}. ${String(e||"").trim()||"(blank)"}`),"","Notes",String(e.notes||"").trim()||"(none)"];await navigator.clipboard.writeText(t.join("\n")),m(!0),setTimeout(()=>m(!1),1500)}catch{m(!1)}};return p?(0,t.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,t.jsx)("p",{className:"text-gray-700",children:"This pack is a lightweight feature review. Keep it practical and defensible. Aim for clear risks, realistic controls, and verification you can actually perform."}),(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Progress"}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-slate-700",children:[x.doneCount," of ",x.total," areas drafted"]})]}),(0,t.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,t.jsx)(i,{id:"fsrp-feature",label:"Feature name",value:e.featureName,onChange:t=>a({...e,featureName:t}),placeholder:"Example password reset"}),(0,t.jsx)(i,{id:"fsrp-journey-short",label:"User journey summary",value:e.userJourney,onChange:t=>a({...e,userJourney:t}),placeholder:"Example user requests reset and receives a link"})]}),(0,t.jsx)(l,{id:"fsrp-boundaries",label:"Trust boundaries and entry points",value:e.trustBoundaries,onChange:t=>a({...e,trustBoundaries:t}),rows:5,placeholder:"Write the boundaries and the inputs you do not fully trust. Include browser, API, third parties, and admin actions."}),(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Top risks"}),(0,t.jsx)(i,{id:"fsrp-risk-1",label:"Risk 1",value:e.topRisks[0],onChange:e=>g("topRisks",0,e),placeholder:"Example account takeover through weak recovery"}),(0,t.jsx)(i,{id:"fsrp-risk-2",label:"Risk 2",value:e.topRisks[1],onChange:e=>g("topRisks",1,e),placeholder:"Example token leakage through logs or referrers"}),(0,t.jsx)(i,{id:"fsrp-risk-3",label:"Risk 3",value:e.topRisks[2],onChange:e=>g("topRisks",2,e),placeholder:"Example broken access control on admin endpoints"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Controls"}),(0,t.jsx)(i,{id:"fsrp-control-1",label:"Control 1",value:e.controls[0],onChange:e=>g("controls",0,e),placeholder:"Example rate limits and step up auth"}),(0,t.jsx)(i,{id:"fsrp-control-2",label:"Control 2",value:e.controls[1],onChange:e=>g("controls",1,e),placeholder:"Example signed tokens with short expiry"}),(0,t.jsx)(i,{id:"fsrp-control-3",label:"Control 3",value:e.controls[2],onChange:e=>g("controls",2,e),placeholder:"Example allow list for admin actions"})]})]}),(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Verification"}),(0,t.jsx)(i,{id:"fsrp-verify-1",label:"Verification 1",value:e.verification[0],onChange:e=>g("verification",0,e),placeholder:"Example prove access is denied for a low privilege role"}),(0,t.jsx)(i,{id:"fsrp-verify-2",label:"Verification 2",value:e.verification[1],onChange:e=>g("verification",1,e),placeholder:"Example verify tokens cannot be replayed after use"}),(0,t.jsx)(i,{id:"fsrp-verify-3",label:"Verification 3",value:e.verification[2],onChange:e=>g("verification",2,e),placeholder:"Example confirm audit logs include admin actions"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Evidence"}),(0,t.jsx)(i,{id:"fsrp-evidence-1",label:"Evidence 1",value:e.evidence[0],onChange:e=>g("evidence",0,e),placeholder:"Example threat model notes"}),(0,t.jsx)(i,{id:"fsrp-evidence-2",label:"Evidence 2",value:e.evidence[1],onChange:e=>g("evidence",1,e),placeholder:"Example access control test result"}),(0,t.jsx)(i,{id:"fsrp-evidence-3",label:"Evidence 3",value:e.evidence[2],onChange:e=>g("evidence",2,e),placeholder:"Example log sample for key actions"})]})]}),(0,t.jsx)(l,{id:"fsrp-notes",label:"Notes",value:e.notes,onChange:t=>a({...e,notes:t}),rows:5,placeholder:"Write any trade offs and what you would monitor after release."}),(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,t.jsx)("button",{type:"button",onClick:h,className:"inline-flex items-center justify-center rounded-full border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",children:f?"Copied":"Copy pack"})}),(0,t.jsx)(n.default,{onReset:o,onCopy:c,onExport:d,onImport:u})]}):(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Loading..."})}e.s(["default",()=>a])},358877,e=>{e.n(e.i(988564))}]);

//# debugId=86a3475f-61bd-4029-f315-cf7461442295
//# sourceMappingURL=8eded380731e2386.js.map