;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="3608e642-6c65-cab6-85cd-4f8dfa1adb40")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,498653,e=>{"use strict";var s=e.i(391398),t=e.i(191788),a=e.i(41158),l=e.i(57699),r=e.i(282717),i=e.i(526626),n=e.i(723451),o=e.i(694713),d=e.i(756902),c=e.i(976835),x=e.i(908277),m=e.i(313667),u=e.i(819945),p=e.i(562987),h=e.i(499505),g=e.i(202360),b=e.i(832178),f=e.i(635732),y=e.i(255420),j=e.i(26423),N=e.i(149843);let w=e=>1/(1+Math.exp(-e));function v(e){let s=e.filter(e=>null!=e);if(0===s.length)return{type:"unknown",reason:"Target is empty."};let t=s.every(e=>!Number.isNaN(Number(e))),a=new Set(s.map(e=>String(e))).size;return t&&a>12?{type:"regression",reason:"Target is numeric with many distinct values."}:!t&&a<=20?{type:"classification",reason:"Target has repeated categories."}:t&&a<=20?{type:"classification",reason:"Target is numeric with few repeated values."}:{type:"regression",reason:"Defaulting to regression."}}function k(e,s,t,a){let l=s.filter(e=>e!==a),r=[],i={};return l.forEach(e=>{t[e]?.isNumeric||(i[e]=Array.from(t[e].uniqueValues).slice(0,20))}),e.forEach(e=>{let s=[];l.forEach(a=>{if(t[a]?.isNumeric){let t=Number(e[a]);s.push(Number.isNaN(t)?0:t)}else(i[a]||[]).forEach(t=>{s.push(+(e[a]===t))})}),r.push(s)}),{featureCols:l,cats:i,encoded:r}}function S(e,s,t){if(!e?.length)return e;let a=0,l=new Set;s.forEach(e=>{t[e]?.isNumeric&&l.add(a),a+=t[e]?.isNumeric?1:Math.min(20,t[e]?.uniqueCount||0)});let r={},i={};for(let s of(l.forEach(e=>{r[e]=1/0,i[e]=-1/0}),e))l.forEach(e=>{let t=Number(s[e]);Number.isFinite(t)&&(r[e]=Math.min(r[e],t),i[e]=Math.max(i[e],t))});for(let s of e)l.forEach(e=>{let t=r[e],a=i[e];Number.isFinite(t)&&Number.isFinite(a)&&a!==t&&(s[e]=(s[e]-t)/(a-t))});return e}function C(){throw new DOMException("Aborted","AbortError")}async function M(e,s,t,{lr:a=.05,epochs:l=120}){if(0===s.length)return{weights:[],bias:0};let r=s.length,i=s[0].length,n=Array(i).fill(0),o=0;for(let d=0;d<l;d+=1){e?.aborted&&C();for(let l=0;l<r;l+=1){e?.aborted&&C();let r=w(n.reduce((e,t,a)=>e+t*s[l][a],o))-t[l];for(let e=0;e<i;e+=1)n[e]-=a*r*s[l][e];o-=a*r}d%10==0&&await new Promise(e=>setTimeout(e,0))}return{weights:n,bias:o}}async function T(e,s,t,{lr:a=.01,epochs:l=200}){if(0===s.length)return{weights:[],bias:0};let r=s.length,i=s[0].length,n=Array(i).fill(0),o=0;for(let d=0;d<l;d+=1){e?.aborted&&C();for(let l=0;l<r;l+=1){e?.aborted&&C();let r=n.reduce((e,t,a)=>e+t*s[l][a],o)-t[l];for(let e=0;e<i;e+=1)n[e]-=a*r*s[l][e];o-=a*r}d%10==0&&await new Promise(e=>setTimeout(e,0))}return{weights:n,bias:o}}function E(e,s){let t=0,a=0,l=0,r=0;for(let i=0;i<e.length;i+=1)1===e[i]&&1===s[i]?t+=1:0===e[i]&&1===s[i]?a+=1:0===e[i]&&0===s[i]?l+=1:1===e[i]&&0===s[i]&&(r+=1);let i=(t+l)/Math.max(1,e.length),n=t/Math.max(1,t+a),o=t/Math.max(1,t+r);return{tp:t,fp:a,tn:l,fn:r,accuracy:i,precision:n,recall:o,f1:n+o>0?2*n*o/(n+o):0}}function A(e,s){let t=e.length;if(0===t)return{mae:0,mse:0,rmse:0,r2:0};let a=0,l=0,r=0,i=0,n=e.reduce((e,s)=>e+s,0)/t;for(let o=0;o<t;o+=1){let t=s[o]-e[o];a+=Math.abs(t),l+=t*t,r+=(e[o]-n)*(e[o]-n),i+=t*t}a/=t;let o=Math.sqrt(l/=t);return{mae:a,mse:l,rmse:o,r2:0===r?0:1-i/r}}function _(){let e=(0,u.useStudiosStore)(e=>e.datasets),C=(0,u.useStudiosStore)(e=>e.parsedDataById),_=(0,u.useStudiosStore)(e=>e.addJob),F=(0,u.useStudiosStore)(e=>e.updateJob),P=(0,u.useStudiosStore)(e=>e.addDataset),[R,D]=(0,t.useState)(e[0]?.id||""),[B,O]=(0,t.useState)(""),[I,L]=(0,t.useState)({type:"unknown",reason:""}),[$,z]=(0,t.useState)("logistic"),[q,U]=(0,t.useState)(.8),[V,G]=(0,t.useState)(4),[J,H]=(0,t.useState)(30),[K,W]=(0,t.useState)(.1),[X,Y]=(0,t.useState)(!0),[Q,Z]=(0,t.useState)(160),[ee,es]=(0,t.useState)(.05),[et,ea]=(0,t.useState)(""),[el,er]=(0,t.useState)(!1),[ei,en]=(0,t.useState)(""),[eo,ed]=(0,t.useState)(null),[ec,ex]=(0,t.useState)([]),[em,eu]=(0,t.useState)(""),[ep,eh]=(0,t.useState)({}),[eg,eb]=(0,t.useState)(null),ef=(0,g.useToolRunner)({minIntervalMs:800,timeoutMs:45e3,toolId:"model-forge-train"}),ey=(0,t.useMemo)(()=>(0,y.getToolFileLimits)("model-forge-train"),[]),ej=(0,t.useMemo)(()=>e.find(e=>e.id===R),[e,R]),eN=(0,t.useMemo)(()=>ej?C[ej.id]:null,[ej,C]),ew=(0,t.useMemo)(()=>eN?.rows||[],[eN]),ev=(0,t.useMemo)(()=>eN?.columns||[],[eN]),ek=(0,t.useMemo)(()=>(function(e){if(!e||0===e.length)return{};let s=Object.keys(e[0]||{}),t={};return s.forEach(s=>{let a=e.map(e=>e[s]).filter(e=>null!=e),l=a.map(e=>Number(e)).filter(e=>!Number.isNaN(e)),r=new Set(a.map(e=>String(e))).size;t[s]={isNumeric:l.length===a.length,min:l.length?Math.min(...l):void 0,max:l.length?Math.max(...l):void 0,uniqueValues:a.slice(0,200).reduce((e,s)=>e.add(String(s)),new Set),uniqueCount:r}}),t})(ew),[ew]);(0,t.useEffect)(()=>{ev.length>0&&!B&&O(ev[ev.length-1])},[ev,B]),(0,t.useEffect)(()=>{if(B&&ew.length>0){let e=ew.map(e=>e[B]);L(v(e)),"classification"===v(e).type?z("logistic"):z("linear")}},[B,ew]),(0,t.useEffect)(()=>{ev.length>0&&!et&&ea(ev.find(e=>e!==B&&!ek[e]?.isNumeric)||"")},[ev,B,et,ek]);let eS=ey?.freeMaxBytes??358400,eC=ey?.paidMaxBytes??2097152,eM=ey?.absoluteMaxBytes??4194304,eT=ef.compute.creditsVisible?eC:eS,eE=ef.compute.creditsVisible?600:200,eA=async e=>{let s=await e.text(),t=(e.name.split(".").pop()||"").toLowerCase(),a=[];if("json"===t){let e=JSON.parse(s);if(Array.isArray(e))a=e;else if(e&&Array.isArray(e.rows))a=e.rows;else throw Error("JSON must be an array of objects or an object with a rows array.")}else{let e=s.split(/\r?\n/).filter(Boolean).slice(0,2e3),t=e[0]?.split(",").map(e=>e.trim())||[];a=e.slice(1).map(e=>{let s=e.split(","),a={};return t.forEach((e,t)=>{a[e]=s[t]??""}),a})}return{columns:Object.keys(a[0]||{}),rows:a}},e_=async e=>{eu("");let{safeFiles:s,errors:t}=(0,h.validateUpload)(e,{maxBytes:eM,allowedExtensions:[".csv",".json"]});if(t.length)return void eu(t.join(" "));let a=s[0];if(a){if(a.size>eT)return void eu(`This file is larger than the current limit (${(0,y.formatBytes)(eT)}). Sign in to unlock the higher studio tier.`);try{let e=await eA(a),s=`ds-${Date.now()}`;P({id:s,name:a.name.replace(/\.(csv|json)$/i,""),sizeBytes:a.size,rowCount:e.rows.length,columnCount:e.columns.length,columns:e.columns,createdAt:new Date().toISOString()},e),D(s)}catch(e){eu(e&&e.message||"Could not parse that file.")}}},eF=(0,t.useMemo)(()=>ev.filter(e=>e!==B),[ev,B]),eP=async()=>{if(en(""),!ej||!B||!ew.length)return void en("Select a dataset and target column first.");er(!0);try{ef.resetError();let e=Math.max(10,Math.min(eE,Number(Q)||160)),s=Math.max(5e-4,Math.min(.5,Number(ee)||.05)),t=`job-${Date.now()}`;_({id:t,name:`Model Forge - ${$} on ${ej.name}`,studio:"model-forge",datasetId:ej.id,status:"running"});let a=ef.compute.creditsVisible?1500:600,l=ew.length>a?ew.slice(0,a):ew;ew.length>a&&en(`Dataset sampled to ${a} rows for this studio tier.`);let r={inputBytes:ej.sizeBytes||Math.min(1e6,l.length*ev.length*10),steps:e,expectedWallMs:3500};ef.prepare(r);let i=await ef.run(async t=>{let a=l.map(e=>e[B]),r=k(l,ev,ek,B),i=X?S(r.encoded,r.featureCols,ek):r.encoded,{train:n,test:o}=function(e,s,t=.8){let a=[...e].sort(()=>Math.random()-.5),l=Math.max(1,Math.floor(a.length*t));return{train:a.slice(0,l),test:a.slice(l)}}(l.map((e,s)=>({x:i[s],y:a[s],raw:e})),0,q),d=n.map(e=>e.x),c=o.map(e=>e.x);if("classification"===I.type){let l=Array.from(new Set(a.map(e=>String(e))));if(2!==l.length)throw Error("This studio currently supports only binary classification for the tabular workbench.");let i=l[0],x=n.map(e=>+(String(e.y)===i)),m=o.map(e=>+(String(e.y)===i)),u=await M(t,d,x,{lr:s,epochs:e}),p=c.map(e=>w(u.weights.reduce((s,t,a)=>s+t*e[a],u.bias))).map(e=>+(e>=.5)),h=E(m,p),g=d.map(e=>w(u.weights.reduce((s,t,a)=>s+t*e[a],u.bias))).map(e=>+(e>=.5)),b=E(x,g);return{taskType:"classification",model:{type:"classification",positiveLabel:i,clf:u,featureCols:r.featureCols,cats:r.cats},metrics:{test:h,train:b},testRows:o}}let x=n.map(e=>Number(e.y)||0),m=o.map(e=>Number(e.y)||0),u=await T(t,d,x,{lr:.01+.01*K,epochs:e}),p=c.map(e=>u.weights.reduce((s,t,a)=>s+t*e[a],u.bias)),h=d.map(e=>u.weights.reduce((s,t,a)=>s+t*e[a],u.bias)),g=A(m,p),b=A(x,h);return{taskType:"regression",model:{type:"regression",reg:u,featureCols:r.featureCols,cats:r.cats},metrics:{test:g,train:b},testRows:o}},r);if(!i)return void F(t,{status:"cancelled",finishedAt:new Date().toISOString()});F(t,{status:"completed",finishedAt:new Date().toISOString(),metrics:i.metrics?.test||{}});let n={id:`run-${Date.now()}`,datasetId:ej.id,datasetName:ej.name,targetCol:B,taskType:i.taskType,algorithm:$,split:q,normaliseNumeric:X,params:{epochs:e,learningRate:s,regStrength:K},model:i.model,metrics:i.metrics,testRows:i.testRows,trainedAt:new Date().toISOString()};ed(n),ex(e=>[n,...e].slice(0,8));let o={};(i.model.featureCols||[]).forEach(e=>{ek[e]?.isNumeric?o[e]=ek[e].min??0:o[e]=Array.from(ek[e].uniqueValues||[])[0]??""}),eh(o)}catch(e){en(e?.message||"Training failed")}finally{er(!1)}},eR=(0,t.useMemo)(()=>{if(!eo||"classification"!==I.type)return[];let e=eo.metrics?.test||eo.metrics||{};return[{name:"Precision",value:e.precision},{name:"Recall",value:e.recall},{name:"F1",value:e.f1},{name:"Accuracy",value:e.accuracy}]},[eo,I.type]),eD=(0,t.useMemo)(()=>{if(!eo||"regression"!==I.type)return[];let e=ew.slice(0,200),s=eo.model?.featureCols||eo.model?.usedFeatures||[],{encoded:t}=k(e,ev,ek,B),a=(X?S(t,s,ek):t).map(e=>eo.model.reg.weights.reduce((s,t,a)=>s+t*e[a],eo.model.reg.bias));return e.map((e,s)=>({actual:Number(e[B])||0,predicted:a[s]}))},[eo,I.type,ew,ev,ek,B,X]),eB=ew.slice(0,5),eO=(0,t.useMemo)(()=>{if(!eo||"classification"!==eo.taskType||!et)return[];let e=Array.isArray(eo.testRows)?eo.testRows:[];if(!e.length)return[];let s=new Map;for(let t of e){let e=String(t.raw?.[et]??"unknown"),a=+(String(t.y)===String(eo.model?.positiveLabel)),l=w(eo.model.clf.weights.reduce((e,s,a)=>e+s*t.x[a],eo.model.clf.bias)),r=+(l>=.5),i=s.get(e)||{group:e,yTrue:[],yPred:[],avgProb:0,n:0};i.yTrue.push(a),i.yPred.push(r),i.avgProb+=l,i.n+=1,s.set(e,i)}return Array.from(s.values()).map(e=>{let s=E(e.yTrue,e.yPred);return{group:e.group,n:e.n,accuracy:s.accuracy,precision:s.precision,recall:s.recall,avgProb:e.avgProb/Math.max(1,e.n)}}).sort((e,s)=>s.n-e.n).slice(0,8)},[eo,et]);return(0,s.jsxs)("div",{className:"mx-auto w-full max-w-5xl px-4 py-6 space-y-6 sm:px-6 sm:py-8 md:space-y-8",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(N.StudioBreadcrumbs,{items:[{label:"Studios Hub",href:"/studios/hub"},{label:"Model Forge"}]}),(0,s.jsx)(j.default,{studioType:"lab",showHome:!0,showHub:!0,currentStudio:"Model Forge",currentStudioHref:"/studios/model-forge"})]}),(0,s.jsxs)("div",{className:"rounded-3xl bg-white p-4 sm:p-6 md:p-8 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-3",children:[(0,s.jsx)("div",{className:"inline-flex items-center gap-2 rounded-2xl bg-sky-50 px-3 py-1 text-xs font-semibold text-sky-800 ring-1 ring-sky-100",children:"Model Forge"}),(0,s.jsx)("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-slate-900",children:"Model Forge"}),(0,s.jsx)("p",{className:"text-sm text-slate-700 max-w-3xl",children:"This is where spreadsheets come to be judged. We take your tabular data, agree what you are trying to predict, and build small models you can actually interrogate."}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)(a.default,{href:"/studios",className:"text-sm font-semibold text-emerald-700 hover:underline",children:"Back to Studios"}),(0,s.jsx)("span",{className:"text-slate-300","aria-hidden":"true",children:"|"}),(0,s.jsx)(a.default,{href:"/courses/ai",className:"text-sm font-semibold text-slate-700 hover:underline",children:"Back to AI course"})]}),(0,s.jsx)("nav",{"aria-label":"AI Studio navigation",className:"flex flex-wrap gap-2 pt-1",children:[["Overview","#overview"],["Data preparation","#data-prep"],["Training","#training"],["Evaluation","#evaluation"],["Inference","#inference"],["Responsible AI","#responsible-ai"],["Export and next steps","#export"]].map(([e,t])=>(0,s.jsx)("a",{href:t,className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",children:e},t))})]}),(0,s.jsx)(p.SecurityBanner,{}),(0,s.jsxs)("section",{id:"overview",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Overview"}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"What this teaches"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-700",children:"How data choices, training settings, and evaluation metrics change what a model can do."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Real world use"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-700",children:"A small workbench for quick baselines, sanity checks, and explaining metrics to humans."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Compute and limits"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-slate-700",children:"Free tier supports small datasets and modest epochs. Signed-in users can use a higher tier. Limits are shown before you run."})]})]})]}),(0,s.jsxs)("section",{id:"data-prep",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Data preparation"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Upload a small dataset, inspect its shape, and make deliberate choices before training."}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("label",{className:"cursor-pointer inline-flex items-center rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 hover:border-sky-300 hover:text-sky-700",children:[(0,s.jsx)("input",{type:"file",className:"hidden",accept:".csv,.json",onChange:e=>e_(e.target.files)}),"Upload CSV or JSON"]}),(0,s.jsxs)("p",{className:"text-xs text-slate-600",children:["Current file limit: ",(0,y.formatBytes)(eT)," (hard cap ",(0,y.formatBytes)(eM),")."]})]}),em?(0,s.jsx)("p",{className:"text-sm font-semibold text-rose-700",role:"alert","aria-live":"polite",children:em}):null,(0,s.jsxs)("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:R,onChange:e=>D(e.target.value),children:[e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id)),0===e.length&&(0,s.jsx)("option",{children:"No datasets"})]})]}),0===e.length&&(0,s.jsx)("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50/60 px-4 py-3 text-sm text-slate-700",children:"No datasets yet. Upload a CSV or JSON in Control Room first."}),ej&&(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2 rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Dataset summary"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:ej.name}),(0,s.jsxs)("p",{className:"text-xs text-slate-700",children:[ej.rowCount??ew.length," rows • ",ej.columnCount??ev.length," columns"]}),(0,s.jsxs)("p",{className:"text-xs text-slate-700",children:["Size: ",(0,y.formatBytes)(ej.sizeBytes||0)]})]}),(0,s.jsxs)("div",{className:"space-y-2 rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Preview (first 5 rows)"}),(0,s.jsx)("div",{className:"overflow-auto rounded-xl border border-slate-200 bg-white",children:(0,s.jsxs)("table",{className:"min-w-full text-xs text-slate-700",children:[(0,s.jsx)("thead",{className:"bg-slate-50",children:(0,s.jsx)("tr",{children:ev.map(e=>(0,s.jsx)("th",{className:"px-2 py-1 text-left font-semibold",children:e},e))})}),(0,s.jsx)("tbody",{children:eB.map((e,t)=>(0,s.jsx)("tr",{className:"border-t border-slate-100",children:ev.map(t=>(0,s.jsx)("td",{className:"px-2 py-1",children:String(e[t])},t))},t))})]})})]})]})]}),(0,s.jsxs)("section",{id:"training",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Model training"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Pick a target, choose a simple model, tune parameters, and train with predictable limits."}),(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-900",children:"Target column"}),(0,s.jsx)("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:B,onChange:e=>O(e.target.value),children:ev.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Inferred task"}),(0,s.jsx)("p",{className:"text-sm text-slate-800 capitalize",children:I.type}),(0,s.jsx)("p",{className:"text-xs text-slate-700",children:I.reason})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2 rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Training split"}),(0,s.jsx)("input",{type:"range",min:.5,max:.9,step:.05,value:q,onChange:e=>U(Number(e.target.value)),className:"w-full"}),(0,s.jsxs)("p",{className:"text-xs text-slate-700",children:["Train fraction: ",q.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"space-y-2 rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Normalisation"}),(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[(0,s.jsx)("input",{type:"checkbox",checked:X,onChange:e=>Y(e.target.checked)}),"Min-max scale numeric features"]}),(0,s.jsx)("p",{className:"text-xs text-slate-600",children:"Normalisation can stabilise training when columns have very different ranges."})]}),(0,s.jsxs)("div",{className:"space-y-2 rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Parameters"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("label",{className:"text-xs font-semibold text-slate-900",children:["Epochs (max ",eE,")",(0,s.jsx)("input",{type:"number",value:Q,onChange:e=>Z(e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]}),(0,s.jsxs)("label",{className:"text-xs font-semibold text-slate-900",children:["Learning rate",(0,s.jsx)("input",{type:"number",value:ee,step:.005,onChange:e=>es(e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200"})]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-600",children:"More epochs and higher learning rates can improve or destabilise learning."})]})]})]}),(0,s.jsxs)("section",{id:"evaluation",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Evaluation"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Evaluate on a holdout set. Watch for overfitting: great train metrics and weak test metrics."})]}),(0,s.jsx)("button",{onClick:eP,disabled:el||ef.loading||!ej||!B,className:"inline-flex items-center rounded-2xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-300",children:el||ef.loading?"Training...":"Train model"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(b.default,{estimate:ef.compute.pre||ef.compute.live}),(0,s.jsx)(f.default,{toolId:"model-forge-train",summary:ef.compute.post}),ef.errorMessage?(0,s.jsx)("p",{className:"text-sm font-semibold text-rose-700",role:"alert","aria-live":"polite",children:ef.errorMessage}):null]}),ei&&(0,s.jsx)("p",{className:"text-xs text-amber-700",children:ei}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:["classification"===I.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>z("logistic"),className:`rounded-2xl border px-4 py-3 text-left transition ${"logistic"===$?"border-sky-300 bg-sky-50 ring-1 ring-sky-200":"border-slate-200 bg-slate-50/60"}`,children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Logistic regression"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Fast, simple baseline. Good for linearly separable signals."})]}),(0,s.jsxs)("button",{onClick:()=>z("rf"),className:`rounded-2xl border px-4 py-3 text-left transition ${"rf"===$?"border-sky-300 bg-sky-50 ring-1 ring-sky-200":"border-slate-200 bg-slate-50/60"}`,children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Tree ensemble"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Handles non-linear patterns. This demo reuses a light trainer."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-900",children:"Max depth (trees)"}),(0,s.jsx)("input",{type:"number",className:"w-24 rounded-xl border border-slate-200 bg-white px-3 py-1 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:V,onChange:e=>G(Number(e.target.value)||1)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-900",children:"Number of trees"}),(0,s.jsx)("input",{type:"number",className:"w-24 rounded-xl border border-slate-200 bg-white px-3 py-1 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:J,onChange:e=>H(Number(e.target.value)||10)})]})]}),"regression"===I.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>z("linear"),className:`rounded-2xl border px-4 py-3 text-left transition ${"linear"===$?"border-sky-300 bg-sky-50 ring-1 ring-sky-200":"border-slate-200 bg-slate-50/60"}`,children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Linear regression"}),(0,s.jsx)("p",{className:"text-xs text-slate-600",children:"Simple baseline with regularisation."})]}),(0,s.jsxs)("button",{onClick:()=>z("tree-reg"),className:`rounded-2xl border px-4 py-3 text-left transition ${"tree-reg"===$?"border-sky-300 bg-sky-50 ring-1 ring-sky-200":"border-slate-200 bg-slate-50/60"}`,children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Tree-based regression"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Captures non-linearities. Demo uses light-weight trainer."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-900",children:"Regularisation strength"}),(0,s.jsx)("input",{type:"number",className:"w-24 rounded-xl border border-slate-200 bg-white px-3 py-1 text-xs text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:K,onChange:e=>W(Number(e.target.value)||.1)})]})]})]}),eo&&"classification"===I.type&&eo.metrics?.test&&(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Confusion matrix"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-center text-xs",children:[(0,s.jsxs)("div",{className:"rounded-xl bg-emerald-50 px-2 py-2",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"TP"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-emerald-700",children:eo.metrics.test.tp})]}),(0,s.jsxs)("div",{className:"rounded-xl bg-amber-50 px-2 py-2",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"FP"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-amber-700",children:eo.metrics.test.fp})]}),(0,s.jsxs)("div",{className:"rounded-xl bg-rose-50 px-2 py-2",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"FN"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-rose-700",children:eo.metrics.test.fn})]}),(0,s.jsxs)("div",{className:"rounded-xl bg-slate-50 px-2 py-2",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"TN"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-700",children:eo.metrics.test.tn})]})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900 mb-2",children:"Precision / Recall / F1"}),(0,s.jsx)("div",{className:"h-48",children:(0,s.jsx)(n.ResponsiveContainer,{width:"100%",height:"100%",children:(0,s.jsxs)(r.BarChart,{data:eR,children:[(0,s.jsx)(i.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,s.jsx)(d.XAxis,{dataKey:"name",tick:{fontSize:11}}),(0,s.jsx)(c.YAxis,{domain:[0,1],tick:{fontSize:11}}),(0,s.jsx)(o.Tooltip,{}),(0,s.jsx)(l.Bar,{dataKey:"value",fill:"#0f766e",radius:[8,8,0,0]})]})})})]})]}),eo&&"regression"===I.type&&eo.metrics?.test&&(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-1 text-sm text-slate-800",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900 mb-1",children:"Error metrics"}),(0,s.jsxs)("p",{children:["Test MAE: ",eo.metrics.test.mae.toFixed(3)]}),(0,s.jsxs)("p",{children:["Test RMSE: ",eo.metrics.test.rmse.toFixed(3)]}),(0,s.jsxs)("p",{children:["Test R²: ",eo.metrics.test.r2.toFixed(3)]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-slate-600",children:"Overfitting hint: if train RMSE is far lower than test RMSE, the model is memorising."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-900 mb-2",children:"Predicted vs actual"}),(0,s.jsx)("div",{className:"h-48",children:(0,s.jsx)(n.ResponsiveContainer,{width:"100%",height:"100%",children:(0,s.jsxs)(x.ScatterChart,{children:[(0,s.jsx)(i.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,s.jsx)(d.XAxis,{dataKey:"actual",name:"Actual",tick:{fontSize:11}}),(0,s.jsx)(c.YAxis,{dataKey:"predicted",name:"Predicted",tick:{fontSize:11}}),(0,s.jsx)(o.Tooltip,{}),(0,s.jsx)(m.Scatter,{data:eD,fill:"#0f766e"})]})})})]})]})]}),eo&&(0,s.jsxs)("section",{id:"inference",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Inference playground"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Generated inputs from your feature columns. Predictions happen in your browser. Use this for intuition, not production decisions."}),ec.length>1?(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Compare recent runs"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:"Different training settings can change performance. Pick one run to use for inference."}),(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:ec.map(e=>(0,s.jsxs)("button",{type:"button",onClick:()=>ed(e),className:`rounded-full border px-3 py-1.5 text-sm font-semibold ${e.id===eo.id?"border-sky-300 bg-sky-50 text-sky-900":"border-slate-200 bg-white text-slate-800"}`,children:[new Date(e.trainedAt).toLocaleTimeString()," (",e.algorithm,")"]},e.id))})]}):null,(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:eF.map(e=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-900",children:e}),ek[e]?.isNumeric?(0,s.jsx)("input",{type:"number",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:ep[e]??"",onChange:s=>eh(t=>({...t,[e]:s.target.value}))}):(0,s.jsx)("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:ep[e]??"",onChange:s=>eh(t=>({...t,[e]:s.target.value})),children:(ek[e]?.uniqueValues?Array.from(ek[e].uniqueValues):[]).map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]},e))}),(0,s.jsx)("button",{onClick:()=>{if(!eo)return;let{model:e}=eo,s=e.featureCols||e.usedFeatures||[],t=e.cats||{},a=[];if(s.forEach(e=>{ek[e]?.isNumeric?a.push(Number(ep[e])||0):(t[e]||[]).forEach(s=>a.push(+(ep[e]===s)))}),"classification"===e.type){let s=w(e.clf.weights.reduce((e,s,t)=>e+s*a[t],e.clf.bias));eb({type:"classification",prob:s,label:s>=.5?e.positiveLabel:`not ${e.positiveLabel}`})}else eb({type:"regression",value:e.reg.weights.reduce((e,s,t)=>e+s*a[t],e.reg.bias)})},className:"inline-flex items-center rounded-2xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-500",children:"Predict"}),eg&&(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 text-sm text-slate-800 space-y-1",children:["classification"===eg.type?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"font-semibold text-slate-900",children:["Predicted class: ",eg.label]}),(0,s.jsxs)("p",{children:["Probability: ",eg.prob.toFixed(3)]})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("p",{className:"font-semibold text-slate-900",children:["Predicted value: ",eg.value.toFixed(3)]})}),(0,s.jsx)("p",{className:"text-xs text-slate-700",children:"This is a classroom-level model trained in your browser on a small sample. Great for intuition, not for medical or credit decisions."})]})]}),eo?(0,s.jsxs)("section",{id:"responsible-ai",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Responsible AI and limitations"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"This is not compliance theatre. It is a way to build the habit of checking how a model behaves across groups, and noticing quiet failures."}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Group check (holdout set)"}),(0,s.jsxs)("label",{className:"text-xs font-semibold text-slate-900",children:["Group column",(0,s.jsxs)("select",{className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-800 focus:border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-200",value:et,onChange:e=>ea(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"None"}),ev.filter(e=>e!==B).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-600",children:"This shows basic differences by group. It does not prove fairness, and it does not replace a proper domain review."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Common pitfalls"}),(0,s.jsxs)("ul",{className:"list-disc pl-5 text-sm text-slate-700 space-y-1",children:[(0,s.jsx)("li",{children:"Different base rates can make metrics look better or worse without any change in harm."}),(0,s.jsx)("li",{children:"Small groups produce noisy metrics. Treat tiny samples as a warning, not evidence."}),(0,s.jsx)("li",{children:"Choosing the wrong target can encode policy decisions as if they were facts."})]})]})]}),eO.length?(0,s.jsx)("div",{className:"overflow-auto rounded-2xl border border-slate-200 bg-white",children:(0,s.jsxs)("table",{className:"min-w-full text-sm text-slate-800",children:[(0,s.jsx)("thead",{className:"bg-slate-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"Group"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"N"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"Accuracy"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"Precision"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"Recall"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left font-semibold",children:"Avg probability"})]})}),(0,s.jsx)("tbody",{children:eO.map(e=>(0,s.jsxs)("tr",{className:"border-t border-slate-100",children:[(0,s.jsx)("td",{className:"px-3 py-2",children:e.group}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.n}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.accuracy.toFixed(3)}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.precision.toFixed(3)}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.recall.toFixed(3)}),(0,s.jsx)("td",{className:"px-3 py-2",children:e.avgProb.toFixed(3)})]},e.group))})]})}):(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Train a classification model and choose a group column to see a simple breakdown."})]}):null,(0,s.jsxs)("section",{id:"export",className:"rounded-3xl bg-white p-4 sm:p-6 md:p-7 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100/80 space-y-4",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Export and next steps"}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Export"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed",children:"Export a small JSON summary of your run for notes, review, or a model card draft. This is not a deployment artifact."}),(0,s.jsx)("button",{type:"button",disabled:!eo,onClick:()=>{let e,s,t;return e=new Blob([JSON.stringify(eo,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),void((t=document.createElement("a")).href=s,t.download="model-forge-run.json",t.click(),URL.revokeObjectURL(s))},className:"inline-flex items-center rounded-2xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-300",children:"Download run summary"})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"What to do next in real work"}),(0,s.jsxs)("ul",{className:"list-disc pl-5 text-sm text-slate-700 space-y-1",children:[(0,s.jsx)("li",{children:"Define success with stakeholders before you pick a metric."}),(0,s.jsx)("li",{children:"Confirm data lineage and label quality."}),(0,s.jsx)("li",{children:"Run a bias review with domain experts, not only with dashboards."}),(0,s.jsx)("li",{children:"Document limitations and decide when not to use the model."})]})]})]})]})]})}e.s(["default",()=>_])},932543,(e,s,t)=>{let a="/studios/model-forge";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(498653)]),s.hot&&s.hot.dispose(function(){window.__NEXT_P.push([a])})}]);

//# debugId=3608e642-6c65-cab6-85cd-4f8dfa1adb40
//# sourceMappingURL=c925364af5d34f17.js.map