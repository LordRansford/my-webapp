;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="921a6389-6b10-9679-ffca-57736e848a39")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,207707,e=>{"use strict";var s=e.i(391398),a=e.i(191788);let t=`Return-Path: <billing@example-payments.com>
Received: from mail-ot1-f45.google.com (mail-ot1-f45.google.com. [209.85.210.45])
        by mx.example.org with ESMTPS id f19si123456qkf.123.2024.01.15.09.13.10
        for <you@example.org>
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384);
        Mon, 15 Jan 2024 09:13:10 +0000 (UTC)
Authentication-Results: mx.example.org;
        spf=softfail (google.com: domain of transitioning billing@example-payments.com does not designate 209.85.210.45 as permitted sender) smtp.mailfrom=billing@example-payments.com;
        dkim=fail;
        dmarc=fail;
From: "Payments team" <billing@example-payments.com>
To: you@example.org
Subject: Urgent: account suspended, update details now
Date: Mon, 15 Jan 2024 09:12:58 +0000`;function i(){let e,i,l,n,[r,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),m=d?t:r,{verdict:u,reasons:h}=m.trim()?(e=m.toLowerCase(),i=[],e.includes("authentication-results")||i.push("No Authentication-Results header was found."),e.includes("spf=")?(e.includes("spf=fail")||e.includes("spf=softfail"))&&i.push("SPF check failed for this message."):i.push("No SPF result was found in Authentication-Results."),e.includes("dkim=fail")&&i.push("DKIM signature failed validation."),e.includes("dmarc=")?e.includes("dmarc=fail")&&i.push("DMARC evaluation failed for this message."):i.push("No DMARC result was found in Authentication-Results."),(e.match(/received:/g)||[]).length<2&&i.push("Only one Received header was found which is unusual."),l="safe",((n=i.join(" ").toLowerCase()).includes("failed")||n.includes("unusual")||n.includes("no dmarc"))&&(l="caution"),(n.includes("spf check failed")||n.includes("dkim signature failed")||n.includes("dmarc evaluation failed"))&&(l="risky"),{verdict:l,reasons:i}):{verdict:"safe",reasons:[]};return(0,s.jsxs)("section",{"aria-labelledby":"email-header-lab-title",className:"rounded-3xl bg-white shadow-sm ring-1 ring-slate-100 p-6 sm:p-8 space-y-6",children:[(0,s.jsxs)("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{id:"email-header-lab-title",className:"text-lg sm:text-xl font-semibold text-slate-900",children:"Email header explainer"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600 max-w-xl",children:"Paste an email header and see how SPF, DKIM and DMARC results affect your trust in the message. Nothing leaves your browser."})]}),(0,s.jsx)("button",{type:"button",onClick:()=>c(e=>!e),className:"inline-flex items-center justify-center rounded-full border border-slate-200 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2",children:d?"Use your own header":"Use example header"})]}),(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("label",{htmlFor:"email-header-input",className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Header text"}),(0,s.jsx)("textarea",{id:"email-header-input",className:"h-56 w-full resize-none rounded-2xl border border-slate-200 bg-slate-50/60 px-3 py-2 text-sm font-mono text-slate-800 shadow-inner focus:border-sky-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-200",placeholder:"Paste the full email header here...",value:d?t:r,onChange:e=>{c(!1),o(e.target.value)}}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Tip: In most email clients you can view the raw header via menu options like View original or Show source. Never paste sensitive content from private or confidential emails."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:`rounded-2xl border px-4 py-3 text-sm font-medium ${"safe"===u?"bg-emerald-50 text-emerald-800 border-emerald-200":"caution"===u?"bg-amber-50 text-amber-800 border-amber-200":"bg-rose-50 text-rose-800 border-rose-200"}`,children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide mb-1",children:"Overall signal"}),(0,s.jsx)("p",{children:m.trim()?"safe"===u?"Signals are mostly consistent. Still stay alert.":"caution"===u?"Signals are mixed. Treat this message with caution.":"Multiple signals look risky. Treat this message as suspicious.":"Waiting for a header."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 p-4 space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"How to read this"}),(0,s.jsxs)("ul",{className:"space-y-1.5 text-xs text-slate-700",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"SPF"})," confirms the sending server is allowed to send mail for this domain."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"DKIM"})," is a digital signature that proves the message has not been changed in transit."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"DMARC"})," tells receivers how strictly to treat failures and can signal phishing."]})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 space-y-2",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Signals from this header"}),m.trim()?(0,s.jsxs)("ul",{className:"list-disc pl-5 space-y-1.5 text-xs text-slate-700",children:[0===h.length&&(0,s.jsx)("li",{children:"No obvious red flags were found. This does not guarantee the message is safe. Always check the content and context."}),h.map((e,a)=>(0,s.jsx)("li",{children:e},a))]}):(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Paste a header to see a breakdown of the main signals."})]})]})]})]})}e.s(["EmailHeaderLab",()=>i])},710819,e=>{e.n(e.i(207707))}]);

//# debugId=921a6389-6b10-9679-ffca-57736e848a39
//# sourceMappingURL=57d1a6fdfbd8684d.js.map