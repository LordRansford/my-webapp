;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="e2a4d050-fd8c-123e-b217-dcb1af00e7b6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,896189,e=>{"use strict";var s=e.i(843476),t=e.i(271645);function l(e){return new Set(String(e||"").split(",").map(e=>e.trim()).filter(Boolean))}function a(e){for(let s of l(e))if(s.startsWith("domain:"))return s.slice(7);return""}function i(e){let[i,n]=(0,t.useState)("cybersecurity"),[o,d]=(0,t.useState)("foundations"),[r,c]=(0,t.useState)("2025.01"),[x,m]=(0,t.useState)(!1),[u,p]=(0,t.useState)(""),[h,b]=(0,t.useState)(""),[v,g]=(0,t.useState)(null),[j,f]=(0,t.useState)(null),[N,y]=(0,t.useState)(null),[w,C]=(0,t.useState)(null),[q,I]=(0,t.useState)(""),R=(0,t.useMemo)(()=>({courseId:i,levelId:o,version:r}),[i,o,r]),S=async()=>{m(!0),p("");try{let e=`/api/admin/assessments/questions?courseId=${encodeURIComponent(R.courseId)}&levelId=${encodeURIComponent(R.levelId)}&version=${encodeURIComponent(R.version)}`,s=await fetch(e),t=await s.json().catch(()=>null);if(!s.ok)return void p(t?.error||"Unable to load assessment.");g(t);let l=`/api/admin/assessments/analysis?courseId=${encodeURIComponent(R.courseId)}&levelId=${encodeURIComponent(R.levelId)}&version=${encodeURIComponent(R.version)}`,a=await fetch(l),i=await a.json().catch(()=>null);a.ok?f(i):f(null);let n=`/api/admin/assessments/quality?courseId=${encodeURIComponent(R.courseId)}&levelId=${encodeURIComponent(R.levelId)}&version=${encodeURIComponent(R.version)}`,o=await fetch(n),d=await o.json().catch(()=>null);o.ok?y(d):y(null)}catch{p("Unable to load assessment.")}finally{m(!1)}};(0,t.useEffect)(()=>{S()},[R.courseId,R.levelId,R.version]);let k=(0,t.useMemo)(()=>{let e=v?.questions||[],s=e.filter(e=>e.published).length;return{total:e.length,published:s,draft:e.length-s}},[v?.questions]),U=(0,t.useMemo)(()=>q?new Set(N?.issues?.[q]||N?.samples?.[q]||[]):null,[q,N?.issues,N?.samples]),$=(0,t.useMemo)(()=>{let e=v?.questions||[];return U?e.filter(e=>U.has(e.id)):e},[v?.questions,U]),A=(0,t.useMemo)(()=>"network-models"===R.courseId?"foundations"===o?["models","encapsulation","layers","addressing","dns","subnetting"]:"applied"===o?["tcp","udp","dns","routing","nat","tls"]:["security","observability","captures","segmentation","operations","troubleshooting"]:"foundations"===o?["basics","identity","network","crypto","risk","response"]:"applied"===o?["web","api","auth","secrets","cloud","logging"]:["sdlc","zero-trust","runtime","vulnerability","detection","governance"],[o,R.courseId]),M=async s=>{if(!e.canManage)return;let t=h.trim();if(!t)return void p("Reason required.");m(!0),p("");try{var a,i;let e,n=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(s.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:t,version:R.version,published:!s.published,patch:{tags:(a=s.tags,i=!s.published,e=l(a),i?e.add("published"):e.delete("published"),Array.from(e).join(", "))}})}),o=await n.json().catch(()=>null);if(!n.ok)return void p(o?.error||"Unable to update question.");b(""),await S()}catch{p("Unable to update question.")}finally{m(!1)}},O=async s=>{if(!e.canManage)return;let t=h.trim();if(!t)return void p("Reason required.");m(!0),p("");try{let e=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(s.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:t,version:R.version,patch:{question:s.question,options:s.options,correctAnswer:s.correctAnswer,explanation:s.explanation,optionRationales:s.optionRationales,tags:s.tags,bloomLevel:s.bloomLevel}})}),l=await e.json().catch(()=>null);if(!e.ok)return void p(l?.error||"Unable to update question.");C(null),b(""),await S()}catch{p("Unable to update question.")}finally{m(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"course",children:"Course"}),(0,s.jsxs)("select",{id:"course",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:i,onChange:e=>n(e.target.value),children:[(0,s.jsx)("option",{value:"cybersecurity",children:"Cybersecurity"}),(0,s.jsx)("option",{value:"network-models",children:"Network models"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"level",children:"Level"}),(0,s.jsxs)("select",{id:"level",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:o,onChange:e=>d(e.target.value),children:[(0,s.jsx)("option",{value:"foundations",children:"Foundations"}),(0,s.jsx)("option",{value:"applied",children:"Applied"}),(0,s.jsx)("option",{value:"practice",children:"Practice"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"version",children:"Course version"}),(0,s.jsx)("input",{id:"version",value:r,onChange:e=>c(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",placeholder:"Example 2025.01"})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Questions"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:k.total})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Published"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:k.published})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Draft"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:k.draft})]})]}),(0,s.jsxs)("div",{className:"grid gap-2 md:grid-cols-[1fr_auto]",children:[(0,s.jsx)("input",{value:h,onChange:e=>b(e.target.value),placeholder:"Reason for change",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"}),(0,s.jsx)("button",{type:"button",disabled:x,onClick:S,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:x?"Loading":"Refresh"})]}),j?(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Attempt analytics"}),(0,s.jsxs)("div",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Attempts"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:j.attempts.total})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Pass rate"}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[j.attempts.passRatePercent," percent"]})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Average score"}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[j.attempts.avgScore," percent"]})]})]})]}):null,u?(0,s.jsx)("div",{className:"text-sm font-semibold text-rose-700",children:u}):null]}),(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Questions"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,s.jsx)("span",{children:"Tag `published` is required for exam selection"}),(0,s.jsx)("a",{className:"font-semibold text-emerald-700 hover:underline",href:`/api/admin/assessments/answer-key?courseId=${encodeURIComponent(R.courseId)}&levelId=${encodeURIComponent(R.levelId)}&version=${encodeURIComponent(R.version)}`,children:"Download answer key"})]})]}),N?(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Quality checks"}),(0,s.jsx)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:Object.entries(N.totals||{}).map(([e,t])=>(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:e}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:t})]},e))}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("button",{type:"button",className:["rounded-full border px-3 py-1 text-xs font-semibold shadow-sm",!q?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-900 hover:bg-slate-50"].join(" "),onClick:()=>I(""),children:"Show all"}),Object.entries(N.totals||{}).filter(([,e])=>Number(e)>0).slice(0,10).map(([e])=>(0,s.jsx)("button",{type:"button",className:["rounded-full border px-3 py-1 text-xs font-semibold shadow-sm",q===e?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-900 hover:bg-slate-50"].join(" "),onClick:()=>I(e),title:"Filter questions by this issue",children:e},e))]}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Prioritise missing rationales first so the exported answer key is worth paying for."})]}):null,(0,s.jsx)("div",{className:"space-y-3",children:$.map(t=>{let i=w===t.id,n=a(t.tags);return(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:t.id}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[t.type," Bloom ",t.bloomLevel]}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:t.published?"Published":"Draft"}),n?(0,s.jsxs)("div",{className:"text-xs font-semibold text-slate-700",children:["Domain ",n]}):(0,s.jsx)("div",{className:"text-xs font-semibold text-rose-700",children:"Domain missing"})]}),(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:e.canManage?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",disabled:x,onClick:()=>C(i?null:t.id),className:"rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:i?"Close":"Edit"}),(0,s.jsx)("button",{type:"button",disabled:x,onClick:()=>M(t),className:"rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:t.published?"Unpublish":"Publish"})]}):(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Read only"})})]}),i?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Question"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:t.question,onChange:e=>{let s=e.target.value;g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,question:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Options"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(t.options||[]).join("\n"),onChange:e=>{let s=e.target.value.split("\n").map(e=>e.trim()).filter(Boolean);g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,options:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Correct answer index"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:"number"==typeof t.correctAnswer?String(t.correctAnswer):"",onChange:e=>{let s=Number(e.target.value);g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,correctAnswer:Number.isFinite(s)?s:0}:e)}:e)}}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"This editor supports MCQ index answers for now"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Explanation"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:t.explanation,onChange:e=>{let s=e.target.value;g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,explanation:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Option rationales"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(t.optionRationales||[]).join("\n"),onChange:e=>{let s=e.target.value.split("\n").map(e=>e.trimEnd());g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,optionRationales:s}:e)}:e)},placeholder:"One line per option. Include why each option is correct or wrong."}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Keep the number of lines aligned with options"})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Bloom level"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:String(t.bloomLevel),onChange:e=>{let s=Math.max(1,Math.min(6,Number(e.target.value)||1));g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,bloomLevel:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tags"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:t.tags,onChange:e=>{let s=e.target.value;g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,tags:s}:e)}:e)}}),(0,s.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Domain tag"}),(0,s.jsxs)("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:a(t.tags)||"",onChange:e=>{let s=e.target.value;g(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,tags:function(e,s){let t=l(e);for(let e of Array.from(t))e.startsWith("domain:")&&t.delete(e);let a=String(s||"").trim();return a&&t.add(`domain:${a}`),Array.from(t).join(", ")}(e.tags,s)}:e)}:e)},children:[(0,s.jsx)("option",{value:"",children:"Choose domain"}),A.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tip"}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Use exactly one domain tag. Keep it consistent with the blueprint so the learning report links correctly."})]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("button",{type:"button",disabled:x,onClick:()=>O(t),className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"}),(0,s.jsx)("button",{type:"button",disabled:x,onClick:()=>C(null),className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"})]})]}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:t.question}),(0,s.jsx)("ol",{className:"ml-5 list-decimal space-y-1 text-sm text-slate-700",children:(t.options||[]).map((e,t)=>(0,s.jsx)("li",{children:e},t))}),(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:["Tags ",t.tags]})]})]},t.id)})})]})]})}e.s(["default",()=>i])}]);

//# debugId=e2a4d050-fd8c-123e-b217-dcb1af00e7b6
//# sourceMappingURL=2221e25ecd2ce78c.js.map