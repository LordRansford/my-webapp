;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="f106b311-7132-afbe-a551-a99760aa1e5a")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,443042,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(522016);function l(e){try{return new Date(e).toLocaleString()}catch{return e}}async function r(e,s){let t=await fetch(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(s)}),a=await t.json().catch(()=>({}));if(!t.ok)throw Error(a?.error||a?.message||"Request failed");return a}function i({user:e}){let[i,n]=(0,t.useState)(null),[d,c]=(0,t.useState)(null),[o,x]=(0,t.useState)(null),[m,u]=(0,t.useState)(e.role),[p,b]=(0,t.useState)(e.accountStatus),[h,f]=(0,t.useState)(""),[g,N]=(0,t.useState)(""),[j,v]=(0,t.useState)(null),[y,w]=(0,t.useState)(null),[A,C]=(0,t.useState)(0),[R,S]=(0,t.useState)(""),I=(0,t.useMemo)(()=>["NONE","READ_ONLY","SUPPORT","ADMIN","OWNER"],[]),P=(0,t.useMemo)(()=>["active","pending","suspended"],[]),k=async()=>{w("snapshot"),c(null);try{let s=await fetch(`/api/admin/users/${encodeURIComponent(e.userId)}/support-snapshot`),t=await s.json().catch(()=>({}));if(!s.ok)throw Error(t?.error||"Failed to load support snapshot");v({learnerProfile:t?.learnerProfile||null,credits:t?.credits?{balance:Number(t.credits.balance||0),expiresAt:t.credits.expiresAt||null}:null,creditLots:Array.isArray(t?.creditLots)?t.creditLots:[],purchases:Array.isArray(t?.purchases)?t.purchases:[],certificateEntitlements:Array.isArray(t?.certificateEntitlements)?t.certificateEntitlements:[],certificates:Array.isArray(t?.certificates)?t.certificates:[],assessmentAttempts:Array.isArray(t?.assessmentAttempts)?t.assessmentAttempts:[]})}catch(e){c(e.message||"Failed to load support snapshot")}finally{w(null)}},E=async()=>{c(null),x(null);let s=R.trim(),t=Math.max(0,Math.round(A||0));if(!s)return c("Reason is required.");if(!t)return c("Credits must be greater than zero.");if(confirm("Confirm credit grant")){w("grant");try{let a=await r(`/api/admin/users/${encodeURIComponent(e.userId)}/credits/grant`,{credits:t,reason:s});x(`Credits granted. New balance ${a?.balance??"updated"}.`),C(0),S(""),await k()}catch(e){c(e.message||"Failed to grant credits.")}finally{w(null)}}},U=async()=>{c(null),x(null);let s=h.trim();if(!s)return c("Reason is required.");if(confirm("Confirm role change")){n("role");try{await r(`/api/admin/users/${encodeURIComponent(e.userId)}/role`,{role:m,reason:s}),x("Role updated."),f("")}catch(e){c(e.message||"Failed to update role.")}finally{n(null)}}},L=async()=>{c(null),x(null);let s=g.trim();if(!s)return c("Reason is required.");if(confirm("Confirm status change")){n("status");try{await r(`/api/admin/users/${encodeURIComponent(e.userId)}/status`,{status:p,reason:s}),x("Status updated."),N("")}catch(e){c(e.message||"Failed to update status.")}finally{n(null)}}};return(0,s.jsxs)("main",{className:"mx-auto max-w-4xl px-4 py-10 md:px-6 lg:px-8 space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"Users"}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:e.email}),(0,s.jsxs)("p",{className:"text-xs text-slate-600 font-mono",children:["User ID: ",e.userId]})]}),(0,s.jsx)(a.default,{href:"/admin/users",className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-900 hover:border-slate-400",children:"Back to users"})]}),d?(0,s.jsx)("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900",children:d}):null,o?(0,s.jsx)("div",{className:"rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-900",children:o}):null,(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Profile summary"}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Created"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:l(e.createdAt)})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Last active"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:l(e.lastActiveAt)})]})]})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Support snapshot"}),(0,s.jsx)("button",{type:"button",className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",disabled:null!==y,onClick:k,children:"snapshot"===y?"Loading...":j?"Refresh":"Load"})]}),j?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Certificate name"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:j.learnerProfile?.certificateName||"Not set"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:j.learnerProfile?.lockedAt?`Locked ${l(j.learnerProfile.lockedAt)}`:""})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-4",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-slate-700",children:"Credits"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:j.credits?j.credits.balance:0}),(0,s.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:j.credits?.expiresAt?`Expires ${l(j.credits.expiresAt)}`:""})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-3",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Grant credits"}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Credits"}),(0,s.jsx)("input",{type:"number",min:0,value:A,onChange:e=>C(Number(e.target.value)||0),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2"})]}),(0,s.jsxs)("label",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Reason"}),(0,s.jsx)("input",{value:R,onChange:e=>S(e.target.value),placeholder:"Required",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2"})]})]}),(0,s.jsx)("button",{type:"button",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:null!==y,onClick:E,children:"grant"===y?"Granting...":"Grant credits"})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Recent assessment attempts"}),(j.assessmentAttempts||[]).length?(0,s.jsx)("div",{className:"space-y-2",children:(j.assessmentAttempts||[]).slice(0,6).map(e=>(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:e.passed?"Pass":"Not passed"}),(0,s.jsxs)("div",{className:"text-xs text-slate-700",children:["Score ",e.score," percent"]}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:e.courseVersion}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:l(e.completedAt)})]},e.id))}):(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No attempts recorded."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Certificate entitlements"}),(j.certificateEntitlements||[]).length?(0,s.jsx)("div",{className:"space-y-2",children:(j.certificateEntitlements||[]).slice(0,6).map(e=>(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:e.courseId}),(0,s.jsx)("div",{className:"text-xs text-slate-700",children:e.status}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:l(e.updatedAt)})]},e.id))}):(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No entitlements."})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Certificates"}),(j.certificates||[]).length?(0,s.jsx)("div",{className:"space-y-2",children:(j.certificates||[]).slice(0,6).map(e=>(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 flex flex-wrap items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:e.courseId}),(0,s.jsx)("div",{className:"text-xs text-slate-700",children:e.status}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:e.courseVersion}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:l(e.issuedAt)})]},e.id))}):(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No certificates issued."})]})]}):(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Load a single view of credits, purchases, attempts, and certificate state for support work."})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Roles and permissions"}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Role changes require a reason and are audited."}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Role"}),(0,s.jsx)("select",{value:m,onChange:e=>u(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2",children:I.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("label",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Reason"}),(0,s.jsx)("input",{value:h,onChange:e=>f(e.target.value),placeholder:"Required",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2"})]})]}),(0,s.jsx)("button",{type:"button",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:null!==i,onClick:U,children:"role"===i?"Updating...":"Change role"})]}),(0,s.jsxs)("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Account status"}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:"Status changes require a reason and are audited."}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("label",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Status"}),(0,s.jsx)("select",{value:p,onChange:e=>b(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2",children:P.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("label",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Reason"}),(0,s.jsx)("input",{value:g,onChange:e=>N(e.target.value),placeholder:"Required",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2"})]})]}),(0,s.jsx)("button",{type:"button",className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:null!==i,onClick:L,children:"status"===i?"Updating...":"Change status"})]})]})}e.s(["default",()=>i])}]);

//# debugId=f106b311-7132-afbe-a551-a99760aa1e5a
//# sourceMappingURL=c4b417f84f950744.js.map