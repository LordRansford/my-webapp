;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="fde61697-998f-9546-214b-75bd372aaef2")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72888,e=>{"use strict";var t=e.i(391398),s=e.i(191788);let a=[{id:"asset1",name:"Customer data",value:"high"},{id:"asset2",name:"Payment API",value:"high"},{id:"asset3",name:"Support inbox",value:"medium"}],n=[{id:"att1",name:"External attacker"},{id:"att2",name:"Insider"},{id:"att3",name:"Bot/scanner"}],l=[{id:"entry1",name:"Web portal"},{id:"entry2",name:"API"},{id:"entry3",name:"Support inbox"}];function r(){let[e,r]=(0,s.useState)(a),[i,c]=(0,s.useState)(n),[m,u]=(0,s.useState)(l),[x,h]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),[f,p]=(0,s.useState)({attToEntry:[],entryToAsset:[]}),[g,j]=(0,s.useState)(""),N=(e,t,s)=>{p(a=>{let n="attToEntry"===s?a.attToEntry:a.entryToAsset,l=n.find(s=>s.from===e&&s.to===t)?n.filter(s=>s.from!==e||s.to!==t):[...n,{from:e,to:t}];return"attToEntry"===s?{...a,attToEntry:l}:{...a,entryToAsset:l}})};return(0,s.useMemo)(()=>{let t={};f.entryToAsset.forEach(e=>{t[e.to]=(t[e.to]||0)+1});let s=Object.entries(t).sort((e,t)=>t[1]-e[1])[0]?.[0],a=e.find(e=>e.id===s)||e[0],n=f.attToEntry.filter(e=>f.entryToAsset.some(t=>t.from===e.to&&t.to===a?.id)).map(e=>e.from).reduce((e,t)=>({...e,[t]:(e[t]||0)+1}),{}),l=Object.entries(n).sort((e,t)=>t[1]-e[1])[0]?.[0],r=i.find(e=>e.id===l)||i[0];a&&r?j(`${a.name} (value: ${a.value}) has the most connected entry points. ${r.name} has the most paths to it.`):j("Add links to see which attacker can most easily reach which asset.")},[e,i,f]),(0,t.jsxs)("div",{className:"rounded-2xl bg-white p-4 shadow-md ring-1 ring-slate-200",children:[(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,t.jsx)(o,{title:"Assets",items:e,onAdd:()=>{e.length>=5||r([...e,{id:`asset-${Date.now()}`,name:"New asset",value:"low"}])},selected:null,onSelect:()=>{},type:"asset"}),(0,t.jsx)(o,{title:"Entry points",items:m,onAdd:()=>{m.length>=5||u([...m,{id:`entry-${Date.now()}`,name:"New entry point"}])},selected:b,onSelect:y,type:"entry"}),(0,t.jsx)(o,{title:"Attacker types",items:i,onAdd:()=>{i.length>=4||c([...i,{id:`att-${Date.now()}`,name:"New attacker"}])},selected:x,onSelect:h,type:"attacker"})]}),(0,t.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm",children:[(0,t.jsx)("h5",{className:"text-sm font-semibold text-slate-900",children:"Link attackers to entry points"}),(0,t.jsx)(d,{rows:i,cols:m,links:f.attToEntry,onToggle:(e,t)=>N(e,t,"attToEntry")})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 text-sm shadow-sm",children:[(0,t.jsx)("h5",{className:"text-sm font-semibold text-slate-900",children:"Link entry points to assets"}),(0,t.jsx)(d,{rows:m,cols:e,links:f.entryToAsset,onToggle:(e,t)=>N(e,t,"entryToAsset")})]})]}),(0,t.jsx)("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white p-3 text-sm text-slate-900 shadow-sm",children:g})]})}function o({title:e,items:s,onAdd:a,selected:n,onSelect:l,type:r}){return(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-slate-900",children:e}),(0,t.jsx)("button",{onClick:a,className:"rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-800 shadow-sm hover:border-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-300",children:"Add"})]}),(0,t.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,t.jsxs)("button",{onClick:()=>l&&l(e.id),className:`w-full rounded-lg border px-3 py-2 text-left text-sm font-medium transition focus:outline-none focus:ring-2 focus:ring-sky-300 ${n===e.id?"border-sky-300 bg-sky-50 text-slate-900":"border-slate-200 bg-white text-slate-800"}`,children:[(0,t.jsx)("div",{className:"font-semibold",children:e.name}),e.value?(0,t.jsxs)("div",{className:"text-xs text-slate-700",children:["Value: ",e.value]}):null]},e.id))})]})}function d({rows:e,cols:s,links:a,onToggle:n}){return(0,t.jsx)("div",{className:"overflow-auto",children:(0,t.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2 text-left text-slate-700",children:"From \\\\ To"}),s.map(e=>(0,t.jsx)("th",{className:"p-2 text-left text-slate-700",children:e.name},e.id))]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,t.jsx)("td",{className:"p-2 font-semibold text-slate-800",children:e.name}),s.map(s=>{let l=a.some(t=>t.from===e.id&&t.to===s.id);return(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("button",{onClick:()=>n(e.id,s.id),className:`h-6 w-6 rounded-full border ${l?"border-emerald-300 bg-emerald-100":"border-slate-300 bg-white"} focus:outline-none focus:ring-2 focus:ring-sky-300`,"aria-label":"Toggle link"})},s.id)})]},e.id))})]})})}e.s(["default",()=>r])},263743,e=>{e.n(e.i(72888))}]);

//# debugId=fde61697-998f-9546-214b-75bd372aaef2
//# sourceMappingURL=d31baeeb58d62b89.js.map