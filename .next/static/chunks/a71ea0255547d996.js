;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="581370e1-3d68-21ed-8264-b4c30f2b96de")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,115910,e=>{"use strict";let t=(0,e.i(369547).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t])},430788,e=>{"use strict";var t=e.i(115910);e.s(["CheckCircle",()=>t.default])},790075,e=>{"use strict";let t=(0,e.i(369547).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["default",()=>t])},835707,e=>{"use strict";var t=e.i(790075);e.s(["Lock",()=>t.default])},302255,e=>{"use strict";let t=(0,e.i(369547).default)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["default",()=>t])},726331,e=>{"use strict";var t=e.i(302255);e.s(["Key",()=>t.default])},941986,e=>{"use strict";let t=(0,e.i(369547).default)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);e.s(["default",()=>t])},934720,e=>{"use strict";let t=(0,e.i(369547).default)("FilePenLine",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]]);e.s(["default",()=>t])},699882,e=>{"use strict";var t=e.i(941986);e.s(["Unlock",()=>t.default])},500203,e=>{"use strict";var t=e.i(391398),s=e.i(191788),a=e.i(726331),r=e.i(835707),i=e.i(699882),l=e.i(934720),l=l,n=e.i(430788);let c=null;async function d(){return c=await crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]),await crypto.subtle.exportKey("spki",c.publicKey),!0}async function o(e){if(!c)throw Error("Generate key pair first");let t=new TextEncoder;return Array.from(new Uint8Array(await crypto.subtle.encrypt({name:"RSA-OAEP"},c.publicKey,t.encode(e)))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function x(e){if(!c)throw Error("Generate key pair first");let t=new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16))),s=await crypto.subtle.decrypt({name:"RSA-OAEP"},c.privateKey,t);return new TextDecoder().decode(s)}async function u(e){if(!c)throw Error("Generate key pair first");let t=new TextEncoder;return Array.from(new Uint8Array(await crypto.subtle.sign({name:"RSA-PSS",saltLength:32},c.privateKey,t.encode(e)))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function m(e,t){if(!c)throw Error("Generate key pair first");let s=new TextEncoder,a=new Uint8Array(t.match(/.{1,2}/g).map(e=>parseInt(e,16)));return crypto.subtle.verify({name:"RSA-PSS",saltLength:32},c.publicKey,a,s.encode(e))}function y(){let[e,c]=(0,s.useState)("Hello, world!"),[y,p]=(0,s.useState)(""),[g,f]=(0,s.useState)(""),[h,b]=(0,s.useState)(""),[k,j]=(0,s.useState)(null),[v,w]=(0,s.useState)(!1),[N,S]=(0,s.useState)(!1),[A,E]=(0,s.useState)(""),K=async()=>{S(!0),E("");try{await d(),w(!0),p(""),f(""),b(""),j(null)}catch(e){E("Key generation failed: "+e.message)}finally{S(!1)}},C=async()=>{if(!v)return void E("Generate a key pair first");S(!0),E("");try{let t=await o(e);p(t),f("")}catch(e){E("Encryption failed: "+e.message)}finally{S(!1)}},z=async()=>{if(!y)return void E("Encrypt a message first");S(!0),E("");try{let e=await x(y);f(e)}catch(e){E("Decryption failed: "+e.message)}finally{S(!1)}},P=async()=>{if(!v)return void E("Generate a key pair first");S(!0),E("");try{let t=await u(e);b(t),j(null)}catch(e){E("Signing failed: "+e.message)}finally{S(!1)}},L=async()=>{if(!h)return void E("Sign a message first");S(!0),E("");try{let t=await m(e,h);j(t)}catch(e){E("Verification failed: "+e.message)}finally{S(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col gap-6 rounded-2xl bg-slate-950/80 p-4 text-slate-50 shadow-sm ring-1 ring-slate-800 md:flex-row md:p-5",children:[(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold tracking-tight text-slate-50",children:"Public and private key lab"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-300",children:"Generate an RSA key pair and try encryption, decryption, signing and verification. All operations use the Web Crypto API in your browser."})]}),(0,t.jsxs)("div",{className:"rounded-xl bg-slate-900/80 p-3 ring-1 ring-slate-800",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,t.jsx)(a.Key,{size:16,className:"text-sky-400"}),(0,t.jsx)("label",{className:"text-xs font-medium text-slate-200",children:"Key pair"})]}),(0,t.jsx)("button",{onClick:K,disabled:N,className:"w-full rounded-lg bg-sky-600 px-3 py-2 text-xs font-medium text-white transition hover:bg-sky-700 disabled:opacity-50",children:v?"Regenerate key pair":"Generate key pair"}),v&&(0,t.jsx)("p",{className:"mt-2 text-[0.7rem] text-emerald-300",children:"Key pair generated successfully"})]}),(0,t.jsxs)("div",{className:"rounded-xl bg-slate-900/80 p-3 ring-1 ring-slate-800",children:[(0,t.jsx)("label",{className:"mb-2 block text-xs font-medium text-slate-200",children:"Message"}),(0,t.jsx)("textarea",{value:e,onChange:e=>c(e.target.value),rows:3,className:"w-full rounded-lg border border-slate-700 bg-slate-950/80 px-2 py-1.5 text-xs text-slate-50 placeholder:text-slate-500 focus:border-sky-400 focus:outline-none focus:ring-1 focus:ring-sky-400",placeholder:"Enter message..."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("button",{onClick:C,disabled:N||!v,className:"flex items-center justify-center gap-2 rounded-lg bg-sky-600 px-3 py-2 text-xs font-medium text-white transition hover:bg-sky-700 disabled:opacity-50",children:[(0,t.jsx)(r.Lock,{size:14}),"Encrypt"]}),(0,t.jsxs)("button",{onClick:z,disabled:N||!y,className:"flex items-center justify-center gap-2 rounded-lg bg-emerald-600 px-3 py-2 text-xs font-medium text-white transition hover:bg-emerald-700 disabled:opacity-50",children:[(0,t.jsx)(i.Unlock,{size:14}),"Decrypt"]}),(0,t.jsxs)("button",{onClick:P,disabled:N||!v,className:"flex items-center justify-center gap-2 rounded-lg bg-purple-600 px-3 py-2 text-xs font-medium text-white transition hover:bg-purple-700 disabled:opacity-50",children:[(0,t.jsx)(l.default,{size:14}),"Sign"]}),(0,t.jsxs)("button",{onClick:L,disabled:N||!h,className:"flex items-center justify-center gap-2 rounded-lg bg-orange-600 px-3 py-2 text-xs font-medium text-white transition hover:bg-orange-700 disabled:opacity-50",children:[(0,t.jsx)(n.CheckCircle,{size:14}),"Verify"]})]}),A&&(0,t.jsx)("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-2 text-xs text-red-300",children:A})]}),(0,t.jsxs)("div",{className:"flex w-full max-w-xs flex-col gap-4 md:max-w-sm",children:[y&&(0,t.jsxs)("div",{className:"rounded-2xl bg-slate-900/80 p-4 ring-1 ring-slate-800",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,t.jsx)(r.Lock,{size:18,className:"text-sky-400"}),(0,t.jsx)("h4",{className:"text-xs font-semibold text-slate-100",children:"Encrypted (ciphertext)"})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-700 bg-slate-950/80 p-2 font-mono text-[0.65rem] text-sky-300 break-all",children:[y.substring(0,64),"..."]})]}),g&&(0,t.jsxs)("div",{className:"rounded-2xl bg-slate-900/80 p-4 ring-1 ring-slate-800",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,t.jsx)(i.Unlock,{size:18,className:"text-emerald-400"}),(0,t.jsx)("h4",{className:"text-xs font-semibold text-slate-100",children:"Decrypted message"})]}),(0,t.jsx)("div",{className:"rounded-lg border border-slate-700 bg-slate-950/80 p-2 text-xs text-emerald-300",children:g})]}),h&&(0,t.jsxs)("div",{className:"rounded-2xl bg-slate-900/80 p-4 ring-1 ring-slate-800",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,t.jsx)(l.default,{size:18,className:"text-purple-400"}),(0,t.jsx)("h4",{className:"text-xs font-semibold text-slate-100",children:"Signature"})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-700 bg-slate-950/80 p-2 font-mono text-[0.65rem] text-purple-300 break-all",children:[h.substring(0,64),"..."]}),null!==k&&(0,t.jsx)("div",{className:`mt-2 text-xs ${k?"text-emerald-300":"text-red-300"}`,children:k?"✓ Signature verified":"✗ Signature invalid"})]}),(0,t.jsxs)("div",{className:"rounded-2xl bg-slate-900/80 p-3 text-xs text-slate-200 ring-1 ring-slate-800",children:[(0,t.jsx)("p",{className:"font-semibold text-sky-200",children:"Key concepts"}),(0,t.jsx)("p",{className:"mt-1 text-[0.7rem] text-slate-300",children:"Public keys encrypt and verify. Private keys decrypt and sign. The public key can be shared, but the private key must be kept secret. This asymmetry enables secure communication without pre sharing secrets."})]})]})]})}e.s(["default",()=>y],500203)},50815,e=>{e.n(e.i(500203))}]);

//# debugId=581370e1-3d68-21ed-8264-b4c30f2b96de
//# sourceMappingURL=d39e63bebf9899bb.js.map