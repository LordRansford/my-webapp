;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4940e3b9-8eda-58e3-d4bc-72138af967be")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,896189,e=>{"use strict";var s=e.i(843476),t=e.i(271645);function l(e){let[l,a]=(0,t.useState)("foundations"),[i,n]=(0,t.useState)("2025.01"),[d,o]=(0,t.useState)(!1),[r,c]=(0,t.useState)(""),[x,m]=(0,t.useState)(""),[u,p]=(0,t.useState)(null),[h,b]=(0,t.useState)(null),[v,j]=(0,t.useState)(null),g=(0,t.useMemo)(()=>({courseId:"cybersecurity",levelId:l,version:i}),[l,i]),f=async()=>{o(!0),c("");try{let e=`/api/admin/assessments/questions?courseId=${encodeURIComponent(g.courseId)}&levelId=${encodeURIComponent(g.levelId)}&version=${encodeURIComponent(g.version)}`,s=await fetch(e),t=await s.json().catch(()=>null);if(!s.ok)return void c(t?.error||"Unable to load assessment.");p(t);let l=`/api/admin/assessments/analysis?courseId=${encodeURIComponent(g.courseId)}&levelId=${encodeURIComponent(g.levelId)}&version=${encodeURIComponent(g.version)}`,a=await fetch(l),i=await a.json().catch(()=>null);a.ok?b(i):b(null)}catch{c("Unable to load assessment.")}finally{o(!1)}};(0,t.useEffect)(()=>{f()},[g.courseId,g.levelId,g.version]);let N=(0,t.useMemo)(()=>{let e=u?.questions||[],s=e.filter(e=>e.published).length;return{total:e.length,published:s,draft:e.length-s}},[u?.questions]),y=async s=>{if(!e.canManage)return;let t=x.trim();if(!t)return void c("Reason required.");o(!0),c("");try{var l,a;let e,i=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(s.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:t,version:g.version,published:!s.published,patch:{tags:(l=s.tags,a=!s.published,e=new Set(String(l||"").split(",").map(e=>e.trim()).filter(Boolean)),a?e.add("published"):e.delete("published"),Array.from(e).join(", "))}})}),n=await i.json().catch(()=>null);if(!i.ok)return void c(n?.error||"Unable to update question.");m(""),await f()}catch{c("Unable to update question.")}finally{o(!1)}},w=async s=>{if(!e.canManage)return;let t=x.trim();if(!t)return void c("Reason required.");o(!0),c("");try{let e=await fetch(`/api/admin/assessments/questions/${encodeURIComponent(s.id)}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reason:t,version:g.version,patch:{question:s.question,options:s.options,correctAnswer:s.correctAnswer,explanation:s.explanation,optionRationales:s.optionRationales,tags:s.tags,bloomLevel:s.bloomLevel}})}),l=await e.json().catch(()=>null);if(!e.ok)return void c(l?.error||"Unable to update question.");j(null),m(""),await f()}catch{c("Unable to update question.")}finally{o(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Course"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:"Cybersecurity"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"level",children:"Level"}),(0,s.jsxs)("select",{id:"level",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:l,onChange:e=>a(e.target.value),children:[(0,s.jsx)("option",{value:"foundations",children:"Foundations"}),(0,s.jsx)("option",{value:"applied",children:"Applied"}),(0,s.jsx)("option",{value:"practice",children:"Practice"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-xs font-semibold text-slate-600",htmlFor:"version",children:"Course version"}),(0,s.jsx)("input",{id:"version",value:i,onChange:e=>n(e.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",placeholder:"Example 2025.01"})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Questions"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:N.total})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Published"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:N.published})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Draft"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:N.draft})]})]}),(0,s.jsxs)("div",{className:"grid gap-2 md:grid-cols-[1fr_auto]",children:[(0,s.jsx)("input",{value:x,onChange:e=>m(e.target.value),placeholder:"Reason for change",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900"}),(0,s.jsx)("button",{type:"button",disabled:d,onClick:f,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:d?"Loading":"Refresh"})]}),h?(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Attempt analytics"}),(0,s.jsxs)("div",{className:"mt-2 grid gap-3 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Attempts"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:h.attempts.total})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Pass rate"}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[h.attempts.passRatePercent," percent"]})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:"Average score"}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[h.attempts.avgScore," percent"]})]})]})]}):null,r?(0,s.jsx)("div",{className:"text-sm font-semibold text-rose-700",children:r}):null]}),(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-white p-5 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Questions"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[(0,s.jsx)("span",{children:"Tag `published` is required for exam selection"}),(0,s.jsx)("a",{className:"font-semibold text-emerald-700 hover:underline",href:`/api/admin/assessments/answer-key?courseId=${encodeURIComponent(g.courseId)}&levelId=${encodeURIComponent(g.levelId)}&version=${encodeURIComponent(g.version)}`,children:"Download answer key"})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:(u?.questions||[]).map(t=>{let l=v===t.id;return(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-600",children:t.id}),(0,s.jsxs)("div",{className:"text-sm font-semibold text-slate-900",children:[t.type," Bloom ",t.bloomLevel]}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:t.published?"Published":"Draft"})]}),(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:e.canManage?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",disabled:d,onClick:()=>j(l?null:t.id),className:"rounded-full border border-slate-200 bg-white px-3 py-2 text-xs font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:l?"Close":"Edit"}),(0,s.jsx)("button",{type:"button",disabled:d,onClick:()=>y(t),className:"rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:t.published?"Unpublish":"Publish"})]}):(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Read only"})})]}),l?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Question"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:t.question,onChange:e=>{let s=e.target.value;p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,question:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Options"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(t.options||[]).join("\n"),onChange:e=>{let s=e.target.value.split("\n").map(e=>e.trim()).filter(Boolean);p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,options:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Correct answer index"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:"number"==typeof t.correctAnswer?String(t.correctAnswer):"",onChange:e=>{let s=Number(e.target.value);p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,correctAnswer:Number.isFinite(s)?s:0}:e)}:e)}}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"This editor supports MCQ index answers for now"})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Explanation"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:3,value:t.explanation,onChange:e=>{let s=e.target.value;p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,explanation:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Option rationales"}),(0,s.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",rows:4,value:(t.optionRationales||[]).join("\n"),onChange:e=>{let s=e.target.value.split("\n").map(e=>e.trimEnd());p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,optionRationales:s}:e)}:e)},placeholder:"One line per option. Include why each option is correct or wrong."}),(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Keep the number of lines aligned with options"})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Bloom level"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:String(t.bloomLevel),onChange:e=>{let s=Math.max(1,Math.min(6,Number(e.target.value)||1));p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,bloomLevel:s}:e)}:e)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"Tags"}),(0,s.jsx)("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900",value:t.tags,onChange:e=>{let s=e.target.value;p(e=>e?{...e,questions:e.questions.map(e=>e.id===t.id?{...e,tags:s}:e)}:e)}})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("button",{type:"button",disabled:d,onClick:()=>w(t),className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"}),(0,s.jsx)("button",{type:"button",disabled:d,onClick:()=>j(null),className:"rounded-full border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"})]})]}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-slate-900",children:t.question}),(0,s.jsx)("ol",{className:"ml-5 list-decimal space-y-1 text-sm text-slate-700",children:(t.options||[]).map((e,t)=>(0,s.jsx)("li",{children:e},t))}),(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:["Tags ",t.tags]})]})]},t.id)})})]})]})}e.s(["default",()=>l])}]);

//# debugId=4940e3b9-8eda-58e3-d4bc-72138af967be
//# sourceMappingURL=bb6e8f3160654046.js.map